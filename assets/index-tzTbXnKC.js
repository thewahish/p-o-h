function $3(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Na(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Kp={exports:{}},uu={},Hp={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _S;function U3(){if(_S)return st;_S=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(X){return X===null||typeof X!="object"?null:(X=p&&X[p]||X["@@iterator"],typeof X=="function"?X:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,y={};function S(X,M,J){this.props=X,this.context=M,this.refs=y,this.updater=J||v}S.prototype.isReactComponent={},S.prototype.setState=function(X,M){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,M,"setState")},S.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function T(){}T.prototype=S.prototype;function k(X,M,J){this.props=X,this.context=M,this.refs=y,this.updater=J||v}var A=k.prototype=new T;A.constructor=k,x(A,S.prototype),A.isPureReactComponent=!0;var P=Array.isArray,N=Object.prototype.hasOwnProperty,I={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function z(X,M,J){var G,K={},he=null,Oe=null;if(M!=null)for(G in M.ref!==void 0&&(Oe=M.ref),M.key!==void 0&&(he=""+M.key),M)N.call(M,G)&&!D.hasOwnProperty(G)&&(K[G]=M[G]);var Ne=arguments.length-2;if(Ne===1)K.children=J;else if(1<Ne){for(var re=Array(Ne),ye=0;ye<Ne;ye++)re[ye]=arguments[ye+2];K.children=re}if(X&&X.defaultProps)for(G in Ne=X.defaultProps,Ne)K[G]===void 0&&(K[G]=Ne[G]);return{$$typeof:e,type:X,key:he,ref:Oe,props:K,_owner:I.current}}function H(X,M){return{$$typeof:e,type:X.type,key:M,ref:X.ref,props:X.props,_owner:X._owner}}function te(X){return typeof X=="object"&&X!==null&&X.$$typeof===e}function q(X){var M={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(J){return M[J]})}var V=/\/+/g;function ae(X,M){return typeof X=="object"&&X!==null&&X.key!=null?q(""+X.key):M.toString(36)}function Ee(X,M,J,G,K){var he=typeof X;(he==="undefined"||he==="boolean")&&(X=null);var Oe=!1;if(X===null)Oe=!0;else switch(he){case"string":case"number":Oe=!0;break;case"object":switch(X.$$typeof){case e:case t:Oe=!0}}if(Oe)return Oe=X,K=K(Oe),X=G===""?"."+ae(Oe,0):G,P(K)?(J="",X!=null&&(J=X.replace(V,"$&/")+"/"),Ee(K,M,J,"",function(ye){return ye})):K!=null&&(te(K)&&(K=H(K,J+(!K.key||Oe&&Oe.key===K.key?"":(""+K.key).replace(V,"$&/")+"/")+X)),M.push(K)),1;if(Oe=0,G=G===""?".":G+":",P(X))for(var Ne=0;Ne<X.length;Ne++){he=X[Ne];var re=G+ae(he,Ne);Oe+=Ee(he,M,J,re,K)}else if(re=m(X),typeof re=="function")for(X=re.call(X),Ne=0;!(he=X.next()).done;)he=he.value,re=G+ae(he,Ne++),Oe+=Ee(he,M,J,re,K);else if(he==="object")throw M=String(X),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return Oe}function Z(X,M,J){if(X==null)return X;var G=[],K=0;return Ee(X,G,"","",function(he){return M.call(J,he,K++)}),G}function Te(X){if(X._status===-1){var M=X._result;M=M(),M.then(function(J){(X._status===0||X._status===-1)&&(X._status=1,X._result=J)},function(J){(X._status===0||X._status===-1)&&(X._status=2,X._result=J)}),X._status===-1&&(X._status=0,X._result=M)}if(X._status===1)return X._result.default;throw X._result}var Se={current:null},me={transition:null},we={ReactCurrentDispatcher:Se,ReactCurrentBatchConfig:me,ReactCurrentOwner:I};function be(){throw Error("act(...) is not supported in production builds of React.")}return st.Children={map:Z,forEach:function(X,M,J){Z(X,function(){M.apply(this,arguments)},J)},count:function(X){var M=0;return Z(X,function(){M++}),M},toArray:function(X){return Z(X,function(M){return M})||[]},only:function(X){if(!te(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},st.Component=S,st.Fragment=r,st.Profiler=a,st.PureComponent=k,st.StrictMode=n,st.Suspense=c,st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,st.act=be,st.cloneElement=function(X,M,J){if(X==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+X+".");var G=x({},X.props),K=X.key,he=X.ref,Oe=X._owner;if(M!=null){if(M.ref!==void 0&&(he=M.ref,Oe=I.current),M.key!==void 0&&(K=""+M.key),X.type&&X.type.defaultProps)var Ne=X.type.defaultProps;for(re in M)N.call(M,re)&&!D.hasOwnProperty(re)&&(G[re]=M[re]===void 0&&Ne!==void 0?Ne[re]:M[re])}var re=arguments.length-2;if(re===1)G.children=J;else if(1<re){Ne=Array(re);for(var ye=0;ye<re;ye++)Ne[ye]=arguments[ye+2];G.children=Ne}return{$$typeof:e,type:X.type,key:K,ref:he,props:G,_owner:Oe}},st.createContext=function(X){return X={$$typeof:o,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},X.Provider={$$typeof:i,_context:X},X.Consumer=X},st.createElement=z,st.createFactory=function(X){var M=z.bind(null,X);return M.type=X,M},st.createRef=function(){return{current:null}},st.forwardRef=function(X){return{$$typeof:u,render:X}},st.isValidElement=te,st.lazy=function(X){return{$$typeof:d,_payload:{_status:-1,_result:X},_init:Te}},st.memo=function(X,M){return{$$typeof:f,type:X,compare:M===void 0?null:M}},st.startTransition=function(X){var M=me.transition;me.transition={};try{X()}finally{me.transition=M}},st.unstable_act=be,st.useCallback=function(X,M){return Se.current.useCallback(X,M)},st.useContext=function(X){return Se.current.useContext(X)},st.useDebugValue=function(){},st.useDeferredValue=function(X){return Se.current.useDeferredValue(X)},st.useEffect=function(X,M){return Se.current.useEffect(X,M)},st.useId=function(){return Se.current.useId()},st.useImperativeHandle=function(X,M,J){return Se.current.useImperativeHandle(X,M,J)},st.useInsertionEffect=function(X,M){return Se.current.useInsertionEffect(X,M)},st.useLayoutEffect=function(X,M){return Se.current.useLayoutEffect(X,M)},st.useMemo=function(X,M){return Se.current.useMemo(X,M)},st.useReducer=function(X,M,J){return Se.current.useReducer(X,M,J)},st.useRef=function(X){return Se.current.useRef(X)},st.useState=function(X){return Se.current.useState(X)},st.useSyncExternalStore=function(X,M,J){return Se.current.useSyncExternalStore(X,M,J)},st.useTransition=function(){return Se.current.useTransition()},st.version="18.3.1",st}var TS;function sl(){return TS||(TS=1,Hp.exports=U3()),Hp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AS;function W3(){if(AS)return uu;AS=1;var e=sl(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(u,c,f){var d,p={},m=null,v=null;f!==void 0&&(m=""+f),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(v=c.ref);for(d in c)n.call(c,d)&&!i.hasOwnProperty(d)&&(p[d]=c[d]);if(u&&u.defaultProps)for(d in c=u.defaultProps,c)p[d]===void 0&&(p[d]=c[d]);return{$$typeof:t,type:u,key:m,ref:v,props:p,_owner:a.current}}return uu.Fragment=r,uu.jsx=o,uu.jsxs=o,uu}var kS;function z3(){return kS||(kS=1,Kp.exports=W3()),Kp.exports}var b=z3(),_=sl();const gd=Na(_),K3=$3({__proto__:null,default:gd},[_]);var If={},Vp={exports:{}},dn={},Gp={exports:{}},Yp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS;function H3(){return OS||(OS=1,function(e){function t(me,we){var be=me.length;me.push(we);e:for(;0<be;){var X=be-1>>>1,M=me[X];if(0<a(M,we))me[X]=we,me[be]=M,be=X;else break e}}function r(me){return me.length===0?null:me[0]}function n(me){if(me.length===0)return null;var we=me[0],be=me.pop();if(be!==we){me[0]=be;e:for(var X=0,M=me.length,J=M>>>1;X<J;){var G=2*(X+1)-1,K=me[G],he=G+1,Oe=me[he];if(0>a(K,be))he<M&&0>a(Oe,K)?(me[X]=Oe,me[he]=be,X=he):(me[X]=K,me[G]=be,X=G);else if(he<M&&0>a(Oe,be))me[X]=Oe,me[he]=be,X=he;else break e}}return we}function a(me,we){var be=me.sortIndex-we.sortIndex;return be!==0?be:me.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var c=[],f=[],d=1,p=null,m=3,v=!1,x=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(me){for(var we=r(f);we!==null;){if(we.callback===null)n(f);else if(we.startTime<=me)n(f),we.sortIndex=we.expirationTime,t(c,we);else break;we=r(f)}}function P(me){if(y=!1,A(me),!x)if(r(c)!==null)x=!0,Te(N);else{var we=r(f);we!==null&&Se(P,we.startTime-me)}}function N(me,we){x=!1,y&&(y=!1,T(z),z=-1),v=!0;var be=m;try{for(A(we),p=r(c);p!==null&&(!(p.expirationTime>we)||me&&!q());){var X=p.callback;if(typeof X=="function"){p.callback=null,m=p.priorityLevel;var M=X(p.expirationTime<=we);we=e.unstable_now(),typeof M=="function"?p.callback=M:p===r(c)&&n(c),A(we)}else n(c);p=r(c)}if(p!==null)var J=!0;else{var G=r(f);G!==null&&Se(P,G.startTime-we),J=!1}return J}finally{p=null,m=be,v=!1}}var I=!1,D=null,z=-1,H=5,te=-1;function q(){return!(e.unstable_now()-te<H)}function V(){if(D!==null){var me=e.unstable_now();te=me;var we=!0;try{we=D(!0,me)}finally{we?ae():(I=!1,D=null)}}else I=!1}var ae;if(typeof k=="function")ae=function(){k(V)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Z=Ee.port2;Ee.port1.onmessage=V,ae=function(){Z.postMessage(null)}}else ae=function(){S(V,0)};function Te(me){D=me,I||(I=!0,ae())}function Se(me,we){z=S(function(){me(e.unstable_now())},we)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(me){me.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,Te(N))},e.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<me?Math.floor(1e3/me):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(me){switch(m){case 1:case 2:case 3:var we=3;break;default:we=m}var be=m;m=we;try{return me()}finally{m=be}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(me,we){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var be=m;m=me;try{return we()}finally{m=be}},e.unstable_scheduleCallback=function(me,we,be){var X=e.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?X+be:X):be=X,me){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=be+M,me={id:d++,callback:we,priorityLevel:me,startTime:be,expirationTime:M,sortIndex:-1},be>X?(me.sortIndex=be,t(f,me),r(c)===null&&me===r(f)&&(y?(T(z),z=-1):y=!0,Se(P,be-X))):(me.sortIndex=M,t(c,me),x||v||(x=!0,Te(N))),me},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(me){var we=m;return function(){var be=m;m=we;try{return me.apply(this,arguments)}finally{m=be}}}}(Yp)),Yp}var PS;function V3(){return PS||(PS=1,Gp.exports=H3()),Gp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CS;function G3(){if(CS)return dn;CS=1;var e=sl(),t=V3();function r(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(s,l){o(s,l),o(s+"Capture",l)}function o(s,l){for(a[s]=l,s=0;s<l.length;s++)n.add(l[s])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function m(s){return c.call(p,s)?!0:c.call(d,s)?!1:f.test(s)?p[s]=!0:(d[s]=!0,!1)}function v(s,l,h,g){if(h!==null&&h.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function x(s,l,h,g){if(l===null||typeof l>"u"||v(s,l,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function y(s,l,h,g,w,E,O){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=h,this.propertyName=s,this.type=l,this.sanitizeURL=E,this.removeEmptyString=O}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){S[s]=new y(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];S[l]=new y(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){S[s]=new y(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){S[s]=new y(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){S[s]=new y(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){S[s]=new y(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){S[s]=new y(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){S[s]=new y(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){S[s]=new y(s,5,!1,s.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function k(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(T,k);S[l]=new y(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(T,k);S[l]=new y(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(T,k);S[l]=new y(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){S[s]=new y(s,1,!1,s.toLowerCase(),null,!1,!1)}),S.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){S[s]=new y(s,1,!1,s.toLowerCase(),null,!0,!0)});function A(s,l,h,g){var w=S.hasOwnProperty(l)?S[l]:null;(w!==null?w.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(x(l,h,w,g)&&(h=null),g||w===null?m(l)&&(h===null?s.removeAttribute(l):s.setAttribute(l,""+h)):w.mustUseProperty?s[w.propertyName]=h===null?w.type===3?!1:"":h:(l=w.attributeName,g=w.attributeNamespace,h===null?s.removeAttribute(l):(w=w.type,h=w===3||w===4&&h===!0?"":""+h,g?s.setAttributeNS(g,l,h):s.setAttribute(l,h))))}var P=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),I=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),q=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),Se=Symbol.for("react.offscreen"),me=Symbol.iterator;function we(s){return s===null||typeof s!="object"?null:(s=me&&s[me]||s["@@iterator"],typeof s=="function"?s:null)}var be=Object.assign,X;function M(s){if(X===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);X=l&&l[1]||""}return`
`+X+s}var J=!1;function G(s,l){if(!s||J)return"";J=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(fe){var g=fe}Reflect.construct(s,[],l)}else{try{l.call()}catch(fe){g=fe}s.call(l.prototype)}else{try{throw Error()}catch(fe){g=fe}s()}}catch(fe){if(fe&&g&&typeof fe.stack=="string"){for(var w=fe.stack.split(`
`),E=g.stack.split(`
`),O=w.length-1,W=E.length-1;1<=O&&0<=W&&w[O]!==E[W];)W--;for(;1<=O&&0<=W;O--,W--)if(w[O]!==E[W]){if(O!==1||W!==1)do if(O--,W--,0>W||w[O]!==E[W]){var Y=`
`+w[O].replace(" at new "," at ");return s.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",s.displayName)),Y}while(1<=O&&0<=W);break}}}finally{J=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?M(s):""}function K(s){switch(s.tag){case 5:return M(s.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return s=G(s.type,!1),s;case 11:return s=G(s.type.render,!1),s;case 1:return s=G(s.type,!0),s;default:return""}}function he(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case I:return"Portal";case H:return"Profiler";case z:return"StrictMode";case ae:return"Suspense";case Ee:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case q:return(s.displayName||"Context")+".Consumer";case te:return(s._context.displayName||"Context")+".Provider";case V:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Z:return l=s.displayName||null,l!==null?l:he(s.type)||"Memo";case Te:l=s._payload,s=s._init;try{return he(s(l))}catch{}}return null}function Oe(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(l);case 8:return l===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ne(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function re(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ye(s){var l=re(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),g=""+s[l];if(!s.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,E=h.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return w.call(this)},set:function(O){g=""+O,E.call(this,O)}}),Object.defineProperty(s,l,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(O){g=""+O},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Be(s){s._valueTracker||(s._valueTracker=ye(s))}function ge(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var h=l.getValue(),g="";return s&&(g=re(s)?s.checked?"true":"false":s.value),s=g,s!==h?(l.setValue(s),!0):!1}function ot(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ze(s,l){var h=l.checked;return be({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??s._wrapperState.initialChecked})}function bt(s,l){var h=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;h=Ne(l.value!=null?l.value:h),s._wrapperState={initialChecked:g,initialValue:h,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function at(s,l){l=l.checked,l!=null&&A(s,"checked",l,!1)}function pe(s,l){at(s,l);var h=Ne(l.value),g=l.type;if(h!=null)g==="number"?(h===0&&s.value===""||s.value!=h)&&(s.value=""+h):s.value!==""+h&&(s.value=""+h);else if(g==="submit"||g==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?Xe(s,l.type,h):l.hasOwnProperty("defaultValue")&&Xe(s,l.type,Ne(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function qe(s,l,h){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,h||l===s.value||(s.value=l),s.defaultValue=l}h=s.name,h!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,h!==""&&(s.name=h)}function Xe(s,l,h){(l!=="number"||ot(s.ownerDocument)!==s)&&(h==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+h&&(s.defaultValue=""+h))}var rt=Array.isArray;function lt(s,l,h,g){if(s=s.options,l){l={};for(var w=0;w<h.length;w++)l["$"+h[w]]=!0;for(h=0;h<s.length;h++)w=l.hasOwnProperty("$"+s[h].value),s[h].selected!==w&&(s[h].selected=w),w&&g&&(s[h].defaultSelected=!0)}else{for(h=""+Ne(h),l=null,w=0;w<s.length;w++){if(s[w].value===h){s[w].selected=!0,g&&(s[w].defaultSelected=!0);return}l!==null||s[w].disabled||(l=s[w])}l!==null&&(l.selected=!0)}}function Nt(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return be({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Vt(s,l){var h=l.value;if(h==null){if(h=l.children,l=l.defaultValue,h!=null){if(l!=null)throw Error(r(92));if(rt(h)){if(1<h.length)throw Error(r(93));h=h[0]}l=h}l==null&&(l=""),h=l}s._wrapperState={initialValue:Ne(h)}}function or(s,l){var h=Ne(l.value),g=Ne(l.defaultValue);h!=null&&(h=""+h,h!==s.value&&(s.value=h),l.defaultValue==null&&s.defaultValue!==h&&(s.defaultValue=h)),g!=null&&(s.defaultValue=""+g)}function gr(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function Da(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ma(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?Da(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var sn,Ec=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,h,g,w){MSApp.execUnsafeLocalFunction(function(){return s(l,h,g,w)})}:s}(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for(sn=sn||document.createElement("div"),sn.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=sn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function hi(s,l){if(l){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=l;return}}s.textContent=l}var pi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_c=["Webkit","ms","Moz","O"];Object.keys(pi).forEach(function(s){_c.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),pi[l]=pi[s]})});function El(s,l,h){return l==null||typeof l=="boolean"||l===""?"":h||typeof l!="number"||l===0||pi.hasOwnProperty(s)&&pi[s]?(""+l).trim():l+"px"}function _l(s,l){s=s.style;for(var h in l)if(l.hasOwnProperty(h)){var g=h.indexOf("--")===0,w=El(h,l[h],g);h==="float"&&(h="cssFloat"),g?s.setProperty(h,w):s[h]=w}}var Tc=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tl(s,l){if(l){if(Tc[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function Al(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ao=null;function io(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var so=null,mi=null,gi=null;function ss(s){if(s=Yl(s)){if(typeof so!="function")throw Error(r(280));var l=s.stateNode;l&&(l=qc(l),so(s.stateNode,s.type,l))}}function Ac(s){mi?gi?gi.push(s):gi=[s]:mi=s}function kc(){if(mi){var s=mi,l=gi;if(gi=mi=null,ss(s),l)for(s=0;s<l.length;s++)ss(l[s])}}function Oc(s,l){return s(l)}function Pc(){}var kl=!1;function Cc(s,l,h){if(kl)return s(l,h);kl=!0;try{return Oc(s,l,h)}finally{kl=!1,(mi!==null||gi!==null)&&(Pc(),kc())}}function os(s,l){var h=s.stateNode;if(h===null)return null;var g=qc(h);if(g===null)return null;h=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(r(231,l,typeof h));return h}var Ol=!1;if(u)try{var Ra={};Object.defineProperty(Ra,"passive",{get:function(){Ol=!0}}),window.addEventListener("test",Ra,Ra),window.removeEventListener("test",Ra,Ra)}catch{Ol=!1}function ch(s,l,h,g,w,E,O,W,Y){var fe=Array.prototype.slice.call(arguments,3);try{l.apply(h,fe)}catch(ke){this.onError(ke)}}var ls=!1,oo=null,C=!1,j=null,R={onError:function(s){ls=!0,oo=s}};function F(s,l,h,g,w,E,O,W,Y){ls=!1,oo=null,ch.apply(R,arguments)}function L(s,l,h,g,w,E,O,W,Y){if(F.apply(this,arguments),ls){if(ls){var fe=oo;ls=!1,oo=null}else throw Error(r(198));C||(C=!0,j=fe)}}function B(s){var l=s,h=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(h=l.return),s=l.return;while(s)}return l.tag===3?h:null}function oe(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function xe(s){if(B(s)!==s)throw Error(r(188))}function se(s){var l=s.alternate;if(!l){if(l=B(s),l===null)throw Error(r(188));return l!==s?null:s}for(var h=s,g=l;;){var w=h.return;if(w===null)break;var E=w.alternate;if(E===null){if(g=w.return,g!==null){h=g;continue}break}if(w.child===E.child){for(E=w.child;E;){if(E===h)return xe(w),s;if(E===g)return xe(w),l;E=E.sibling}throw Error(r(188))}if(h.return!==g.return)h=w,g=E;else{for(var O=!1,W=w.child;W;){if(W===h){O=!0,h=w,g=E;break}if(W===g){O=!0,g=w,h=E;break}W=W.sibling}if(!O){for(W=E.child;W;){if(W===h){O=!0,h=E,g=w;break}if(W===g){O=!0,g=E,h=w;break}W=W.sibling}if(!O)throw Error(r(189))}}if(h.alternate!==g)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?s:l}function ue(s){return s=se(s),s!==null?ce(s):null}function ce(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=ce(s);if(l!==null)return l;s=s.sibling}return null}var Pe=t.unstable_scheduleCallback,je=t.unstable_cancelCallback,$e=t.unstable_shouldYield,Me=t.unstable_requestPaint,De=t.unstable_now,nt=t.unstable_getCurrentPriorityLevel,Tt=t.unstable_ImmediatePriority,kt=t.unstable_UserBlockingPriority,Qt=t.unstable_NormalPriority,us=t.unstable_LowPriority,vi=t.unstable_IdlePriority,xa=null,vr=null;function Pl(s){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(xa,s,void 0,(s.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:aN,rN=Math.log,nN=Math.LN2;function aN(s){return s>>>=0,s===0?32:31-(rN(s)/nN|0)|0}var Nc=64,Dc=4194304;function Cl(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Mc(s,l){var h=s.pendingLanes;if(h===0)return 0;var g=0,w=s.suspendedLanes,E=s.pingedLanes,O=h&268435455;if(O!==0){var W=O&~w;W!==0?g=Cl(W):(E&=O,E!==0&&(g=Cl(E)))}else O=h&~w,O!==0?g=Cl(O):E!==0&&(g=Cl(E));if(g===0)return 0;if(l!==0&&l!==g&&(l&w)===0&&(w=g&-g,E=l&-l,w>=E||w===16&&(E&4194240)!==0))return l;if((g&4)!==0&&(g|=h&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=g;0<l;)h=31-Zt(l),w=1<<h,g|=s[h],l&=~w;return g}function iN(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sN(s,l){for(var h=s.suspendedLanes,g=s.pingedLanes,w=s.expirationTimes,E=s.pendingLanes;0<E;){var O=31-Zt(E),W=1<<O,Y=w[O];Y===-1?((W&h)===0||(W&g)!==0)&&(w[O]=iN(W,l)):Y<=l&&(s.expiredLanes|=W),E&=~W}}function fh(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function tx(){var s=Nc;return Nc<<=1,(Nc&4194240)===0&&(Nc=64),s}function dh(s){for(var l=[],h=0;31>h;h++)l.push(s);return l}function Nl(s,l,h){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-Zt(l),s[l]=h}function oN(s,l){var h=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var g=s.eventTimes;for(s=s.expirationTimes;0<h;){var w=31-Zt(h),E=1<<w;l[w]=0,g[w]=-1,s[w]=-1,h&=~E}}function hh(s,l){var h=s.entangledLanes|=l;for(s=s.entanglements;h;){var g=31-Zt(h),w=1<<g;w&l|s[g]&l&&(s[g]|=l),h&=~w}}var gt=0;function rx(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var nx,ph,ax,ix,sx,mh=!1,Rc=[],yi=null,xi=null,wi=null,Dl=new Map,Ml=new Map,Si=[],lN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ox(s,l){switch(s){case"focusin":case"focusout":yi=null;break;case"dragenter":case"dragleave":xi=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":Dl.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ml.delete(l.pointerId)}}function Rl(s,l,h,g,w,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:h,eventSystemFlags:g,nativeEvent:E,targetContainers:[w]},l!==null&&(l=Yl(l),l!==null&&ph(l)),s):(s.eventSystemFlags|=g,l=s.targetContainers,w!==null&&l.indexOf(w)===-1&&l.push(w),s)}function uN(s,l,h,g,w){switch(l){case"focusin":return yi=Rl(yi,s,l,h,g,w),!0;case"dragenter":return xi=Rl(xi,s,l,h,g,w),!0;case"mouseover":return wi=Rl(wi,s,l,h,g,w),!0;case"pointerover":var E=w.pointerId;return Dl.set(E,Rl(Dl.get(E)||null,s,l,h,g,w)),!0;case"gotpointercapture":return E=w.pointerId,Ml.set(E,Rl(Ml.get(E)||null,s,l,h,g,w)),!0}return!1}function lx(s){var l=cs(s.target);if(l!==null){var h=B(l);if(h!==null){if(l=h.tag,l===13){if(l=oe(h),l!==null){s.blockedOn=l,sx(s.priority,function(){ax(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ic(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var h=vh(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(h===null){h=s.nativeEvent;var g=new h.constructor(h.type,h);ao=g,h.target.dispatchEvent(g),ao=null}else return l=Yl(h),l!==null&&ph(l),s.blockedOn=h,!1;l.shift()}return!0}function ux(s,l,h){Ic(s)&&h.delete(l)}function cN(){mh=!1,yi!==null&&Ic(yi)&&(yi=null),xi!==null&&Ic(xi)&&(xi=null),wi!==null&&Ic(wi)&&(wi=null),Dl.forEach(ux),Ml.forEach(ux)}function Il(s,l){s.blockedOn===l&&(s.blockedOn=null,mh||(mh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,cN)))}function Fl(s){function l(w){return Il(w,s)}if(0<Rc.length){Il(Rc[0],s);for(var h=1;h<Rc.length;h++){var g=Rc[h];g.blockedOn===s&&(g.blockedOn=null)}}for(yi!==null&&Il(yi,s),xi!==null&&Il(xi,s),wi!==null&&Il(wi,s),Dl.forEach(l),Ml.forEach(l),h=0;h<Si.length;h++)g=Si[h],g.blockedOn===s&&(g.blockedOn=null);for(;0<Si.length&&(h=Si[0],h.blockedOn===null);)lx(h),h.blockedOn===null&&Si.shift()}var lo=P.ReactCurrentBatchConfig,Fc=!0;function fN(s,l,h,g){var w=gt,E=lo.transition;lo.transition=null;try{gt=1,gh(s,l,h,g)}finally{gt=w,lo.transition=E}}function dN(s,l,h,g){var w=gt,E=lo.transition;lo.transition=null;try{gt=4,gh(s,l,h,g)}finally{gt=w,lo.transition=E}}function gh(s,l,h,g){if(Fc){var w=vh(s,l,h,g);if(w===null)Rh(s,l,g,jc,h),ox(s,g);else if(uN(w,s,l,h,g))g.stopPropagation();else if(ox(s,g),l&4&&-1<lN.indexOf(s)){for(;w!==null;){var E=Yl(w);if(E!==null&&nx(E),E=vh(s,l,h,g),E===null&&Rh(s,l,g,jc,h),E===w)break;w=E}w!==null&&g.stopPropagation()}else Rh(s,l,g,null,h)}}var jc=null;function vh(s,l,h,g){if(jc=null,s=io(g),s=cs(s),s!==null)if(l=B(s),l===null)s=null;else if(h=l.tag,h===13){if(s=oe(l),s!==null)return s;s=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return jc=s,null}function cx(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nt()){case Tt:return 1;case kt:return 4;case Qt:case us:return 16;case vi:return 536870912;default:return 16}default:return 16}}var bi=null,yh=null,Lc=null;function fx(){if(Lc)return Lc;var s,l=yh,h=l.length,g,w="value"in bi?bi.value:bi.textContent,E=w.length;for(s=0;s<h&&l[s]===w[s];s++);var O=h-s;for(g=1;g<=O&&l[h-g]===w[E-g];g++);return Lc=w.slice(s,1<g?1-g:void 0)}function Bc(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function $c(){return!0}function dx(){return!1}function xn(s){function l(h,g,w,E,O){this._reactName=h,this._targetInst=w,this.type=g,this.nativeEvent=E,this.target=O,this.currentTarget=null;for(var W in s)s.hasOwnProperty(W)&&(h=s[W],this[W]=h?h(E):E[W]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?$c:dx,this.isPropagationStopped=dx,this}return be(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=$c)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=$c)},persist:function(){},isPersistent:$c}),l}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xh=xn(uo),jl=be({},uo,{view:0,detail:0}),hN=xn(jl),wh,Sh,Ll,Uc=be({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Eh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ll&&(Ll&&s.type==="mousemove"?(wh=s.screenX-Ll.screenX,Sh=s.screenY-Ll.screenY):Sh=wh=0,Ll=s),wh)},movementY:function(s){return"movementY"in s?s.movementY:Sh}}),hx=xn(Uc),pN=be({},Uc,{dataTransfer:0}),mN=xn(pN),gN=be({},jl,{relatedTarget:0}),bh=xn(gN),vN=be({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),yN=xn(vN),xN=be({},uo,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),wN=xn(xN),SN=be({},uo,{data:0}),px=xn(SN),bN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_N={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TN(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=_N[s])?!!l[s]:!1}function Eh(){return TN}var AN=be({},jl,{key:function(s){if(s.key){var l=bN[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Bc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?EN[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Eh,charCode:function(s){return s.type==="keypress"?Bc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Bc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),kN=xn(AN),ON=be({},Uc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mx=xn(ON),PN=be({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Eh}),CN=xn(PN),NN=be({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),DN=xn(NN),MN=be({},Uc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),RN=xn(MN),IN=[9,13,27,32],_h=u&&"CompositionEvent"in window,Bl=null;u&&"documentMode"in document&&(Bl=document.documentMode);var FN=u&&"TextEvent"in window&&!Bl,gx=u&&(!_h||Bl&&8<Bl&&11>=Bl),vx=" ",yx=!1;function xx(s,l){switch(s){case"keyup":return IN.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wx(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var co=!1;function jN(s,l){switch(s){case"compositionend":return wx(l);case"keypress":return l.which!==32?null:(yx=!0,vx);case"textInput":return s=l.data,s===vx&&yx?null:s;default:return null}}function LN(s,l){if(co)return s==="compositionend"||!_h&&xx(s,l)?(s=fx(),Lc=yh=bi=null,co=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return gx&&l.locale!=="ko"?null:l.data;default:return null}}var BN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sx(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!BN[s.type]:l==="textarea"}function bx(s,l,h,g){Ac(g),l=Vc(l,"onChange"),0<l.length&&(h=new xh("onChange","change",null,h,g),s.push({event:h,listeners:l}))}var $l=null,Ul=null;function $N(s){$x(s,0)}function Wc(s){var l=go(s);if(ge(l))return s}function UN(s,l){if(s==="change")return l}var Ex=!1;if(u){var Th;if(u){var Ah="oninput"in document;if(!Ah){var _x=document.createElement("div");_x.setAttribute("oninput","return;"),Ah=typeof _x.oninput=="function"}Th=Ah}else Th=!1;Ex=Th&&(!document.documentMode||9<document.documentMode)}function Tx(){$l&&($l.detachEvent("onpropertychange",Ax),Ul=$l=null)}function Ax(s){if(s.propertyName==="value"&&Wc(Ul)){var l=[];bx(l,Ul,s,io(s)),Cc($N,l)}}function WN(s,l,h){s==="focusin"?(Tx(),$l=l,Ul=h,$l.attachEvent("onpropertychange",Ax)):s==="focusout"&&Tx()}function zN(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Wc(Ul)}function KN(s,l){if(s==="click")return Wc(l)}function HN(s,l){if(s==="input"||s==="change")return Wc(l)}function VN(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ra=typeof Object.is=="function"?Object.is:VN;function Wl(s,l){if(ra(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var h=Object.keys(s),g=Object.keys(l);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var w=h[g];if(!c.call(l,w)||!ra(s[w],l[w]))return!1}return!0}function kx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ox(s,l){var h=kx(s);s=0;for(var g;h;){if(h.nodeType===3){if(g=s+h.textContent.length,s<=l&&g>=l)return{node:h,offset:l-s};s=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=kx(h)}}function Px(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Px(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Cx(){for(var s=window,l=ot();l instanceof s.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)s=l.contentWindow;else break;l=ot(s.document)}return l}function kh(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function GN(s){var l=Cx(),h=s.focusedElem,g=s.selectionRange;if(l!==h&&h&&h.ownerDocument&&Px(h.ownerDocument.documentElement,h)){if(g!==null&&kh(h)){if(l=g.start,s=g.end,s===void 0&&(s=l),"selectionStart"in h)h.selectionStart=l,h.selectionEnd=Math.min(s,h.value.length);else if(s=(l=h.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var w=h.textContent.length,E=Math.min(g.start,w);g=g.end===void 0?E:Math.min(g.end,w),!s.extend&&E>g&&(w=g,g=E,E=w),w=Ox(h,E);var O=Ox(h,g);w&&O&&(s.rangeCount!==1||s.anchorNode!==w.node||s.anchorOffset!==w.offset||s.focusNode!==O.node||s.focusOffset!==O.offset)&&(l=l.createRange(),l.setStart(w.node,w.offset),s.removeAllRanges(),E>g?(s.addRange(l),s.extend(O.node,O.offset)):(l.setEnd(O.node,O.offset),s.addRange(l)))}}for(l=[],s=h;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<l.length;h++)s=l[h],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var YN=u&&"documentMode"in document&&11>=document.documentMode,fo=null,Oh=null,zl=null,Ph=!1;function Nx(s,l,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ph||fo==null||fo!==ot(g)||(g=fo,"selectionStart"in g&&kh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),zl&&Wl(zl,g)||(zl=g,g=Vc(Oh,"onSelect"),0<g.length&&(l=new xh("onSelect","select",null,l,h),s.push({event:l,listeners:g}),l.target=fo)))}function zc(s,l){var h={};return h[s.toLowerCase()]=l.toLowerCase(),h["Webkit"+s]="webkit"+l,h["Moz"+s]="moz"+l,h}var ho={animationend:zc("Animation","AnimationEnd"),animationiteration:zc("Animation","AnimationIteration"),animationstart:zc("Animation","AnimationStart"),transitionend:zc("Transition","TransitionEnd")},Ch={},Dx={};u&&(Dx=document.createElement("div").style,"AnimationEvent"in window||(delete ho.animationend.animation,delete ho.animationiteration.animation,delete ho.animationstart.animation),"TransitionEvent"in window||delete ho.transitionend.transition);function Kc(s){if(Ch[s])return Ch[s];if(!ho[s])return s;var l=ho[s],h;for(h in l)if(l.hasOwnProperty(h)&&h in Dx)return Ch[s]=l[h];return s}var Mx=Kc("animationend"),Rx=Kc("animationiteration"),Ix=Kc("animationstart"),Fx=Kc("transitionend"),jx=new Map,Lx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(s,l){jx.set(s,l),i(l,[s])}for(var Nh=0;Nh<Lx.length;Nh++){var Dh=Lx[Nh],qN=Dh.toLowerCase(),XN=Dh[0].toUpperCase()+Dh.slice(1);Ei(qN,"on"+XN)}Ei(Mx,"onAnimationEnd"),Ei(Rx,"onAnimationIteration"),Ei(Ix,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(Fx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kl));function Bx(s,l,h){var g=s.type||"unknown-event";s.currentTarget=h,L(g,l,void 0,s),s.currentTarget=null}function $x(s,l){l=(l&4)!==0;for(var h=0;h<s.length;h++){var g=s[h],w=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var O=g.length-1;0<=O;O--){var W=g[O],Y=W.instance,fe=W.currentTarget;if(W=W.listener,Y!==E&&w.isPropagationStopped())break e;Bx(w,W,fe),E=Y}else for(O=0;O<g.length;O++){if(W=g[O],Y=W.instance,fe=W.currentTarget,W=W.listener,Y!==E&&w.isPropagationStopped())break e;Bx(w,W,fe),E=Y}}}if(C)throw s=j,C=!1,j=null,s}function Dt(s,l){var h=l[$h];h===void 0&&(h=l[$h]=new Set);var g=s+"__bubble";h.has(g)||(Ux(l,s,2,!1),h.add(g))}function Mh(s,l,h){var g=0;l&&(g|=4),Ux(h,s,g,l)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function Hl(s){if(!s[Hc]){s[Hc]=!0,n.forEach(function(h){h!=="selectionchange"&&(QN.has(h)||Mh(h,!1,s),Mh(h,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Hc]||(l[Hc]=!0,Mh("selectionchange",!1,l))}}function Ux(s,l,h,g){switch(cx(l)){case 1:var w=fN;break;case 4:w=dN;break;default:w=gh}h=w.bind(null,l,h,s),w=void 0,!Ol||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(w=!0),g?w!==void 0?s.addEventListener(l,h,{capture:!0,passive:w}):s.addEventListener(l,h,!0):w!==void 0?s.addEventListener(l,h,{passive:w}):s.addEventListener(l,h,!1)}function Rh(s,l,h,g,w){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var O=g.tag;if(O===3||O===4){var W=g.stateNode.containerInfo;if(W===w||W.nodeType===8&&W.parentNode===w)break;if(O===4)for(O=g.return;O!==null;){var Y=O.tag;if((Y===3||Y===4)&&(Y=O.stateNode.containerInfo,Y===w||Y.nodeType===8&&Y.parentNode===w))return;O=O.return}for(;W!==null;){if(O=cs(W),O===null)return;if(Y=O.tag,Y===5||Y===6){g=E=O;continue e}W=W.parentNode}}g=g.return}Cc(function(){var fe=E,ke=io(h),Ce=[];e:{var Ae=jx.get(s);if(Ae!==void 0){var Le=xh,Ke=s;switch(s){case"keypress":if(Bc(h)===0)break e;case"keydown":case"keyup":Le=kN;break;case"focusin":Ke="focus",Le=bh;break;case"focusout":Ke="blur",Le=bh;break;case"beforeblur":case"afterblur":Le=bh;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=hx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=mN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=CN;break;case Mx:case Rx:case Ix:Le=yN;break;case Fx:Le=DN;break;case"scroll":Le=hN;break;case"wheel":Le=RN;break;case"copy":case"cut":case"paste":Le=wN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=mx}var He=(l&4)!==0,Jt=!He&&s==="scroll",ne=He?Ae!==null?Ae+"Capture":null:Ae;He=[];for(var Q=fe,ie;Q!==null;){ie=Q;var Re=ie.stateNode;if(ie.tag===5&&Re!==null&&(ie=Re,ne!==null&&(Re=os(Q,ne),Re!=null&&He.push(Vl(Q,Re,ie)))),Jt)break;Q=Q.return}0<He.length&&(Ae=new Le(Ae,Ke,null,h,ke),Ce.push({event:Ae,listeners:He}))}}if((l&7)===0){e:{if(Ae=s==="mouseover"||s==="pointerover",Le=s==="mouseout"||s==="pointerout",Ae&&h!==ao&&(Ke=h.relatedTarget||h.fromElement)&&(cs(Ke)||Ke[Ia]))break e;if((Le||Ae)&&(Ae=ke.window===ke?ke:(Ae=ke.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Le?(Ke=h.relatedTarget||h.toElement,Le=fe,Ke=Ke?cs(Ke):null,Ke!==null&&(Jt=B(Ke),Ke!==Jt||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):(Le=null,Ke=fe),Le!==Ke)){if(He=hx,Re="onMouseLeave",ne="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(He=mx,Re="onPointerLeave",ne="onPointerEnter",Q="pointer"),Jt=Le==null?Ae:go(Le),ie=Ke==null?Ae:go(Ke),Ae=new He(Re,Q+"leave",Le,h,ke),Ae.target=Jt,Ae.relatedTarget=ie,Re=null,cs(ke)===fe&&(He=new He(ne,Q+"enter",Ke,h,ke),He.target=ie,He.relatedTarget=Jt,Re=He),Jt=Re,Le&&Ke)t:{for(He=Le,ne=Ke,Q=0,ie=He;ie;ie=po(ie))Q++;for(ie=0,Re=ne;Re;Re=po(Re))ie++;for(;0<Q-ie;)He=po(He),Q--;for(;0<ie-Q;)ne=po(ne),ie--;for(;Q--;){if(He===ne||ne!==null&&He===ne.alternate)break t;He=po(He),ne=po(ne)}He=null}else He=null;Le!==null&&Wx(Ce,Ae,Le,He,!1),Ke!==null&&Jt!==null&&Wx(Ce,Jt,Ke,He,!0)}}e:{if(Ae=fe?go(fe):window,Le=Ae.nodeName&&Ae.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Ae.type==="file")var Ve=UN;else if(Sx(Ae))if(Ex)Ve=HN;else{Ve=zN;var Qe=WN}else(Le=Ae.nodeName)&&Le.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(Ve=KN);if(Ve&&(Ve=Ve(s,fe))){bx(Ce,Ve,h,ke);break e}Qe&&Qe(s,Ae,fe),s==="focusout"&&(Qe=Ae._wrapperState)&&Qe.controlled&&Ae.type==="number"&&Xe(Ae,"number",Ae.value)}switch(Qe=fe?go(fe):window,s){case"focusin":(Sx(Qe)||Qe.contentEditable==="true")&&(fo=Qe,Oh=fe,zl=null);break;case"focusout":zl=Oh=fo=null;break;case"mousedown":Ph=!0;break;case"contextmenu":case"mouseup":case"dragend":Ph=!1,Nx(Ce,h,ke);break;case"selectionchange":if(YN)break;case"keydown":case"keyup":Nx(Ce,h,ke)}var Ze;if(_h)e:{switch(s){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else co?xx(s,h)&&(et="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(et="onCompositionStart");et&&(gx&&h.locale!=="ko"&&(co||et!=="onCompositionStart"?et==="onCompositionEnd"&&co&&(Ze=fx()):(bi=ke,yh="value"in bi?bi.value:bi.textContent,co=!0)),Qe=Vc(fe,et),0<Qe.length&&(et=new px(et,s,null,h,ke),Ce.push({event:et,listeners:Qe}),Ze?et.data=Ze:(Ze=wx(h),Ze!==null&&(et.data=Ze)))),(Ze=FN?jN(s,h):LN(s,h))&&(fe=Vc(fe,"onBeforeInput"),0<fe.length&&(ke=new px("onBeforeInput","beforeinput",null,h,ke),Ce.push({event:ke,listeners:fe}),ke.data=Ze))}$x(Ce,l)})}function Vl(s,l,h){return{instance:s,listener:l,currentTarget:h}}function Vc(s,l){for(var h=l+"Capture",g=[];s!==null;){var w=s,E=w.stateNode;w.tag===5&&E!==null&&(w=E,E=os(s,h),E!=null&&g.unshift(Vl(s,E,w)),E=os(s,l),E!=null&&g.push(Vl(s,E,w))),s=s.return}return g}function po(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Wx(s,l,h,g,w){for(var E=l._reactName,O=[];h!==null&&h!==g;){var W=h,Y=W.alternate,fe=W.stateNode;if(Y!==null&&Y===g)break;W.tag===5&&fe!==null&&(W=fe,w?(Y=os(h,E),Y!=null&&O.unshift(Vl(h,Y,W))):w||(Y=os(h,E),Y!=null&&O.push(Vl(h,Y,W)))),h=h.return}O.length!==0&&s.push({event:l,listeners:O})}var ZN=/\r\n?/g,JN=/\u0000|\uFFFD/g;function zx(s){return(typeof s=="string"?s:""+s).replace(ZN,`
`).replace(JN,"")}function Gc(s,l,h){if(l=zx(l),zx(s)!==l&&h)throw Error(r(425))}function Yc(){}var Ih=null,Fh=null;function jh(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Lh=typeof setTimeout=="function"?setTimeout:void 0,e3=typeof clearTimeout=="function"?clearTimeout:void 0,Kx=typeof Promise=="function"?Promise:void 0,t3=typeof queueMicrotask=="function"?queueMicrotask:typeof Kx<"u"?function(s){return Kx.resolve(null).then(s).catch(r3)}:Lh;function r3(s){setTimeout(function(){throw s})}function Bh(s,l){var h=l,g=0;do{var w=h.nextSibling;if(s.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"){if(g===0){s.removeChild(w),Fl(l);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=w}while(h);Fl(l)}function _i(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function Hx(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(l===0)return s;l--}else h==="/$"&&l++}s=s.previousSibling}return null}var mo=Math.random().toString(36).slice(2),wa="__reactFiber$"+mo,Gl="__reactProps$"+mo,Ia="__reactContainer$"+mo,$h="__reactEvents$"+mo,n3="__reactListeners$"+mo,a3="__reactHandles$"+mo;function cs(s){var l=s[wa];if(l)return l;for(var h=s.parentNode;h;){if(l=h[Ia]||h[wa]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(s=Hx(s);s!==null;){if(h=s[wa])return h;s=Hx(s)}return l}s=h,h=s.parentNode}return null}function Yl(s){return s=s[wa]||s[Ia],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function go(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(r(33))}function qc(s){return s[Gl]||null}var Uh=[],vo=-1;function Ti(s){return{current:s}}function Mt(s){0>vo||(s.current=Uh[vo],Uh[vo]=null,vo--)}function Ot(s,l){vo++,Uh[vo]=s.current,s.current=l}var Ai={},$r=Ti(Ai),on=Ti(!1),fs=Ai;function yo(s,l){var h=s.type.contextTypes;if(!h)return Ai;var g=s.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var w={},E;for(E in h)w[E]=l[E];return g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=w),w}function ln(s){return s=s.childContextTypes,s!=null}function Xc(){Mt(on),Mt($r)}function Vx(s,l,h){if($r.current!==Ai)throw Error(r(168));Ot($r,l),Ot(on,h)}function Gx(s,l,h){var g=s.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var w in g)if(!(w in l))throw Error(r(108,Oe(s)||"Unknown",w));return be({},h,g)}function Qc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Ai,fs=$r.current,Ot($r,s),Ot(on,on.current),!0}function Yx(s,l,h){var g=s.stateNode;if(!g)throw Error(r(169));h?(s=Gx(s,l,fs),g.__reactInternalMemoizedMergedChildContext=s,Mt(on),Mt($r),Ot($r,s)):Mt(on),Ot(on,h)}var Fa=null,Zc=!1,Wh=!1;function qx(s){Fa===null?Fa=[s]:Fa.push(s)}function i3(s){Zc=!0,qx(s)}function ki(){if(!Wh&&Fa!==null){Wh=!0;var s=0,l=gt;try{var h=Fa;for(gt=1;s<h.length;s++){var g=h[s];do g=g(!0);while(g!==null)}Fa=null,Zc=!1}catch(w){throw Fa!==null&&(Fa=Fa.slice(s+1)),Pe(Tt,ki),w}finally{gt=l,Wh=!1}}return null}var xo=[],wo=0,Jc=null,ef=0,jn=[],Ln=0,ds=null,ja=1,La="";function hs(s,l){xo[wo++]=ef,xo[wo++]=Jc,Jc=s,ef=l}function Xx(s,l,h){jn[Ln++]=ja,jn[Ln++]=La,jn[Ln++]=ds,ds=s;var g=ja;s=La;var w=32-Zt(g)-1;g&=~(1<<w),h+=1;var E=32-Zt(l)+w;if(30<E){var O=w-w%5;E=(g&(1<<O)-1).toString(32),g>>=O,w-=O,ja=1<<32-Zt(l)+w|h<<w|g,La=E+s}else ja=1<<E|h<<w|g,La=s}function zh(s){s.return!==null&&(hs(s,1),Xx(s,1,0))}function Kh(s){for(;s===Jc;)Jc=xo[--wo],xo[wo]=null,ef=xo[--wo],xo[wo]=null;for(;s===ds;)ds=jn[--Ln],jn[Ln]=null,La=jn[--Ln],jn[Ln]=null,ja=jn[--Ln],jn[Ln]=null}var wn=null,Sn=null,Ft=!1,na=null;function Qx(s,l){var h=Wn(5,null,null,0);h.elementType="DELETED",h.stateNode=l,h.return=s,l=s.deletions,l===null?(s.deletions=[h],s.flags|=16):l.push(h)}function Zx(s,l){switch(s.tag){case 5:var h=s.type;return l=l.nodeType!==1||h.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,wn=s,Sn=_i(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,wn=s,Sn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(h=ds!==null?{id:ja,overflow:La}:null,s.memoizedState={dehydrated:l,treeContext:h,retryLane:1073741824},h=Wn(18,null,null,0),h.stateNode=l,h.return=s,s.child=h,wn=s,Sn=null,!0):!1;default:return!1}}function Hh(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Vh(s){if(Ft){var l=Sn;if(l){var h=l;if(!Zx(s,l)){if(Hh(s))throw Error(r(418));l=_i(h.nextSibling);var g=wn;l&&Zx(s,l)?Qx(g,h):(s.flags=s.flags&-4097|2,Ft=!1,wn=s)}}else{if(Hh(s))throw Error(r(418));s.flags=s.flags&-4097|2,Ft=!1,wn=s}}}function Jx(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;wn=s}function tf(s){if(s!==wn)return!1;if(!Ft)return Jx(s),Ft=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!jh(s.type,s.memoizedProps)),l&&(l=Sn)){if(Hh(s))throw ew(),Error(r(418));for(;l;)Qx(s,l),l=_i(l.nextSibling)}if(Jx(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"){if(l===0){Sn=_i(s.nextSibling);break e}l--}else h!=="$"&&h!=="$!"&&h!=="$?"||l++}s=s.nextSibling}Sn=null}}else Sn=wn?_i(s.stateNode.nextSibling):null;return!0}function ew(){for(var s=Sn;s;)s=_i(s.nextSibling)}function So(){Sn=wn=null,Ft=!1}function Gh(s){na===null?na=[s]:na.push(s)}var s3=P.ReactCurrentBatchConfig;function ql(s,l,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(r(309));var g=h.stateNode}if(!g)throw Error(r(147,s));var w=g,E=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===E?l.ref:(l=function(O){var W=w.refs;O===null?delete W[E]:W[E]=O},l._stringRef=E,l)}if(typeof s!="string")throw Error(r(284));if(!h._owner)throw Error(r(290,s))}return s}function rf(s,l){throw s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function tw(s){var l=s._init;return l(s._payload)}function rw(s){function l(ne,Q){if(s){var ie=ne.deletions;ie===null?(ne.deletions=[Q],ne.flags|=16):ie.push(Q)}}function h(ne,Q){if(!s)return null;for(;Q!==null;)l(ne,Q),Q=Q.sibling;return null}function g(ne,Q){for(ne=new Map;Q!==null;)Q.key!==null?ne.set(Q.key,Q):ne.set(Q.index,Q),Q=Q.sibling;return ne}function w(ne,Q){return ne=Ii(ne,Q),ne.index=0,ne.sibling=null,ne}function E(ne,Q,ie){return ne.index=ie,s?(ie=ne.alternate,ie!==null?(ie=ie.index,ie<Q?(ne.flags|=2,Q):ie):(ne.flags|=2,Q)):(ne.flags|=1048576,Q)}function O(ne){return s&&ne.alternate===null&&(ne.flags|=2),ne}function W(ne,Q,ie,Re){return Q===null||Q.tag!==6?(Q=Lp(ie,ne.mode,Re),Q.return=ne,Q):(Q=w(Q,ie),Q.return=ne,Q)}function Y(ne,Q,ie,Re){var Ve=ie.type;return Ve===D?ke(ne,Q,ie.props.children,Re,ie.key):Q!==null&&(Q.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Te&&tw(Ve)===Q.type)?(Re=w(Q,ie.props),Re.ref=ql(ne,Q,ie),Re.return=ne,Re):(Re=kf(ie.type,ie.key,ie.props,null,ne.mode,Re),Re.ref=ql(ne,Q,ie),Re.return=ne,Re)}function fe(ne,Q,ie,Re){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ie.containerInfo||Q.stateNode.implementation!==ie.implementation?(Q=Bp(ie,ne.mode,Re),Q.return=ne,Q):(Q=w(Q,ie.children||[]),Q.return=ne,Q)}function ke(ne,Q,ie,Re,Ve){return Q===null||Q.tag!==7?(Q=Ss(ie,ne.mode,Re,Ve),Q.return=ne,Q):(Q=w(Q,ie),Q.return=ne,Q)}function Ce(ne,Q,ie){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Lp(""+Q,ne.mode,ie),Q.return=ne,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case N:return ie=kf(Q.type,Q.key,Q.props,null,ne.mode,ie),ie.ref=ql(ne,null,Q),ie.return=ne,ie;case I:return Q=Bp(Q,ne.mode,ie),Q.return=ne,Q;case Te:var Re=Q._init;return Ce(ne,Re(Q._payload),ie)}if(rt(Q)||we(Q))return Q=Ss(Q,ne.mode,ie,null),Q.return=ne,Q;rf(ne,Q)}return null}function Ae(ne,Q,ie,Re){var Ve=Q!==null?Q.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Ve!==null?null:W(ne,Q,""+ie,Re);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case N:return ie.key===Ve?Y(ne,Q,ie,Re):null;case I:return ie.key===Ve?fe(ne,Q,ie,Re):null;case Te:return Ve=ie._init,Ae(ne,Q,Ve(ie._payload),Re)}if(rt(ie)||we(ie))return Ve!==null?null:ke(ne,Q,ie,Re,null);rf(ne,ie)}return null}function Le(ne,Q,ie,Re,Ve){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return ne=ne.get(ie)||null,W(Q,ne,""+Re,Ve);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case N:return ne=ne.get(Re.key===null?ie:Re.key)||null,Y(Q,ne,Re,Ve);case I:return ne=ne.get(Re.key===null?ie:Re.key)||null,fe(Q,ne,Re,Ve);case Te:var Qe=Re._init;return Le(ne,Q,ie,Qe(Re._payload),Ve)}if(rt(Re)||we(Re))return ne=ne.get(ie)||null,ke(Q,ne,Re,Ve,null);rf(Q,Re)}return null}function Ke(ne,Q,ie,Re){for(var Ve=null,Qe=null,Ze=Q,et=Q=0,wr=null;Ze!==null&&et<ie.length;et++){Ze.index>et?(wr=Ze,Ze=null):wr=Ze.sibling;var ft=Ae(ne,Ze,ie[et],Re);if(ft===null){Ze===null&&(Ze=wr);break}s&&Ze&&ft.alternate===null&&l(ne,Ze),Q=E(ft,Q,et),Qe===null?Ve=ft:Qe.sibling=ft,Qe=ft,Ze=wr}if(et===ie.length)return h(ne,Ze),Ft&&hs(ne,et),Ve;if(Ze===null){for(;et<ie.length;et++)Ze=Ce(ne,ie[et],Re),Ze!==null&&(Q=E(Ze,Q,et),Qe===null?Ve=Ze:Qe.sibling=Ze,Qe=Ze);return Ft&&hs(ne,et),Ve}for(Ze=g(ne,Ze);et<ie.length;et++)wr=Le(Ze,ne,et,ie[et],Re),wr!==null&&(s&&wr.alternate!==null&&Ze.delete(wr.key===null?et:wr.key),Q=E(wr,Q,et),Qe===null?Ve=wr:Qe.sibling=wr,Qe=wr);return s&&Ze.forEach(function(Fi){return l(ne,Fi)}),Ft&&hs(ne,et),Ve}function He(ne,Q,ie,Re){var Ve=we(ie);if(typeof Ve!="function")throw Error(r(150));if(ie=Ve.call(ie),ie==null)throw Error(r(151));for(var Qe=Ve=null,Ze=Q,et=Q=0,wr=null,ft=ie.next();Ze!==null&&!ft.done;et++,ft=ie.next()){Ze.index>et?(wr=Ze,Ze=null):wr=Ze.sibling;var Fi=Ae(ne,Ze,ft.value,Re);if(Fi===null){Ze===null&&(Ze=wr);break}s&&Ze&&Fi.alternate===null&&l(ne,Ze),Q=E(Fi,Q,et),Qe===null?Ve=Fi:Qe.sibling=Fi,Qe=Fi,Ze=wr}if(ft.done)return h(ne,Ze),Ft&&hs(ne,et),Ve;if(Ze===null){for(;!ft.done;et++,ft=ie.next())ft=Ce(ne,ft.value,Re),ft!==null&&(Q=E(ft,Q,et),Qe===null?Ve=ft:Qe.sibling=ft,Qe=ft);return Ft&&hs(ne,et),Ve}for(Ze=g(ne,Ze);!ft.done;et++,ft=ie.next())ft=Le(Ze,ne,et,ft.value,Re),ft!==null&&(s&&ft.alternate!==null&&Ze.delete(ft.key===null?et:ft.key),Q=E(ft,Q,et),Qe===null?Ve=ft:Qe.sibling=ft,Qe=ft);return s&&Ze.forEach(function(B3){return l(ne,B3)}),Ft&&hs(ne,et),Ve}function Jt(ne,Q,ie,Re){if(typeof ie=="object"&&ie!==null&&ie.type===D&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case N:e:{for(var Ve=ie.key,Qe=Q;Qe!==null;){if(Qe.key===Ve){if(Ve=ie.type,Ve===D){if(Qe.tag===7){h(ne,Qe.sibling),Q=w(Qe,ie.props.children),Q.return=ne,ne=Q;break e}}else if(Qe.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Te&&tw(Ve)===Qe.type){h(ne,Qe.sibling),Q=w(Qe,ie.props),Q.ref=ql(ne,Qe,ie),Q.return=ne,ne=Q;break e}h(ne,Qe);break}else l(ne,Qe);Qe=Qe.sibling}ie.type===D?(Q=Ss(ie.props.children,ne.mode,Re,ie.key),Q.return=ne,ne=Q):(Re=kf(ie.type,ie.key,ie.props,null,ne.mode,Re),Re.ref=ql(ne,Q,ie),Re.return=ne,ne=Re)}return O(ne);case I:e:{for(Qe=ie.key;Q!==null;){if(Q.key===Qe)if(Q.tag===4&&Q.stateNode.containerInfo===ie.containerInfo&&Q.stateNode.implementation===ie.implementation){h(ne,Q.sibling),Q=w(Q,ie.children||[]),Q.return=ne,ne=Q;break e}else{h(ne,Q);break}else l(ne,Q);Q=Q.sibling}Q=Bp(ie,ne.mode,Re),Q.return=ne,ne=Q}return O(ne);case Te:return Qe=ie._init,Jt(ne,Q,Qe(ie._payload),Re)}if(rt(ie))return Ke(ne,Q,ie,Re);if(we(ie))return He(ne,Q,ie,Re);rf(ne,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,Q!==null&&Q.tag===6?(h(ne,Q.sibling),Q=w(Q,ie),Q.return=ne,ne=Q):(h(ne,Q),Q=Lp(ie,ne.mode,Re),Q.return=ne,ne=Q),O(ne)):h(ne,Q)}return Jt}var bo=rw(!0),nw=rw(!1),nf=Ti(null),af=null,Eo=null,Yh=null;function qh(){Yh=Eo=af=null}function Xh(s){var l=nf.current;Mt(nf),s._currentValue=l}function Qh(s,l,h){for(;s!==null;){var g=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),s===h)break;s=s.return}}function _o(s,l){af=s,Yh=Eo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&l)!==0&&(un=!0),s.firstContext=null)}function Bn(s){var l=s._currentValue;if(Yh!==s)if(s={context:s,memoizedValue:l,next:null},Eo===null){if(af===null)throw Error(r(308));Eo=s,af.dependencies={lanes:0,firstContext:s}}else Eo=Eo.next=s;return l}var ps=null;function Zh(s){ps===null?ps=[s]:ps.push(s)}function aw(s,l,h,g){var w=l.interleaved;return w===null?(h.next=h,Zh(l)):(h.next=w.next,w.next=h),l.interleaved=h,Ba(s,g)}function Ba(s,l){s.lanes|=l;var h=s.alternate;for(h!==null&&(h.lanes|=l),h=s,s=s.return;s!==null;)s.childLanes|=l,h=s.alternate,h!==null&&(h.childLanes|=l),h=s,s=s.return;return h.tag===3?h.stateNode:null}var Oi=!1;function Jh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iw(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function $a(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function Pi(s,l,h){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(ct&2)!==0){var w=g.pending;return w===null?l.next=l:(l.next=w.next,w.next=l),g.pending=l,Ba(s,h)}return w=g.interleaved,w===null?(l.next=l,Zh(g)):(l.next=w.next,w.next=l),g.interleaved=l,Ba(s,h)}function sf(s,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194240)!==0)){var g=l.lanes;g&=s.pendingLanes,h|=g,l.lanes=h,hh(s,h)}}function sw(s,l){var h=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var w=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var O={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};E===null?w=E=O:E=E.next=O,h=h.next}while(h!==null);E===null?w=E=l:E=E.next=l}else w=E=l;h={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:E,shared:g.shared,effects:g.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=l:s.next=l,h.lastBaseUpdate=l}function of(s,l,h,g){var w=s.updateQueue;Oi=!1;var E=w.firstBaseUpdate,O=w.lastBaseUpdate,W=w.shared.pending;if(W!==null){w.shared.pending=null;var Y=W,fe=Y.next;Y.next=null,O===null?E=fe:O.next=fe,O=Y;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,W=ke.lastBaseUpdate,W!==O&&(W===null?ke.firstBaseUpdate=fe:W.next=fe,ke.lastBaseUpdate=Y))}if(E!==null){var Ce=w.baseState;O=0,ke=fe=Y=null,W=E;do{var Ae=W.lane,Le=W.eventTime;if((g&Ae)===Ae){ke!==null&&(ke=ke.next={eventTime:Le,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var Ke=s,He=W;switch(Ae=l,Le=h,He.tag){case 1:if(Ke=He.payload,typeof Ke=="function"){Ce=Ke.call(Le,Ce,Ae);break e}Ce=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=He.payload,Ae=typeof Ke=="function"?Ke.call(Le,Ce,Ae):Ke,Ae==null)break e;Ce=be({},Ce,Ae);break e;case 2:Oi=!0}}W.callback!==null&&W.lane!==0&&(s.flags|=64,Ae=w.effects,Ae===null?w.effects=[W]:Ae.push(W))}else Le={eventTime:Le,lane:Ae,tag:W.tag,payload:W.payload,callback:W.callback,next:null},ke===null?(fe=ke=Le,Y=Ce):ke=ke.next=Le,O|=Ae;if(W=W.next,W===null){if(W=w.shared.pending,W===null)break;Ae=W,W=Ae.next,Ae.next=null,w.lastBaseUpdate=Ae,w.shared.pending=null}}while(!0);if(ke===null&&(Y=Ce),w.baseState=Y,w.firstBaseUpdate=fe,w.lastBaseUpdate=ke,l=w.shared.interleaved,l!==null){w=l;do O|=w.lane,w=w.next;while(w!==l)}else E===null&&(w.shared.lanes=0);vs|=O,s.lanes=O,s.memoizedState=Ce}}function ow(s,l,h){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var g=s[l],w=g.callback;if(w!==null){if(g.callback=null,g=h,typeof w!="function")throw Error(r(191,w));w.call(g)}}}var Xl={},Sa=Ti(Xl),Ql=Ti(Xl),Zl=Ti(Xl);function ms(s){if(s===Xl)throw Error(r(174));return s}function ep(s,l){switch(Ot(Zl,l),Ot(Ql,s),Ot(Sa,Xl),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Ma(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=Ma(l,s)}Mt(Sa),Ot(Sa,l)}function To(){Mt(Sa),Mt(Ql),Mt(Zl)}function lw(s){ms(Zl.current);var l=ms(Sa.current),h=Ma(l,s.type);l!==h&&(Ot(Ql,s),Ot(Sa,h))}function tp(s){Ql.current===s&&(Mt(Sa),Mt(Ql))}var zt=Ti(0);function lf(s){for(var l=s;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var rp=[];function np(){for(var s=0;s<rp.length;s++)rp[s]._workInProgressVersionPrimary=null;rp.length=0}var uf=P.ReactCurrentDispatcher,ap=P.ReactCurrentBatchConfig,gs=0,Kt=null,lr=null,yr=null,cf=!1,Jl=!1,eu=0,o3=0;function Ur(){throw Error(r(321))}function ip(s,l){if(l===null)return!1;for(var h=0;h<l.length&&h<s.length;h++)if(!ra(s[h],l[h]))return!1;return!0}function sp(s,l,h,g,w,E){if(gs=E,Kt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,uf.current=s===null||s.memoizedState===null?f3:d3,s=h(g,w),Jl){E=0;do{if(Jl=!1,eu=0,25<=E)throw Error(r(301));E+=1,yr=lr=null,l.updateQueue=null,uf.current=h3,s=h(g,w)}while(Jl)}if(uf.current=hf,l=lr!==null&&lr.next!==null,gs=0,yr=lr=Kt=null,cf=!1,l)throw Error(r(300));return s}function op(){var s=eu!==0;return eu=0,s}function ba(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Kt.memoizedState=yr=s:yr=yr.next=s,yr}function $n(){if(lr===null){var s=Kt.alternate;s=s!==null?s.memoizedState:null}else s=lr.next;var l=yr===null?Kt.memoizedState:yr.next;if(l!==null)yr=l,lr=s;else{if(s===null)throw Error(r(310));lr=s,s={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},yr===null?Kt.memoizedState=yr=s:yr=yr.next=s}return yr}function tu(s,l){return typeof l=="function"?l(s):l}function lp(s){var l=$n(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=s;var g=lr,w=g.baseQueue,E=h.pending;if(E!==null){if(w!==null){var O=w.next;w.next=E.next,E.next=O}g.baseQueue=w=E,h.pending=null}if(w!==null){E=w.next,g=g.baseState;var W=O=null,Y=null,fe=E;do{var ke=fe.lane;if((gs&ke)===ke)Y!==null&&(Y=Y.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),g=fe.hasEagerState?fe.eagerState:s(g,fe.action);else{var Ce={lane:ke,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};Y===null?(W=Y=Ce,O=g):Y=Y.next=Ce,Kt.lanes|=ke,vs|=ke}fe=fe.next}while(fe!==null&&fe!==E);Y===null?O=g:Y.next=W,ra(g,l.memoizedState)||(un=!0),l.memoizedState=g,l.baseState=O,l.baseQueue=Y,h.lastRenderedState=g}if(s=h.interleaved,s!==null){w=s;do E=w.lane,Kt.lanes|=E,vs|=E,w=w.next;while(w!==s)}else w===null&&(h.lanes=0);return[l.memoizedState,h.dispatch]}function up(s){var l=$n(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=s;var g=h.dispatch,w=h.pending,E=l.memoizedState;if(w!==null){h.pending=null;var O=w=w.next;do E=s(E,O.action),O=O.next;while(O!==w);ra(E,l.memoizedState)||(un=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),h.lastRenderedState=E}return[E,g]}function uw(){}function cw(s,l){var h=Kt,g=$n(),w=l(),E=!ra(g.memoizedState,w);if(E&&(g.memoizedState=w,un=!0),g=g.queue,cp(hw.bind(null,h,g,s),[s]),g.getSnapshot!==l||E||yr!==null&&yr.memoizedState.tag&1){if(h.flags|=2048,ru(9,dw.bind(null,h,g,w,l),void 0,null),xr===null)throw Error(r(349));(gs&30)!==0||fw(h,l,w)}return w}function fw(s,l,h){s.flags|=16384,s={getSnapshot:l,value:h},l=Kt.updateQueue,l===null?(l={lastEffect:null,stores:null},Kt.updateQueue=l,l.stores=[s]):(h=l.stores,h===null?l.stores=[s]:h.push(s))}function dw(s,l,h,g){l.value=h,l.getSnapshot=g,pw(l)&&mw(s)}function hw(s,l,h){return h(function(){pw(l)&&mw(s)})}function pw(s){var l=s.getSnapshot;s=s.value;try{var h=l();return!ra(s,h)}catch{return!0}}function mw(s){var l=Ba(s,1);l!==null&&oa(l,s,1,-1)}function gw(s){var l=ba();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tu,lastRenderedState:s},l.queue=s,s=s.dispatch=c3.bind(null,Kt,s),[l.memoizedState,s]}function ru(s,l,h,g){return s={tag:s,create:l,destroy:h,deps:g,next:null},l=Kt.updateQueue,l===null?(l={lastEffect:null,stores:null},Kt.updateQueue=l,l.lastEffect=s.next=s):(h=l.lastEffect,h===null?l.lastEffect=s.next=s:(g=h.next,h.next=s,s.next=g,l.lastEffect=s)),s}function vw(){return $n().memoizedState}function ff(s,l,h,g){var w=ba();Kt.flags|=s,w.memoizedState=ru(1|l,h,void 0,g===void 0?null:g)}function df(s,l,h,g){var w=$n();g=g===void 0?null:g;var E=void 0;if(lr!==null){var O=lr.memoizedState;if(E=O.destroy,g!==null&&ip(g,O.deps)){w.memoizedState=ru(l,h,E,g);return}}Kt.flags|=s,w.memoizedState=ru(1|l,h,E,g)}function yw(s,l){return ff(8390656,8,s,l)}function cp(s,l){return df(2048,8,s,l)}function xw(s,l){return df(4,2,s,l)}function ww(s,l){return df(4,4,s,l)}function Sw(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function bw(s,l,h){return h=h!=null?h.concat([s]):null,df(4,4,Sw.bind(null,l,s),h)}function fp(){}function Ew(s,l){var h=$n();l=l===void 0?null:l;var g=h.memoizedState;return g!==null&&l!==null&&ip(l,g[1])?g[0]:(h.memoizedState=[s,l],s)}function _w(s,l){var h=$n();l=l===void 0?null:l;var g=h.memoizedState;return g!==null&&l!==null&&ip(l,g[1])?g[0]:(s=s(),h.memoizedState=[s,l],s)}function Tw(s,l,h){return(gs&21)===0?(s.baseState&&(s.baseState=!1,un=!0),s.memoizedState=h):(ra(h,l)||(h=tx(),Kt.lanes|=h,vs|=h,s.baseState=!0),l)}function l3(s,l){var h=gt;gt=h!==0&&4>h?h:4,s(!0);var g=ap.transition;ap.transition={};try{s(!1),l()}finally{gt=h,ap.transition=g}}function Aw(){return $n().memoizedState}function u3(s,l,h){var g=Mi(s);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},kw(s))Ow(l,h);else if(h=aw(s,l,h,g),h!==null){var w=Qr();oa(h,s,g,w),Pw(h,l,g)}}function c3(s,l,h){var g=Mi(s),w={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(kw(s))Ow(l,w);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var O=l.lastRenderedState,W=E(O,h);if(w.hasEagerState=!0,w.eagerState=W,ra(W,O)){var Y=l.interleaved;Y===null?(w.next=w,Zh(l)):(w.next=Y.next,Y.next=w),l.interleaved=w;return}}catch{}finally{}h=aw(s,l,w,g),h!==null&&(w=Qr(),oa(h,s,g,w),Pw(h,l,g))}}function kw(s){var l=s.alternate;return s===Kt||l!==null&&l===Kt}function Ow(s,l){Jl=cf=!0;var h=s.pending;h===null?l.next=l:(l.next=h.next,h.next=l),s.pending=l}function Pw(s,l,h){if((h&4194240)!==0){var g=l.lanes;g&=s.pendingLanes,h|=g,l.lanes=h,hh(s,h)}}var hf={readContext:Bn,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},f3={readContext:Bn,useCallback:function(s,l){return ba().memoizedState=[s,l===void 0?null:l],s},useContext:Bn,useEffect:yw,useImperativeHandle:function(s,l,h){return h=h!=null?h.concat([s]):null,ff(4194308,4,Sw.bind(null,l,s),h)},useLayoutEffect:function(s,l){return ff(4194308,4,s,l)},useInsertionEffect:function(s,l){return ff(4,2,s,l)},useMemo:function(s,l){var h=ba();return l=l===void 0?null:l,s=s(),h.memoizedState=[s,l],s},useReducer:function(s,l,h){var g=ba();return l=h!==void 0?h(l):l,g.memoizedState=g.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},g.queue=s,s=s.dispatch=u3.bind(null,Kt,s),[g.memoizedState,s]},useRef:function(s){var l=ba();return s={current:s},l.memoizedState=s},useState:gw,useDebugValue:fp,useDeferredValue:function(s){return ba().memoizedState=s},useTransition:function(){var s=gw(!1),l=s[0];return s=l3.bind(null,s[1]),ba().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,h){var g=Kt,w=ba();if(Ft){if(h===void 0)throw Error(r(407));h=h()}else{if(h=l(),xr===null)throw Error(r(349));(gs&30)!==0||fw(g,l,h)}w.memoizedState=h;var E={value:h,getSnapshot:l};return w.queue=E,yw(hw.bind(null,g,E,s),[s]),g.flags|=2048,ru(9,dw.bind(null,g,E,h,l),void 0,null),h},useId:function(){var s=ba(),l=xr.identifierPrefix;if(Ft){var h=La,g=ja;h=(g&~(1<<32-Zt(g)-1)).toString(32)+h,l=":"+l+"R"+h,h=eu++,0<h&&(l+="H"+h.toString(32)),l+=":"}else h=o3++,l=":"+l+"r"+h.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},d3={readContext:Bn,useCallback:Ew,useContext:Bn,useEffect:cp,useImperativeHandle:bw,useInsertionEffect:xw,useLayoutEffect:ww,useMemo:_w,useReducer:lp,useRef:vw,useState:function(){return lp(tu)},useDebugValue:fp,useDeferredValue:function(s){var l=$n();return Tw(l,lr.memoizedState,s)},useTransition:function(){var s=lp(tu)[0],l=$n().memoizedState;return[s,l]},useMutableSource:uw,useSyncExternalStore:cw,useId:Aw,unstable_isNewReconciler:!1},h3={readContext:Bn,useCallback:Ew,useContext:Bn,useEffect:cp,useImperativeHandle:bw,useInsertionEffect:xw,useLayoutEffect:ww,useMemo:_w,useReducer:up,useRef:vw,useState:function(){return up(tu)},useDebugValue:fp,useDeferredValue:function(s){var l=$n();return lr===null?l.memoizedState=s:Tw(l,lr.memoizedState,s)},useTransition:function(){var s=up(tu)[0],l=$n().memoizedState;return[s,l]},useMutableSource:uw,useSyncExternalStore:cw,useId:Aw,unstable_isNewReconciler:!1};function aa(s,l){if(s&&s.defaultProps){l=be({},l),s=s.defaultProps;for(var h in s)l[h]===void 0&&(l[h]=s[h]);return l}return l}function dp(s,l,h,g){l=s.memoizedState,h=h(g,l),h=h==null?l:be({},l,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var pf={isMounted:function(s){return(s=s._reactInternals)?B(s)===s:!1},enqueueSetState:function(s,l,h){s=s._reactInternals;var g=Qr(),w=Mi(s),E=$a(g,w);E.payload=l,h!=null&&(E.callback=h),l=Pi(s,E,w),l!==null&&(oa(l,s,w,g),sf(l,s,w))},enqueueReplaceState:function(s,l,h){s=s._reactInternals;var g=Qr(),w=Mi(s),E=$a(g,w);E.tag=1,E.payload=l,h!=null&&(E.callback=h),l=Pi(s,E,w),l!==null&&(oa(l,s,w,g),sf(l,s,w))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var h=Qr(),g=Mi(s),w=$a(h,g);w.tag=2,l!=null&&(w.callback=l),l=Pi(s,w,g),l!==null&&(oa(l,s,g,h),sf(l,s,g))}};function Cw(s,l,h,g,w,E,O){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,E,O):l.prototype&&l.prototype.isPureReactComponent?!Wl(h,g)||!Wl(w,E):!0}function Nw(s,l,h){var g=!1,w=Ai,E=l.contextType;return typeof E=="object"&&E!==null?E=Bn(E):(w=ln(l)?fs:$r.current,g=l.contextTypes,E=(g=g!=null)?yo(s,w):Ai),l=new l(h,E),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=pf,s.stateNode=l,l._reactInternals=s,g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=w,s.__reactInternalMemoizedMaskedChildContext=E),l}function Dw(s,l,h,g){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,g),l.state!==s&&pf.enqueueReplaceState(l,l.state,null)}function hp(s,l,h,g){var w=s.stateNode;w.props=h,w.state=s.memoizedState,w.refs={},Jh(s);var E=l.contextType;typeof E=="object"&&E!==null?w.context=Bn(E):(E=ln(l)?fs:$r.current,w.context=yo(s,E)),w.state=s.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(dp(s,l,E,h),w.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(l=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),l!==w.state&&pf.enqueueReplaceState(w,w.state,null),of(s,h,w,g),w.state=s.memoizedState),typeof w.componentDidMount=="function"&&(s.flags|=4194308)}function Ao(s,l){try{var h="",g=l;do h+=K(g),g=g.return;while(g);var w=h}catch(E){w=`
Error generating stack: `+E.message+`
`+E.stack}return{value:s,source:l,stack:w,digest:null}}function pp(s,l,h){return{value:s,source:null,stack:h??null,digest:l??null}}function mp(s,l){try{console.error(l.value)}catch(h){setTimeout(function(){throw h})}}var p3=typeof WeakMap=="function"?WeakMap:Map;function Mw(s,l,h){h=$a(-1,h),h.tag=3,h.payload={element:null};var g=l.value;return h.callback=function(){Sf||(Sf=!0,Cp=g),mp(s,l)},h}function Rw(s,l,h){h=$a(-1,h),h.tag=3;var g=s.type.getDerivedStateFromError;if(typeof g=="function"){var w=l.value;h.payload=function(){return g(w)},h.callback=function(){mp(s,l)}}var E=s.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(h.callback=function(){mp(s,l),typeof g!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var O=l.stack;this.componentDidCatch(l.value,{componentStack:O!==null?O:""})}),h}function Iw(s,l,h){var g=s.pingCache;if(g===null){g=s.pingCache=new p3;var w=new Set;g.set(l,w)}else w=g.get(l),w===void 0&&(w=new Set,g.set(l,w));w.has(h)||(w.add(h),s=O3.bind(null,s,l,h),l.then(s,s))}function Fw(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function jw(s,l,h,g,w){return(s.mode&1)===0?(s===l?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(l=$a(-1,1),l.tag=2,Pi(h,l,1))),h.lanes|=1),s):(s.flags|=65536,s.lanes=w,s)}var m3=P.ReactCurrentOwner,un=!1;function Xr(s,l,h,g){l.child=s===null?nw(l,null,h,g):bo(l,s.child,h,g)}function Lw(s,l,h,g,w){h=h.render;var E=l.ref;return _o(l,w),g=sp(s,l,h,g,E,w),h=op(),s!==null&&!un?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~w,Ua(s,l,w)):(Ft&&h&&zh(l),l.flags|=1,Xr(s,l,g,w),l.child)}function Bw(s,l,h,g,w){if(s===null){var E=h.type;return typeof E=="function"&&!jp(E)&&E.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(l.tag=15,l.type=E,$w(s,l,E,g,w)):(s=kf(h.type,null,g,l,l.mode,w),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,(s.lanes&w)===0){var O=E.memoizedProps;if(h=h.compare,h=h!==null?h:Wl,h(O,g)&&s.ref===l.ref)return Ua(s,l,w)}return l.flags|=1,s=Ii(E,g),s.ref=l.ref,s.return=l,l.child=s}function $w(s,l,h,g,w){if(s!==null){var E=s.memoizedProps;if(Wl(E,g)&&s.ref===l.ref)if(un=!1,l.pendingProps=g=E,(s.lanes&w)!==0)(s.flags&131072)!==0&&(un=!0);else return l.lanes=s.lanes,Ua(s,l,w)}return gp(s,l,h,g,w)}function Uw(s,l,h){var g=l.pendingProps,w=g.children,E=s!==null?s.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Oo,bn),bn|=h;else{if((h&1073741824)===0)return s=E!==null?E.baseLanes|h:h,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Ot(Oo,bn),bn|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=E!==null?E.baseLanes:h,Ot(Oo,bn),bn|=g}else E!==null?(g=E.baseLanes|h,l.memoizedState=null):g=h,Ot(Oo,bn),bn|=g;return Xr(s,l,w,h),l.child}function Ww(s,l){var h=l.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(l.flags|=512,l.flags|=2097152)}function gp(s,l,h,g,w){var E=ln(h)?fs:$r.current;return E=yo(l,E),_o(l,w),h=sp(s,l,h,g,E,w),g=op(),s!==null&&!un?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~w,Ua(s,l,w)):(Ft&&g&&zh(l),l.flags|=1,Xr(s,l,h,w),l.child)}function zw(s,l,h,g,w){if(ln(h)){var E=!0;Qc(l)}else E=!1;if(_o(l,w),l.stateNode===null)gf(s,l),Nw(l,h,g),hp(l,h,g,w),g=!0;else if(s===null){var O=l.stateNode,W=l.memoizedProps;O.props=W;var Y=O.context,fe=h.contextType;typeof fe=="object"&&fe!==null?fe=Bn(fe):(fe=ln(h)?fs:$r.current,fe=yo(l,fe));var ke=h.getDerivedStateFromProps,Ce=typeof ke=="function"||typeof O.getSnapshotBeforeUpdate=="function";Ce||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(W!==g||Y!==fe)&&Dw(l,O,g,fe),Oi=!1;var Ae=l.memoizedState;O.state=Ae,of(l,g,O,w),Y=l.memoizedState,W!==g||Ae!==Y||on.current||Oi?(typeof ke=="function"&&(dp(l,h,ke,g),Y=l.memoizedState),(W=Oi||Cw(l,h,W,g,Ae,Y,fe))?(Ce||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(l.flags|=4194308)):(typeof O.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=Y),O.props=g,O.state=Y,O.context=fe,g=W):(typeof O.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{O=l.stateNode,iw(s,l),W=l.memoizedProps,fe=l.type===l.elementType?W:aa(l.type,W),O.props=fe,Ce=l.pendingProps,Ae=O.context,Y=h.contextType,typeof Y=="object"&&Y!==null?Y=Bn(Y):(Y=ln(h)?fs:$r.current,Y=yo(l,Y));var Le=h.getDerivedStateFromProps;(ke=typeof Le=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(W!==Ce||Ae!==Y)&&Dw(l,O,g,Y),Oi=!1,Ae=l.memoizedState,O.state=Ae,of(l,g,O,w);var Ke=l.memoizedState;W!==Ce||Ae!==Ke||on.current||Oi?(typeof Le=="function"&&(dp(l,h,Le,g),Ke=l.memoizedState),(fe=Oi||Cw(l,h,fe,g,Ae,Ke,Y)||!1)?(ke||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(g,Ke,Y),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(g,Ke,Y)),typeof O.componentDidUpdate=="function"&&(l.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof O.componentDidUpdate!="function"||W===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Ke),O.props=g,O.state=Ke,O.context=Y,g=fe):(typeof O.componentDidUpdate!="function"||W===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),g=!1)}return vp(s,l,h,g,E,w)}function vp(s,l,h,g,w,E){Ww(s,l);var O=(l.flags&128)!==0;if(!g&&!O)return w&&Yx(l,h,!1),Ua(s,l,E);g=l.stateNode,m3.current=l;var W=O&&typeof h.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,s!==null&&O?(l.child=bo(l,s.child,null,E),l.child=bo(l,null,W,E)):Xr(s,l,W,E),l.memoizedState=g.state,w&&Yx(l,h,!0),l.child}function Kw(s){var l=s.stateNode;l.pendingContext?Vx(s,l.pendingContext,l.pendingContext!==l.context):l.context&&Vx(s,l.context,!1),ep(s,l.containerInfo)}function Hw(s,l,h,g,w){return So(),Gh(w),l.flags|=256,Xr(s,l,h,g),l.child}var yp={dehydrated:null,treeContext:null,retryLane:0};function xp(s){return{baseLanes:s,cachePool:null,transitions:null}}function Vw(s,l,h){var g=l.pendingProps,w=zt.current,E=!1,O=(l.flags&128)!==0,W;if((W=O)||(W=s!==null&&s.memoizedState===null?!1:(w&2)!==0),W?(E=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(w|=1),Ot(zt,w&1),s===null)return Vh(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((l.mode&1)===0?l.lanes=1:s.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(O=g.children,s=g.fallback,E?(g=l.mode,E=l.child,O={mode:"hidden",children:O},(g&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=O):E=Of(O,g,0,null),s=Ss(s,g,h,null),E.return=l,s.return=l,E.sibling=s,l.child=E,l.child.memoizedState=xp(h),l.memoizedState=yp,s):wp(l,O));if(w=s.memoizedState,w!==null&&(W=w.dehydrated,W!==null))return g3(s,l,O,g,W,w,h);if(E){E=g.fallback,O=l.mode,w=s.child,W=w.sibling;var Y={mode:"hidden",children:g.children};return(O&1)===0&&l.child!==w?(g=l.child,g.childLanes=0,g.pendingProps=Y,l.deletions=null):(g=Ii(w,Y),g.subtreeFlags=w.subtreeFlags&14680064),W!==null?E=Ii(W,E):(E=Ss(E,O,h,null),E.flags|=2),E.return=l,g.return=l,g.sibling=E,l.child=g,g=E,E=l.child,O=s.child.memoizedState,O=O===null?xp(h):{baseLanes:O.baseLanes|h,cachePool:null,transitions:O.transitions},E.memoizedState=O,E.childLanes=s.childLanes&~h,l.memoizedState=yp,g}return E=s.child,s=E.sibling,g=Ii(E,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=h),g.return=l,g.sibling=null,s!==null&&(h=l.deletions,h===null?(l.deletions=[s],l.flags|=16):h.push(s)),l.child=g,l.memoizedState=null,g}function wp(s,l){return l=Of({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function mf(s,l,h,g){return g!==null&&Gh(g),bo(l,s.child,null,h),s=wp(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function g3(s,l,h,g,w,E,O){if(h)return l.flags&256?(l.flags&=-257,g=pp(Error(r(422))),mf(s,l,O,g)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(E=g.fallback,w=l.mode,g=Of({mode:"visible",children:g.children},w,0,null),E=Ss(E,w,O,null),E.flags|=2,g.return=l,E.return=l,g.sibling=E,l.child=g,(l.mode&1)!==0&&bo(l,s.child,null,O),l.child.memoizedState=xp(O),l.memoizedState=yp,E);if((l.mode&1)===0)return mf(s,l,O,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var W=g.dgst;return g=W,E=Error(r(419)),g=pp(E,g,void 0),mf(s,l,O,g)}if(W=(O&s.childLanes)!==0,un||W){if(g=xr,g!==null){switch(O&-O){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|O))!==0?0:w,w!==0&&w!==E.retryLane&&(E.retryLane=w,Ba(s,w),oa(g,s,w,-1))}return Fp(),g=pp(Error(r(421))),mf(s,l,O,g)}return w.data==="$?"?(l.flags|=128,l.child=s.child,l=P3.bind(null,s),w._reactRetry=l,null):(s=E.treeContext,Sn=_i(w.nextSibling),wn=l,Ft=!0,na=null,s!==null&&(jn[Ln++]=ja,jn[Ln++]=La,jn[Ln++]=ds,ja=s.id,La=s.overflow,ds=l),l=wp(l,g.children),l.flags|=4096,l)}function Gw(s,l,h){s.lanes|=l;var g=s.alternate;g!==null&&(g.lanes|=l),Qh(s.return,l,h)}function Sp(s,l,h,g,w){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:w}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=g,E.tail=h,E.tailMode=w)}function Yw(s,l,h){var g=l.pendingProps,w=g.revealOrder,E=g.tail;if(Xr(s,l,g.children,h),g=zt.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Gw(s,h,l);else if(s.tag===19)Gw(s,h,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}g&=1}if(Ot(zt,g),(l.mode&1)===0)l.memoizedState=null;else switch(w){case"forwards":for(h=l.child,w=null;h!==null;)s=h.alternate,s!==null&&lf(s)===null&&(w=h),h=h.sibling;h=w,h===null?(w=l.child,l.child=null):(w=h.sibling,h.sibling=null),Sp(l,!1,w,h,E);break;case"backwards":for(h=null,w=l.child,l.child=null;w!==null;){if(s=w.alternate,s!==null&&lf(s)===null){l.child=w;break}s=w.sibling,w.sibling=h,h=w,w=s}Sp(l,!0,h,null,E);break;case"together":Sp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function gf(s,l){(l.mode&1)===0&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function Ua(s,l,h){if(s!==null&&(l.dependencies=s.dependencies),vs|=l.lanes,(h&l.childLanes)===0)return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,h=Ii(s,s.pendingProps),l.child=h,h.return=l;s.sibling!==null;)s=s.sibling,h=h.sibling=Ii(s,s.pendingProps),h.return=l;h.sibling=null}return l.child}function v3(s,l,h){switch(l.tag){case 3:Kw(l),So();break;case 5:lw(l);break;case 1:ln(l.type)&&Qc(l);break;case 4:ep(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,w=l.memoizedProps.value;Ot(nf,g._currentValue),g._currentValue=w;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(Ot(zt,zt.current&1),l.flags|=128,null):(h&l.child.childLanes)!==0?Vw(s,l,h):(Ot(zt,zt.current&1),s=Ua(s,l,h),s!==null?s.sibling:null);Ot(zt,zt.current&1);break;case 19:if(g=(h&l.childLanes)!==0,(s.flags&128)!==0){if(g)return Yw(s,l,h);l.flags|=128}if(w=l.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ot(zt,zt.current),g)break;return null;case 22:case 23:return l.lanes=0,Uw(s,l,h)}return Ua(s,l,h)}var qw,bp,Xw,Qw;qw=function(s,l){for(var h=l.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},bp=function(){},Xw=function(s,l,h,g){var w=s.memoizedProps;if(w!==g){s=l.stateNode,ms(Sa.current);var E=null;switch(h){case"input":w=ze(s,w),g=ze(s,g),E=[];break;case"select":w=be({},w,{value:void 0}),g=be({},g,{value:void 0}),E=[];break;case"textarea":w=Nt(s,w),g=Nt(s,g),E=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(s.onclick=Yc)}Tl(h,g);var O;h=null;for(fe in w)if(!g.hasOwnProperty(fe)&&w.hasOwnProperty(fe)&&w[fe]!=null)if(fe==="style"){var W=w[fe];for(O in W)W.hasOwnProperty(O)&&(h||(h={}),h[O]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(a.hasOwnProperty(fe)?E||(E=[]):(E=E||[]).push(fe,null));for(fe in g){var Y=g[fe];if(W=w?.[fe],g.hasOwnProperty(fe)&&Y!==W&&(Y!=null||W!=null))if(fe==="style")if(W){for(O in W)!W.hasOwnProperty(O)||Y&&Y.hasOwnProperty(O)||(h||(h={}),h[O]="");for(O in Y)Y.hasOwnProperty(O)&&W[O]!==Y[O]&&(h||(h={}),h[O]=Y[O])}else h||(E||(E=[]),E.push(fe,h)),h=Y;else fe==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,W=W?W.__html:void 0,Y!=null&&W!==Y&&(E=E||[]).push(fe,Y)):fe==="children"?typeof Y!="string"&&typeof Y!="number"||(E=E||[]).push(fe,""+Y):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(a.hasOwnProperty(fe)?(Y!=null&&fe==="onScroll"&&Dt("scroll",s),E||W===Y||(E=[])):(E=E||[]).push(fe,Y))}h&&(E=E||[]).push("style",h);var fe=E;(l.updateQueue=fe)&&(l.flags|=4)}},Qw=function(s,l,h,g){h!==g&&(l.flags|=4)};function nu(s,l){if(!Ft)switch(s.tailMode){case"hidden":l=s.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Wr(s){var l=s.alternate!==null&&s.alternate.child===s.child,h=0,g=0;if(l)for(var w=s.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=s,w=w.sibling;else for(w=s.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=s,w=w.sibling;return s.subtreeFlags|=g,s.childLanes=h,l}function y3(s,l,h){var g=l.pendingProps;switch(Kh(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wr(l),null;case 1:return ln(l.type)&&Xc(),Wr(l),null;case 3:return g=l.stateNode,To(),Mt(on),Mt($r),np(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(s===null||s.child===null)&&(tf(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,na!==null&&(Mp(na),na=null))),bp(s,l),Wr(l),null;case 5:tp(l);var w=ms(Zl.current);if(h=l.type,s!==null&&l.stateNode!=null)Xw(s,l,h,g,w),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Wr(l),null}if(s=ms(Sa.current),tf(l)){g=l.stateNode,h=l.type;var E=l.memoizedProps;switch(g[wa]=l,g[Gl]=E,s=(l.mode&1)!==0,h){case"dialog":Dt("cancel",g),Dt("close",g);break;case"iframe":case"object":case"embed":Dt("load",g);break;case"video":case"audio":for(w=0;w<Kl.length;w++)Dt(Kl[w],g);break;case"source":Dt("error",g);break;case"img":case"image":case"link":Dt("error",g),Dt("load",g);break;case"details":Dt("toggle",g);break;case"input":bt(g,E),Dt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!E.multiple},Dt("invalid",g);break;case"textarea":Vt(g,E),Dt("invalid",g)}Tl(h,E),w=null;for(var O in E)if(E.hasOwnProperty(O)){var W=E[O];O==="children"?typeof W=="string"?g.textContent!==W&&(E.suppressHydrationWarning!==!0&&Gc(g.textContent,W,s),w=["children",W]):typeof W=="number"&&g.textContent!==""+W&&(E.suppressHydrationWarning!==!0&&Gc(g.textContent,W,s),w=["children",""+W]):a.hasOwnProperty(O)&&W!=null&&O==="onScroll"&&Dt("scroll",g)}switch(h){case"input":Be(g),qe(g,E,!0);break;case"textarea":Be(g),gr(g);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(g.onclick=Yc)}g=w,l.updateQueue=g,g!==null&&(l.flags|=4)}else{O=w.nodeType===9?w:w.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Da(h)),s==="http://www.w3.org/1999/xhtml"?h==="script"?(s=O.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof g.is=="string"?s=O.createElement(h,{is:g.is}):(s=O.createElement(h),h==="select"&&(O=s,g.multiple?O.multiple=!0:g.size&&(O.size=g.size))):s=O.createElementNS(s,h),s[wa]=l,s[Gl]=g,qw(s,l,!1,!1),l.stateNode=s;e:{switch(O=Al(h,g),h){case"dialog":Dt("cancel",s),Dt("close",s),w=g;break;case"iframe":case"object":case"embed":Dt("load",s),w=g;break;case"video":case"audio":for(w=0;w<Kl.length;w++)Dt(Kl[w],s);w=g;break;case"source":Dt("error",s),w=g;break;case"img":case"image":case"link":Dt("error",s),Dt("load",s),w=g;break;case"details":Dt("toggle",s),w=g;break;case"input":bt(s,g),w=ze(s,g),Dt("invalid",s);break;case"option":w=g;break;case"select":s._wrapperState={wasMultiple:!!g.multiple},w=be({},g,{value:void 0}),Dt("invalid",s);break;case"textarea":Vt(s,g),w=Nt(s,g),Dt("invalid",s);break;default:w=g}Tl(h,w),W=w;for(E in W)if(W.hasOwnProperty(E)){var Y=W[E];E==="style"?_l(s,Y):E==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&Ec(s,Y)):E==="children"?typeof Y=="string"?(h!=="textarea"||Y!=="")&&hi(s,Y):typeof Y=="number"&&hi(s,""+Y):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(a.hasOwnProperty(E)?Y!=null&&E==="onScroll"&&Dt("scroll",s):Y!=null&&A(s,E,Y,O))}switch(h){case"input":Be(s),qe(s,g,!1);break;case"textarea":Be(s),gr(s);break;case"option":g.value!=null&&s.setAttribute("value",""+Ne(g.value));break;case"select":s.multiple=!!g.multiple,E=g.value,E!=null?lt(s,!!g.multiple,E,!1):g.defaultValue!=null&&lt(s,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(s.onclick=Yc)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Wr(l),null;case 6:if(s&&l.stateNode!=null)Qw(s,l,s.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(h=ms(Zl.current),ms(Sa.current),tf(l)){if(g=l.stateNode,h=l.memoizedProps,g[wa]=l,(E=g.nodeValue!==h)&&(s=wn,s!==null))switch(s.tag){case 3:Gc(g.nodeValue,h,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Gc(g.nodeValue,h,(s.mode&1)!==0)}E&&(l.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[wa]=l,l.stateNode=g}return Wr(l),null;case 13:if(Mt(zt),g=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ft&&Sn!==null&&(l.mode&1)!==0&&(l.flags&128)===0)ew(),So(),l.flags|=98560,E=!1;else if(E=tf(l),g!==null&&g.dehydrated!==null){if(s===null){if(!E)throw Error(r(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(r(317));E[wa]=l}else So(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Wr(l),E=!1}else na!==null&&(Mp(na),na=null),E=!0;if(!E)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=h,l):(g=g!==null,g!==(s!==null&&s.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(s===null||(zt.current&1)!==0?ur===0&&(ur=3):Fp())),l.updateQueue!==null&&(l.flags|=4),Wr(l),null);case 4:return To(),bp(s,l),s===null&&Hl(l.stateNode.containerInfo),Wr(l),null;case 10:return Xh(l.type._context),Wr(l),null;case 17:return ln(l.type)&&Xc(),Wr(l),null;case 19:if(Mt(zt),E=l.memoizedState,E===null)return Wr(l),null;if(g=(l.flags&128)!==0,O=E.rendering,O===null)if(g)nu(E,!1);else{if(ur!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(O=lf(s),O!==null){for(l.flags|=128,nu(E,!1),g=O.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=h,h=l.child;h!==null;)E=h,s=g,E.flags&=14680066,O=E.alternate,O===null?(E.childLanes=0,E.lanes=s,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=O.childLanes,E.lanes=O.lanes,E.child=O.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=O.memoizedProps,E.memoizedState=O.memoizedState,E.updateQueue=O.updateQueue,E.type=O.type,s=O.dependencies,E.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),h=h.sibling;return Ot(zt,zt.current&1|2),l.child}s=s.sibling}E.tail!==null&&De()>Po&&(l.flags|=128,g=!0,nu(E,!1),l.lanes=4194304)}else{if(!g)if(s=lf(O),s!==null){if(l.flags|=128,g=!0,h=s.updateQueue,h!==null&&(l.updateQueue=h,l.flags|=4),nu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!O.alternate&&!Ft)return Wr(l),null}else 2*De()-E.renderingStartTime>Po&&h!==1073741824&&(l.flags|=128,g=!0,nu(E,!1),l.lanes=4194304);E.isBackwards?(O.sibling=l.child,l.child=O):(h=E.last,h!==null?h.sibling=O:l.child=O,E.last=O)}return E.tail!==null?(l=E.tail,E.rendering=l,E.tail=l.sibling,E.renderingStartTime=De(),l.sibling=null,h=zt.current,Ot(zt,g?h&1|2:h&1),l):(Wr(l),null);case 22:case 23:return Ip(),g=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(bn&1073741824)!==0&&(Wr(l),l.subtreeFlags&6&&(l.flags|=8192)):Wr(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function x3(s,l){switch(Kh(l),l.tag){case 1:return ln(l.type)&&Xc(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return To(),Mt(on),Mt($r),np(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 5:return tp(l),null;case 13:if(Mt(zt),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));So()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Mt(zt),null;case 4:return To(),null;case 10:return Xh(l.type._context),null;case 22:case 23:return Ip(),null;case 24:return null;default:return null}}var vf=!1,zr=!1,w3=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function ko(s,l){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){Gt(s,l,g)}else h.current=null}function Ep(s,l,h){try{h()}catch(g){Gt(s,l,g)}}var Zw=!1;function S3(s,l){if(Ih=Fc,s=Cx(),kh(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var w=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var O=0,W=-1,Y=-1,fe=0,ke=0,Ce=s,Ae=null;t:for(;;){for(var Le;Ce!==h||w!==0&&Ce.nodeType!==3||(W=O+w),Ce!==E||g!==0&&Ce.nodeType!==3||(Y=O+g),Ce.nodeType===3&&(O+=Ce.nodeValue.length),(Le=Ce.firstChild)!==null;)Ae=Ce,Ce=Le;for(;;){if(Ce===s)break t;if(Ae===h&&++fe===w&&(W=O),Ae===E&&++ke===g&&(Y=O),(Le=Ce.nextSibling)!==null)break;Ce=Ae,Ae=Ce.parentNode}Ce=Le}h=W===-1||Y===-1?null:{start:W,end:Y}}else h=null}h=h||{start:0,end:0}}else h=null;for(Fh={focusedElem:s,selectionRange:h},Fc=!1,Ue=l;Ue!==null;)if(l=Ue,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Ue=s;else for(;Ue!==null;){l=Ue;try{var Ke=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var He=Ke.memoizedProps,Jt=Ke.memoizedState,ne=l.stateNode,Q=ne.getSnapshotBeforeUpdate(l.elementType===l.type?He:aa(l.type,He),Jt);ne.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ie=l.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Re){Gt(l,l.return,Re)}if(s=l.sibling,s!==null){s.return=l.return,Ue=s;break}Ue=l.return}return Ke=Zw,Zw=!1,Ke}function au(s,l,h){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&s)===s){var E=w.destroy;w.destroy=void 0,E!==void 0&&Ep(l,h,E)}w=w.next}while(w!==g)}}function yf(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&s)===s){var g=h.create;h.destroy=g()}h=h.next}while(h!==l)}}function _p(s){var l=s.ref;if(l!==null){var h=s.stateNode;switch(s.tag){case 5:s=h;break;default:s=h}typeof l=="function"?l(s):l.current=s}}function Jw(s){var l=s.alternate;l!==null&&(s.alternate=null,Jw(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[wa],delete l[Gl],delete l[$h],delete l[n3],delete l[a3])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function eS(s){return s.tag===5||s.tag===3||s.tag===4}function tS(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||eS(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Tp(s,l,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?h.nodeType===8?h.parentNode.insertBefore(s,l):h.insertBefore(s,l):(h.nodeType===8?(l=h.parentNode,l.insertBefore(s,h)):(l=h,l.appendChild(s)),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=Yc));else if(g!==4&&(s=s.child,s!==null))for(Tp(s,l,h),s=s.sibling;s!==null;)Tp(s,l,h),s=s.sibling}function Ap(s,l,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,l?h.insertBefore(s,l):h.appendChild(s);else if(g!==4&&(s=s.child,s!==null))for(Ap(s,l,h),s=s.sibling;s!==null;)Ap(s,l,h),s=s.sibling}var Or=null,ia=!1;function Ci(s,l,h){for(h=h.child;h!==null;)rS(s,l,h),h=h.sibling}function rS(s,l,h){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(xa,h)}catch{}switch(h.tag){case 5:zr||ko(h,l);case 6:var g=Or,w=ia;Or=null,Ci(s,l,h),Or=g,ia=w,Or!==null&&(ia?(s=Or,h=h.stateNode,s.nodeType===8?s.parentNode.removeChild(h):s.removeChild(h)):Or.removeChild(h.stateNode));break;case 18:Or!==null&&(ia?(s=Or,h=h.stateNode,s.nodeType===8?Bh(s.parentNode,h):s.nodeType===1&&Bh(s,h),Fl(s)):Bh(Or,h.stateNode));break;case 4:g=Or,w=ia,Or=h.stateNode.containerInfo,ia=!0,Ci(s,l,h),Or=g,ia=w;break;case 0:case 11:case 14:case 15:if(!zr&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var E=w,O=E.destroy;E=E.tag,O!==void 0&&((E&2)!==0||(E&4)!==0)&&Ep(h,l,O),w=w.next}while(w!==g)}Ci(s,l,h);break;case 1:if(!zr&&(ko(h,l),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(W){Gt(h,l,W)}Ci(s,l,h);break;case 21:Ci(s,l,h);break;case 22:h.mode&1?(zr=(g=zr)||h.memoizedState!==null,Ci(s,l,h),zr=g):Ci(s,l,h);break;default:Ci(s,l,h)}}function nS(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new w3),l.forEach(function(g){var w=C3.bind(null,s,g);h.has(g)||(h.add(g),g.then(w,w))})}}function sa(s,l){var h=l.deletions;if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];try{var E=s,O=l,W=O;e:for(;W!==null;){switch(W.tag){case 5:Or=W.stateNode,ia=!1;break e;case 3:Or=W.stateNode.containerInfo,ia=!0;break e;case 4:Or=W.stateNode.containerInfo,ia=!0;break e}W=W.return}if(Or===null)throw Error(r(160));rS(E,O,w),Or=null,ia=!1;var Y=w.alternate;Y!==null&&(Y.return=null),w.return=null}catch(fe){Gt(w,l,fe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)aS(l,s),l=l.sibling}function aS(s,l){var h=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(sa(l,s),Ea(s),g&4){try{au(3,s,s.return),yf(3,s)}catch(He){Gt(s,s.return,He)}try{au(5,s,s.return)}catch(He){Gt(s,s.return,He)}}break;case 1:sa(l,s),Ea(s),g&512&&h!==null&&ko(h,h.return);break;case 5:if(sa(l,s),Ea(s),g&512&&h!==null&&ko(h,h.return),s.flags&32){var w=s.stateNode;try{hi(w,"")}catch(He){Gt(s,s.return,He)}}if(g&4&&(w=s.stateNode,w!=null)){var E=s.memoizedProps,O=h!==null?h.memoizedProps:E,W=s.type,Y=s.updateQueue;if(s.updateQueue=null,Y!==null)try{W==="input"&&E.type==="radio"&&E.name!=null&&at(w,E),Al(W,O);var fe=Al(W,E);for(O=0;O<Y.length;O+=2){var ke=Y[O],Ce=Y[O+1];ke==="style"?_l(w,Ce):ke==="dangerouslySetInnerHTML"?Ec(w,Ce):ke==="children"?hi(w,Ce):A(w,ke,Ce,fe)}switch(W){case"input":pe(w,E);break;case"textarea":or(w,E);break;case"select":var Ae=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!E.multiple;var Le=E.value;Le!=null?lt(w,!!E.multiple,Le,!1):Ae!==!!E.multiple&&(E.defaultValue!=null?lt(w,!!E.multiple,E.defaultValue,!0):lt(w,!!E.multiple,E.multiple?[]:"",!1))}w[Gl]=E}catch(He){Gt(s,s.return,He)}}break;case 6:if(sa(l,s),Ea(s),g&4){if(s.stateNode===null)throw Error(r(162));w=s.stateNode,E=s.memoizedProps;try{w.nodeValue=E}catch(He){Gt(s,s.return,He)}}break;case 3:if(sa(l,s),Ea(s),g&4&&h!==null&&h.memoizedState.isDehydrated)try{Fl(l.containerInfo)}catch(He){Gt(s,s.return,He)}break;case 4:sa(l,s),Ea(s);break;case 13:sa(l,s),Ea(s),w=s.child,w.flags&8192&&(E=w.memoizedState!==null,w.stateNode.isHidden=E,!E||w.alternate!==null&&w.alternate.memoizedState!==null||(Pp=De())),g&4&&nS(s);break;case 22:if(ke=h!==null&&h.memoizedState!==null,s.mode&1?(zr=(fe=zr)||ke,sa(l,s),zr=fe):sa(l,s),Ea(s),g&8192){if(fe=s.memoizedState!==null,(s.stateNode.isHidden=fe)&&!ke&&(s.mode&1)!==0)for(Ue=s,ke=s.child;ke!==null;){for(Ce=Ue=ke;Ue!==null;){switch(Ae=Ue,Le=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:au(4,Ae,Ae.return);break;case 1:ko(Ae,Ae.return);var Ke=Ae.stateNode;if(typeof Ke.componentWillUnmount=="function"){g=Ae,h=Ae.return;try{l=g,Ke.props=l.memoizedProps,Ke.state=l.memoizedState,Ke.componentWillUnmount()}catch(He){Gt(g,h,He)}}break;case 5:ko(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){oS(Ce);continue}}Le!==null?(Le.return=Ae,Ue=Le):oS(Ce)}ke=ke.sibling}e:for(ke=null,Ce=s;;){if(Ce.tag===5){if(ke===null){ke=Ce;try{w=Ce.stateNode,fe?(E=w.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(W=Ce.stateNode,Y=Ce.memoizedProps.style,O=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,W.style.display=El("display",O))}catch(He){Gt(s,s.return,He)}}}else if(Ce.tag===6){if(ke===null)try{Ce.stateNode.nodeValue=fe?"":Ce.memoizedProps}catch(He){Gt(s,s.return,He)}}else if((Ce.tag!==22&&Ce.tag!==23||Ce.memoizedState===null||Ce===s)&&Ce.child!==null){Ce.child.return=Ce,Ce=Ce.child;continue}if(Ce===s)break e;for(;Ce.sibling===null;){if(Ce.return===null||Ce.return===s)break e;ke===Ce&&(ke=null),Ce=Ce.return}ke===Ce&&(ke=null),Ce.sibling.return=Ce.return,Ce=Ce.sibling}}break;case 19:sa(l,s),Ea(s),g&4&&nS(s);break;case 21:break;default:sa(l,s),Ea(s)}}function Ea(s){var l=s.flags;if(l&2){try{e:{for(var h=s.return;h!==null;){if(eS(h)){var g=h;break e}h=h.return}throw Error(r(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(hi(w,""),g.flags&=-33);var E=tS(s);Ap(s,E,w);break;case 3:case 4:var O=g.stateNode.containerInfo,W=tS(s);Tp(s,W,O);break;default:throw Error(r(161))}}catch(Y){Gt(s,s.return,Y)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function b3(s,l,h){Ue=s,iS(s)}function iS(s,l,h){for(var g=(s.mode&1)!==0;Ue!==null;){var w=Ue,E=w.child;if(w.tag===22&&g){var O=w.memoizedState!==null||vf;if(!O){var W=w.alternate,Y=W!==null&&W.memoizedState!==null||zr;W=vf;var fe=zr;if(vf=O,(zr=Y)&&!fe)for(Ue=w;Ue!==null;)O=Ue,Y=O.child,O.tag===22&&O.memoizedState!==null?lS(w):Y!==null?(Y.return=O,Ue=Y):lS(w);for(;E!==null;)Ue=E,iS(E),E=E.sibling;Ue=w,vf=W,zr=fe}sS(s)}else(w.subtreeFlags&8772)!==0&&E!==null?(E.return=w,Ue=E):sS(s)}}function sS(s){for(;Ue!==null;){var l=Ue;if((l.flags&8772)!==0){var h=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:zr||yf(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!zr)if(h===null)g.componentDidMount();else{var w=l.elementType===l.type?h.memoizedProps:aa(l.type,h.memoizedProps);g.componentDidUpdate(w,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var E=l.updateQueue;E!==null&&ow(l,E,g);break;case 3:var O=l.updateQueue;if(O!==null){if(h=null,l.child!==null)switch(l.child.tag){case 5:h=l.child.stateNode;break;case 1:h=l.child.stateNode}ow(l,O,h)}break;case 5:var W=l.stateNode;if(h===null&&l.flags&4){h=W;var Y=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&h.focus();break;case"img":Y.src&&(h.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var fe=l.alternate;if(fe!==null){var ke=fe.memoizedState;if(ke!==null){var Ce=ke.dehydrated;Ce!==null&&Fl(Ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}zr||l.flags&512&&_p(l)}catch(Ae){Gt(l,l.return,Ae)}}if(l===s){Ue=null;break}if(h=l.sibling,h!==null){h.return=l.return,Ue=h;break}Ue=l.return}}function oS(s){for(;Ue!==null;){var l=Ue;if(l===s){Ue=null;break}var h=l.sibling;if(h!==null){h.return=l.return,Ue=h;break}Ue=l.return}}function lS(s){for(;Ue!==null;){var l=Ue;try{switch(l.tag){case 0:case 11:case 15:var h=l.return;try{yf(4,l)}catch(Y){Gt(l,h,Y)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var w=l.return;try{g.componentDidMount()}catch(Y){Gt(l,w,Y)}}var E=l.return;try{_p(l)}catch(Y){Gt(l,E,Y)}break;case 5:var O=l.return;try{_p(l)}catch(Y){Gt(l,O,Y)}}}catch(Y){Gt(l,l.return,Y)}if(l===s){Ue=null;break}var W=l.sibling;if(W!==null){W.return=l.return,Ue=W;break}Ue=l.return}}var E3=Math.ceil,xf=P.ReactCurrentDispatcher,kp=P.ReactCurrentOwner,Un=P.ReactCurrentBatchConfig,ct=0,xr=null,tr=null,Pr=0,bn=0,Oo=Ti(0),ur=0,iu=null,vs=0,wf=0,Op=0,su=null,cn=null,Pp=0,Po=1/0,Wa=null,Sf=!1,Cp=null,Ni=null,bf=!1,Di=null,Ef=0,ou=0,Np=null,_f=-1,Tf=0;function Qr(){return(ct&6)!==0?De():_f!==-1?_f:_f=De()}function Mi(s){return(s.mode&1)===0?1:(ct&2)!==0&&Pr!==0?Pr&-Pr:s3.transition!==null?(Tf===0&&(Tf=tx()),Tf):(s=gt,s!==0||(s=window.event,s=s===void 0?16:cx(s.type)),s)}function oa(s,l,h,g){if(50<ou)throw ou=0,Np=null,Error(r(185));Nl(s,h,g),((ct&2)===0||s!==xr)&&(s===xr&&((ct&2)===0&&(wf|=h),ur===4&&Ri(s,Pr)),fn(s,g),h===1&&ct===0&&(l.mode&1)===0&&(Po=De()+500,Zc&&ki()))}function fn(s,l){var h=s.callbackNode;sN(s,l);var g=Mc(s,s===xr?Pr:0);if(g===0)h!==null&&je(h),s.callbackNode=null,s.callbackPriority=0;else if(l=g&-g,s.callbackPriority!==l){if(h!=null&&je(h),l===1)s.tag===0?i3(cS.bind(null,s)):qx(cS.bind(null,s)),t3(function(){(ct&6)===0&&ki()}),h=null;else{switch(rx(g)){case 1:h=Tt;break;case 4:h=kt;break;case 16:h=Qt;break;case 536870912:h=vi;break;default:h=Qt}h=yS(h,uS.bind(null,s))}s.callbackPriority=l,s.callbackNode=h}}function uS(s,l){if(_f=-1,Tf=0,(ct&6)!==0)throw Error(r(327));var h=s.callbackNode;if(Co()&&s.callbackNode!==h)return null;var g=Mc(s,s===xr?Pr:0);if(g===0)return null;if((g&30)!==0||(g&s.expiredLanes)!==0||l)l=Af(s,g);else{l=g;var w=ct;ct|=2;var E=dS();(xr!==s||Pr!==l)&&(Wa=null,Po=De()+500,xs(s,l));do try{A3();break}catch(W){fS(s,W)}while(!0);qh(),xf.current=E,ct=w,tr!==null?l=0:(xr=null,Pr=0,l=ur)}if(l!==0){if(l===2&&(w=fh(s),w!==0&&(g=w,l=Dp(s,w))),l===1)throw h=iu,xs(s,0),Ri(s,g),fn(s,De()),h;if(l===6)Ri(s,g);else{if(w=s.current.alternate,(g&30)===0&&!_3(w)&&(l=Af(s,g),l===2&&(E=fh(s),E!==0&&(g=E,l=Dp(s,E))),l===1))throw h=iu,xs(s,0),Ri(s,g),fn(s,De()),h;switch(s.finishedWork=w,s.finishedLanes=g,l){case 0:case 1:throw Error(r(345));case 2:ws(s,cn,Wa);break;case 3:if(Ri(s,g),(g&130023424)===g&&(l=Pp+500-De(),10<l)){if(Mc(s,0)!==0)break;if(w=s.suspendedLanes,(w&g)!==g){Qr(),s.pingedLanes|=s.suspendedLanes&w;break}s.timeoutHandle=Lh(ws.bind(null,s,cn,Wa),l);break}ws(s,cn,Wa);break;case 4:if(Ri(s,g),(g&4194240)===g)break;for(l=s.eventTimes,w=-1;0<g;){var O=31-Zt(g);E=1<<O,O=l[O],O>w&&(w=O),g&=~E}if(g=w,g=De()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*E3(g/1960))-g,10<g){s.timeoutHandle=Lh(ws.bind(null,s,cn,Wa),g);break}ws(s,cn,Wa);break;case 5:ws(s,cn,Wa);break;default:throw Error(r(329))}}}return fn(s,De()),s.callbackNode===h?uS.bind(null,s):null}function Dp(s,l){var h=su;return s.current.memoizedState.isDehydrated&&(xs(s,l).flags|=256),s=Af(s,l),s!==2&&(l=cn,cn=h,l!==null&&Mp(l)),s}function Mp(s){cn===null?cn=s:cn.push.apply(cn,s)}function _3(s){for(var l=s;;){if(l.flags&16384){var h=l.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var w=h[g],E=w.getSnapshot;w=w.value;try{if(!ra(E(),w))return!1}catch{return!1}}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ri(s,l){for(l&=~Op,l&=~wf,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var h=31-Zt(l),g=1<<h;s[h]=-1,l&=~g}}function cS(s){if((ct&6)!==0)throw Error(r(327));Co();var l=Mc(s,0);if((l&1)===0)return fn(s,De()),null;var h=Af(s,l);if(s.tag!==0&&h===2){var g=fh(s);g!==0&&(l=g,h=Dp(s,g))}if(h===1)throw h=iu,xs(s,0),Ri(s,l),fn(s,De()),h;if(h===6)throw Error(r(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,ws(s,cn,Wa),fn(s,De()),null}function Rp(s,l){var h=ct;ct|=1;try{return s(l)}finally{ct=h,ct===0&&(Po=De()+500,Zc&&ki())}}function ys(s){Di!==null&&Di.tag===0&&(ct&6)===0&&Co();var l=ct;ct|=1;var h=Un.transition,g=gt;try{if(Un.transition=null,gt=1,s)return s()}finally{gt=g,Un.transition=h,ct=l,(ct&6)===0&&ki()}}function Ip(){bn=Oo.current,Mt(Oo)}function xs(s,l){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==-1&&(s.timeoutHandle=-1,e3(h)),tr!==null)for(h=tr.return;h!==null;){var g=h;switch(Kh(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Xc();break;case 3:To(),Mt(on),Mt($r),np();break;case 5:tp(g);break;case 4:To();break;case 13:Mt(zt);break;case 19:Mt(zt);break;case 10:Xh(g.type._context);break;case 22:case 23:Ip()}h=h.return}if(xr=s,tr=s=Ii(s.current,null),Pr=bn=l,ur=0,iu=null,Op=wf=vs=0,cn=su=null,ps!==null){for(l=0;l<ps.length;l++)if(h=ps[l],g=h.interleaved,g!==null){h.interleaved=null;var w=g.next,E=h.pending;if(E!==null){var O=E.next;E.next=w,g.next=O}h.pending=g}ps=null}return s}function fS(s,l){do{var h=tr;try{if(qh(),uf.current=hf,cf){for(var g=Kt.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}cf=!1}if(gs=0,yr=lr=Kt=null,Jl=!1,eu=0,kp.current=null,h===null||h.return===null){ur=1,iu=l,tr=null;break}e:{var E=s,O=h.return,W=h,Y=l;if(l=Pr,W.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var fe=Y,ke=W,Ce=ke.tag;if((ke.mode&1)===0&&(Ce===0||Ce===11||Ce===15)){var Ae=ke.alternate;Ae?(ke.updateQueue=Ae.updateQueue,ke.memoizedState=Ae.memoizedState,ke.lanes=Ae.lanes):(ke.updateQueue=null,ke.memoizedState=null)}var Le=Fw(O);if(Le!==null){Le.flags&=-257,jw(Le,O,W,E,l),Le.mode&1&&Iw(E,fe,l),l=Le,Y=fe;var Ke=l.updateQueue;if(Ke===null){var He=new Set;He.add(Y),l.updateQueue=He}else Ke.add(Y);break e}else{if((l&1)===0){Iw(E,fe,l),Fp();break e}Y=Error(r(426))}}else if(Ft&&W.mode&1){var Jt=Fw(O);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),jw(Jt,O,W,E,l),Gh(Ao(Y,W));break e}}E=Y=Ao(Y,W),ur!==4&&(ur=2),su===null?su=[E]:su.push(E),E=O;do{switch(E.tag){case 3:E.flags|=65536,l&=-l,E.lanes|=l;var ne=Mw(E,Y,l);sw(E,ne);break e;case 1:W=Y;var Q=E.type,ie=E.stateNode;if((E.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Ni===null||!Ni.has(ie)))){E.flags|=65536,l&=-l,E.lanes|=l;var Re=Rw(E,W,l);sw(E,Re);break e}}E=E.return}while(E!==null)}pS(h)}catch(Ve){l=Ve,tr===h&&h!==null&&(tr=h=h.return);continue}break}while(!0)}function dS(){var s=xf.current;return xf.current=hf,s===null?hf:s}function Fp(){(ur===0||ur===3||ur===2)&&(ur=4),xr===null||(vs&268435455)===0&&(wf&268435455)===0||Ri(xr,Pr)}function Af(s,l){var h=ct;ct|=2;var g=dS();(xr!==s||Pr!==l)&&(Wa=null,xs(s,l));do try{T3();break}catch(w){fS(s,w)}while(!0);if(qh(),ct=h,xf.current=g,tr!==null)throw Error(r(261));return xr=null,Pr=0,ur}function T3(){for(;tr!==null;)hS(tr)}function A3(){for(;tr!==null&&!$e();)hS(tr)}function hS(s){var l=vS(s.alternate,s,bn);s.memoizedProps=s.pendingProps,l===null?pS(s):tr=l,kp.current=null}function pS(s){var l=s;do{var h=l.alternate;if(s=l.return,(l.flags&32768)===0){if(h=y3(h,l,bn),h!==null){tr=h;return}}else{if(h=x3(h,l),h!==null){h.flags&=32767,tr=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{ur=6,tr=null;return}}if(l=l.sibling,l!==null){tr=l;return}tr=l=s}while(l!==null);ur===0&&(ur=5)}function ws(s,l,h){var g=gt,w=Un.transition;try{Un.transition=null,gt=1,k3(s,l,h,g)}finally{Un.transition=w,gt=g}return null}function k3(s,l,h,g){do Co();while(Di!==null);if((ct&6)!==0)throw Error(r(327));h=s.finishedWork;var w=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0;var E=h.lanes|h.childLanes;if(oN(s,E),s===xr&&(tr=xr=null,Pr=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||bf||(bf=!0,yS(Qt,function(){return Co(),null})),E=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||E){E=Un.transition,Un.transition=null;var O=gt;gt=1;var W=ct;ct|=4,kp.current=null,S3(s,h),aS(h,s),GN(Fh),Fc=!!Ih,Fh=Ih=null,s.current=h,b3(h),Me(),ct=W,gt=O,Un.transition=E}else s.current=h;if(bf&&(bf=!1,Di=s,Ef=w),E=s.pendingLanes,E===0&&(Ni=null),Pl(h.stateNode),fn(s,De()),l!==null)for(g=s.onRecoverableError,h=0;h<l.length;h++)w=l[h],g(w.value,{componentStack:w.stack,digest:w.digest});if(Sf)throw Sf=!1,s=Cp,Cp=null,s;return(Ef&1)!==0&&s.tag!==0&&Co(),E=s.pendingLanes,(E&1)!==0?s===Np?ou++:(ou=0,Np=s):ou=0,ki(),null}function Co(){if(Di!==null){var s=rx(Ef),l=Un.transition,h=gt;try{if(Un.transition=null,gt=16>s?16:s,Di===null)var g=!1;else{if(s=Di,Di=null,Ef=0,(ct&6)!==0)throw Error(r(331));var w=ct;for(ct|=4,Ue=s.current;Ue!==null;){var E=Ue,O=E.child;if((Ue.flags&16)!==0){var W=E.deletions;if(W!==null){for(var Y=0;Y<W.length;Y++){var fe=W[Y];for(Ue=fe;Ue!==null;){var ke=Ue;switch(ke.tag){case 0:case 11:case 15:au(8,ke,E)}var Ce=ke.child;if(Ce!==null)Ce.return=ke,Ue=Ce;else for(;Ue!==null;){ke=Ue;var Ae=ke.sibling,Le=ke.return;if(Jw(ke),ke===fe){Ue=null;break}if(Ae!==null){Ae.return=Le,Ue=Ae;break}Ue=Le}}}var Ke=E.alternate;if(Ke!==null){var He=Ke.child;if(He!==null){Ke.child=null;do{var Jt=He.sibling;He.sibling=null,He=Jt}while(He!==null)}}Ue=E}}if((E.subtreeFlags&2064)!==0&&O!==null)O.return=E,Ue=O;else e:for(;Ue!==null;){if(E=Ue,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:au(9,E,E.return)}var ne=E.sibling;if(ne!==null){ne.return=E.return,Ue=ne;break e}Ue=E.return}}var Q=s.current;for(Ue=Q;Ue!==null;){O=Ue;var ie=O.child;if((O.subtreeFlags&2064)!==0&&ie!==null)ie.return=O,Ue=ie;else e:for(O=Q;Ue!==null;){if(W=Ue,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:yf(9,W)}}catch(Ve){Gt(W,W.return,Ve)}if(W===O){Ue=null;break e}var Re=W.sibling;if(Re!==null){Re.return=W.return,Ue=Re;break e}Ue=W.return}}if(ct=w,ki(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(xa,s)}catch{}g=!0}return g}finally{gt=h,Un.transition=l}}return!1}function mS(s,l,h){l=Ao(h,l),l=Mw(s,l,1),s=Pi(s,l,1),l=Qr(),s!==null&&(Nl(s,1,l),fn(s,l))}function Gt(s,l,h){if(s.tag===3)mS(s,s,h);else for(;l!==null;){if(l.tag===3){mS(l,s,h);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ni===null||!Ni.has(g))){s=Ao(h,s),s=Rw(l,s,1),l=Pi(l,s,1),s=Qr(),l!==null&&(Nl(l,1,s),fn(l,s));break}}l=l.return}}function O3(s,l,h){var g=s.pingCache;g!==null&&g.delete(l),l=Qr(),s.pingedLanes|=s.suspendedLanes&h,xr===s&&(Pr&h)===h&&(ur===4||ur===3&&(Pr&130023424)===Pr&&500>De()-Pp?xs(s,0):Op|=h),fn(s,l)}function gS(s,l){l===0&&((s.mode&1)===0?l=1:(l=Dc,Dc<<=1,(Dc&130023424)===0&&(Dc=4194304)));var h=Qr();s=Ba(s,l),s!==null&&(Nl(s,l,h),fn(s,h))}function P3(s){var l=s.memoizedState,h=0;l!==null&&(h=l.retryLane),gS(s,h)}function C3(s,l){var h=0;switch(s.tag){case 13:var g=s.stateNode,w=s.memoizedState;w!==null&&(h=w.retryLane);break;case 19:g=s.stateNode;break;default:throw Error(r(314))}g!==null&&g.delete(l),gS(s,h)}var vS;vS=function(s,l,h){if(s!==null)if(s.memoizedProps!==l.pendingProps||on.current)un=!0;else{if((s.lanes&h)===0&&(l.flags&128)===0)return un=!1,v3(s,l,h);un=(s.flags&131072)!==0}else un=!1,Ft&&(l.flags&1048576)!==0&&Xx(l,ef,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;gf(s,l),s=l.pendingProps;var w=yo(l,$r.current);_o(l,h),w=sp(null,l,g,s,w,h);var E=op();return l.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,ln(g)?(E=!0,Qc(l)):E=!1,l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Jh(l),w.updater=pf,l.stateNode=w,w._reactInternals=l,hp(l,g,s,h),l=vp(null,l,g,!0,E,h)):(l.tag=0,Ft&&E&&zh(l),Xr(null,l,w,h),l=l.child),l;case 16:g=l.elementType;e:{switch(gf(s,l),s=l.pendingProps,w=g._init,g=w(g._payload),l.type=g,w=l.tag=D3(g),s=aa(g,s),w){case 0:l=gp(null,l,g,s,h);break e;case 1:l=zw(null,l,g,s,h);break e;case 11:l=Lw(null,l,g,s,h);break e;case 14:l=Bw(null,l,g,aa(g.type,s),h);break e}throw Error(r(306,g,""))}return l;case 0:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:aa(g,w),gp(s,l,g,w,h);case 1:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:aa(g,w),zw(s,l,g,w,h);case 3:e:{if(Kw(l),s===null)throw Error(r(387));g=l.pendingProps,E=l.memoizedState,w=E.element,iw(s,l),of(l,g,null,h);var O=l.memoizedState;if(g=O.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){w=Ao(Error(r(423)),l),l=Hw(s,l,g,h,w);break e}else if(g!==w){w=Ao(Error(r(424)),l),l=Hw(s,l,g,h,w);break e}else for(Sn=_i(l.stateNode.containerInfo.firstChild),wn=l,Ft=!0,na=null,h=nw(l,null,g,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(So(),g===w){l=Ua(s,l,h);break e}Xr(s,l,g,h)}l=l.child}return l;case 5:return lw(l),s===null&&Vh(l),g=l.type,w=l.pendingProps,E=s!==null?s.memoizedProps:null,O=w.children,jh(g,w)?O=null:E!==null&&jh(g,E)&&(l.flags|=32),Ww(s,l),Xr(s,l,O,h),l.child;case 6:return s===null&&Vh(l),null;case 13:return Vw(s,l,h);case 4:return ep(l,l.stateNode.containerInfo),g=l.pendingProps,s===null?l.child=bo(l,null,g,h):Xr(s,l,g,h),l.child;case 11:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:aa(g,w),Lw(s,l,g,w,h);case 7:return Xr(s,l,l.pendingProps,h),l.child;case 8:return Xr(s,l,l.pendingProps.children,h),l.child;case 12:return Xr(s,l,l.pendingProps.children,h),l.child;case 10:e:{if(g=l.type._context,w=l.pendingProps,E=l.memoizedProps,O=w.value,Ot(nf,g._currentValue),g._currentValue=O,E!==null)if(ra(E.value,O)){if(E.children===w.children&&!on.current){l=Ua(s,l,h);break e}}else for(E=l.child,E!==null&&(E.return=l);E!==null;){var W=E.dependencies;if(W!==null){O=E.child;for(var Y=W.firstContext;Y!==null;){if(Y.context===g){if(E.tag===1){Y=$a(-1,h&-h),Y.tag=2;var fe=E.updateQueue;if(fe!==null){fe=fe.shared;var ke=fe.pending;ke===null?Y.next=Y:(Y.next=ke.next,ke.next=Y),fe.pending=Y}}E.lanes|=h,Y=E.alternate,Y!==null&&(Y.lanes|=h),Qh(E.return,h,l),W.lanes|=h;break}Y=Y.next}}else if(E.tag===10)O=E.type===l.type?null:E.child;else if(E.tag===18){if(O=E.return,O===null)throw Error(r(341));O.lanes|=h,W=O.alternate,W!==null&&(W.lanes|=h),Qh(O,h,l),O=E.sibling}else O=E.child;if(O!==null)O.return=E;else for(O=E;O!==null;){if(O===l){O=null;break}if(E=O.sibling,E!==null){E.return=O.return,O=E;break}O=O.return}E=O}Xr(s,l,w.children,h),l=l.child}return l;case 9:return w=l.type,g=l.pendingProps.children,_o(l,h),w=Bn(w),g=g(w),l.flags|=1,Xr(s,l,g,h),l.child;case 14:return g=l.type,w=aa(g,l.pendingProps),w=aa(g.type,w),Bw(s,l,g,w,h);case 15:return $w(s,l,l.type,l.pendingProps,h);case 17:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:aa(g,w),gf(s,l),l.tag=1,ln(g)?(s=!0,Qc(l)):s=!1,_o(l,h),Nw(l,g,w),hp(l,g,w,h),vp(null,l,g,!0,s,h);case 19:return Yw(s,l,h);case 22:return Uw(s,l,h)}throw Error(r(156,l.tag))};function yS(s,l){return Pe(s,l)}function N3(s,l,h,g){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(s,l,h,g){return new N3(s,l,h,g)}function jp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function D3(s){if(typeof s=="function")return jp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===V)return 11;if(s===Z)return 14}return 2}function Ii(s,l){var h=s.alternate;return h===null?(h=Wn(s.tag,l,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=l,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,l=s.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function kf(s,l,h,g,w,E){var O=2;if(g=s,typeof s=="function")jp(s)&&(O=1);else if(typeof s=="string")O=5;else e:switch(s){case D:return Ss(h.children,w,E,l);case z:O=8,w|=8;break;case H:return s=Wn(12,h,l,w|2),s.elementType=H,s.lanes=E,s;case ae:return s=Wn(13,h,l,w),s.elementType=ae,s.lanes=E,s;case Ee:return s=Wn(19,h,l,w),s.elementType=Ee,s.lanes=E,s;case Se:return Of(h,w,E,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:O=10;break e;case q:O=9;break e;case V:O=11;break e;case Z:O=14;break e;case Te:O=16,g=null;break e}throw Error(r(130,s==null?s:typeof s,""))}return l=Wn(O,h,l,w),l.elementType=s,l.type=g,l.lanes=E,l}function Ss(s,l,h,g){return s=Wn(7,s,g,l),s.lanes=h,s}function Of(s,l,h,g){return s=Wn(22,s,g,l),s.elementType=Se,s.lanes=h,s.stateNode={isHidden:!1},s}function Lp(s,l,h){return s=Wn(6,s,null,l),s.lanes=h,s}function Bp(s,l,h){return l=Wn(4,s.children!==null?s.children:[],s.key,l),l.lanes=h,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function M3(s,l,h,g,w){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dh(0),this.expirationTimes=dh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dh(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function $p(s,l,h,g,w,E,O,W,Y){return s=new M3(s,l,h,W,Y),l===1?(l=1,E===!0&&(l|=8)):l=0,E=Wn(3,null,null,l),s.current=E,E.stateNode=s,E.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jh(E),s}function R3(s,l,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:g==null?null:""+g,children:s,containerInfo:l,implementation:h}}function xS(s){if(!s)return Ai;s=s._reactInternals;e:{if(B(s)!==s||s.tag!==1)throw Error(r(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(ln(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(s.tag===1){var h=s.type;if(ln(h))return Gx(s,h,l)}return l}function wS(s,l,h,g,w,E,O,W,Y){return s=$p(h,g,!0,s,w,E,O,W,Y),s.context=xS(null),h=s.current,g=Qr(),w=Mi(h),E=$a(g,w),E.callback=l??null,Pi(h,E,w),s.current.lanes=w,Nl(s,w,g),fn(s,g),s}function Pf(s,l,h,g){var w=l.current,E=Qr(),O=Mi(w);return h=xS(h),l.context===null?l.context=h:l.pendingContext=h,l=$a(E,O),l.payload={element:s},g=g===void 0?null:g,g!==null&&(l.callback=g),s=Pi(w,l,O),s!==null&&(oa(s,w,O,E),sf(s,w,O)),O}function Cf(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function SS(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<l?h:l}}function Up(s,l){SS(s,l),(s=s.alternate)&&SS(s,l)}function I3(){return null}var bS=typeof reportError=="function"?reportError:function(s){console.error(s)};function Wp(s){this._internalRoot=s}Nf.prototype.render=Wp.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));Pf(s,l,null,null)},Nf.prototype.unmount=Wp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;ys(function(){Pf(null,s,null,null)}),l[Ia]=null}};function Nf(s){this._internalRoot=s}Nf.prototype.unstable_scheduleHydration=function(s){if(s){var l=ix();s={blockedOn:null,target:s,priority:l};for(var h=0;h<Si.length&&l!==0&&l<Si[h].priority;h++);Si.splice(h,0,s),h===0&&lx(s)}};function zp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Df(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function ES(){}function F3(s,l,h,g,w){if(w){if(typeof g=="function"){var E=g;g=function(){var fe=Cf(O);E.call(fe)}}var O=wS(l,g,s,0,null,!1,!1,"",ES);return s._reactRootContainer=O,s[Ia]=O.current,Hl(s.nodeType===8?s.parentNode:s),ys(),O}for(;w=s.lastChild;)s.removeChild(w);if(typeof g=="function"){var W=g;g=function(){var fe=Cf(Y);W.call(fe)}}var Y=$p(s,0,!1,null,null,!1,!1,"",ES);return s._reactRootContainer=Y,s[Ia]=Y.current,Hl(s.nodeType===8?s.parentNode:s),ys(function(){Pf(l,Y,h,g)}),Y}function Mf(s,l,h,g,w){var E=h._reactRootContainer;if(E){var O=E;if(typeof w=="function"){var W=w;w=function(){var Y=Cf(O);W.call(Y)}}Pf(l,O,s,w)}else O=F3(h,l,s,w,g);return Cf(O)}nx=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var h=Cl(l.pendingLanes);h!==0&&(hh(l,h|1),fn(l,De()),(ct&6)===0&&(Po=De()+500,ki()))}break;case 13:ys(function(){var g=Ba(s,1);if(g!==null){var w=Qr();oa(g,s,1,w)}}),Up(s,1)}},ph=function(s){if(s.tag===13){var l=Ba(s,134217728);if(l!==null){var h=Qr();oa(l,s,134217728,h)}Up(s,134217728)}},ax=function(s){if(s.tag===13){var l=Mi(s),h=Ba(s,l);if(h!==null){var g=Qr();oa(h,s,l,g)}Up(s,l)}},ix=function(){return gt},sx=function(s,l){var h=gt;try{return gt=s,l()}finally{gt=h}},so=function(s,l,h){switch(l){case"input":if(pe(s,h),l=h.name,h.type==="radio"&&l!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<h.length;l++){var g=h[l];if(g!==s&&g.form===s.form){var w=qc(g);if(!w)throw Error(r(90));ge(g),pe(g,w)}}}break;case"textarea":or(s,h);break;case"select":l=h.value,l!=null&&lt(s,!!h.multiple,l,!1)}},Oc=Rp,Pc=ys;var j3={usingClientEntryPoint:!1,Events:[Yl,go,qc,Ac,kc,Rp]},lu={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},L3={bundleType:lu.bundleType,version:lu.version,rendererPackageName:lu.rendererPackageName,rendererConfig:lu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ue(s),s===null?null:s.stateNode},findFiberByHostInstance:lu.findFiberByHostInstance||I3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rf.isDisabled&&Rf.supportsFiber)try{xa=Rf.inject(L3),vr=Rf}catch{}}return dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j3,dn.createPortal=function(s,l){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zp(l))throw Error(r(200));return R3(s,l,null,h)},dn.createRoot=function(s,l){if(!zp(s))throw Error(r(299));var h=!1,g="",w=bS;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(w=l.onRecoverableError)),l=$p(s,1,!1,null,null,h,!1,g,w),s[Ia]=l.current,Hl(s.nodeType===8?s.parentNode:s),new Wp(l)},dn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=ue(l),s=s===null?null:s.stateNode,s},dn.flushSync=function(s){return ys(s)},dn.hydrate=function(s,l,h){if(!Df(l))throw Error(r(200));return Mf(null,s,l,!0,h)},dn.hydrateRoot=function(s,l,h){if(!zp(s))throw Error(r(405));var g=h!=null&&h.hydratedSources||null,w=!1,E="",O=bS;if(h!=null&&(h.unstable_strictMode===!0&&(w=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onRecoverableError!==void 0&&(O=h.onRecoverableError)),l=wS(l,null,s,1,h??null,w,!1,E,O),s[Ia]=l.current,Hl(s),g)for(s=0;s<g.length;s++)h=g[s],w=h._getVersion,w=w(h._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[h,w]:l.mutableSourceEagerHydrationData.push(h,w);return new Nf(l)},dn.render=function(s,l,h){if(!Df(l))throw Error(r(200));return Mf(null,s,l,!1,h)},dn.unmountComponentAtNode=function(s){if(!Df(s))throw Error(r(40));return s._reactRootContainer?(ys(function(){Mf(null,null,s,!1,function(){s._reactRootContainer=null,s[Ia]=null})}),!0):!1},dn.unstable_batchedUpdates=Rp,dn.unstable_renderSubtreeIntoContainer=function(s,l,h,g){if(!Df(h))throw Error(r(200));if(s==null||s._reactInternals===void 0)throw Error(r(38));return Mf(s,l,h,!1,g)},dn.version="18.3.1-next-f1338f8080-20240426",dn}var NS;function AT(){if(NS)return Vp.exports;NS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Vp.exports=G3(),Vp.exports}var DS;function Y3(){if(DS)return If;DS=1;var e=AT();return If.createRoot=e.createRoot,If.hydrateRoot=e.hydrateRoot,If}var q3=Y3();const X3=Na(q3),de={logs:[],_subscribers:new Set,subscribe(e){return this._subscribers.add(e),e([...this.logs]),()=>this._subscribers.delete(e)},_notify(){const e=[...this.logs];for(const t of this._subscribers)t(e)},log(e,t="SYSTEM"){const r=new Date().toLocaleTimeString(),n={id:Date.now()+Math.random(),timestamp:r,source:t,message:e};this.logs.push(n),console.log(`[${t}] ${e}`),this._notify()},initGlobalErrorHandling(){this.log("Initializing global error handlers.","LOGGER"),window.onerror=(e,t,r,n,a)=>(this.log(`[UNCAUGHT ERROR] ${e} at ${t}:${r}:${n}`,"ERROR"),!0),window.onunhandledrejection=e=>{this.log(`[UNHANDLED PROMISE] ${e.reason}`,"ERROR")}}},Xo={WARRIOR:{id:"warrior",nameKey:"characters.warrior.name",resourceKey:"resources.vigor",resourceIcon:"🟣",roleKey:"characters.warrior.role",descriptionKey:"characters.warrior.description",traits:["characters.warrior.traits.highDefense","characters.warrior.traits.resolute","characters.warrior.traits.areaStrikes"],baseStats:{hp:100,resource:50,atk:12,def:10,spd:6,crit:10},growthRates:{hp:6,atk:1.2,def:1.8,spd:.4,crit:.2},abilities:["power_strike","defensive_stance","shield_bash","battle_cry","whirlwind_attack","iron_will","execute","last_stand"],progressionPath:"defensive_tank",preferredEnemyTypes:["brute","physical"],bossScalingModifier:1,uniqueRewards:["heavy_armor","shields"]},SORCERESS:{id:"sorceress",nameKey:"characters.sorceress.name",resourceKey:"resources.mana",resourceIcon:"🔵",roleKey:"characters.sorceress.role",descriptionKey:"characters.sorceress.description",traits:["characters.sorceress.traits.elementalMagic","characters.sorceress.traits.spellMastery","characters.sorceress.traits.ancientKnowledge"],baseStats:{hp:80,resource:70,atk:14,def:6,spd:7,crit:12},growthRates:{hp:4,atk:1.4,def:.6,spd:.6,crit:.4},abilities:["magic_missile","mana_shield","fireball","ice_shard","lightning_bolt","arcane_intellect","meteor","time_warp"],progressionPath:"elemental_mage",preferredEnemyTypes:["magical","undead"],bossScalingModifier:1,uniqueRewards:["staves","mana_crystals"]},ROGUE:{id:"rogue",nameKey:"characters.rogue.name",resourceKey:"resources.energy",resourceIcon:"🟢",roleKey:"characters.rogue.role",descriptionKey:"characters.rogue.description",traits:["characters.rogue.traits.berserkerRage","characters.rogue.traits.rawStrength","characters.rogue.traits.intimidating"],baseStats:{hp:90,resource:60,atk:15,def:7,spd:10,crit:18},growthRates:{hp:5,atk:1.5,def:.9,spd:.8,crit:.6},abilities:["quick_strike","evasion","venom_strike","shadow_step","fan_of_knives","deadly_precision","backstab","death_mark"],progressionPath:"assassin_berserker",preferredEnemyTypes:["fast","elite"],bossScalingModifier:1,uniqueRewards:["daggers","poisons"]}},tt={DEBUG_MODE:!1,GAME_VERSION:"V.40.1",LOADING_DURATION_MS:1e3,SCREENS:{intro:{html:"screens/intro.html",js:"js/screens/intro.js"},"character-select":{html:"screens/character-select.html",js:"js/screens/character-select.js"},battle:{html:"screens/battle.html",js:"js/screens/battle.js"}},DEFAULT_LANGUAGE:"en",AUTOSAVE_FLOORS:[1,5,10],INVENTORY:{startingGold:100,maxSlots:20,startingPotions:[{type:"hp_potion",quantity:3},{type:"resource_potion",quantity:2}]},XP_CURVE:{baseXP:70,increment:50,maxLevel:60},RARITIES:{common:{name:{en:"Common",ar:"شائع"},chance:60,statMult:1,color:"#95a5a6"},uncommon:{name:{en:"Uncommon",ar:"غير شائع"},chance:25,statMult:1.2,color:"#27ae60"},rare:{name:{en:"Rare",ar:"نادر"},chance:10,statMult:1.5,color:"#3498db"},epic:{name:{en:"Epic",ar:"ملحمي"},chance:4,statMult:1.9,color:"#9b59b6"},mythic:{name:{en:"Mythic",ar:"أسطوري"},chance:.8,statMult:2.4,color:"#e67e22"},legendary:{name:{en:"Legendary",ar:"خارق"},chance:.2,statMult:3,color:"#f1c40f"}},EQUIPMENT_SLOTS:{weapon:{name:{en:"Weapon",ar:"سلاح"},icon:"⚔️"},head:{name:{en:"Head",ar:"رأس"},icon:"👑"},chest:{name:{en:"Chest",ar:"صدر"},icon:"👕"}},ITEM_TYPES:{sword:{name:{en:"Sword",ar:"سيف"},slot:"weapon",icon:"🗡️",baseStats:{atk:5}},staff:{name:{en:"Staff",ar:"عصا"},slot:"weapon",icon:"🪄",baseStats:{atk:7}},hp_potion:{name:{en:"Health Potion",ar:"جرعة صحة"},slot:null,icon:"❤️‍🩹",consumable:!0,effect:"heal_hp",value:50,description:{en:"Restores 50 HP instantly.",ar:"يستعيد 50 نقطة صحة فوراً."}},resource_potion:{name:{en:"Resource Potion",ar:"جرعة المورد"},slot:null,icon:"🧪",consumable:!0,effect:"restore_resource",value:40,description:{en:"Restores 40 resource points.",ar:"يستعيد 40 نقطة مورد."}},greater_hp_potion:{name:{en:"Greater Health Potion",ar:"جرعة صحة كبيرة"},slot:null,icon:"💖",consumable:!0,effect:"heal_hp",value:80,description:{en:"Restores 80 HP instantly.",ar:"يستعيد 80 نقطة صحة فوراً."}},elixir_of_vitality:{name:{en:"Elixir of Vitality",ar:"إكسير الحيوية"},slot:null,icon:"🌟",consumable:!0,effect:"full_heal",value:100,description:{en:"Fully restores HP and resource.",ar:"يستعيد الصحة والمورد بالكامل."}}},ITEM_PREFIXES:[{name:{en:"Sturdy",ar:"متين"},statMod:{def:2}},{name:{en:"Sharp",ar:"حاد"},statMod:{atk:2}}],ITEM_SUFFIXES:[{name:{en:"of Speed",ar:"السرعة"},statMod:{spd:1}},{name:{en:"of Power",ar:"القوة"},statMod:{atk:1,def:1}}],COMBAT:{baseCritMultiplier:1.6,fleeChance:.6,resourceRegeneration:{baseAmount:8,levelScaling:.5}},ABILITIES:{power_strike:{name:{en:"Power Strike",ar:"ضربة قوية"},description:{en:"Deal 150% weapon damage to single target.",ar:"اصنع 150% من ضرر السلاح لهدف واحد."},cost:8,target:"single",type:"attack",damageMultiplier:1.5,unlockLevel:1},defensive_stance:{name:{en:"Defensive Stance",ar:"موقف دفاعي"},description:{en:"+50% DEF and regenerate 5 HP per turn for 2 turns.",ar:"+50% دفاع واستعادة 5 نقطة صحة لكل دور لمدة دورتين."},cost:10,target:"self",type:"buff",effect:{type:"def_buff",stat:"def",multiplier:1.5,duration:2,regen:5,icon:"🛡️"},cooldown:3,unlockLevel:1},shield_bash:{name:{en:"Shield Bash",ar:"ضربة الدرع"},description:{en:"Deal 90% damage and reduce enemy ATK by 30% for 2 turns.",ar:"اصنع 90% ضرر وقلل هجوم العدو بنسبة 30% لمدة دورتين."},cost:12,target:"single",type:"attack_debuff",damageMultiplier:.9,effect:{type:"weaken",stat:"atk",amount:.7,duration:2,icon:"📉"},unlockLevel:3},battle_cry:{name:{en:"Battle Cry",ar:"صرخة المعركة"},description:{en:"+25% ATK and +2 SPD for 3 turns.",ar:"+25% هجوم و +2 سرعة لمدة 3 أدوار."},cost:15,target:"self",type:"buff",effect:{type:"atk_buff",stat:"atk",multiplier:1.25,spdBonus:2,duration:3,icon:"📢"},cooldown:4,unlockLevel:6},whirlwind_attack:{name:{en:"Whirlwind Attack",ar:"هجوم الزوبعة"},description:{en:"Deal 70% damage to ALL enemies.",ar:"اصنع 70% ضرر لجميع الأعداء."},cost:20,target:"all",type:"attack_aoe",damageMultiplier:.7,unlockLevel:9},iron_will:{name:{en:"Iron Will",ar:"إرادة حديدية"},description:{en:"Heal 30 HP and gain 20% damage resistance for 2 turns.",ar:"استعد 30 نقطة صحة واحصل على 20% مقاومة للضرر لمدة دورتين."},cost:25,target:"self",type:"heal_buff",healAmount:30,effect:{type:"resistance",amount:.8,duration:2,icon:"💪"},cooldown:5,unlockLevel:12},execute:{name:{en:"Execute",ar:"إعدام"},description:{en:"Deal 200% damage, +100% bonus if enemy HP < 30%.",ar:"اصنع 200% ضرر، +100% مكافأة إذا كانت صحة العدو < 30%."},cost:18,target:"single",type:"attack",damageMultiplier:2,effect:{type:"execute",threshold:.3,bonusMultiplier:1},cooldown:2,unlockLevel:15},last_stand:{name:{en:"Last Stand",ar:"الموقف الأخير"},description:{en:"Deal 250% damage to all enemies and heal 20% of damage dealt.",ar:"اصنع 250% ضرر لجميع الأعداء واستعد 20% من الضرر المسبب."},cost:40,target:"all",type:"attack_aoe",damageMultiplier:2.5,effect:{type:"vampiric",percentage:20},cooldown:6,unlockLevel:18},magic_missile:{name:{en:"Magic Missile",ar:"صاروخ سحري"},description:{en:"Deal 140% magic damage to single target, never misses.",ar:"اصنع 140% ضرر سحري لهدف واحد، لا يخطئ أبداً."},cost:8,target:"single",type:"attack",damageMultiplier:1.4,neverMiss:!0,unlockLevel:1},mana_shield:{name:{en:"Mana Shield",ar:"درع المانا"},description:{en:"Absorb next 40 damage taken (lasts 3 turns).",ar:"امتص الضرر التالي 40 (يدوم 3 أدوار)."},cost:12,target:"self",type:"buff",effect:{type:"shield",amount:40,duration:3,icon:"🔮"},cooldown:4,unlockLevel:1},fireball:{name:{en:"Fireball",ar:"كرة نارية"},description:{en:"Deal 80% fire damage to ALL enemies.",ar:"اصنع 80% ضرر ناري لجميع الأعداء."},cost:20,target:"all",type:"attack_aoe",damageMultiplier:.8,unlockLevel:3},ice_shard:{name:{en:"Ice Shard",ar:"شظية جليدية"},description:{en:"Deal 120% damage and slow enemy (-30% SPD) for 2 turns.",ar:"اصنع 120% ضرر وبطء العدو (-30% سرعة) لمدة دورتين."},cost:15,target:"single",type:"attack_debuff",damageMultiplier:1.2,effect:{type:"slow",stat:"spd",amount:.7,duration:2,icon:"❄️"},unlockLevel:6},lightning_bolt:{name:{en:"Lightning Bolt",ar:"صاعقة برق"},description:{en:"Deal 180% damage with +40% crit chance.",ar:"اصنع 180% ضرر مع +40% فرصة حرجة."},cost:18,target:"single",type:"attack",damageMultiplier:1.8,effect:{type:"crit_boost",bonus:40},cooldown:2,unlockLevel:9},arcane_intellect:{name:{en:"Arcane Intellect",ar:"ذكاء سري"},description:{en:"+40% ATK and +20 max Mana for rest of battle.",ar:"+40% هجوم و +20 مانا كحد أقصى لبقية المعركة."},cost:25,target:"self",type:"buff",effect:{type:"permanent_buff",stat:"atk",multiplier:1.4,resourceBonus:20,duration:"battle",icon:"🧠"},cooldown:999,unlockLevel:12},meteor:{name:{en:"Meteor",ar:"نيزك"},description:{en:"Deal 120% damage to all enemies + 20% burn over 2 turns.",ar:"اصنع 120% ضرر لجميع الأعداء + 20% حرق على مدى دورتين."},cost:35,target:"all",type:"attack_aoe",damageMultiplier:1.2,effect:{type:"burn",damagePercent:.2,duration:2,icon:"☄️"},cooldown:4,unlockLevel:15},time_warp:{name:{en:"Time Warp",ar:"تشوه الزمن"},description:{en:"Take an extra turn immediately and restore 20 resource.",ar:"خذ دوراً إضافياً فوراً واستعد 20 مورد."},cost:50,target:"self",type:"utility",effect:{type:"extra_turn",resourceRestore:20},cooldown:7,unlockLevel:18},quick_strike:{name:{en:"Quick Strike",ar:"ضربة سريعة"},description:{en:"Deal 130% damage with +20% crit chance.",ar:"اصنع 130% ضرر مع +20% فرصة حرجة."},cost:7,target:"single",type:"attack",damageMultiplier:1.3,effect:{type:"crit_boost",bonus:20},unlockLevel:1},evasion:{name:{en:"Evasion",ar:"مراوغة"},description:{en:"+40% dodge chance (avoid damage) for 2 turns.",ar:"+40% فرصة المراوغة (تجنب الضرر) لمدة دورتين."},cost:10,target:"self",type:"buff",effect:{type:"dodge_buff",amount:40,duration:2,icon:"💨"},cooldown:4,unlockLevel:1},venom_strike:{name:{en:"Venom Strike",ar:"ضربة سامة"},description:{en:"Deal 130% damage + poison (10 dmg/turn for 3 turns).",ar:"اصنع 130% ضرر + سم (10 ضرر/دور لمدة 3 أدوار)."},cost:15,target:"single",type:"attack_dot",damageMultiplier:1.3,effect:{type:"poison",damage:10,duration:3,icon:"☠️"},unlockLevel:3},shadow_step:{name:{en:"Shadow Step",ar:"خطوة الظل"},description:{en:"Next attack deals +60% damage and cannot miss.",ar:"الهجوم التالي يسبب +60% ضرر ولا يمكن أن يخطئ."},cost:12,target:"self",type:"buff",effect:{type:"guaranteed_hit",bonusMultiplier:.6,duration:1,icon:"👤"},cooldown:3,unlockLevel:6},fan_of_knives:{name:{en:"Fan of Knives",ar:"مروحة السكاكين"},description:{en:"Deal 60% damage to all enemies + weak poison (5 dmg/turn).",ar:"اصنع 60% ضرر لجميع الأعداء + سم ضعيف (5 ضرر/دور)."},cost:20,target:"all",type:"attack_aoe",damageMultiplier:.6,effect:{type:"poison",damage:5,duration:3,icon:"🔪"},unlockLevel:9},deadly_precision:{name:{en:"Deadly Precision",ar:"دقة قاتلة"},description:{en:"+50% crit chance and +30% crit damage for 3 turns.",ar:"+50% فرصة حرجة و +30% ضرر حرج لمدة 3 أدوار."},cost:25,target:"self",type:"buff",effect:{type:"crit_buff",critBonus:50,critDamageBonus:.3,duration:3,icon:"🎯"},cooldown:5,unlockLevel:12},backstab:{name:{en:"Backstab",ar:"طعنة في الظهر"},description:{en:"Deal 250% damage to single target, guaranteed crit.",ar:"اصنع 250% ضرر لهدف واحد، حرج مضمون."},cost:22,target:"single",type:"attack",damageMultiplier:2.5,guaranteedCrit:!0,cooldown:3,unlockLevel:15},death_mark:{name:{en:"Death Mark",ar:"علامة الموت"},description:{en:"Mark enemy - all attacks deal +50% damage to marked target for 4 turns.",ar:"ضع علامة على العدو - جميع الهجمات تسبب +50% ضرر للهدف المحدد لمدة 4 أدوار."},cost:45,target:"single",type:"debuff",effect:{type:"marked",multiplier:1.5,duration:4,icon:"💀"},cooldown:6,unlockLevel:18}},BATTLE_BUFFS:{berserker_rage:{name:{en:"Berserker Rage",ar:"غضب البرسيركر"},description:{en:"+25% attack damage this battle",ar:"+25% ضرر الهجوم في هذه المعركة"},icon:"🔥",effect:{stat:"atk",multiplier:1.25,duration:"battle"}},precision_strike:{name:{en:"Precision Strike",ar:"ضربة دقيقة"},description:{en:"+15% critical hit chance this battle",ar:"+15% فرصة الضربة الحاسمة في هذه المعركة"},icon:"🎯",effect:{stat:"crit",bonus:15,duration:"battle"}},swift_reflexes:{name:{en:"Swift Reflexes",ar:"ردود فعل سريعة"},description:{en:"+30% speed this battle",ar:"+30% سرعة في هذه المعركة"},icon:"⚡",effect:{stat:"spd",multiplier:1.3,duration:"battle"}},iron_skin:{name:{en:"Iron Skin",ar:"جلد حديدي"},description:{en:"+40% defense this battle",ar:"+40% دفاع في هذه المعركة"},icon:"🛡️",effect:{stat:"def",multiplier:1.4,duration:"battle"}},vampiric_aura:{name:{en:"Vampiric Aura",ar:"هالة مصاص الدماء"},description:{en:"Heal 20% of damage dealt as HP",ar:"استعيد 20% من الضرر كصحة"},icon:"🩸",effect:{type:"vampiric",percentage:20,duration:"battle"}},mana_surge:{name:{en:"Mana Surge",ar:"تدفق مانا"},description:{en:"+50% resource regeneration this battle",ar:"+50% تجديد المورد في هذه المعركة"},icon:"💫",effect:{type:"resource_boost",multiplier:1.5,duration:"battle"}},battle_focus:{name:{en:"Battle Focus",ar:"تركيز القتال"},description:{en:"Abilities cost 25% less resource",ar:"المهارات تكلف 25% أقل"},icon:"🎭",effect:{type:"cost_reduction",percentage:25,duration:"battle"}},lucky_strikes:{name:{en:"Lucky Strikes",ar:"ضربات محظوظة"},description:{en:"20% chance to not consume resource on ability use",ar:"20% عدم استهلاك مورد"},icon:"🍀",effect:{type:"resource_save",chance:20,duration:"battle"}},second_wind:{name:{en:"Second Wind",ar:"نفس ثاني"},description:{en:"Heal 15 HP at start of each turn",ar:"استعيد 15 صحة في بداية كل دور"},icon:"🌪️",effect:{type:"regeneration",amount:15,duration:"battle"}}},DIFFICULTIES:{easy:{enemyHp:.8,enemyAtk:.8,xpGain:1,goldGain:1,playerDmgMult:1.2,enemyDmgMult:.7},normal:{enemyHp:1,enemyAtk:1,xpGain:1.1,goldGain:1.1,playerDmgMult:1,enemyDmgMult:1},hard:{enemyHp:1.3,enemyAtk:1.2,xpGain:1.3,goldGain:1.2,playerDmgMult:.9,enemyDmgMult:1.2}}};class Q3{constructor(){this.currentLanguage="en",this.translations={en:{},ar:{}},this.isLoaded=!1,this.subscribers=new Set;const t=localStorage.getItem("pathOfHeroes_language");t&&(t==="en"||t==="ar")&&(this.currentLanguage=t)}async loadTranslations(){try{de.log("Loading translation files...","SYSTEM");const t="/p-o-h/",[r,n]=await Promise.all([fetch(`${t}locales/en.json`),fetch(`${t}locales/ar.json`)]);if(!r.ok||!n.ok)throw new Error("Failed to load translation files");this.translations.en=await r.json(),this.translations.ar=await n.json(),this.isLoaded=!0,de.log(`Translations loaded successfully. Current language: ${this.currentLanguage}`,"SYSTEM"),this.setLanguage(this.currentLanguage),this.notifySubscribers()}catch(t){de.log(`Failed to load translations: ${t.message}`,"ERROR"),this.loadFallbackTranslations()}}loadFallbackTranslations(){this.translations={en:{game:{title:"Path of Heroes"},language:{select:"Select Language",english:"English",arabic:"العربية"},menu:{loading:"Loading..."}},ar:{game:{title:"طريق الأبطال"},language:{select:"اختر اللغة",english:"English",arabic:"العربية"},menu:{loading:"جاري التحميل..."}}},this.isLoaded=!0,de.log("Loaded fallback translations","SYSTEM")}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}notifySubscribers(){this.subscribers.forEach(t=>{try{t(this.currentLanguage)}catch(r){de.log(`Error in localization subscriber: ${r}`,"ERROR")}})}get(t,r={}){if(!this.isLoaded)return t;const n=t.split(".");let a=this.translations[this.currentLanguage];for(const i of n)if(a&&typeof a=="object"&&i in a)a=a[i];else{if(this.currentLanguage==="ar"){let o=this.translations.en;for(const u of n)if(o&&typeof o=="object"&&u in o)o=o[u];else{o=t;break}a=o}else a=t;break}return typeof a=="string"&&Object.keys(r).length>0?this.interpolate(a,r):a}interpolate(t,r){return t.replace(/\{(\w+)\}/g,(n,a)=>r[a]!==void 0?r[a]:n)}setLanguage(t){if(!["en","ar"].includes(t)){de.log(`Unsupported language: ${t}`,"ERROR");return}this.currentLanguage=t,document.documentElement.setAttribute("dir",t==="ar"?"rtl":"ltr"),document.documentElement.setAttribute("lang",t),localStorage.setItem("pathOfHeroes_language",t),de.log(`Language changed to: ${t}`,"SYSTEM"),this.notifySubscribers()}getCurrentLanguage(){return this.currentLanguage}isReady(){return this.isLoaded}}const Er=new Q3,ee=(e,t)=>Er.get(e,t);class kT{static initializeStartingPotions(){U.current.potions||(U.current.potions={}),(tt.INVENTORY.startingPotions||[]).forEach(({type:r,quantity:n})=>{U.current.potions[r]=(U.current.potions[r]||0)+n}),de.log(`Initialized starting potions: ${JSON.stringify(U.current.potions)}`,"SYSTEM"),U._notify()}static usePotion(t){if(!U.current.potions||!U.current.potions[t]||U.current.potions[t]<=0)return de.log(`No ${t} available`,"SYSTEM"),!1;const r=tt.ITEM_TYPES[t];if(!r||!r.consumable)return de.log(`Invalid potion type: ${t}`,"ERROR"),!1;const n=U.current.player;let a="";switch(r.effect){case"heal_hp":const i=Math.min(r.value,n.maxStats.hp-n.stats.hp);n.stats.hp+=i,a=`Healed ${i} HP`;break;case"restore_resource":const o=Math.min(r.value,n.resource.max-n.resource.current);n.resource.current+=o,a=`Restored ${o} ${ee(n.resource.nameKey)}`;break;case"full_heal":const u=n.maxStats.hp-n.stats.hp,c=n.resource.max-n.resource.current;n.stats.hp=n.maxStats.hp,n.resource.current=n.resource.max,a=`Fully healed (+${u} HP, +${c} ${ee(n.resource.nameKey)})`;break;default:return de.log(`Unknown potion effect: ${r.effect}`,"ERROR"),!1}return U.current.potions[t]--,de.log(`Used ${t}: ${a}`,"SYSTEM"),U._notify(),{success:!0,message:a}}static getAvailablePotions(){return U.current.potions?Object.entries(U.current.potions).filter(([t,r])=>r>0).map(([t,r])=>({type:t,quantity:r,config:tt.ITEM_TYPES[t],name:ee(`items.${t}`)||tt.ITEM_TYPES[t]?.name?.en||t})):[]}static addPotion(t,r=1){U.current.potions||(U.current.potions={}),U.current.potions[t]=(U.current.potions[t]||0)+r,de.log(`Added ${r}x ${t}`,"SYSTEM"),U._notify()}static hasPotion(t,r=1){return U.current.potions&&U.current.potions[t]&&U.current.potions[t]>=r}}const U={current:{gameStarted:!1,currentScreen:"main-menu",player:null,selectedCharacter:null,currentFloor:1,gold:0,level:1,inventory:[],equipped:{},battleInProgress:!1,enemies:[],turnOrder:[],currentTurnIndex:0,enemiesDefeated:0,dungeon:null,playerPos:null,onBattleEnd:null,godMode:!1,currentRunSouls:0,totalSouls:0,soulUpgrades:{},characterSouls:{},characterUpgrades:{}},subscribers:[],subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter(t=>t!==e)}},_notify(){this.subscribers.forEach(e=>{try{e({...this.current})}catch(t){de.log(`Error in GameState subscriber: ${t}`,"ERROR")}})},update(e,t){this.current[e]=t,this._notify()},reset(){const e=this.current.selectedCharacter;this.current={...this.current,gameStarted:!1,currentScreen:e?"save-slots":"main-menu",player:null,currentFloor:1,gold:0,experience:0,level:1,inventory:[],equipped:{},battleInProgress:!1,enemies:[],turnOrder:[],currentTurnIndex:0,enemiesDefeated:0},de.log(`Game state has been reset. Returning to ${this.current.currentScreen}`,"STATE"),this._notify()},newGame(e,t="normal"){this.current={...this.current,gameStarted:!0,currentScreen:"exploration",difficulty:t,selectedCharacter:e,currentFloor:1,gold:25,experience:0,level:1,inventory:[],equipped:{},battleInProgress:!1,enemies:[],turnOrder:[],currentTurnIndex:0,enemiesDefeated:0};const r=Xo[e.toUpperCase()];if(!r)throw new Error(`Invalid character: ${e}`);return this.current.player=this.createPlayerFromCharacter(r),kT.initializeStartingPotions(),de.log(`New game started with character: ${e}`,"STATE"),this._notify(),!0},createPlayerFromCharacter(e){return{id:e.id,characterId:e.id,nameKey:e.nameKey,class:e.id,roleKey:e.roleKey,sprite:"...",stats:{...e.baseStats},maxStats:{...e.baseStats},resource:{nameKey:e.resourceKey,current:e.baseStats.resource,max:e.baseStats.resource},abilities:[...e.abilities],statusEffects:[]}},updatePlayerStats(){if(!this.current.player)return;const e=Xo[this.current.selectedCharacter.toUpperCase()],t={...e.baseStats},r=e.growthRates,n=this.current.level-1;t.hp=Math.floor(t.hp+r.hp*n),t.maxHp=t.hp,t.atk=Math.floor(t.atk+r.atk*n),t.def=Math.floor(t.def+r.def*n),t.spd=Math.floor(t.spd+r.spd*n),t.crit=parseFloat((t.crit+r.crit*n).toFixed(2)),Object.values(this.current.equipped).forEach(i=>{i&&i.stats&&Object.keys(i.stats).forEach(o=>{t.hasOwnProperty(o)&&(t[o]+=i.stats[o])})});const a=this.applyPermanentUpgrades();t.hp=Math.floor(t.hp*a.hpMultiplier),this.current.player.stats=t,this.current.player.maxStats={...t}},addExperience(e){if(!this.current.player)return;const t=this.applyPermanentUpgrades();e=Math.floor(e*t.xpMultiplier),this.current.experience+=e;const r=this.current.level,n=this.getRequiredExperience(r+1);this.current.experience>=n&&this.levelUp(),this._notify()},levelUp(){this.current.player&&(this.current.level++,this.updatePlayerStats(),this.healPlayerToFull(),de.log(`Player leveled up to ${this.current.level}!`,"SYSTEM"),this._notify())},getRequiredExperience(e){return e<=1?0:tt.XP_CURVE.baseXP+(e-2)*tt.XP_CURVE.increment},healPlayerToFull(){this.current.player&&(this.current.player.stats.hp=this.current.player.maxStats.hp,this.current.player.resource.current=this.current.player.resource.max,de.log("Player healed to full HP and resource.","SYSTEM"),this._notify())},spendResource(e){return this.current.player&&this.current.player.resource.current>=e?(this.current.player.resource.current-=e,this._notify(),!0):!1},addGold(e){const t=this.applyPermanentUpgrades();e===tt.INVENTORY.startingGold&&(e=Math.floor(e*t.startingGoldMultiplier)),this.current.gold+=e,this._notify()},spendGold(e){return this.current.gold>=e?(this.current.gold-=e,this._notify(),!0):!1},applyDeathPenalty(){const e=Math.floor(this.current.gold*.9),t=this.current.gold-e;return this.current.gold=t,de.log(`Death penalty applied: Lost ${e} gold, kept ${t}`,"SYSTEM"),this._notify(),{goldLost:e,goldKept:t}},awardSouls(e,t){this.current.currentRunSouls+=e,de.log(`Earned ${e} Hero Souls: ${t}`,"SYSTEM"),this._notify()},collectRunSouls(){const e=this.current.currentRunSouls;this.current.totalSouls+=e;const t=this.current.selectedCharacter,r=this.getCurrentSaveSlot();t&&r&&this.addCharacterSouls(t,r,e),this.current.currentRunSouls=0,this.saveSoulData(),de.log(`Collected ${e} Hero Souls. Total: ${this.current.totalSouls}`,"SYSTEM")},getCharacterSouls(e,t){this.current.characterSouls[e]||(this.current.characterSouls[e]={});const r=`slot${t}`;return this.current.characterSouls[e][r]||0},addCharacterSouls(e,t,r){this.current.characterSouls[e]||(this.current.characterSouls[e]={});const n=`slot${t}`;this.current.characterSouls[e][n]=(this.current.characterSouls[e][n]||0)+r,this.saveSoulData()},spendCharacterSouls(e,t,r){const n=this.getCharacterSouls(e,t);if(n>=r){const a=`slot${t}`;return this.current.characterSouls[e][a]=n-r,this.saveSoulData(),!0}return!1},getCurrentSaveSlot(){return this.current.currentSaveSlot||1},getCharacterLevel(e,t){const r=`pathOfHeroes_save_${e}_slot${t}`,n=localStorage.getItem(r);return n&&JSON.parse(n).level||1},getCharacterUpgrades(e,t){this.current.characterUpgrades[e]||(this.current.characterUpgrades[e]={});const r=`slot${t}`;return this.current.characterUpgrades[e][r]||{}},purchaseCharacterUpgrade(e,t,r){const n=this.getCharacterLevel(e,t),i=this.getSoulUpgrades(e,n)[r],o=this.getCharacterUpgrades(e,t);if(!i||o[r])return!1;if(this.spendCharacterSouls(e,t,i.cost)){this.current.characterUpgrades[e]||(this.current.characterUpgrades[e]={});const u=`slot${t}`;return this.current.characterUpgrades[e][u]||(this.current.characterUpgrades[e][u]={}),this.current.characterUpgrades[e][u][r]=!0,this.saveSoulData(),de.log(`Purchased upgrade: ${r} for ${e} slot ${t}`,"SYSTEM"),!0}return!1},spendSouls(e){return this.current.totalSouls>=e?(this.current.totalSouls-=e,this.saveSoulData(),this._notify(),!0):!1},purchaseUpgrade(e){const r=this.getSoulUpgrades()[e];return!r||this.current.soulUpgrades[e]?!1:this.spendSouls(r.cost)?(this.current.soulUpgrades[e]=!0,this.saveSoulData(),de.log(`Purchased upgrade: ${e}`,"SYSTEM"),!0):!1},getSoulUpgrades(e,t=1){const r={vitality:{nameKey:"upgrades.vitality.name",descriptionKey:"upgrades.vitality.description",baseCost:10,tier:1,type:"stat",maxLevel:5},fortune:{nameKey:"upgrades.fortune.name",descriptionKey:"upgrades.fortune.description",baseCost:12,tier:1,type:"economic",maxLevel:3},wisdom:{nameKey:"upgrades.wisdom.name",descriptionKey:"upgrades.wisdom.description",baseCost:15,tier:1,type:"progression",maxLevel:3},strength:{nameKey:"upgrades.strength.name",descriptionKey:"upgrades.strength.description",baseCost:18,tier:1,type:"stat",maxLevel:5},resilience:{nameKey:"upgrades.resilience.name",descriptionKey:"upgrades.resilience.description",baseCost:16,tier:1,type:"stat",maxLevel:4},swiftness:{nameKey:"upgrades.swiftness.name",descriptionKey:"upgrades.swiftness.description",baseCost:25,tier:2,type:"stat",maxLevel:3},merchantsFavor:{nameKey:"upgrades.merchantsFavor.name",descriptionKey:"upgrades.merchantsFavor.description",baseCost:30,tier:2,type:"economic",maxLevel:3},battleMastery:{nameKey:"upgrades.battleMastery.name",descriptionKey:"upgrades.battleMastery.description",baseCost:35,tier:2,type:"combat",maxLevel:4},treasureHunter:{nameKey:"upgrades.treasureHunter.name",descriptionKey:"upgrades.treasureHunter.description",baseCost:40,tier:2,type:"economic",maxLevel:3},mysticism:{nameKey:"upgrades.mysticism.name",descriptionKey:"upgrades.mysticism.description",baseCost:45,tier:2,type:"magic",maxLevel:3},regeneration:{nameKey:"upgrades.regeneration.name",descriptionKey:"upgrades.regeneration.description",baseCost:38,tier:2,type:"survival",maxLevel:4},floorMaster:{nameKey:"upgrades.floorMaster.name",descriptionKey:"upgrades.floorMaster.description",baseCost:60,tier:3,type:"progression",maxLevel:1},soulReaper:{nameKey:"upgrades.soulReaper.name",descriptionKey:"upgrades.soulReaper.description",baseCost:80,tier:3,type:"meta",maxLevel:3},criticalStrike:{nameKey:"upgrades.criticalStrike.name",descriptionKey:"upgrades.criticalStrike.description",baseCost:70,tier:3,type:"combat",maxLevel:4},resourceMastery:{nameKey:"upgrades.resourceMastery.name",descriptionKey:"upgrades.resourceMastery.description",baseCost:75,tier:3,type:"resource",maxLevel:3},goldRush:{nameKey:"upgrades.goldRush.name",descriptionKey:"upgrades.goldRush.description",baseCost:65,tier:3,type:"economic",maxLevel:2},titanicHealth:{nameKey:"upgrades.titanicHealth.name",descriptionKey:"upgrades.titanicHealth.description",baseCost:85,tier:3,type:"stat",maxLevel:2},legendaryLuck:{nameKey:"upgrades.legendaryLuck.name",descriptionKey:"upgrades.legendaryLuck.description",baseCost:120,tier:4,type:"rare",maxLevel:2},transcendence:{nameKey:"upgrades.transcendence.name",descriptionKey:"upgrades.transcendence.description",baseCost:200,tier:4,type:"ultimate",maxLevel:1},soulSiphon:{nameKey:"upgrades.soulSiphon.name",descriptionKey:"upgrades.soulSiphon.description",baseCost:150,tier:4,type:"meta",maxLevel:2},divineBlessing:{nameKey:"upgrades.divineBlessing.name",descriptionKey:"upgrades.divineBlessing.description",baseCost:180,tier:4,type:"ultimate",maxLevel:1},omnipotence:{nameKey:"upgrades.omnipotence.name",descriptionKey:"upgrades.omnipotence.description",baseCost:500,tier:5,type:"godlike",maxLevel:1,rarity:"mythical"},immortality:{nameKey:"upgrades.immortality.name",descriptionKey:"upgrades.immortality.description",baseCost:400,tier:5,type:"godlike",maxLevel:1,rarity:"mythical"},timeManipulation:{nameKey:"upgrades.timeManipulation.name",descriptionKey:"upgrades.timeManipulation.description",baseCost:600,tier:5,type:"godlike",maxLevel:1,rarity:"mythical"}},n={warrior:{shieldMastery:{nameKey:"upgrades.shieldMastery.name",descriptionKey:"upgrades.shieldMastery.description",cost:45,tier:2,type:"class"},armorExpert:{nameKey:"upgrades.armorExpert.name",descriptionKey:"upgrades.armorExpert.description",cost:80,tier:3,type:"class"},guardianSpirit:{nameKey:"upgrades.guardianSpirit.name",descriptionKey:"upgrades.guardianSpirit.description",cost:130,tier:4,type:"class"}},sorceress:{manaFlow:{nameKey:"upgrades.manaFlow.name",descriptionKey:"upgrades.manaFlow.description",cost:45,tier:2,type:"class"},elementalMastery:{nameKey:"upgrades.elementalMastery.name",descriptionKey:"upgrades.elementalMastery.description",cost:80,tier:3,type:"class"},arcaneTranscendence:{nameKey:"upgrades.arcaneTranscendence.name",descriptionKey:"upgrades.arcaneTranscendence.description",cost:130,tier:4,type:"class"}},rogue:{poisonMastery:{nameKey:"upgrades.poisonMastery.name",descriptionKey:"upgrades.poisonMastery.description",cost:45,tier:2,type:"class"},shadowStep:{nameKey:"upgrades.shadowStep.name",descriptionKey:"upgrades.shadowStep.description",cost:80,tier:3,type:"class"},deathFromShadows:{nameKey:"upgrades.deathFromShadows.name",descriptionKey:"upgrades.deathFromShadows.description",cost:130,tier:4,type:"class"}}},a={...r};n[e]&&Object.assign(a,n[e]);const i=Math.min(4,Math.ceil(t/3)),o={};return Object.keys(a).forEach(u=>{const c=a[u];c.tier<=i&&(o[u]={...c,cost:c.cost||c.baseCost||10})}),o},applyPermanentUpgrades(){const e=this.current.soulUpgrades;let t={hpMultiplier:1,startingGoldMultiplier:1,xpMultiplier:1};return e.vitality&&(t.hpMultiplier=1.2),e.fortune&&(t.startingGoldMultiplier=1.5),e.wisdom&&(t.xpMultiplier=1.25),t},saveSoulData(){try{const e={totalSouls:this.current.totalSouls,soulUpgrades:this.current.soulUpgrades,characterSouls:this.current.characterSouls,characterUpgrades:this.current.characterUpgrades};localStorage.setItem("pathOfHeroes_souls",JSON.stringify(e))}catch(e){de.log(`Failed to save soul data: ${e}`,"ERROR")}},loadSoulData(){try{const e=localStorage.getItem("pathOfHeroes_souls");if(e){const t=JSON.parse(e);this.current.totalSouls=t.totalSouls||0,this.current.soulUpgrades=t.soulUpgrades||{},this.current.characterSouls=t.characterSouls||{},this.current.characterUpgrades=t.characterUpgrades||{},de.log(`Loaded soul data: ${this.current.totalSouls} souls`,"SYSTEM")}}catch(e){de.log(`Failed to load soul data: ${e}`,"ERROR")}},nextFloor(){const e=this.calculateFloorReward();if(this.addGold(e.gold),this.awardSouls(e.souls,`Completing floor ${this.current.currentFloor}`),this.current.currentFloor+=1,this.current.player){const t=Math.floor(this.current.player.maxStats.hp*.25);this.current.player.stats.hp=Math.min(this.current.player.maxStats.hp,this.current.player.stats.hp+t)}return de.log(`Advanced to floor ${this.current.currentFloor}. Rewards: ${e.gold} gold, ${e.souls} souls`,"SYSTEM"),this._notify(),e},calculateFloorReward(){const e=5+this.current.currentFloor*2,t=5+Math.floor(this.current.currentFloor/2);return{gold:e,souls:t,reason:`Floor ${this.current.currentFloor} completion bonus`}},checkBossDefeat(){const e=this.current.dungeon;if(!e)return!1;for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++){const n=e[t][r];if(n.type==="boss"&&n.completed)return!0}return!1},resetForNewFloor(){this.current.dungeon=null,this.current.playerPos=null,this.current.battleInProgress=!1,this.current.enemies=[],this.current.turnOrder=[],this.current.currentTurnIndex=0,this.current.currentScreen="exploration",de.log(`Reset game state for floor ${this.current.currentFloor}`,"SYSTEM"),this._notify()},saveGame(e,t){try{const r=`pathOfHeroes_save_${e}_slot${t}`,n={characterId:e,currentFloor:this.current.currentFloor,gold:this.current.gold,experience:this.current.experience,level:this.current.level,inventory:this.current.inventory,equipped:this.current.equipped,player:this.current.player,currentRunSouls:this.current.currentRunSouls,timestamp:Date.now(),gameVersion:"1.0.0",currentSaveSlot:t};return localStorage.setItem(r,JSON.stringify(n)),de.log(`Game saved for ${e} in slot ${t}`,"SYSTEM"),!0}catch(r){return de.log(`Failed to save game: ${r}`,"ERROR"),!1}},loadGame(e,t){try{const r=`pathOfHeroes_save_${e}_slot${t}`,n=localStorage.getItem(r);if(!n)return de.log(`No save found for ${e} slot ${t}`,"SYSTEM"),!1;const a=JSON.parse(n);return this.current.gameStarted=!0,this.current.selectedCharacter=a.characterId,this.current.currentFloor=a.currentFloor,this.current.gold=a.gold,this.current.experience=a.experience,this.current.level=a.level,this.current.inventory=a.inventory||[],this.current.equipped=a.equipped||{},this.current.player=a.player,this.current.currentRunSouls=a.currentRunSouls||0,this.current.currentSaveSlot=a.currentSaveSlot||t,this.current.currentScreen="exploration",de.log(`Game loaded for ${e} from slot ${t}`,"SYSTEM"),this._notify(),!0}catch(r){return de.log(`Failed to load game: ${r}`,"ERROR"),!1}},getSaveSlotInfo(e,t){try{const r=`pathOfHeroes_save_${e}_slot${t}`,n=localStorage.getItem(r);if(!n)return null;const a=JSON.parse(n);return{exists:!0,level:a.level,floor:a.currentFloor,gold:a.gold,timestamp:a.timestamp,characterId:a.characterId}}catch(r){return de.log(`Failed to get save slot info: ${r}`,"ERROR"),null}},deleteSave(e,t){try{const r=`pathOfHeroes_save_${e}_slot${t}`;return localStorage.removeItem(r),de.log(`Deleted save for ${e} slot ${t}`,"SYSTEM"),!0}catch(r){return de.log(`Failed to delete save: ${r}`,"ERROR"),!1}}};de.log("state.js: Module loaded.","SYSTEM");const Z3={SYSTEM:"text-common",STATE:"text-epic",UI:"text-mana-light",INPUT:"text-rare",COMBAT:"text-health-mid",LOGGER:"text-legendary",ERROR:"text-health-full font-bold"};function la(){const[e,t]=_.useState([]),[r,n]=_.useState(!1);return _.useEffect(()=>de.subscribe(i=>{setTimeout(()=>t(i),0)}),[]),r?b.jsxs("div",{className:"fixed bottom-0 left-0 right-0 h-1/3 bg-rpg-bg-darkest/80 backdrop-blur-sm border-t-2 border-rpg-primary z-[9999] flex flex-col text-sm font-mono",children:[b.jsxs("div",{className:"flex justify-between items-center bg-rpg-bg-darker p-2 border-b border-rpg-secondary",children:[b.jsx("h3",{className:"font-bold text-rpg-primary",children:"Persistent Debugger"}),b.jsx("button",{onClick:()=>n(!1),className:"bg-health-full hover:bg-health-mid text-rpg-text px-2 py-1 rounded",children:"Hide"})]}),b.jsx("ul",{className:"flex-grow overflow-y-auto p-2",children:e.map(a=>b.jsxs("li",{className:"border-b border-rpg-secondary py-1",children:[b.jsx("span",{className:"text-rpg-text opacity-60",children:a.timestamp}),b.jsxs("span",{className:`ml-2 font-semibold ${Z3[a.source]||"text-rpg-text"}`,children:["[",a.source,"]"]}),b.jsx("span",{className:"ml-2 text-rpg-text opacity-90",children:a.message})]},a.id))})]}):b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:()=>n(!0),className:"fixed top-4 right-4 bg-rpg-bg-darker hover:bg-rpg-secondary text-rpg-text w-8 h-8 rounded-full shadow-lg z-[9999] flex items-center justify-center text-lg",title:"Show Debugger",children:"🐛"}),b.jsx("button",{onClick:()=>U.update("currentScreen","analytics"),className:"fixed top-4 right-14 bg-rpg-bg-darker hover:bg-rpg-secondary text-rpg-text w-8 h-8 rounded-full shadow-lg z-[9999] flex items-center justify-center text-lg",title:"Analytics",children:"📊"})]})}const Rg={goblin:{id:"goblin",nameKey:"enemies.goblin",baseStats:{hp:48,atk:10,def:3,spd:6,crit:5},goldReward:{min:2,max:5},xpReward:20,abilities:[],icon:"👹",types:["physical","fast"]},slime:{id:"slime",nameKey:"enemies.slime",baseStats:{hp:54,atk:9,def:8,spd:3,crit:3},goldReward:{min:3,max:6},xpReward:25,abilities:[],icon:"🟢",types:["magical","brute"]},orcBrute:{id:"orcBrute",nameKey:"enemies.orcBrute",baseStats:{hp:72,atk:14,def:5,spd:5,crit:8},goldReward:{min:5,max:10},xpReward:35,abilities:[],icon:"🗡️",types:["brute","physical"]},orcWarlord:{id:"orcWarlord",nameKey:"enemies.orcWarlord",baseStats:{hp:144,atk:23,def:10,spd:10,crit:12},goldReward:{min:8,max:15},xpReward:100,abilities:["intimidate"],icon:"👑",isBoss:!0,types:["elite","brute","physical"]},skeleton:{id:"skeleton",nameKey:"enemies.skeleton",baseStats:{hp:48,atk:18,def:12,spd:6,crit:15},goldReward:{min:3,max:5},xpReward:30,abilities:["bone_throw"],icon:"💀",types:["undead","physical"]},ghoul:{id:"ghoul",nameKey:"enemies.ghoul",baseStats:{hp:72,atk:20,def:8,spd:14,crit:10},goldReward:{min:3,max:6},xpReward:35,abilities:["life_drain"],icon:"🧟",types:["undead","fast"]},wraith:{id:"wraith",nameKey:"enemies.wraith",baseStats:{hp:54,atk:25,def:5,spd:18,crit:25},goldReward:{min:4,max:7},xpReward:45,abilities:["phase","wail"],icon:"👻",types:["undead","magical","fast"]},graveGolem:{id:"graveGolem",nameKey:"enemies.graveGolem",baseStats:{hp:240,atk:31,def:20,spd:5,crit:5},goldReward:{min:10,max:18},xpReward:200,abilities:["slam","regenerate"],icon:"🏗️",isBoss:!0,types:["elite","brute","undead"]},demonicImp:{id:"demonicImp",nameKey:"enemies.imp",baseStats:{hp:66,atk:30,def:10,spd:20,crit:18},goldReward:{min:4,max:8},xpReward:55,abilities:["fireball","teleport"],icon:"👺",types:["magical","fast"]},cultist:{id:"cultist",nameKey:"enemies.cultist",baseStats:{hp:84,atk:28,def:15,spd:12,crit:15},goldReward:{min:5,max:9},xpReward:60,abilities:["dark_ritual","curse"],icon:"🔮",types:["magical","elite"]},cryptLord:{id:"cryptLord",nameKey:"enemies.cryptLord",baseStats:{hp:360,atk:44,def:25,spd:12,crit:20},goldReward:{min:15,max:25},xpReward:500,abilities:["death_ray","summon_minions","unholy_aura"],icon:"☠️",isBoss:!0,types:["elite","magical","undead"]}},$o=e=>e<=10?["goblin","slime","orcBrute"]:e<=20?["skeleton","ghoul","wraith"]:["demonicImp","cultist"],J3=e=>e===10?"orcWarlord":e===20?"graveGolem":e===30?"cryptLord":null,MS={PREFERRED_TYPE_WEIGHT:2,NEUTRAL_TYPE_WEIGHT:1};class eD{constructor(){this.currentCharacterId=null,this.characterConfig=null}initialize(t){const r=t.toUpperCase();return this.characterConfig=Xo[r],this.characterConfig?(this.currentCharacterId=t,de.log(`CharacterService: Initialized for ${t}`,"SYSTEM"),!0):(de.log(`CharacterService: Invalid character ID: ${t}`,"ERROR"),!1)}getPreferredEnemyTypes(){return this.characterConfig?this.characterConfig.preferredEnemyTypes||[]:(de.log("CharacterService: Not initialized","ERROR"),[])}isPreferredEnemy(t){if(!t.types||!this.characterConfig)return!1;const r=this.getPreferredEnemyTypes();return t.types.some(n=>r.includes(n))}calculateEnemyWeight(t){return this.isPreferredEnemy(t)?MS.PREFERRED_TYPE_WEIGHT:MS.NEUTRAL_TYPE_WEIGHT}generateEnemyPool(t){const r=$o(t),n=[];return r.forEach(a=>{const i=Rg[a];if(!i)return;const o=this.calculateEnemyWeight(i),u=Math.floor(o*10);for(let c=0;c<u;c++)n.push(a)}),n}selectFromPool(t){if(t.length===0)return de.log("CharacterService: Empty pool, using fallback","ERROR"),"goblin";const r=Math.floor(Math.random()*t.length);return t[r]}generateEncounter(t,r=1){if(!this.characterConfig){de.log("CharacterService: Not initialized, using default encounters","ERROR");const i=$o(t);return Array(r).fill(i[0])}const n=this.generateEnemyPool(t),a=[];for(let i=0;i<r;i++){const o=this.selectFromPool(n);a.push(o)}return a}getEncounterStats(t,r=100){if(!this.characterConfig)return{error:"Service not initialized"};const n={floor:t,character:this.currentCharacterId,preferredTypes:this.getPreferredEnemyTypes(),enemyCounts:{},totalPreferred:0,totalNeutral:0};for(let a=0;a<r;a++){const o=this.generateEncounter(t,1)[0];n.enemyCounts[o]=(n.enemyCounts[o]||0)+1,this.isPreferredEnemy(Rg[o])?n.totalPreferred++:n.totalNeutral++}return n.preferredPercentage=Math.round(n.totalPreferred/r*100),n}getBossScalingModifier(){return this.characterConfig&&this.characterConfig.bossScalingModifier||1}getUniqueRewardTypes(){return this.characterConfig?this.characterConfig.uniqueRewards||[]:[]}getProgressionPath(){return this.characterConfig&&this.characterConfig.progressionPath||"default"}reset(){this.currentCharacterId=null,this.characterConfig=null,de.log("CharacterService: Reset","SYSTEM")}}const As=new eD;de.log("character-service.js: Module loaded.","SYSTEM");const Ye={EMPTY:"empty",WALL:"wall",BATTLE:"battle",ELITE:"elite",SHOP:"shop",CAMPFIRE:"campfire",SHRINE:"shrine",TREASURE:"treasure",BOSS:"boss",STAIRS:"stairs"},tD={[Ye.EMPTY]:"",[Ye.WALL]:"🧱",[Ye.BATTLE]:"⚔️",[Ye.ELITE]:"💀",[Ye.SHOP]:"🏪",[Ye.CAMPFIRE]:"🔥",[Ye.SHRINE]:"⛩️",[Ye.TREASURE]:"💎",[Ye.BOSS]:"👹",[Ye.STAIRS]:"🔄"},js=5,Ls=9;function No(e,t){const r=Rg[e];if(!r)return de.log(`Enemy ID not found: ${e}`,"ERROR"),null;const n=JSON.parse(JSON.stringify(r)),a=U.current.level||1;let i;t<=2?i=Math.max(1,a-1):t<=4?i=a:t<=7?i=Math.max(1,a+Math.floor(Math.random()*2)):i=Math.max(1,a+Math.floor(Math.random()*3)-1),n.isBoss&&(i=Math.max(a+1,i)),n.level=i;const o=i-1,u=1+o*.12;n.baseStats.hp=Math.ceil(n.baseStats.hp*u),n.baseStats.atk=Math.ceil(n.baseStats.atk*u),n.baseStats.def=Math.ceil(n.baseStats.def*u),n.baseStats.spd=Math.ceil(n.baseStats.spd*(1+o*.08)),n.baseStats.crit&&(n.baseStats.crit=Math.min(30,n.baseStats.crit+o*1.5)),n.isBoss||(n.baseStats.atk=Math.ceil(n.baseStats.atk*.95)),n.stats={...n.baseStats},n.maxStats={...n.baseStats};const c=1+(i-1)*.08;return n.goldReward.min=Math.ceil(n.goldReward.min*c),n.goldReward.max=Math.ceil(n.goldReward.max*c),n.xpReward=Math.ceil(n.xpReward*c),de.log(`Generated Lv.${i} ${n.nameKey} (Player Lv.${a}, Floor ${t})`,"SYSTEM"),n}function rD(e,t){return e>=0&&e<js&&t>=0&&t<Ls}function nD(e,t){return[{x:e-2,y:t},{x:e+2,y:t},{x:e,y:t-2},{x:e,y:t+2}].filter(r=>rD(r.x,r.y))}function aD(){const e=Array(Ls).fill(null).map(()=>Array(js).fill(null).map(()=>({type:Ye.WALL,isPath:!1}))),t=Math.floor(js/2),r=Ls-2;e[r][t]={type:Ye.EMPTY,isPath:!0};const n=[{x:t,y:r}],a=new Set;for(a.add(`${t},${r}`);n.length>0;){const i=n[n.length-1],o=nD(i.x,i.y).filter(u=>!a.has(`${u.x},${u.y}`));if(o.length>0){const u=o[Math.floor(Math.random()*o.length)],c=(i.x+u.x)/2,f=(i.y+u.y)/2;e[u.y][u.x]={type:Ye.EMPTY,isPath:!0},e[f][c]={type:Ye.EMPTY,isPath:!0},a.add(`${u.x},${u.y}`),n.push(u)}else n.pop()}return{maze:e,startX:t,startY:r}}function Ig(){const{maze:e,startX:t,startY:r}=aD(),n=Array(Ls).fill(null).map((p,m)=>Array(js).fill(null).map((v,x)=>({type:e[m][x].type,revealed:!0,visited:!1,completed:!1,encounter:null,isPath:e[m][x].isPath||!1}))),a={x:t,y:r};n[a.y][a.x].revealed=!0,n[a.y][a.x].visited=!0,n[a.y][a.x].completed=!0;const i=[];for(let p=0;p<Ls;p++)for(let m=0;m<js;m++)n[p][m].isPath&&!(m===a.x&&p===a.y)&&i.push({x:m,y:p});for(let p=i.length-1;p>0;p--){const m=Math.floor(Math.random()*(p+1));[i[p],i[m]]=[i[m],i[p]]}let o=0;const u=U.current.currentFloor;let c=0,f=null;i.forEach(p=>{const m=Math.abs(p.x-a.x)+Math.abs(p.y-a.y);m>c&&(c=m,f=p)}),f&&(n[f.y][f.x].type=Ye.BOSS,i.splice(i.findIndex(p=>p.x===f.x&&p.y===f.y),1)),[{type:Ye.SHOP,count:1},{type:Ye.SHRINE,count:2},{type:Ye.TREASURE,count:3},{type:Ye.ELITE,count:2}].forEach(({type:p,count:m})=>{for(let v=0;v<m&&o<i.length;v++)n[i[o].y][i[o].x].type=p,o++});for(let p=o;p<i.length;p++)n[i[p].y][i[p].x].type=Ye.BATTLE;return iD(n,u),U.current.dungeon=n,U.current.playerPos={...a},U._notify(),de.log(`Generated visible dungeon for floor ${u} with ${i.length+1} rooms. Path fully revealed for strategic planning.`,"SYSTEM"),n}function iD(e,t){const r=J3(t),n=U.current.selectedCharacter&&As.currentCharacterId;for(let a=0;a<Ls;a++)for(let i=0;i<js;i++){const o=e[a][i];if(o.type===Ye.BATTLE){let u=[];if(n)u.push(As.generateEncounter(t,1)[0]);else{const f=$o(t),d=f[Math.floor(Math.random()*f.length)];u.push(d)}o.encounter=[No(u[0],t)];const c=Math.min(.6,.3+(t-1)*.1);if(Math.random()<c){let f;if(n)f=As.generateEncounter(t,1)[0];else{const d=$o(t);f=d[Math.floor(Math.random()*d.length)]}if(o.encounter.push(No(f,t)),t>=5&&Math.random()<.2){let d;if(n)d=As.generateEncounter(t,1)[0];else{const p=$o(t);d=p[Math.floor(Math.random()*p.length)]}o.encounter.push(No(d,t))}}}else if(o.type===Ye.ELITE){let u;if(n)u=As.generateEncounter(t,1)[0];else{const d=$o(t);u=d[Math.floor(Math.random()*d.length)]}const c=No(u,t),f=1.5+(t-1)*.1;if(c.baseStats.hp=Math.floor(c.baseStats.hp*f),c.baseStats.atk=Math.floor(c.baseStats.atk*f),c.baseStats.def=Math.floor(c.baseStats.def*f),c.stats={...c.baseStats},c.maxStats={...c.baseStats},c.prefixKey="prefixes.elite",o.encounter=[c],t>=3&&Math.random()<.4){const d=availableEnemies[Math.floor(Math.random()*availableEnemies.length)];o.encounter.push(No(d,t))}}else if(o.type===Ye.BOSS&&r){const u=No(r,t),c=U.current.selectedCharacter?.toUpperCase()||"WARRIOR",f=Xo[c],d=f?.bossScalingModifier||1;let p=1.8+(t-1)*.15;if(p*=d,u.baseStats.hp=Math.floor(u.baseStats.hp*p),u.baseStats.atk=Math.floor(u.baseStats.atk*p),u.baseStats.def=Math.floor(u.baseStats.def*p),u.stats={...u.baseStats},u.maxStats={...u.baseStats},t>1){const m=f?.progressionPath||"standard";u.nameKey=`${u.nameKey} - Floor ${t} ${m} Nemesis`}o.encounter=[u]}}}function sD(){const e=U.current.dungeon;if(!e)return;let t=null;for(let r=0;r<Ls;r++){for(let n=0;n<js;n++)if(e[r][n].type===Ye.BOSS){t={x:n,y:r};break}if(t)break}t&&(e[t.y][t.x].type=Ye.STAIRS,e[t.y][t.x].encounter=null,e[t.y][t.x].completed=!0,U._notify(),de.log("Stairs to next floor have appeared!","SYSTEM"))}class Bi{static initializeBattle(){U.current.battleBuffs||(U.current.battleBuffs=[]),U.current.battleBuffs=U.current.battleBuffs.filter(t=>t.duration!=="battle")}static generateBuffChoices(t=3){return Object.keys(tt.BATTLE_BUFFS).sort(()=>.5-Math.random()).slice(0,t).map(a=>({key:a,...tt.BATTLE_BUFFS[a]}))}static applyBuff(t){const r=tt.BATTLE_BUFFS[t];if(!r)return de.log(`Invalid buff: ${t}`,"ERROR"),!1;const n=U.current.player,a={key:t,...r,appliedAt:Date.now()};switch(r.effect.type){case"vampiric":break;case"resource_boost":break;case"cost_reduction":break;case"resource_save":break;case"regeneration":break;default:if(r.effect.stat&&r.effect.multiplier){const i=n.stats[r.effect.stat],o=Math.floor(i*r.effect.multiplier);n.stats[r.effect.stat]=o}else r.effect.stat&&r.effect.bonus&&(n.stats[r.effect.stat]+=r.effect.bonus)}return U.current.battleBuffs||(U.current.battleBuffs=[]),U.current.battleBuffs.push(a),de.log(`Applied buff: ${t}`,"SYSTEM"),U._notify(),!0}static processBuffEffects(t,r={}){if(!U.current.battleBuffs)return;const n=U.current.player;U.current.battleBuffs.forEach(a=>{const i=a.effect;switch(t){case"turn_start":if(i.type==="regeneration"){const o=Math.min(i.amount,n.maxStats.hp-n.stats.hp);n.stats.hp+=o,o>0&&r.onLog&&r.onLog(`${a.icon} Second Wind: Healed ${o} HP`)}break;case"damage_dealt":if(i.type==="vampiric"&&r.damage){const o=Math.floor(r.damage*(i.percentage/100)),u=Math.min(o,n.maxStats.hp-n.stats.hp);n.stats.hp+=u,u>0&&r.onLog&&r.onLog(`${a.icon} Vampiric: Healed ${u} HP`)}break;case"ability_used":if(i.type==="resource_save"&&r.cost){const o=Math.random(),u=i.chance/100;if(de.log(`[BUFF] Lucky Strikes roll: ${(o*100).toFixed(1)}% (need < ${i.chance}%)`,"SYSTEM"),o<u){const c=n.resource.current;n.resource.current+=r.cost;const f=n.resource.current;return de.log(`[BUFF] Lucky Strikes triggered! Resource refunded: ${c} → ${f} (+${r.cost})`,"SYSTEM"),r.onLog&&r.onLog(`${a.icon} Lucky Strike: Resource saved! (+${r.cost})`),{resourceSaved:!0}}else de.log("[BUFF] Lucky Strikes did not trigger","SYSTEM")}break}}),U._notify()}static getModifiedAbilityCost(t){if(!U.current.battleBuffs)return t;let r=t;return U.current.battleBuffs.forEach(n=>{if(n.effect.type==="cost_reduction"){const a=n.effect.percentage/100;r=Math.floor(r*(1-a))}}),Math.max(1,r)}static getModifiedResourceRegen(t){if(!U.current.battleBuffs)return t;let r=t;return U.current.battleBuffs.forEach(n=>{n.effect.type==="resource_boost"&&(r=Math.floor(r*n.effect.multiplier))}),r}static getActiveBuffs(){return U.current.battleBuffs||[]}static clearBattleBuffs(){U.current.battleBuffs=U.current.battleBuffs?.filter(t=>t.duration!=="battle")||[],U._notify()}}const RS={PHYSICAL:{id:"physical",name:{en:"Physical",ar:"جسدي"},icon:"⚔️",color:"#aaaaaa"},FIRE:{id:"fire",name:{en:"Fire",ar:"نار"},icon:"🔥",color:"#ff4444"},ICE:{id:"ice",name:{en:"Ice",ar:"جليد"},icon:"❄️",color:"#44ccff"},LIGHTNING:{id:"lightning",name:{en:"Lightning",ar:"برق"},icon:"⚡",color:"#ffdd44"},POISON:{id:"poison",name:{en:"Poison",ar:"سم"},icon:"☠️",color:"#aa44ff"},SHADOW:{id:"shadow",name:{en:"Shadow",ar:"ظل"},icon:"🌑",color:"#444444"},HOLY:{id:"holy",name:{en:"Holy",ar:"مقدس"},icon:"✨",color:"#ffff88"}},oD={goblin:{weaknesses:["fire","lightning"],resistances:["physical"],baseToughness:60},slime:{weaknesses:["ice","lightning"],resistances:["poison"],baseToughness:50},orcBrute:{weaknesses:["poison","ice"],resistances:["fire"],baseToughness:80},skeleton:{weaknesses:["holy","fire"],resistances:["physical"],baseToughness:55},ghoul:{weaknesses:["fire","holy"],resistances:["poison"],baseToughness:70},wraith:{weaknesses:["holy","physical"],resistances:["shadow"],baseToughness:65},imp:{weaknesses:["ice","holy"],resistances:["fire"],baseToughness:60},cultist:{weaknesses:["physical","lightning"],resistances:["shadow"],baseToughness:55},orcWarlord:{weaknesses:["ice","lightning"],resistances:["physical"],baseToughness:120},graveGolem:{weaknesses:["fire","lightning"],resistances:["physical"],baseToughness:100},cryptLord:{weaknesses:["holy","fire"],resistances:["shadow"],baseToughness:150}},lD={power_strike:"physical",shield_bash:"physical",whirlwind_attack:"physical",execute:"physical",last_stand:"fire",iron_will:"holy",magic_missile:"lightning",fireball:"fire",ice_shard:"ice",lightning_bolt:"lightning",meteor:"fire",quick_strike:"physical",venom_strike:"poison",shadow_step:"shadow",fan_of_knives:"poison",backstab:"shadow",death_mark:"shadow",basic_attack:"physical"},IS={physical:{name:{en:"Physical Break",ar:"كسر جسدي"},damage:25,effect:"instant",description:{en:"25 instant damage",ar:"25 ضرر فوري"}},fire:{name:{en:"Fire Break",ar:"كسر ناري"},damage:30,effect:"burn",duration:2,description:{en:"30 burn damage over 2 turns",ar:"30 ضرر حرق على مدى دورتين"}},ice:{name:{en:"Ice Break",ar:"كسر جليدي"},damage:20,effect:"freeze",description:{en:"Freeze + 20 damage",ar:"تجميد + 20 ضرر"}},lightning:{name:{en:"Lightning Break",ar:"كسر برقي"},damage:40,effect:"instant",description:{en:"40 instant damage",ar:"40 ضرر فوري"}},poison:{name:{en:"Poison Break",ar:"كسر سام"},damage:15,effect:"poison",duration:3,description:{en:"15 damage per turn for 3 turns",ar:"15 ضرر لكل دور لمدة 3 أدوار"}},shadow:{name:{en:"Shadow Break",ar:"كسر ظلي"},damage:0,effect:"defense_down",duration:2,debuff:.7,description:{en:"-30% DEF for 2 turns",ar:"-30% دفاع لمدة دورتين"}},holy:{name:{en:"Holy Break",ar:"كسر مقدس"},damage:35,effect:"instant",description:{en:"35 instant damage + cleanse",ar:"35 ضرر فوري + تطهير"}}};function uD(e){return Object.values(RS).find(t=>t.id===e)||RS.PHYSICAL}function cD(e){return oD[e]||{weaknesses:[],resistances:[],baseToughness:60}}function fD(e){return lD[e]||"physical"}function dD(e,t,r){return t.includes(e)?1.5:r.includes(e)?.75:1}function hD(e,t,r){return t.includes(e)?20:r.includes(e)?2:5}class cu{static initializeEnemyBreakData(t,r=1){const n=t.type||"goblin",a=cD(n),i=a.baseToughness||60,o=(r-1)*10,u=i+o;return t.breakData={maxToughness:u,currentToughness:u,weaknesses:a.weaknesses||[],resistances:a.resistances||[],isBroken:!1,brokenTurnsRemaining:0,breakEffects:[]},de.log(`Enemy ${t.type} initialized with toughness: ${u}, weaknesses: ${t.breakData.weaknesses.join(", ")}`,"COMBAT"),t}static dealToughnessDamage(t,r,n){t.breakData||this.initializeEnemyBreakData(t,U.current.currentFloor);const a=t.breakData;if(a.isBroken)return{broken:!1,toughnessDamage:0};const i=hD(r,a.weaknesses,a.resistances),o=a.currentToughness;return a.currentToughness=Math.max(0,a.currentToughness-i),de.log(`Toughness damage: ${i} (${o} → ${a.currentToughness})`,"COMBAT"),a.currentToughness===0&&o>0?this.breakEnemy(t,r,n):{broken:!1,toughnessDamage:i}}static breakEnemy(t,r,n){const a=t.breakData;a.isBroken=!0,a.brokenTurnsRemaining=1;const i=IS[r]||IS.physical,o=t.nameKey||t.type;let u=i.damage||0;return i.effect==="instant"?(t.stats.hp=Math.max(0,t.stats.hp-u),n&&n(`⚠️ ${o.toUpperCase()} BROKEN! 💥 ${i.name.en}: ${u} damage!`),de.log(`Break: ${o} broken by ${r}! Instant damage: ${u}`,"COMBAT")):i.effect==="burn"||i.effect==="poison"?(t.statusEffects=t.statusEffects||[],t.statusEffects.push({type:i.effect,damage:Math.floor(i.damage/i.duration),duration:i.duration,icon:i.effect==="burn"?"🔥":"☠️"}),n&&n(`⚠️ ${o.toUpperCase()} BROKEN! 💥 ${i.name.en}: ${i.description.en}!`),de.log(`Break: ${o} broken by ${r}! ${i.effect} applied`,"COMBAT")):i.effect==="freeze"?(t.stats.hp=Math.max(0,t.stats.hp-u),a.brokenTurnsRemaining=2,n&&n(`⚠️ ${o.toUpperCase()} BROKEN! ❄️ Frozen solid! ${u} damage!`),de.log(`Break: ${o} frozen! Stunned for 2 turns`,"COMBAT")):i.effect==="defense_down"&&(t.statusEffects=t.statusEffects||[],t.statusEffects.push({type:"defense_down",amount:i.debuff,duration:i.duration,icon:"🛡️💔"}),n&&n(`⚠️ ${o.toUpperCase()} BROKEN! 🌑 ${i.description.en}!`),de.log(`Break: ${o} defense reduced by ${i.debuff}`,"COMBAT")),n&&n("💥 Enemy STUNNED! Takes 50% bonus damage this turn!"),{broken:!0,toughnessDamage:t.breakData.maxToughness,breakElement:r,breakEffect:i}}static recoverFromBreak(t,r){if(!(!t.breakData||!t.breakData.isBroken)&&(t.breakData.brokenTurnsRemaining--,t.breakData.brokenTurnsRemaining<=0)){t.breakData.isBroken=!1,t.breakData.brokenTurnsRemaining=0,t.breakData.currentToughness=Math.floor(t.breakData.maxToughness*.5);const n=t.nameKey||t.type;r&&r(`🔄 ${n} recovered from break! Toughness restored to ${t.breakData.currentToughness}`),de.log(`${n} recovered from break`,"COMBAT")}}static isBroken(t){return t.breakData&&t.breakData.isBroken}static getBrokenMultiplier(t){return this.isBroken(t)?1.5:1}static processBreakEffects(t,r){t.breakData&&t.breakData.isBroken&&this.recoverFromBreak(t,r)}static shouldSkipTurn(t){return t.breakData&&t.breakData.isBroken&&t.breakData.brokenTurnsRemaining>0}}class bs{static initializeUltimateGauge(){U.current.player.ultimate||(U.current.player.ultimate={current:0,max:100,ready:!1},de.log("Ultimate gauge initialized","COMBAT"))}static addUltimatePoints(t,r,n){this.initializeUltimateGauge();const a=U.current.player.ultimate,i=a.current;a.current=Math.min(a.max,a.current+t),a.ready=a.current>=a.max,n&&t>0&&n(`⚡ +${t} Ultimate! (${i} → ${a.current}/${a.max})`),de.log(`Ultimate: +${t} from ${r} (${i} → ${a.current})`,"COMBAT"),a.ready&&i<a.max&&(n&&n("💥 ULTIMATE READY! 💥"),de.log("Ultimate gauge READY!","COMBAT")),U._notify()}static useUltimate(t,r,n,a){this.initializeUltimateGauge();const i=U.current.player.ultimate;if(!i.ready||i.current<i.max)return a&&a("❌ Ultimate not ready!"),!1;const o=this.getUltimateAbility(t);return o?(this.executeUltimate(o,r,n,a),i.current=0,i.ready=!1,U._notify(),!0):(de.log(`No ultimate ability found for character: ${t}`,"ERROR"),!1)}static getUltimateAbility(t){return{warrior:{id:"titans_wrath",name:{en:"Titan's Wrath",ar:"غضب الجبار"},description:{en:"Deal 300% damage to all enemies + heal 30% max HP",ar:"اصنع 300% ضرر لجميع الأعداء + استعادة 30% من الصحة القصوى"},element:"fire",damageMultiplier:3,targetAll:!0,selfHeal:.3,icon:"🔥⚔️"},sorceress:{id:"elemental_cataclysm",name:{en:"Elemental Cataclysm",ar:"كارثة عنصرية"},description:{en:"Deal 250% damage to all enemies, hits ALL weaknesses",ar:"اصنع 250% ضرر لجميع الأعداء، يصيب كل نقاط الضعف"},element:"multi",damageMultiplier:2.5,targetAll:!0,hitsAllWeaknesses:!0,icon:"⚡❄️🔥"},rogue:{id:"shadow_assassination",name:{en:"Shadow Assassination",ar:"اغتيال الظل"},description:{en:"Deal 500% damage to single target + Death Mark (50% bonus damage for 2 turns)",ar:"اصنع 500% ضرر لهدف واحد + علامة الموت (50% ضرر إضافي لمدة دورتين)"},element:"shadow",damageMultiplier:5,targetAll:!1,deathMark:!0,icon:"🌑💀"}}[t]||null}static executeUltimate(t,r,n,a){const i=U.current.player,o=typeof t.name=="string"?t.name:t.name.en;if(a&&(a("═══════════════════════════════"),a(`💥💥💥 ${o.toUpperCase()}! 💥💥💥`),a("═══════════════════════════════")),de.log(`ULTIMATE: ${o} activated!`,"COMBAT"),(t.targetAll?U.current.enemies.filter(c=>c.isAlive):[r[0]]).forEach(c=>{if(!c||!c.isAlive)return;let f=n.calculateDamage(i,c,t.damageMultiplier);c.stats.hp=Math.max(0,c.stats.hp-f);const d=c.level?`Lv.${c.level} ${c.nameKey?ee(c.nameKey):"Enemy"}`:c.nameKey?ee(c.nameKey):"Enemy";if(a&&a(`${t.icon} ${d} takes ${f} damage!`),t.hitsAllWeaknesses&&c.breakData&&!c.breakData.isBroken){const{BreakSystem:p}=require("./break-system.js");c.breakData.currentToughness=0,p.breakEnemy(c,t.element,a)}t.deathMark&&(c.statusEffects=c.statusEffects||[],c.statusEffects.push({type:"death_mark",multiplier:1.5,duration:2,icon:"💀"}),a&&a(`💀 ${d} marked for death! (+50% damage for 2 turns)`)),c.stats.hp<=0&&n.killUnit(c)}),t.selfHeal){const c=Math.floor(i.maxStats.hp*t.selfHeal);i.stats.hp=Math.min(i.maxStats.hp,i.stats.hp+c),a&&a(`💚 Healed ${c} HP! (${i.stats.hp}/${i.maxStats.hp})`)}a&&a("═══════════════════════════════"),U._notify()}static resetUltimateGauge(){U.current.player.ultimate?(U.current.player.ultimate.current=0,U.current.player.ultimate.ready=!1,de.log("Ultimate gauge reset for new battle","COMBAT")):this.initializeUltimateGauge()}static isUltimateReady(){return this.initializeUltimateGauge(),U.current.player.ultimate.ready}static getUltimatePercentage(){this.initializeUltimateGauge();const t=U.current.player.ultimate;return Math.floor(t.current/t.max*100)}static getUltimateBarColor(){const t=this.getUltimatePercentage();return t>=100?"#ffd700":t>=67?"#ffff44":t>=34?"#ff8844":"#ff4444"}}const fu={BASIC_ATTACK:10,USE_ABILITY:15,TAKE_DAMAGE:8,BREAK_ENEMY:25};class pD{constructor({forceUpdate:t}){this.updateCallback=t,this.onLog=()=>{}}startBattle(t,r={}){this.onLog=r.onLog||(()=>{}),U.update("battleInProgress",!0),U.current.player&&(U.current.player.isAlive=!0),Bi.initializeBattle(),bs.resetUltimateGauge();const n=U.current.currentFloor||1;t.forEach(o=>{cu.initializeEnemyBreakData(o,n)}),this.organizeWaves(t),this.currentWave=1,this.spawnWave(1);const a=t.length,i=ee("combat.messages.battleBegins",{enemies:`${a} enemies in ${this.totalWaves} waves`});de.log(i,"COMBAT"),this.onLog(i),this.calculateTurnOrder(),this.processTurn()}organizeWaves(t){if(this.allWaveEnemies=t,this.waves=[],t.length<=2)this.waves=[t];else if(t.length===3)this.waves=[t.slice(0,2),t.slice(2,3)];else{const r=Math.ceil(t.length/Math.ceil(t.length/2));for(let n=0;n<t.length;n+=r)this.waves.push(t.slice(n,n+r))}this.totalWaves=this.waves.length,de.log(`Combat organized into ${this.totalWaves} waves: ${this.waves.map(r=>r.length).join(", ")} enemies`,"COMBAT")}spawnWave(t){const r=this.waves[t-1];if(!r)return;U.current.enemies=r.map((a,i)=>({...a,originalIndex:i,isAlive:!0,statusEffects:[]}));const n=t===1?ee("combat.messages.waveBegins",{wave:t,total:this.totalWaves}):ee("combat.messages.waveSpawn",{wave:t,total:this.totalWaves,enemies:r.map(a=>a.level?`Lv.${a.level} ${a.nameKey?ee(a.nameKey):"Enemy"}`:a.nameKey?ee(a.nameKey):"Enemy").join(", ")});this.onLog(n),de.log(n,"COMBAT")}calculateTurnOrder(){const t={...U.current.player,id:"player"},r=U.current.enemies.map(n=>({...n,id:`enemy_${n.originalIndex}`}));U.current.turnOrder=[...r,t].sort((n,a)=>a.stats.spd-n.stats.spd).map(n=>n.id),U.current.currentTurnIndex=0,U.update("turnOrder",U.current.turnOrder)}isPlayerTurn(){return U.current.battleInProgress?U.current.turnOrder[U.current.currentTurnIndex]==="player":!1}playerAttack(t){if(!this.isPlayerTurn())return;const r=U.current.enemies.find(u=>u.originalIndex===t);if(!r||!r.isAlive)return;const n="physical";let a=this.calculateDamageWithElements(U.current.player,r,1,n);r.stats.hp=Math.max(0,r.stats.hp-a);const i=r.level?`Lv.${r.level} ${r.nameKey?ee(r.nameKey):"Enemy"}`:r.nameKey?ee(r.nameKey):"Enemy";this.onLog(ee("combat.messages.youAttack",{target:i,damage:a})),cu.dealToughnessDamage(r,n,this.onLog.bind(this)).broken&&bs.addUltimatePoints(fu.BREAK_ENEMY,"breaking enemy",this.onLog.bind(this)),Bi.processBuffEffects("damage_dealt",{damage:a,onLog:this.onLog.bind(this)}),bs.addUltimatePoints(fu.BASIC_ATTACK,"basic attack",this.onLog.bind(this)),r.stats.hp<=0&&this.killUnit(r),this.updateCallback(),this.nextTurn()}playerSkill(t){if(!this.isPlayerTurn())return;const r=U.current.player,n=r.abilities[0],a=tt.ABILITIES[n];if(!a){de.log(`Skill not found: ${n}`,"ERROR");return}const i=r.resource.current;if(!U.spendResource(a.cost)){const p=r.resource.nameKey?ee(r.resource.nameKey):"Resource",m=typeof a.name=="object"?a.name.en:a.name;this.onLog(`Not enough ${p} for ${m}.`);return}const o=r.resource.current,u=r.resource.nameKey?ee(r.resource.nameKey):"Resource",c=typeof a.name=="object"?a.name[Er.getCurrentLanguage()]||a.name.en:a.name;this.onLog(`Used ${c} (-${a.cost} ${u})`),de.log(`[COMBAT] Resource before: ${i}, after spend: ${o}, cost: ${a.cost}`,"COMBAT"),Bi.processBuffEffects("ability_used",{cost:a.cost,onLog:this.onLog.bind(this)}),this.onLog(ee("combat.messages.youUseSkill",{skill:c}));const f=fD(n);(a.target==="all"?U.current.enemies.filter(p=>p.isAlive):[U.current.enemies.find(p=>p.originalIndex===t)].filter(Boolean)).forEach(p=>{if(a.damageMultiplier){const m=this.calculateDamageWithElements(r,p,a.damageMultiplier,f);p.stats.hp=Math.max(0,p.stats.hp-m);const v=typeof a.name=="object"?a.name[Er.getCurrentLanguage()]||a.name.en:a.name,x=p.level?`Lv.${p.level} ${p.nameKey?ee(p.nameKey):"Enemy"}`:p.nameKey?ee(p.nameKey):"Enemy";this.onLog(ee("combat.messages.skillHits",{skill:v,target:x,damage:m})),cu.dealToughnessDamage(p,f,this.onLog.bind(this)).broken&&bs.addUltimatePoints(fu.BREAK_ENEMY,"breaking enemy",this.onLog.bind(this)),Bi.processBuffEffects("damage_dealt",{damage:m,onLog:this.onLog.bind(this)}),p.stats.hp<=0&&this.killUnit(p)}if(a.effect&&p.isAlive){const m=p.statusEffects.find(x=>x.type===a.effect.type);m?m.duration=a.effect.duration:p.statusEffects.push({...a.effect});const v=p.level?`Lv.${p.level} ${p.nameKey?ee(p.nameKey):"Enemy"}`:p.nameKey?ee(p.nameKey):"Enemy";this.onLog(ee("combat.messages.targetAfflicted",{target:v,effect:a.effect.type}))}}),bs.addUltimatePoints(fu.USE_ABILITY,"using ability",this.onLog.bind(this)),this.updateCallback(),this.nextTurn()}playerDefend(){this.isPlayerTurn()&&(this.onLog(ee("combat.messages.defensiveStance")),U.current.player.defending=!0,this.updateCallback(),this.nextTurn())}playerUltimate(t){if(!this.isPlayerTurn())return;const r=U.current.player.characterId,a=[U.current.enemies.find(o=>o.originalIndex===t)].filter(Boolean);bs.useUltimate(r,a,this,this.onLog.bind(this))&&(this.updateCallback(),this.nextTurn())}playerFlee(){this.isPlayerTurn()&&(Math.random()<tt.COMBAT.fleeChance?(this.onLog(ee("combat.messages.successfulEscape")),U.current.onBattleEnd(!1,null)):(this.onLog(ee("combat.messages.failedEscape")),this.updateCallback(),this.nextTurn()))}enemyAttack(t){if(cu.shouldSkipTurn(t)){const i=t.level?`Lv.${t.level} ${t.nameKey?ee(t.nameKey):"Enemy"}`:t.nameKey?ee(t.nameKey):"Enemy";this.onLog(`⚠️ ${i} is STUNNED! Turn skipped!`),this.updateCallback();return}const r=U.current.player;let n=this.calculateDamage(t,r);r.defending&&(n=Math.floor(n*.5),this.onLog(ee("combat.messages.defenseReduced"))),r.stats.hp=Math.max(0,r.stats.hp-n);const a=t.level?`Lv.${t.level} ${t.nameKey?ee(t.nameKey):"Enemy"}`:t.nameKey?ee(t.nameKey):"Enemy";this.onLog(ee("combat.messages.enemyAttacks",{enemy:a,damage:n})),bs.addUltimatePoints(fu.TAKE_DAMAGE,"taking damage",this.onLog.bind(this)),r.stats.hp<=0&&this.killUnit(r),this.updateCallback()}processTurn(){if(!U.current.battleInProgress)return;const t=this.getCurrentTurnUnit();if(!t||!t.isAlive){this.nextTurn();return}if(this.processStatusEffects(t),!t.isAlive){this.nextTurn();return}if(this.isPlayerTurn()){const r=U.current.player,n=tt.COMBAT.resourceRegeneration.baseAmount,a=(U.current.level-1)*tt.COMBAT.resourceRegeneration.levelScaling;let i=Math.floor(n+a);const o=Bi.getModifiedResourceRegen(i),u=r.resource.current;r.resource.current=Math.min(r.resource.max,r.resource.current+o);const c=r.resource.current-u,f=r.resource.nameKey?ee(r.resource.nameKey):"Resource";c>0&&(this.onLog(`[Regen] +${c} ${f} (${u} → ${r.resource.current})`),de.log(`[COMBAT] Resource regeneration: +${c} (${u} → ${r.resource.current})`,"COMBAT")),Bi.processBuffEffects("turn_start",{onLog:this.onLog.bind(this)}),this.onLog(ee("combat.messages.yourTurn")),U.current.player.defending=!1,this.updateCallback()}else setTimeout(()=>{t.isAlive&&U.current.battleInProgress&&this.enemyAttack(t),this.nextTurn()},800)}nextTurn(){if(!U.current.battleInProgress)return;const t=this.checkBattleEnd();if(t!==null){const r=t?U.current.enemies.map(n=>({gold:n.goldReward?Math.floor(Math.random()*(n.goldReward.max-n.goldReward.min+1))+n.goldReward.min:0,xp:n.xpReward||0})):null;U.current.onBattleEnd(t,r);return}U.current.currentTurnIndex=(U.current.currentTurnIndex+1)%U.current.turnOrder.length,U.update("currentTurnIndex",U.current.currentTurnIndex),U.current.turnOrder.length>0&&this.processTurn()}checkBattleEnd(){const t=U.current.enemies.every(n=>!n.isAlive),r=U.current.player.stats.hp<=0;return t?this.currentWave<this.totalWaves?(this.onLog(ee("combat.messages.waveCleared",{wave:this.currentWave,next:this.currentWave+1})),U.awardSouls(1,`Clearing wave ${this.currentWave}`),setTimeout(()=>{this.currentWave++,this.spawnWave(this.currentWave),this.calculateTurnOrder(),this.processTurn(),this.updateCallback()},1500),null):(this.onLog(ee("combat.messages.allEnemiesDefeated")),U.update("battleInProgress",!1),!0):r?(this.onLog(ee("combat.messages.youDefeated")),U.update("battleInProgress",!1),!1):null}killUnit(t){if(t.isAlive=!1,t.id==="player")this.onLog(ee("combat.messages.youDefeated"));else{const r=t.level?`Lv.${t.level} ${t.nameKey?ee(t.nameKey):"Enemy"}`:t.nameKey?ee(t.nameKey):"Enemy";this.onLog(ee("combat.messages.unitDefeated",{unit:r})),U.awardSouls(3,`Defeating ${r}`)}this.updateCallback()}processStatusEffects(t){t.statusEffects||(t.statusEffects=[]);const r=[];t.statusEffects.forEach(n=>{if(n.type==="poison"){const a=n.damage;t.stats.hp=Math.max(0,t.stats.hp-a);const i=t.nameKey?ee(t.nameKey):t.id==="player"?"Player":"Enemy";this.onLog(ee("combat.messages.poisonDamage",{unit:i,damage:a})),t.stats.hp<=0&&this.killUnit(t)}if(n.duration--,n.duration>0)r.push(n);else{const a=t.nameKey?ee(t.nameKey):t.id==="player"?"Player":"Enemy";this.onLog(ee("combat.messages.statusWoreOff",{unit:a,effect:n.type}))}}),t.statusEffects=r}getCurrentTurnUnit(){const t=U.current.turnOrder[U.current.currentTurnIndex];if(t==="player")return U.current.player;const r=parseInt(t.split("_")[1]);return U.current.enemies.find(n=>n.originalIndex===r)}instantWin(){U.current.battleInProgress&&(de.log("DEBUG: Instantly winning battle.","SYSTEM"),U.current.enemies.forEach(t=>{t.stats.hp=0,t.isAlive=!1}),this.updateCallback(),this.nextTurn())}calculateDamage(t,r,n=1){if(r.id==="player"&&U.current.godMode)return de.log("GOD MODE: Player takes 0 damage.","SYSTEM"),0;if(t.id==="player"&&U.current.godMode)return de.log("GOD MODE: Player deals 9999 damage.","SYSTEM"),9999;let a=t.stats.atk;const i=r.stats.def;let o=a*a/(a+i);o<1&&(o=1);let u=Math.floor(o*n);return Math.random()*100<t.stats.crit&&(u=Math.floor(u*tt.COMBAT.baseCritMultiplier),this.onLog(ee("combat.messages.criticalHit"))),Math.max(1,u)}calculateDamageWithElements(t,r,n=1,a="physical"){let i=this.calculateDamage(t,r,n);if(r.breakData){const u=dD(a,r.breakData.weaknesses,r.breakData.resistances);i=Math.floor(i*u),u>1?this.onLog(`🔥 Weakness hit! (${u}x damage)`):u<1&&this.onLog(`🛡️ Resisted! (${u}x damage)`)}const o=cu.getBrokenMultiplier(r);return o>1&&(i=Math.floor(i*o),this.onLog("💥 BONUS DAMAGE! (Enemy is broken!)")),Math.max(1,i)}}class mD{constructor({getSystem:t}){this.getSystem=t}init(){de.log("InventorySystem initialized.","SYSTEM")}getRandomRarity(){const t=Math.random()*100;let r=0;for(const n in tt.RARITIES)if(r+=tt.RARITIES[n].chance,t<r)return{id:n,...tt.RARITIES[n]};return{id:"common",...tt.RARITIES.common}}generateItem(t=1){const r=Object.keys(tt.ITEM_TYPES).filter(c=>!tt.ITEM_TYPES[c].consumable),n=r[Math.floor(Math.random()*r.length)],a=tt.ITEM_TYPES[n],i=this.getRandomRarity(),o={id:`item_${Date.now()}_${Math.random()}`,baseType:n,nameKey:`items.${n}`,slot:a.slot,rarity:i.id,stats:{...a.baseStats}},u=i.statMult+(t-1)*.1;for(const c in o.stats)o.stats[c]=Math.ceil(o.stats[c]*u);if(Math.random()<.3){const c=Math.floor(Math.random()*tt.ITEM_PREFIXES.length),f=tt.ITEM_PREFIXES[c];o.prefixKey=c===0?"prefixes.sturdy":"prefixes.sharp";for(const d in f.statMod)o.stats[d]=(o.stats[d]||0)+f.statMod[d]}return o.price=10*i.statMult+t*5,o.price=Math.floor(o.price),de.log(`Generated item: ${o.nameKey} (Rarity: ${i.id})`,"INVENTORY"),o}generateItemsForShop(t=3,r=1){return Array.from({length:t},()=>this.generateItem(r))}}function gD({onLanguageSelected:e}){const[t,r]=_.useState("en"),[n,a]=_.useState(!1);_.useEffect(()=>{const u=()=>{Er.isReady()?(a(!0),r(Er.getCurrentLanguage())):setTimeout(u,100)};u()},[]);const i=u=>{r(u),de.log(`Language selected: ${u}`,"UI")},o=()=>{Er.setLanguage(t),de.log(`Language confirmed and applied: ${t}`,"SYSTEM"),e(t)};return n?b.jsx("div",{className:"h-full bg-rpg-radial text-rpg-text flex items-center justify-center px-4",children:b.jsxs("div",{className:"bg-rpg-bg-darker border-2 border-rpg-primary rounded-lg p-8 max-w-md w-full text-center shadow-2xl backdrop-blur-sm",children:[b.jsxs("div",{className:"mb-8",children:[b.jsx("h1",{className:"text-4xl font-bold text-rpg-primary mb-4",children:"🌍"}),b.jsx("h2",{className:"text-2xl font-bold mb-2",children:Er.get("language.select")}),b.jsx("div",{className:"text-lg text-rpg-text opacity-80",children:"Select Language / اختر اللغة"})]}),b.jsxs("div",{className:"space-y-4 mb-8",children:[b.jsxs("button",{onClick:()=>i("en"),className:`w-full p-4 rounded-lg text-xl font-bold transition-all duration-200 flex items-center justify-center gap-3 ${t==="en"?"bg-rpg-primary border-2 border-rpg-secondary text-rpg-text shadow-lg scale-105":"bg-rpg-secondary border-2 border-rpg-primary text-rpg-text opacity-80 hover:bg-rpg-primary hover:opacity-100"}`,children:[b.jsx("span",{className:"text-2xl",children:"🇺🇸"}),b.jsx("span",{children:"English"}),t==="en"&&b.jsx("span",{className:"text-uncommon",children:"✓"})]}),b.jsxs("button",{onClick:()=>i("ar"),className:`w-full p-4 rounded-lg text-xl font-bold transition-all duration-200 flex items-center justify-center gap-3 ${t==="ar"?"bg-rpg-primary border-2 border-rpg-secondary text-rpg-text shadow-lg scale-105":"bg-rpg-secondary border-2 border-rpg-primary text-rpg-text opacity-80 hover:bg-rpg-primary hover:opacity-100"}`,dir:"rtl",children:[b.jsx("span",{className:"text-2xl",children:"🇸🇦"}),b.jsx("span",{children:"العربية"}),t==="ar"&&b.jsx("span",{className:"text-uncommon",children:"✓"})]})]}),b.jsxs("button",{onClick:o,className:"w-full bg-uncommon hover:bg-rare text-rpg-text font-bold py-3 px-6 rounded-lg text-xl transition-all duration-200 transform hover:scale-105 shadow-lg",children:[Er.get("language.confirm")," / متابعة"]}),b.jsxs("div",{className:"mt-6 text-sm text-rpg-text opacity-60",children:["You can change this later in settings",b.jsx("br",{}),"يمكنك تغيير هذا لاحقاً في الإعدادات"]})]})}):b.jsx("div",{className:"h-full bg-rpg-radial text-rpg-text flex items-center justify-center",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl mb-4",children:"🌍"}),b.jsx("div",{className:"text-lg text-rpg-text opacity-80",children:"Loading..."})]})})}const du={DEBOUNCE_MS:3e4,MIN_INTERVAL_MS:5e3,STORAGE_KEY:"pathOfHeroes_autosave_metadata"},zo={FLOOR_COMPLETE:"floor_complete",BOSS_DEFEAT:"boss_defeat",PLAYER_DEATH:"player_death",MANUAL:"manual"};class vD{constructor(){this.lastSaveTimestamp=null,this.pendingSave=!1,this.saveTimer=null,this.observers={saveStart:[],saveComplete:[],saveError:[]}}shouldAutoSave(t,r){if(t===zo.PLAYER_DEATH||t===zo.MANUAL)return!0;if(!U.current.selectedCharacter)return de.log("Cannot auto-save: No character selected","ERROR"),!1;const n=Date.now();if(this.lastSaveTimestamp){const a=n-this.lastSaveTimestamp;if(a<du.MIN_INTERVAL_MS||t!==zo.BOSS_DEFEAT&&a<du.DEBOUNCE_MS)return!1}return!0}async performAutoSave(t){const r=U.current.selectedCharacter,n=U.getCurrentSaveSlot();return!r||!n?(de.log("Cannot auto-save: Missing character or slot info","ERROR"),this._notifyError(new Error("Missing character or slot")),!1):!this.shouldAutoSave(t,U.current.currentFloor)||this.pendingSave?!1:(this.pendingSave=!0,this._notifySaveStart(),new Promise(a=>{const i=()=>{try{U.saveGame(r,n)?(this.lastSaveTimestamp=Date.now(),this._saveMetadata(t,U.current.currentFloor),this._notifySaveComplete(),de.log(`Auto-save completed: ${t} (Floor ${U.current.currentFloor})`,"SYSTEM"),a(!0)):(this._notifyError(new Error("Save failed")),de.log(`Auto-save failed: ${t}`,"ERROR"),a(!1))}catch(o){this._notifyError(o),de.log(`Auto-save error: ${o.message}`,"ERROR"),a(!1)}finally{this.pendingSave=!1}};"requestIdleCallback"in window?requestIdleCallback(i,{timeout:2e3}):setTimeout(i,0)}))}getTimeSinceLastSave(){return this.lastSaveTimestamp?Date.now()-this.lastSaveTimestamp:null}getLastSaveMetadata(){try{const t=localStorage.getItem(du.STORAGE_KEY);if(t)return JSON.parse(t)}catch(t){de.log(`Failed to load auto-save metadata: ${t.message}`,"ERROR")}return null}subscribe(t,r){if(this.observers[t])this.observers[t].push(r);else return de.log(`Unknown auto-save event: ${t}`,"ERROR"),()=>{};return()=>{this.observers[t]=this.observers[t].filter(n=>n!==r)}}clearTimer(){this.saveTimer&&(clearTimeout(this.saveTimer),this.saveTimer=null)}reset(){this.clearTimer(),this.pendingSave=!1,this.lastSaveTimestamp=null}_notifySaveStart(){this.observers.saveStart.forEach(t=>{try{t()}catch(r){de.log(`Error in saveStart callback: ${r.message}`,"ERROR")}})}_notifySaveComplete(){this.observers.saveComplete.forEach(t=>{try{t()}catch(r){de.log(`Error in saveComplete callback: ${r.message}`,"ERROR")}})}_notifyError(t){this.observers.saveError.forEach(r=>{try{r(t)}catch(n){de.log(`Error in saveError callback: ${n.message}`,"ERROR")}})}_saveMetadata(t,r){try{const n={lastSaveTimestamp:this.lastSaveTimestamp,trigger:t,floor:r,character:U.current.selectedCharacter,version:tt.GAME_VERSION};localStorage.setItem(du.STORAGE_KEY,JSON.stringify(n))}catch(n){de.log(`Failed to save auto-save metadata: ${n.message}`,"ERROR")}}_loadMetadata(){try{const t=localStorage.getItem(du.STORAGE_KEY);if(t){const r=JSON.parse(t);this.lastSaveTimestamp=r.lastSaveTimestamp||null,tt.DEBUG_MODE}}catch(t){de.log(`Failed to load auto-save metadata: ${t.message}`,"ERROR")}}}const Lo=new vD;Lo._loadMetadata();de.log("autosave.js: Module loaded.","SYSTEM");const fa={defaultStats:{totalBattles:0,battlesWon:0,battlesLost:0,totalDamageDealt:0,totalDamageTaken:0,floorsCompleted:0,goldEarned:0,goldSpent:0,playtime:0,highestFloor:0,totalDeaths:0,characterStats:{omar:{battles:0,wins:0,losses:0,maxFloor:0,damageDealt:0,damageTaken:0,goldEarned:0,playtime:0},salma:{battles:0,wins:0,losses:0,maxFloor:0,damageDealt:0,damageTaken:0,goldEarned:0,playtime:0},shadi:{battles:0,wins:0,losses:0,maxFloor:0,damageDealt:0,damageTaken:0,goldEarned:0,playtime:0}},battleHistory:[],floorProgression:[]},initialize(){const e=localStorage.getItem("poh_analytics");if(e)try{this.stats=JSON.parse(e),this.stats={...this.defaultStats,...this.stats},de.log("Analytics loaded from localStorage","SYSTEM")}catch{de.log("Failed to load analytics, using defaults","ERROR"),this.stats={...this.defaultStats}}else this.stats={...this.defaultStats}},save(){try{localStorage.setItem("poh_analytics",JSON.stringify(this.stats)),de.log("Analytics saved","SYSTEM")}catch(e){de.log("Failed to save analytics: "+e,"ERROR")}},trackBattle(e){const{victory:t,characterId:r,floor:n,goldGained:a=0,goldLost:i=0,damageDealt:o=0,damageTaken:u=0,duration:c=0}=e;this.stats.totalBattles++,t?(this.stats.battlesWon++,this.stats.goldEarned+=a):(this.stats.battlesLost++,this.stats.totalDeaths++),this.stats.totalDamageDealt+=o,this.stats.totalDamageTaken+=u;const f=r.toLowerCase();if(this.stats.characterStats[f]){const d=this.stats.characterStats[f];d.battles++,t?(d.wins++,d.goldEarned+=a):d.losses++,d.damageDealt+=o,d.damageTaken+=u,n>d.maxFloor&&(d.maxFloor=n)}this.stats.battleHistory.unshift({timestamp:Date.now(),character:r,floor:n,victory:t,goldGained:a,damageDealt:o,damageTaken:u,duration:c}),this.stats.battleHistory.length>50&&(this.stats.battleHistory=this.stats.battleHistory.slice(0,50)),n>this.stats.highestFloor&&(this.stats.highestFloor=n),this.save(),de.log(`Battle tracked: ${t?"Victory":"Defeat"} on Floor ${n}`,"SYSTEM")},trackFloorComplete(e,t){this.stats.floorsCompleted++,this.stats.floorProgression.push({timestamp:Date.now(),floor:e,character:t}),this.stats.floorProgression.length>100&&(this.stats.floorProgression=this.stats.floorProgression.slice(0,100)),this.save()},trackGoldSpent(e){this.stats.goldSpent+=e,this.save()},trackPlaytime(e,t){this.stats.playtime+=e;const r=t?.toLowerCase();r&&this.stats.characterStats[r]&&(this.stats.characterStats[r].playtime+=e),this.save()},getWinRate(){return this.stats.totalBattles===0?0:(this.stats.battlesWon/this.stats.totalBattles*100).toFixed(1)},getCharacterWinRate(e){const t=e.toLowerCase(),r=this.stats.characterStats[t];return!r||r.battles===0?0:(r.wins/r.battles*100).toFixed(1)},getChartData(){return{winLoss:[{name:"Wins",value:this.stats.battlesWon,fill:"#27ae60"},{name:"Losses",value:this.stats.battlesLost,fill:"#e74c3c"}],characterComparison:Object.entries(this.stats.characterStats).map(([e,t])=>({character:e.charAt(0).toUpperCase()+e.slice(1),battles:t.battles,wins:t.wins,maxFloor:t.maxFloor,winRate:t.battles>0?t.wins/t.battles*100:0,damageDealt:t.damageDealt,goldEarned:t.goldEarned})),recentBattles:this.stats.battleHistory.slice(0,20).reverse().map((e,t)=>({battle:t+1,floor:e.floor,damage:e.damageDealt,gold:e.goldGained,victory:e.victory?1:0})),floorProgression:this.stats.floorProgression.slice(0,30).reverse().map((e,t)=>({run:t+1,floor:e.floor,character:e.character}))}},getSummary(){return{totalBattles:this.stats.totalBattles,winRate:this.getWinRate(),highestFloor:this.stats.highestFloor,totalGoldEarned:this.stats.goldEarned,totalGoldSpent:this.stats.goldSpent,netGold:this.stats.goldEarned-this.stats.goldSpent,totalDamageDealt:this.stats.totalDamageDealt,totalDamageTaken:this.stats.totalDamageTaken,avgDamagePerBattle:this.stats.totalBattles>0?Math.round(this.stats.totalDamageDealt/this.stats.totalBattles):0,playtimeMinutes:Math.round(this.stats.playtime/60),totalDeaths:this.stats.totalDeaths,floorsCompleted:this.stats.floorsCompleted}},reset(){this.stats={...this.defaultStats},this.save(),de.log("Analytics reset","SYSTEM")}};fa.initialize();const Ns={metrics:{fps:0,avgFps:0,memoryUsage:0,battleDurations:[],avgBattleDuration:0,slowBattles:0,totalFrames:0,startTime:Date.now()},battleStartTime:null,fpsFrameCount:0,fpsLastTime:performance.now(),fpsValues:[],isMonitoring:!1,rafId:null,initialize(){this.isMonitoring||(this.metrics.startTime=Date.now(),this.isMonitoring=!0,this.measureFPS(),performance.memory&&setInterval(()=>{this.updateMemoryUsage()},5e3),de.log("Performance monitoring initialized","SYSTEM"))},measureFPS(){const e=t=>{this.fpsFrameCount++,this.metrics.totalFrames++;const r=t-this.fpsLastTime;r>=1e3&&(this.metrics.fps=Math.round(this.fpsFrameCount*1e3/r),this.fpsValues.push(this.metrics.fps),this.fpsValues.length>60&&this.fpsValues.shift(),this.metrics.avgFps=Math.round(this.fpsValues.reduce((n,a)=>n+a,0)/this.fpsValues.length),this.metrics.fps<30&&de.log(`Low FPS detected: ${this.metrics.fps}`,"SYSTEM"),this.fpsFrameCount=0,this.fpsLastTime=t),this.isMonitoring&&(this.rafId=requestAnimationFrame(e))};this.rafId=requestAnimationFrame(e)},updateMemoryUsage(){if(!performance.memory)return;const e=performance.memory.usedJSHeapSize/(1024*1024);this.metrics.memoryUsage=Math.round(e),e>100&&de.log(`High memory usage: ${this.metrics.memoryUsage}MB`,"SYSTEM")},startBattleTimer(){this.battleStartTime=performance.now(),de.log("Battle timer started","SYSTEM")},endBattleTimer(){if(!this.battleStartTime)return;const e=performance.now()-this.battleStartTime,t=Math.round(e/1e3);this.metrics.battleDurations.push(t),this.metrics.battleDurations.length>100&&this.metrics.battleDurations.shift();const r=this.metrics.battleDurations.reduce((n,a)=>n+a,0);return this.metrics.avgBattleDuration=Math.round(r/this.metrics.battleDurations.length),t>60&&(this.metrics.slowBattles++,de.log(`Long battle detected: ${t}s`,"SYSTEM")),de.log(`Battle duration: ${t}s`,"SYSTEM"),this.battleStartTime=null,t},getReport(){const e=Math.round((Date.now()-this.metrics.startTime)/1e3),t=Math.floor(e/60),r=e%60;return{fps:this.metrics.fps,avgFps:this.metrics.avgFps,memoryMB:this.metrics.memoryUsage,avgBattleDuration:this.metrics.avgBattleDuration,totalBattles:this.metrics.battleDurations.length,slowBattles:this.metrics.slowBattles,totalFrames:this.metrics.totalFrames,uptime:`${t}m ${r}s`,uptimeSeconds:e}},getDetailedMetrics(){return{...this.metrics,report:this.getReport()}},isPerformanceGood(){return{fps:this.metrics.fps>=30,memory:this.metrics.memoryUsage<100,battles:this.metrics.avgBattleDuration<45,overall:this.metrics.fps>=30&&this.metrics.memoryUsage<100}},getPerformanceGrade(){this.metrics.fps;const e=this.metrics.avgFps;return e>=55?"A":e>=45?"B":e>=35?"C":e>=25?"D":"F"},logSummary(){const e=this.getReport();console.log("=== PERFORMANCE SUMMARY ==="),console.log(`FPS: ${e.fps} (Avg: ${e.avgFps})`),console.log(`Memory: ${e.memoryMB}MB`),console.log(`Battles: ${e.totalBattles} (Avg: ${e.avgBattleDuration}s)`),console.log(`Slow Battles: ${e.slowBattles}`),console.log(`Uptime: ${e.uptime}`),console.log(`Grade: ${this.getPerformanceGrade()}`),console.log("========================")},reset(){this.metrics={fps:0,avgFps:0,memoryUsage:0,battleDurations:[],avgBattleDuration:0,slowBattles:0,totalFrames:0,startTime:Date.now()},this.fpsValues=[],de.log("Performance metrics reset","SYSTEM")},stop(){this.isMonitoring=!1,this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),de.log("Performance monitoring stopped","SYSTEM")}};typeof window<"u"&&Ns.initialize();const vd={floorDescriptions:{1:["The entrance to the dungeon. Torches flicker on damp stone walls.","Moss-covered stones mark the beginning of your descent.","Fresh air still reaches this level. It won't last much longer.","Ancient runes carved into the archway warn of dangers below."],2:["Deeper into darkness. The air grows cold and stale.","Water drips from unseen crevices above.","The walls here show signs of old battles - claw marks and bloodstains.","Shadows seem to move of their own accord."],3:["Ancient bones litter the floor. Something terrible happened here.","The temperature drops noticeably. Your breath fogs in the air.","Faded banners hang from rusted chains, their colors long forgotten.","A sense of dread fills this forsaken place."],4:["The stench of decay is overwhelming.","Cobwebs thick as rope span the corridors.","Strange symbols glow faintly on the walls.","The floor trembles occasionally. Something massive moves below."],5:["Fire pits burn with unnatural flame, casting eerie shadows.","The screams of the damned echo from somewhere distant.","Sulfurous smoke stings your eyes.","This level feels... alive. Watching you."],6:["Ice crystals form on every surface despite the heat.","Reality seems thin here. Space bends unnaturally.","You see glimpses of other worlds through cracked walls.","Time moves strangely in this cursed place."],7:["Pure malevolence saturates the very stone.","Your equipment feels heavier with each step.","The darkness here hungers. It wants to consume you.","Few have reached this depth. Fewer have returned."],8:["The boundary between life and death blurs.","Whispers in forgotten languages fill your mind.","Your shadow no longer follows your movements.","This is where legends come to die."],9:["The final approaches loom before you.","Ancient evil permeates everything. You taste it in the air.","Your courage wavers. This is madness. But you press on.","The heart of darkness beats somewhere ahead."],10:["No light reaches this abyss.","The dungeon's master awaits in the darkness beyond.","Every instinct screams at you to flee. You ignore them.","This is the end. One way or another."]},bossIntros:{defensive_tank:["A hulking brute emerges from the shadows, shield raised. It seeks an immovable object to test.","The ground trembles as an armored giant steps forward, eyes gleaming with challenge.","Chains rattle as a massive warrior blocks your path. It grins. Finally, worthy prey.","Stone armor cracks and shifts as the dungeon's guardian awakens. Your defense will be tested.","A fortress given form. This enemy will not yield easily."],elemental_mage:["Arcane energy crackles as a robed figure materializes. The air itself bends to its will.","The temperature plummets. A frost mage appears before you, ice forming with each breath.","Flames dance around a pyromancer's staff. Fire answers its call.","Reality shivers as raw magical power takes shape. This foe commands the elements themselves.","Lightning arcs between its fingers. The very laws of nature obey this being."],assassin_berserker:["Silent footsteps. A shadow detaches from the wall, blades already drawn.","Twin daggers gleam in the torchlight as a figure approaches with deadly grace.","A scarred warrior grins, weapons ready. It has tasted blood and craves more.","Swift as death itself, your opponent circles. Speed is life in this dance.","Crimson eyes lock onto yours. The hunt has begun."]},eliteIntros:{brute:["A towering brute blocks the way. Its muscles ripple with barely contained rage.","This one is larger than the others. Scars cover its massive frame.","A champion among its kind. It won't fall easily."],magical:["Eldritch power radiates from this creature. The air shimmers around it.","This enemy has mastered dark arts. Approach with caution.","Magical wards protect this foe. Brute force alone won't suffice."],fast:["Faster than the rest. It moves like liquid shadow.","This one's reflexes are supernatural. Blink and you're dead.","Speed incarnate. Your own quickness will be tested."],undead:["Death itself walks. This creature shouldn't exist, yet it does.","Unholy power animates these bones. The grave couldn't hold it.","Neither living nor dead. An abomination that defies nature."],elite:["A battle-hardened veteran. It's survived countless fights.","This enemy radiates confidence. It knows it's dangerous.","Elite warrior. Underestimate it at your peril."]},roomDescriptions:{battle:["You hear grunting and the clang of metal ahead.","Shadows move in the darkness. You're not alone.","Something lurks in this chamber. It knows you're here.","The air shifts. Hostile eyes watch from the gloom.","Battle-stained floors tell of previous fights. Yours is next."],elite:["A powerful presence fills this room. The very air feels heavy.","This chamber radiates menace. Whatever's inside is formidable.","Ancient trophies line the walls. A champion dwells here.","The stench of old blood is overwhelming.","Lesser creatures fled this room. The thing inside made them."],boss:["The final chamber. Your destiny awaits within.","Massive doors loom before you. What lies beyond will test everything.","This is it. The dungeon master's throne room.","Your journey culminates here. Victory or death.","The air itself seems to scream: turn back! You don't."],shop:["A mysterious merchant beckons from the corner.","Wares are laid out on a worn wooden table.","The smell of old leather and metal fills the air.",'"Ah, a customer!" the merchant grins. "What can I offer you?"',"Coins change hands here. Death is merely business."],treasure:["A chest gleams in the torchlight!","Gold coins spill from an overturned chest. Your lucky day.","Your eyes catch the glint of treasure.","Riches beyond measure... or so it appears.","Fortune favors the bold. This cache is yours."],shrine:["A sacred altar radiates divine energy.","The gods have not abandoned this place entirely.","Healing light emanates from ancient carvings.","Your wounds begin to close just from proximity.","Blessed ground. Even in hell, sanctuaries exist."],stairs:["Stairs descend into deeper darkness.","The way down beckons. Are you ready?","Another floor awaits. The dungeon grows deadlier.","These steps lead further from salvation.","Descend, if you dare. There's no going back."]},victoryTexts:{quick:["Swift and decisive. The enemy never stood a chance.","A masterful display. They fell before they knew the battle began.","Efficient. Brutal. Perfect execution."],normal:["Victory is yours. But at what cost?","The enemy lies defeated. You stand victorious.","Another battle won. How many more await?"],hard:["You survived. Barely. That was too close.","Victory tastes like blood and ash. But it's yours.","Death came for you. You sent it away empty-handed."],boss:["The floor's master falls. Against all odds, you prevailed.","VICTORY! The dungeon trembles at your might!","Impossible odds. Overwhelming power. You conquered both.","Legends will speak of this day. You have triumphed!"]},defeatTexts:["Darkness claims you. Your story ends here... for now.","Death's embrace is cold. But Hero Souls remember.","You fall. But heroes don't die. They evolve.","The dungeon wins this round. You'll return stronger.","Not the end. Merely a setback. Rise again, hero."],getFloorDescription(e){const r=Math.min(e,10),n=this.floorDescriptions[r]||this.floorDescriptions[10];return this.randomChoice(n)},generateBossIntro(e,t){const r=this.bossIntros[t]||this.bossIntros.defensive_tank,n=this.randomChoice(r),a=e>=10?" The final guardian.":"";return n+a},generateEliteIntro(e){const t=e?.toLowerCase()||"elite",r=this.eliteIntros[t]||this.eliteIntros.elite;return this.randomChoice(r)},getRoomDescription(e){const t=this.roomDescriptions[e]||this.roomDescriptions.battle;return this.randomChoice(t)},getVictoryText(e,t=!1){return t?this.randomChoice(this.victoryTexts.boss):e<15?this.randomChoice(this.victoryTexts.quick):e<45?this.randomChoice(this.victoryTexts.normal):this.randomChoice(this.victoryTexts.hard)},getDefeatText(){return this.randomChoice(this.defeatTexts)},generateEnemyVariation(e,t){const r={low:["Lesser","Weak","Young","Feral"],mid:["Veteran","Hardened","Cunning","Savage"],high:["Elite","Ancient","Legendary","Corrupted"]};let n="low";return t>=5&&(n="mid"),t>=8&&(n="high"),`${this.randomChoice(r[n])} ${e}`},getCombatFlavor(e,t,r=!1){const n=["A devastating strike!","CRITICAL HIT!","Perfect execution!","A masterful blow!"],a=["A solid hit.","The attack connects.","Damage dealt.","The enemy reels."],i=["A glancing blow.","Barely a scratch.","The enemy shrugs it off.","Minimal impact."];return r?this.randomChoice(n):t>20?this.randomChoice(a):this.randomChoice(i)},randomChoice(e){return e[Math.floor(Math.random()*e.length)]},logContent(e,t){de.log(`Generated ${e}: ${t}`,"SYSTEM")}};function yD({player:e,enemies:t,combatSystem:r,combatLog:n}){const[a,i]=_.useState(n||[]),[o,u]=_.useState([]),[c,f]=_.useState([]),[d,p]=_.useState(()=>{const Z=t.find(Te=>Te.isAlive);return Z?Z.originalIndex:null}),[m]=_.useState(()=>{const Z=U.current.currentFloor||1,Te=U.current.player?.progressionPath||"defensive_tank",Se=t.some(we=>we.isBoss),me=t.some(we=>we.isElite||we.prefixKey?.includes("elite"));if(Se)return vd.generateBossIntro(Z,Te);if(me){const we=t[0]?.type||"elite";return vd.generateEliteIntro(we)}else{const we=["Steel meets flesh. Battle begins!","Your enemies stand ready. Show no mercy.","Another fight. Another chance to prove yourself.","They block your path. Cut them down."];return we[Math.floor(Math.random()*we.length)]}});_.useEffect(()=>{const Z=U.current.enemies,Te=Z.find(Se=>Se.originalIndex===d);if(!Te||!Te.isAlive){const Se=Z.find(we=>we.isAlive),me=Se?Se.originalIndex:null;d!==me&&(de.log(`Target defeated or invalid. Auto-targeting next enemy: index ${me}.`,"UI"),p(me))}},[n,d]),_.useEffect(()=>{if(i(n),n&&n.length>0){const Z=n[n.length-1];if(Z){v(Z);const Te=Z.match(/(\d+)\s*damage/i),Se=/critical/i.test(Z)||/💥/i.test(Z);if(Te&&d!==null){const we=parseInt(Te[1],10);x(d,we,Se?"crit":"damage")}const me=Z.match(/heal(?:ed)?\s*(\d+)/i);me&&parseInt(me[1],10)}}},[n,d]);const v=(Z,Te=2e3)=>{const Se=Date.now()+Math.random(),me={id:Se,text:Z,timestamp:Date.now()};u(we=>[...we,me].slice(-3)),setTimeout(()=>{u(we=>we.filter(be=>be.id!==Se))},Te)},x=(Z,Te,Se="damage")=>{const me=Date.now()+Math.random(),we={id:me,entityId:Z,value:Te,type:Se,timestamp:Date.now()};f(be=>[...be,we]),setTimeout(()=>{f(be=>be.filter(X=>X.id!==me))},1500)},y=()=>{d!==null&&r.playerAttack(d)},S=()=>{d!==null&&r.playerSkill(d)},T=Z=>{if(!D)return;if(kT.usePotion(Z)){const Se=ee(`items.${Z}`),me=ee("combat.messages.usedPotion",{potion:Se});de.log(me,"COMBAT"),i(we=>[...we,me])}},k=Z=>{if(!Z||!Z.stats)return 0;const Te=Z.maxStats?.hp||Z.stats.hp||1;return Math.max(0,Z.stats.hp/Te*100)},A=Z=>!Z||!Z.resource?0:Math.max(0,Z.resource.current/Z.resource.max*100),P=Z=>{switch(Z?ee(Z):""){case"Vigor":case"قوة":return"bg-vigor-full";case"Mana":case"مانا":return"bg-mana-full";case"Energy":case"طاقة":return"bg-energy-full";default:return"bg-common"}},N=Z=>{switch(Z?ee(Z):""){case"Vigor":case"قوة":return"bg-vigor-empty";case"Mana":case"مانا":return"bg-mana-empty";case"Energy":case"طاقة":return"bg-energy-empty";default:return"bg-common"}},I=()=>{const Z=U.current.level,Te=U.current.experience||0;if(Z>=tt.XP_CURVE.maxLevel)return{percentage:100,current:"MAX",required:"LEVEL"};const Se=U.getRequiredExperience(Z-1),we=U.getRequiredExperience(Z)-Se,be=Te-Se;return{percentage:we===0?0:Math.max(0,Math.min(100,be/we*100)),current:Math.max(0,be),required:we}},D=r.isPlayerTurn(),z=e?tt.ABILITIES[e.abilities[0]]:null,H=I(),te=U.current.enemies||[],q=te.filter(Z=>Z.isAlive),V=te.find(Z=>Z.originalIndex===d),ae=te.filter(Z=>Z.isAlive&&Z.originalIndex!==d),Ee=Er.getCurrentLanguage();return b.jsxs(b.Fragment,{children:[b.jsx("style",{children:`
                @keyframes fadeInOut {
                    0% { opacity: 0; transform: translateY(20px); }
                    15% { opacity: 1; transform: translateY(0); }
                    85% { opacity: 1; transform: translateY(0); }
                    100% { opacity: 0; transform: translateY(-10px); }
                }
                .feedback-message {
                    animation: fadeInOut 2s ease-in-out forwards;
                }

                @keyframes floatUp {
                    0% {
                        opacity: 1;
                        transform: translateY(0) scale(1);
                    }
                    50% {
                        transform: translateY(-30px) scale(1.2);
                    }
                    100% {
                        opacity: 0;
                        transform: translateY(-60px) scale(0.8);
                    }
                }
                .floating-number {
                    animation: floatUp 1.5s ease-out forwards;
                    pointer-events: none;
                    font-weight: bold;
                    text-shadow: 0 0 10px rgba(0, 0, 0, 0.8), 0 0 20px rgba(0, 0, 0, 0.5);
                }
            `}),b.jsx("div",{className:"min-h-screen max-h-screen bg-rpg-radial text-rpg-text p-2 flex flex-col overflow-y-auto",children:b.jsxs("div",{className:"w-full max-w-3xl mx-auto flex flex-col justify-between flex-1",children:[b.jsxs("div",{className:"text-center mb-2 flex-shrink-0",children:[b.jsxs("h1",{className:"text-lg font-bold text-rpg-primary",children:["⚔️ ",ee("combat.battle")," ⚔️"]}),(r.totalWaves>1||te.length>1)&&b.jsx("div",{className:"inline-block bg-rpg-secondary border border-rpg-primary rounded-full px-2 py-0.5 text-xs text-rpg-primary font-semibold",children:r.totalWaves>1?b.jsxs(b.Fragment,{children:["🌊 Wave ",r.currentWave,"/",r.totalWaves]}):b.jsxs(b.Fragment,{children:["⚔️ ",ee("combat.messages.enemiesRemaining",{alive:q.length,total:te.length})]})}),b.jsx("p",{className:"text-xs text-rpg-text opacity-80",children:D?ee("combat.playerTurn",{player:e?.nameKey?ee(e.nameKey):"Player"}):ee("combat.enemyTurn")})]}),m&&b.jsx("div",{className:"mb-2 flex-shrink-0",children:b.jsx("p",{className:"text-xs italic text-[#d4a656] text-center opacity-80",children:m})}),b.jsxs("div",{className:"space-y-2 mb-3 flex-shrink-0 max-h-[40vh] overflow-y-auto",children:[V&&b.jsxs("div",{className:`relative bg-rpg-bg-darker bg-opacity-80 p-1.5 rounded-lg border-2 backdrop-blur-sm ${V.isAlive?"border-legendary":"border-rpg-secondary opacity-60"}`,children:[c.filter(Z=>Z.entityId===V.originalIndex).map(Z=>{const Te=()=>{switch(Z.type){case"crit":return{color:"#ffff00",fontSize:"1.8rem"};case"heal":return{color:"#44ff44",fontSize:"1.5rem"};case"miss":return{color:"#999999",fontSize:"1.2rem"};default:return{color:"#ff4444",fontSize:"1.5rem"}}};return b.jsxs("div",{className:"floating-number absolute top-4 left-1/2 transform -translate-x-1/2 z-50",style:Te(),children:[Z.type==="heal"?"+":Z.type==="miss"?"MISS":"-",Z.type!=="miss"&&Z.value]},Z.id)}),b.jsxs("div",{className:"flex gap-2 items-center",children:[b.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-rpg-bg-darkest rounded-lg flex items-center justify-center text-3xl border-2 border-health-dark",children:V.isAlive?"👹":"💀"}),b.jsxs("div",{className:"flex-grow min-w-0",children:[b.jsxs("div",{className:"flex justify-between items-center mb-1",children:[b.jsxs("h2",{className:"text-base font-bold text-health-mid truncate",children:[V.prefixKey?`${ee(V.prefixKey)} `:"",V.nameKey?ee(V.nameKey):V.id||"Enemy"," ",V.level?`(${ee("stats.level")} ${V.level})`:""]}),b.jsx("div",{className:"flex gap-1 flex-shrink-0",children:V.statusEffects?.map((Z,Te)=>b.jsxs("div",{className:"text-xs bg-epic bg-opacity-50 border border-epic rounded-full px-2 py-0.5",children:[Z.icon," ",Z.duration]},Te))})]}),b.jsx("div",{className:"h-2 bg-health-empty rounded overflow-hidden mb-1",children:b.jsx("div",{className:"h-2 bg-health-full",style:{width:`${k(V)}%`}})}),b.jsxs("p",{className:"text-xs text-right text-rpg-text opacity-80",children:[ee("stats.hpShort"),": ",V.stats.hp," / ",V.maxStats.hp]}),V.breakData&&b.jsxs("div",{className:"mt-1",children:[b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx("span",{className:"text-xs text-rpg-text opacity-70",children:"🛡️"}),V.breakData.isBroken&&b.jsx("span",{className:"text-xs font-bold text-red-500 animate-pulse",children:"BROKEN!"}),V.breakData.weaknesses.map(Z=>{const Te=uD(Z);return b.jsx("span",{className:"text-xs",title:typeof Te.name=="object"?Te.name.en:Te.name,children:Te.icon},Z)})]}),b.jsxs("span",{className:"text-xs text-rpg-text opacity-70",children:[V.breakData.currentToughness,"/",V.breakData.maxToughness]})]}),b.jsx("div",{className:"h-1.5 bg-gray-700 rounded overflow-hidden mt-0.5",children:b.jsx("div",{className:`h-1.5 transition-all ${V.breakData.isBroken?"bg-red-500":"bg-blue-400"}`,style:{width:`${V.breakData.currentToughness/V.breakData.maxToughness*100}%`}})})]}),b.jsxs("div",{className:"flex justify-end gap-2 mt-1 text-xs text-rpg-text opacity-70",children:[b.jsxs("span",{children:["⚔️ ",V.stats.atk]})," ",b.jsxs("span",{children:["🛡️ ",V.stats.def]})," ",b.jsxs("span",{children:["⚡ ",V.stats.spd]})," ",b.jsxs("span",{children:["💥 ",V.stats.crit,"%"]})]})]})]})]}),ae.map(Z=>b.jsxs("button",{onClick:()=>p(Z.originalIndex),className:"w-full bg-rpg-secondary bg-opacity-30 hover:bg-rpg-secondary hover:bg-opacity-50 rounded-lg p-2 border border-rpg-secondary text-left flex items-center text-sm transition-all",children:[b.jsx("div",{className:"w-8 h-8 rounded-full bg-rpg-bg-darkest flex items-center justify-center mr-2 text-lg",children:Z.isAlive?"👹":"💀"}),b.jsxs("div",{className:"flex-grow text-rpg-text font-semibold text-xs",children:[Z.prefixKey?`${ee(Z.prefixKey)} `:"",Z.nameKey?ee(Z.nameKey):Z.id||"Enemy"," ",Z.level?`(${ee("stats.level")} ${Z.level})`:""]}),b.jsx("div",{className:"w-1/3 h-2 bg-health-empty rounded-full overflow-hidden mr-2",children:b.jsx("div",{className:"h-2 bg-health-full",style:{width:`${k(Z)}%`}})}),b.jsxs("div",{className:"text-rpg-text opacity-70 text-right w-20 text-xs",children:[Z.stats.hp," / ",Z.maxStats.hp]})]},Z.originalIndex)),b.jsxs("div",{className:"flex gap-2 items-center",children:[b.jsx("div",{className:"flex-shrink-0 w-14 h-14 bg-rpg-bg-darkest rounded-lg flex items-center justify-center text-3xl border-2 border-uncommon",children:"👤"}),b.jsxs("div",{className:"flex-grow min-w-0",children:[b.jsxs("div",{className:"flex justify-between items-center mb-1",children:[b.jsxs("h2",{className:"text-base font-bold text-uncommon truncate",children:[e?.nameKey?ee(e.nameKey):"Player"," (",ee("stats.level")," ",U.current.level,")"]}),b.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e?.defending&&b.jsx("div",{className:"text-xs bg-rare bg-opacity-50 border border-rare rounded-full px-2 py-0.5",children:"🛡️"}),e?.statusEffects?.map((Z,Te)=>b.jsx("div",{className:"text-xs bg-health-dark bg-opacity-50 border border-health-mid rounded-full px-2 py-0.5",children:Z.icon},Te))]})]}),b.jsx("div",{className:"h-2 bg-health-empty rounded overflow-hidden mb-1",children:b.jsx("div",{className:"h-2 bg-health-full",style:{width:`${k(e)}%`}})}),b.jsxs("div",{className:"text-xs text-right text-rpg-text opacity-80 mb-1",children:[ee("stats.hpShort"),": ",e?.stats.hp," / ",e?.maxStats.hp]}),b.jsx("div",{className:`h-2 rounded overflow-hidden mb-1 ${N(e?.resource?.nameKey)}`,children:b.jsx("div",{className:`h-2 ${P(e?.resource?.nameKey)}`,style:{width:`${A(e)}%`}})}),b.jsxs("div",{className:"text-xs text-right text-rpg-text opacity-80",children:[e?.resource?.nameKey?ee(e.resource.nameKey):"Resource",": ",e?.resource.current," / ",e?.resource.max]}),b.jsxs("div",{className:"flex justify-end gap-2 mt-1 text-xs text-rpg-text opacity-70",children:[b.jsxs("span",{children:["⚔️ ",e?.stats.atk]})," ",b.jsxs("span",{children:["🛡️ ",e?.stats.def]})," ",b.jsxs("span",{children:["⚡ ",e?.stats.spd]})," ",b.jsxs("span",{children:["💥 ",e?.stats.crit,"%"]})]})]})]}),b.jsxs("div",{className:"mt-1",children:[b.jsx("div",{className:"h-2 bg-rpg-bg-darkest rounded overflow-hidden mb-1",children:b.jsx("div",{className:"h-2 bg-mana-light",style:{width:`${H.percentage}%`}})}),b.jsxs("div",{className:"text-xs text-right text-mana-light",children:[ee("stats.xpShort"),": ",H.current," / ",H.required]})]}),U.current.battleBuffs&&U.current.battleBuffs.length>0&&b.jsx("div",{className:"mt-1 pt-1 border-t border-rpg-secondary",children:b.jsx("div",{className:"flex flex-wrap gap-1",children:U.current.battleBuffs.map((Z,Te)=>b.jsxs("div",{className:"bg-legendary bg-opacity-20 border border-legendary rounded px-2 py-0.5 text-xs",title:typeof Z.description=="object"?Z.description[Er.getCurrentLanguage()]:Z.description,children:[b.jsx("span",{className:"text-sm mr-0.5",children:Z.icon}),b.jsx("span",{className:"font-bold text-legendary text-xs",children:typeof Z.name=="object"?Z.name[Er.getCurrentLanguage()]:Z.name})]},Te))})})]}),b.jsxs("div",{className:"flex-shrink-0 pt-2",children:[e.ultimate&&b.jsxs("div",{className:"mb-1 bg-rpg-bg-darker bg-opacity-80 rounded-lg p-2 border border-rpg-primary",children:[b.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[b.jsx("span",{className:"text-xs font-bold text-rpg-primary",children:"⚡ ULT"}),b.jsxs("span",{className:"text-xs font-bold text-rpg-primary",children:[e.ultimate.current,"/",e.ultimate.max]})]}),b.jsx("div",{className:"h-2 bg-gray-700 rounded overflow-hidden",children:b.jsx("div",{className:`h-2 transition-all ${e.ultimate.ready?"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-500 animate-pulse":"bg-gradient-to-r from-gray-600 to-blue-500"}`,style:{width:`${e.ultimate.current/e.ultimate.max*100}%`}})}),e.ultimate.ready&&b.jsx("p",{className:"text-center text-xs text-yellow-400 font-bold animate-pulse",children:"READY!"})]}),b.jsxs("div",{className:"grid grid-cols-5 gap-1 mb-1",children:[b.jsxs("button",{onClick:y,disabled:!D||!V?.isAlive,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&V?.isAlive?"bg-rpg-primary hover:bg-legendary":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:["⚔️ ",ee("combat.attack")]}),z?b.jsx("button",{onClick:S,disabled:!D||e.resource.current<z.cost||!V?.isAlive,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&e.resource.current>=z.cost&&V?.isAlive?"bg-epic hover:bg-mythic":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:b.jsx("div",{className:"flex flex-col items-center leading-tight",children:b.jsx("span",{className:"text-xs",children:z.name?typeof z.name=="object"?z.name[Ee]||z.name.en:z.name:ee("combat.skill")})})}):b.jsxs("button",{disabled:!0,className:"px-1 py-1.5 text-xs rounded font-bold bg-rpg-secondary bg-opacity-50 text-rpg-text opacity-50 cursor-not-allowed",children:["🔮 ",ee("combat.noSkill")]}),b.jsx("button",{onClick:()=>r.playerUltimate(d),disabled:!D||!e.ultimate?.ready||!V?.isAlive,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors ${D&&e.ultimate?.ready&&V?.isAlive?"bg-gradient-to-r from-yellow-400 to-red-500 text-black hover:from-yellow-300 hover:to-red-400 animate-pulse":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed text-rpg-text"}`,children:"💥 ULT"}),b.jsxs("button",{onClick:()=>r.playerDefend(),disabled:!D,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D?"bg-rpg-secondary hover:bg-rpg-primary":"bg-rpg-secondary bg-opacity-50 cursor-not-allowed"}`,children:["🛡️ ",ee("combat.defend")]}),b.jsxs("button",{onClick:()=>r.playerFlee(),disabled:!D,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D?"bg-health-full hover:bg-health-mid":"bg-rpg-secondary bg-opacity-50 cursor-not-allowed"}`,children:["🏃 ",ee("combat.flee")]})]}),b.jsxs("div",{className:"grid grid-cols-4 gap-1 mb-2",children:[b.jsxs("button",{onClick:()=>T("hp_potion"),disabled:!D||!U.current.potions?.hp_potion||U.current.potions.hp_potion<=0,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&U.current.potions?.hp_potion>0?"bg-health-full hover:bg-health-mid":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:["❤️‍🩹 (",U.current.potions?.hp_potion||0,")"]}),b.jsxs("button",{onClick:()=>T("resource_potion"),disabled:!D||!U.current.potions?.resource_potion||U.current.potions.resource_potion<=0,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&U.current.potions?.resource_potion>0?"bg-mana-full hover:bg-mana-light":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:["🧪 (",U.current.potions?.resource_potion||0,")"]}),b.jsxs("button",{onClick:()=>T("greater_hp_potion"),disabled:!D||!U.current.potions?.greater_hp_potion||U.current.potions.greater_hp_potion<=0,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&U.current.potions?.greater_hp_potion>0?"bg-legendary hover:bg-mythic":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:["💖 (",U.current.potions?.greater_hp_potion||0,")"]}),b.jsxs("button",{onClick:()=>T("elixir_of_vitality"),disabled:!D||!U.current.potions?.elixir_of_vitality||U.current.potions.elixir_of_vitality<=0,className:`px-1 py-1.5 text-xs rounded font-bold transition-colors text-rpg-text ${D&&U.current.potions?.elixir_of_vitality>0?"bg-epic hover:bg-legendary":"bg-rpg-secondary bg-opacity-50 opacity-50 cursor-not-allowed"}`,children:["🌟 (",U.current.potions?.elixir_of_vitality||0,")"]})]}),b.jsxs("div",{className:"relative h-12 flex items-center justify-center overflow-hidden",children:[o.map((Z,Te)=>b.jsx("div",{className:"feedback-message absolute text-center text-sm font-bold px-3 py-1.5 bg-black bg-opacity-60 rounded-lg backdrop-blur-sm border border-rpg-primary",style:{zIndex:o.length-Te,color:"#f8e4c0"},children:Z.text},Z.id)),o.length===0&&b.jsx("div",{className:"text-rpg-text opacity-30 italic text-xs",children:ee(D?"combat.chooseAction":"combat.enemyThinking")})]})]})]})})]})}const Ff={UNIQUE_REWARD_CHANCE:.25,PREFERRED_ITEM_WEIGHT:2.5,RARITY_BOOST_CHANCE:.15,GOLD_VARIANCE:.2},FS={heavy_armor:{slot:"chest",baseStats:{def:8,hp:10},nameKey:"items.heavy_armor",icon:"🛡️"},shields:{slot:"weapon",baseStats:{def:6,atk:4},nameKey:"items.shield",icon:"🛡️"},staves:{slot:"weapon",baseStats:{atk:10,crit:3},nameKey:"items.staff",icon:"🪄"},mana_crystals:{slot:"head",baseStats:{atk:5,spd:2},nameKey:"items.mana_crystal",icon:"💎"},daggers:{slot:"weapon",baseStats:{atk:8,spd:4,crit:5},nameKey:"items.dagger",icon:"🗡️"},poisons:{slot:null,consumable:!0,nameKey:"items.poison_vial",icon:"🧪",effect:"poison",value:12}};class xD{constructor(){this.currentCharacterId=null,this.characterConfig=null}initialize(t){const r=t.toUpperCase();return this.characterConfig=Xo[r],this.characterConfig?(this.currentCharacterId=t,de.log(`RewardService: Initialized for ${t}`,"SYSTEM"),!0):(de.log(`RewardService: Invalid character ID: ${t}`,"ERROR"),!1)}getUniqueRewardTypes(){return this.characterConfig?this.characterConfig.uniqueRewards||[]:[]}isPreferredItemType(t){if(this.getUniqueRewardTypes().includes(t))return!0;const n=FS[t]||tt.ITEM_TYPES[t];return n?this.currentCharacterId==="warrior"?n.slot==="chest"||t.includes("shield"):this.currentCharacterId==="sorceress"?n.slot==="weapon"||t.includes("staff")||t.includes("mana"):this.currentCharacterId==="rogue"?n.slot==="weapon"||t.includes("dagger")||t.includes("poison"):!1:!1}getRandomRarity(t=1){const r=Math.random()*100;let n=0;const a=Math.min(t*.5,15);for(const i in tt.RARITIES){const o=tt.RARITIES[i];let u=o.chance;if(i!=="common"&&i!=="uncommon"&&(u+=a),n+=u,r<n)return{id:i,...o}}return{id:"common",...tt.RARITIES.common}}boostRarity(t){const r=["common","uncommon","rare","epic","mythic","legendary"],n=r.indexOf(t);return n===-1||n>=r.length-1?t:r[n+1]}generateItem(t=1){if(!this.characterConfig)return de.log("RewardService: Not initialized, using default generation","ERROR"),this._generateDefaultItem(t);const r=this.getUniqueRewardTypes();let n=null,a=null;if(Math.random()<Ff.UNIQUE_REWARD_CHANCE&&r.length>0){const c=r[Math.floor(Math.random()*r.length)];a=FS[c],n=c}if(!a){const c=Object.keys(tt.ITEM_TYPES).filter(d=>!tt.ITEM_TYPES[d].consumable),f=[];c.forEach(d=>{const p=this.isPreferredItemType(d)?Ff.PREFERRED_ITEM_WEIGHT:1,m=Math.floor(p*10);for(let v=0;v<m;v++)f.push(d)}),n=f[Math.floor(Math.random()*f.length)],a=tt.ITEM_TYPES[n]}let i=this.getRandomRarity(t);if(this.isPreferredItemType(n)&&Math.random()<Ff.RARITY_BOOST_CHANCE){const c=this.boostRarity(i.id);i={id:c,...tt.RARITIES[c]}}const o={id:`item_${Date.now()}_${Math.random()}`,baseType:n,nameKey:a.nameKey||`items.${n}`,slot:a.slot,rarity:i.id,stats:{...a.baseStats}},u=i.statMult+(t-1)*.1;for(const c in o.stats)o.stats[c]=Math.ceil(o.stats[c]*u);if(Math.random()<.3){const c=Math.floor(Math.random()*tt.ITEM_PREFIXES.length),f=tt.ITEM_PREFIXES[c];o.prefixKey=c===0?"prefixes.sturdy":"prefixes.sharp";for(const d in f.statMod)o.stats[d]=(o.stats[d]||0)+f.statMod[d]}return o.price=10*i.statMult+t*5,o.price=Math.floor(o.price),de.log(`RewardService: Generated ${n} (${i.id}) for ${this.currentCharacterId}`,"SYSTEM"),o}generateItemsForShop(t=3,r=1){return Array.from({length:t},()=>this.generateItem(r))}calculateGoldReward(t,r=1){const n=1+(Math.random()*2-1)*Ff.GOLD_VARIANCE,a=Math.floor(t*n);return Math.max(1,a)}_generateDefaultItem(t){const r=Object.keys(tt.ITEM_TYPES).filter(c=>!tt.ITEM_TYPES[c].consumable),n=r[Math.floor(Math.random()*r.length)],a=tt.ITEM_TYPES[n],i=this.getRandomRarity(t),o={id:`item_${Date.now()}_${Math.random()}`,baseType:n,nameKey:`items.${n}`,slot:a.slot,rarity:i.id,stats:{...a.baseStats}},u=i.statMult+(t-1)*.1;for(const c in o.stats)o.stats[c]=Math.ceil(o.stats[c]*u);return o.price=10*i.statMult+t*5,o.price=Math.floor(o.price),o}reset(){this.currentCharacterId=null,this.characterConfig=null,de.log("RewardService: Reset","SYSTEM")}}const yd=new xD;de.log("reward-service.js: Module loaded.","SYSTEM");const Lt={text:{screenTitle:"text-2xl font-bold",cardTitle:"text-base font-bold",body:"text-sm",bodyLarge:"text-base",small:"text-xs"},spacing:{screen:"p-3",cardPadding:"p-3"},components:{button:{primary:"px-6 py-2 text-base font-bold rounded-lg transition-all",secondary:"px-4 py-2 text-sm font-bold rounded-lg transition-all"},card:{base:"bg-rpg-bg-darker rounded-lg border-2 backdrop-blur-sm",padding:"p-3"},icon:{large:"text-5xl"},stats:{bar:"h-2 rounded-full",label:"text-xs opacity-70"}},layout:{screenContainer:"min-h-screen max-h-screen flex flex-col overflow-y-auto",screenContent:"w-full max-w-3xl mx-auto flex flex-col flex-1",modal:"fixed inset-0 flex items-center justify-center z-[100] p-3",modalContent:"bg-rpg-bg-darker border-2 border-rpg-primary rounded-lg shadow-2xl backdrop-blur-sm max-w-md w-full max-h-[95vh] overflow-y-auto",grid:{cols3:"grid grid-cols-3 gap-3"}},colors:{primary:"text-rpg-primary",text:"text-rpg-text"}};function Rv({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.layout.screenContainer} bg-rpg-radial text-rpg-text ${Lt.spacing.screen} ${t}`,children:e})}function OT({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.layout.screenContent} ${t}`,children:e})}function PT({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.layout.modal} bg-rpg-bg-darkest/90 ${t}`,children:e})}function CT({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.layout.modalContent} ${Lt.spacing.cardPadding} ${t}`,children:e})}function Xu({children:e,className:t=""}){return b.jsx("h1",{className:`${Lt.text.screenTitle} ${Lt.colors.primary} text-center ${t}`,children:e})}function NT({children:e,className:t=""}){return b.jsx("h3",{className:`${Lt.text.cardTitle} ${t}`,children:e})}function An({children:e,className:t="",large:r=!1}){const n=r?Lt.text.bodyLarge:Lt.text.body;return b.jsx("p",{className:`${n} ${Lt.colors.text} ${t}`,children:e})}function Za({children:e,className:t=""}){return b.jsx("p",{className:`${Lt.text.small} ${Lt.colors.text} opacity-70 ${t}`,children:e})}function ol({children:e,onClick:t,disabled:r=!1,className:n=""}){return b.jsx("button",{onClick:t,disabled:r,className:`${Lt.components.button.primary} bg-rpg-primary hover:bg-rpg-secondary text-rpg-text ${r?"opacity-50 cursor-not-allowed":""} ${n}`,children:e})}function DT({children:e,onClick:t,disabled:r=!1,className:n=""}){return b.jsx("button",{onClick:t,disabled:r,className:`${Lt.components.button.secondary} bg-rpg-secondary hover:bg-rpg-primary text-rpg-text ${r?"opacity-50 cursor-not-allowed":""} ${n}`,children:e})}function wD({children:e,className:t="",highlighted:r=!1}){return b.jsx("div",{className:`${Lt.components.card.base} ${Lt.components.card.padding} ${r?"border-legendary":"border-rpg-secondary"} ${t}`,children:e})}function SD({current:e,max:t,color:r="bg-health-full",label:n="",showNumbers:a=!0}){const i=t>0?e/t*100:0;return b.jsxs("div",{className:"w-full",children:[(n||a)&&b.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n&&b.jsx("span",{className:Lt.components.stats.label,children:n}),a&&b.jsxs("span",{className:Lt.components.stats.label,children:[e," / ",t]})]}),b.jsx("div",{className:`${Lt.components.stats.bar} bg-rpg-bg-darkest bg-opacity-80 overflow-hidden`,children:b.jsx("div",{className:`${Lt.components.stats.bar} ${r} transition-all`,style:{width:`${Math.min(100,Math.max(0,i))}%`}})})]})}function MT({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.components.icon.large} ${t}`,children:e})}function bD({children:e,className:t=""}){return b.jsx("div",{className:`${Lt.layout.grid.cols3} ${t}`,children:e})}const ED={common:"text-common",uncommon:"text-uncommon",rare:"text-rare",epic:"text-epic",mythic:"text-mythic",legendary:"text-legendary"};function _D({inventorySystem:e,onLeave:t}){const[r,n]=_.useState(()=>U.current.selectedCharacter&&yd.currentCharacterId?yd.generateItemsForShop(3,U.current.currentFloor):e.generateItemsForShop(3,U.current.currentFloor)),[a,i]=_.useState(!1),[o,u]=_.useState({}),c=f=>{if(!a)if(U.current.gold>=f.price){U.spendGold(f.price),U.current.inventory.push(f);const d=(f.prefixKey?`${ee(f.prefixKey)} `:"")+ee(f.nameKey||"items.sword");de.log(`Purchased ${d} for ${f.price} gold.`,"PLAYER"),i(!0),setTimeout(()=>{t()},1e3)}else{const d=(f.prefixKey?`${ee(f.prefixKey)} `:"")+ee(f.nameKey||"items.sword");de.log(`Not enough gold to purchase ${d}.`,"PLAYER"),u(p=>({...p,[f.id]:ee("shop.notEnoughGold")})),setTimeout(()=>{u(p=>{const m={...p};return delete m[f.id],m})},2e3)}};return b.jsx(PT,{children:b.jsxs(CT,{className:"flex flex-col justify-between text-center space-y-3",children:[b.jsxs(Xu,{children:["🏪 ",ee("shop.title")]}),b.jsx("div",{className:"bg-rpg-secondary rounded-lg p-2 border border-rpg-primary",children:b.jsxs(An,{large:!0,className:"text-legendary",children:["💰 ",U.current.gold," ",ee("stats.gold")]})}),b.jsx(Za,{children:ee("shop.onePurchaseOnly")}),b.jsx("div",{className:"space-y-2 flex-shrink-0",children:r.map(f=>b.jsxs(wD,{className:"text-left",children:[b.jsxs(NT,{className:ED[f.rarity],children:[f.prefixKey?`${ee(f.prefixKey)} `:"",ee(f.nameKey||"items.sword")]}),b.jsxs(Za,{className:"capitalize",children:[ee(`rarities.${f.rarity}`)," ",f.slot]}),b.jsxs("div",{className:"flex justify-between items-center mt-2",children:[b.jsx("div",{className:"text-rpg-text opacity-80 text-xs",children:Object.entries(f.stats).map(([d,p])=>b.jsxs("span",{className:"mr-2",children:[d.toUpperCase(),": +",p]},d))}),b.jsx("button",{onClick:()=>c(f),disabled:a||U.current.gold<f.price,className:`font-bold py-1 px-3 rounded transition-colors text-xs ${o[f.id]?"bg-health-full text-white":"bg-uncommon hover:bg-rare disabled:bg-rpg-secondary disabled:bg-opacity-50 disabled:cursor-not-allowed text-rpg-text"}`,"data-item-id":f.id,children:o[f.id]||`${f.price} G`})]})]},f.id))}),a?b.jsx(An,{className:"text-uncommon",children:ee("shop.thankYou")}):b.jsx(ol,{onClick:t,className:"w-full bg-health-full hover:bg-health-mid",children:ee("shop.leave")})]})})}function TD({victory:e,results:t,battleContext:r,onContinue:n}){gd.useEffect(()=>{de.log(`Rendering OutcomeScreen. Victory: ${e}`,"UI")},[e]);const a=U.current.currentRunSouls,i=ee(e?"combat.victory":"combat.defeat"),o=e?"text-uncommon":"text-health-full",u=gd.useMemo(()=>r?e?vd.getVictoryText(r.duration,r.isBoss):vd.getDefeatText():null,[e,r]);return b.jsx(PT,{children:b.jsxs(CT,{className:"flex flex-col justify-between text-center space-y-4",children:[b.jsx(Xu,{className:o,children:i}),u&&b.jsx("div",{className:"animate-fade-in",children:b.jsx("div",{className:`bg-gradient-to-r ${e?"from-transparent via-uncommon/20 to-transparent border-uncommon":"from-transparent via-health-full/20 to-transparent border-health-full"} p-3 rounded-lg border-l-4 border-r-4`,children:b.jsx(Za,{className:`italic ${e?"text-uncommon":"text-health-full"}`,children:u})})}),e&&b.jsxs("div",{className:"space-y-2",children:[b.jsx(An,{large:!0,children:ee("combat.victorious")}),b.jsxs(An,{children:[ee("combat.goldAcquired")," ",b.jsxs("span",{className:"text-legendary font-bold",children:["+",t.gold]})]}),b.jsxs(An,{children:[ee("combat.experienceGained")," ",b.jsxs("span",{className:"text-mana-light font-bold",children:["+",t.xp]})]}),b.jsxs(An,{children:[ee("souls.earned")," ",b.jsxs("span",{className:"text-epic font-bold",children:["👻 ",a]})]})]}),!e&&b.jsxs("div",{className:"space-y-2",children:[b.jsx(An,{children:ee("combat.journeyEnds")}),b.jsxs(An,{children:[ee("combat.goldLost")," ",b.jsxs("span",{className:"text-health-full font-bold",children:["-",t.goldLost," (",t.goldKept," ",ee("combat.remaining"),")"]})]}),b.jsxs(An,{children:[ee("souls.earned")," ",b.jsxs("span",{className:"text-epic font-bold",children:["👻 ",a]})]}),b.jsx(Za,{className:"text-epic",children:ee("souls.kept")})]}),b.jsx(ol,{onClick:n,className:"w-full",children:ee(e?"combat.continue":"combat.returnToMenu")})]})})}function AD({characterId:e,slotNumber:t,onClose:r}){const[n,a]=_.useState(0),i=U.getCharacterSouls(e,t),o=U.getCharacterLevel(e,t),u=U.getSoulUpgrades(e,o),c=U.getCharacterUpgrades(e,t),f=m=>{const v=U.getCharacterSouls(e,t),x=u[m].cost,y=c[m];de.log(`Purchase attempt: ${m}, Souls: ${v}, Cost: ${x}, Owned: ${y}`,"UI"),U.purchaseCharacterUpgrade(e,t,m)?(de.log(`Successfully purchased ${u[m].nameKey} for ${e} slot ${t}`,"UI"),a(S=>S+1)):de.log(`Cannot purchase ${u[m].nameKey} - insufficient souls or already owned`,"UI")},d=m=>c[m]?"owned":i>=u[m].cost?"available":"locked",p=m=>{switch(m){case"owned":return"bg-uncommon text-rpg-text cursor-default";case"available":return"bg-rpg-primary hover:bg-rpg-secondary text-rpg-text cursor-pointer";case"locked":return"bg-rpg-secondary bg-opacity-50 text-rpg-text opacity-50 cursor-not-allowed";default:return""}};return b.jsx("div",{className:"fixed inset-0 bg-rpg-bg-darkest/90 flex items-center justify-center z-[100] p-4",children:b.jsxs("div",{className:"bg-rpg-bg-darker border-2 border-epic rounded-lg p-4 max-w-md w-full max-h-[80vh] overflow-y-auto shadow-2xl backdrop-blur-sm",children:[b.jsxs("div",{className:"flex justify-between items-start mb-4",children:[b.jsxs("h1",{className:"text-2xl font-bold text-epic",children:["⚡ ",ee("souls.forge")]}),b.jsxs("div",{className:"text-center",children:[b.jsx("p",{className:"text-sm text-epic",children:ee(`characters.${e}.name`)}),b.jsxs("p",{className:"text-xs text-epic opacity-80",children:[ee("saveSlots.slot")," ",t]})]}),b.jsx("button",{onClick:r,className:"text-rpg-text opacity-70 hover:text-rpg-primary text-2xl font-bold",children:"×"})]}),b.jsxs("div",{className:"mb-4 text-center",children:[b.jsxs("div",{className:"text-xl font-bold text-epic",children:["👻 ",i," ",ee("souls.heroSouls")]}),b.jsx("div",{className:"text-xs text-rpg-text opacity-70 mt-1",children:ee("souls.permanentUpgrades")})]}),b.jsx("div",{className:"space-y-3",children:Object.entries(u).map(([m,v])=>{const x=d(m),y=x==="owned",S=x==="available";return b.jsxs("div",{className:"bg-rpg-bg-darker bg-opacity-60 rounded-lg p-3 border border-rpg-secondary backdrop-blur-sm",children:[b.jsxs("div",{className:"flex justify-between items-start mb-1",children:[b.jsx("h3",{className:"text-sm font-bold text-rpg-text",children:ee(`upgrades.${m}.name`)}),b.jsx("div",{className:"text-epic font-bold text-sm",children:y?"✓":`${v.cost} 👻`})]}),b.jsx("p",{className:"text-rpg-text opacity-80 text-xs mb-2",children:ee(`upgrades.${m}.description`)}),b.jsx("button",{onClick:()=>S&&f(m),disabled:!S,className:`w-full py-1 px-3 rounded font-bold text-sm transition-colors ${p(x)}`,children:y?ee("souls.owned"):S?ee("souls.purchase"):ee("souls.needSouls",{cost:v.cost})})]},m)})}),b.jsx("div",{className:"mt-4 text-center",children:b.jsx("button",{onClick:r,className:"bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm",children:ee("saveSlots.back")})}),b.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:ee("souls.earnDescription")})]})})}function kD({reward:e,onClose:t}){if(!e)return null;const r=a=>{if(e.icon)return e.icon;switch(a){case"gold":return"💰";case"blessing":return"✨";case"item":return"🎁";default:return"⭐"}},n=a=>{if(e.title)return e.title;switch(a){case"gold":return ee("rewards.goldFound");case"blessing":return ee("rewards.blessingReceived");case"item":return ee("rewards.itemFound");default:return ee("rewards.reward")}};return b.jsx("div",{className:"fixed inset-0 bg-rpg-bg-darkest/60 flex items-center justify-center z-[200] p-4",children:b.jsxs("div",{className:"bg-rpg-bg-darker border-2 border-rpg-primary rounded-lg p-6 max-w-sm w-full text-center shadow-2xl animate-pulse backdrop-blur-sm",children:[b.jsx("div",{className:"text-6xl mb-4",children:r(e.type)}),b.jsx("h2",{className:"text-2xl font-bold text-rpg-primary mb-4",children:n(e.type)}),b.jsx("div",{className:"text-lg text-rpg-text mb-6",children:e.message}),b.jsx("button",{onClick:t,className:"w-full bg-rpg-primary hover:bg-rpg-secondary text-rpg-text font-bold py-3 px-4 rounded-lg text-xl transition-transform transform hover:scale-105",children:ee("rewards.continue")})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xd={};xd.version="0.18.5";var RT=1252,OD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],IT=function(e){OD.indexOf(e)!=-1&&(RT=e)};function PD(){IT(1252)}var Du=function(e){IT(e)};function CD(){Du(1200),PD()}var jf=function(t){return String.fromCharCode(t)},jS=function(t){return String.fromCharCode(t)},wd,zi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mu(e){for(var t="",r=0,n=0,a=0,i=0,o=0,u=0,c=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),u=(n&15)<<2|a>>6,c=a&63,isNaN(n)?u=c=64:isNaN(a)&&(c=64),t+=zi.charAt(i)+zi.charAt(o)+zi.charAt(u)+zi.charAt(c);return t}function Ja(e){var t="",r=0,n=0,a=0,i=0,o=0,u=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=zi.indexOf(e.charAt(f++)),o=zi.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),u=zi.indexOf(e.charAt(f++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),c=zi.indexOf(e.charAt(f++)),a=(u&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),si=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Bs(e){return mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function LS(e){return mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var da=function(t){return mt?si(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function y0(e){if(typeof ArrayBuffer>"u")return da(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Qu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function ND(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Rr=mt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:si(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function DD(e){for(var t=[],r=0,n=e.length+250,a=Bs(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Bs(65535),n=65530)}return t.push(a.slice(0,r)),Rr(t)}var Tu=/\u0000/g,Lf=/[\u0001-\u0006]/g;function Ko(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ma(e,t){var r=""+e;return r.length>=t?r:Yt("0",t-r.length)+r}function Iv(e,t){var r=""+e;return r.length>=t?r:Yt(" ",t-r.length)+r}function Sd(e,t){var r=""+e;return r.length>=t?r:r+Yt(" ",t-r.length)}function MD(e,t){var r=""+Math.round(e);return r.length>=t?r:Yt("0",t-r.length)+r}function RD(e,t){var r=""+e;return r.length>=t?r:Yt("0",t-r.length)+r}var BS=Math.pow(2,32);function Do(e,t){if(e>BS||e<-BS)return MD(e,t);var r=Math.round(e);return RD(r,t)}function bd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $S=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ID(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},US={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ed(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,u=0,c=1,f=0,d=0,p=Math.floor(a);f<t&&(p=Math.floor(a),u=p*o+i,d=p*f+c,!(a-p<5e-8));)a=1/(a-p),i=o,o=u,c=f,f=d;if(d>t&&(f>t?(d=c,u=i):(d=f,u=o)),!r)return[0,n*u,d];var m=Math.floor(n*u/d);return[m,n*u-m*d,d]}function Bf(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],u={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=zD(c,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var FT=new Date(1899,11,31,0,0,0),jD=FT.getTime(),LD=new Date(1900,2,1,0,0,0);function jT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=LD&&(r+=1440*60*1e3),(r-(jD+(e.getTimezoneOffset()-FT.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Fv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function BD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function $D(e){var t=e<0?12:11,r=Fv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function UD(e){var t=Fv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function WD(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=$D(e):t===10?r=e.toFixed(10).substr(0,12):r=UD(e),Fv(BD(r.toUpperCase()))}function Fg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):WD(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Vi(14,jT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function zD(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function KD(e,t,r,n){var a="",i=0,o=0,u=r.y,c,f=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:c=u%100,f=2;break;default:c=u%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,f=t.length;break;case 3:return qp[r.m-1][1];case 5:return qp[r.m-1][0];default:return qp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,f=t.length;break;case 3:return $S[r.q][0];default:return $S[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ma(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=ma(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:c=u,f=1;break}var d=f>0?ma(c,f):"";return d}function Ki(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var LT=/%/g;function HD(e,t,r){var n=t.replace(LT,""),a=t.length-n.length;return Ga(e,n,r*Math.pow(10,2*a))+Yt("%",a)}function VD(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function BT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+BT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,c,f,d){return c+f+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $T=/# (\?+)( ?)\/( ?)(\d+)/;function GD(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Yt(" ",e[1].length+1+e[4].length):Iv(o,e[1].length)+e[2]+"/"+e[3]+ma(u,e[4].length))}function YD(e,t,r){return r+(t===0?"":""+t)+Yt(" ",e[1].length+2+e[4].length)}var UT=/^#*0*\.([0#]+)/,WT=/\).*[0#]/,zT=/\(###\) ###\\?-####/;function Zr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function WS(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function zS(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qD(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function XD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(WT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vn("n",n,r):"("+Vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return VD(e,t,r);if(t.indexOf("%")!==-1)return HD(e,t,r);if(t.indexOf("E")!==-1)return BT(t,r);if(t.charCodeAt(0)===36)return"$"+Vn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,u,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Do(c,t.length);if(t.match(/^[#?]+$/))return a=Do(r,0),a==="0"&&(a=""),a.length>t.length?a:Zr(t.substr(0,t.length-a.length))+a;if(i=t.match($T))return GD(i,c,f);if(t.match(/^#+0+$/))return f+Do(c,t.length-t.indexOf("0"));if(i=t.match(UT))return a=WS(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Zr(i[1])).replace(/\.$/,"."+Zr(i[1])).replace(/\.(\d*)$/,function(x,y){return"."+y+Yt("0",Zr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+WS(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+Ki(Do(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vn(e,t,-r):Ki(""+(Math.floor(r)+qD(r,i[1].length)))+"."+ma(zS(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Vn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ko(Vn(e,t.replace(/[\\-]/g,""),r)),o=0,Ko(Ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(zT))return a=Vn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Ed(c,Math.pow(10,o)-1,!1),a=""+f,d=Ga("n",i[1],u[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Sd(u[2],o),d.length<i[4].length&&(d=Zr(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Ed(c,Math.pow(10,o)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Iv(u[1],o)+i[2]+"/"+i[3]+Sd(u[2],o):Yt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Do(r,0),t.length<=a.length?a:Zr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var p=t.indexOf(".")-o,m=t.length-a.length-p;return Zr(t.substr(0,p)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=zS(r,i[1].length),r<0?"-"+Vn(e,t,-r):Ki(XD(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ma(0,3-x.length):"")+x})+"."+ma(o,i[1].length);switch(t){case"###,##0.00":return Vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Ki(Do(c,0));return v!=="0"?f+v:"";case"###,###.00":return Vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function QD(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ga(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ZD(e,t,r){var n=t.replace(LT,""),a=t.length-n.length;return Ga(e,n,r*Math.pow(10,2*a))+Yt("%",a)}function KT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+KT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,c,f,d){return c+f+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(WT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_a("n",n,r):"("+_a("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return QD(e,t,r);if(t.indexOf("%")!==-1)return ZD(e,t,r);if(t.indexOf("E")!==-1)return KT(t,r);if(t.charCodeAt(0)===36)return"$"+_a(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,u,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ma(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Zr(t.substr(0,t.length-a.length))+a;if(i=t.match($T))return YD(i,c,f);if(t.match(/^#+0+$/))return f+ma(c,t.length-t.indexOf("0"));if(i=t.match(UT))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Zr(i[1])).replace(/\.$/,"."+Zr(i[1])),a=a.replace(/\.(\d*)$/,function(x,y){return"."+y+Yt("0",Zr(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+Ki(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_a(e,t,-r):Ki(""+r)+"."+Yt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return _a(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ko(_a(e,t.replace(/[\\-]/g,""),r)),o=0,Ko(Ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(zT))return a=_a(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Ed(c,Math.pow(10,o)-1,!1),a=""+f,d=Ga("n",i[1],u[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Sd(u[2],o),d.length<i[4].length&&(d=Zr(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Ed(c,Math.pow(10,o)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Iv(u[1],o)+i[2]+"/"+i[3]+Sd(u[2],o):Yt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Zr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var p=t.indexOf(".")-o,m=t.length-a.length-p;return Zr(t.substr(0,p)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_a(e,t,-r):Ki(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ma(0,3-x.length):"")+x})+"."+ma(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Ki(""+c);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return _a(e,t.slice(0,t.lastIndexOf(".")),r)+Zr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ga(e,t,r){return(r|0)===r?_a(e,t,r):Vn(e,t,r)}function JD(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var HT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function VT(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":bd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(HT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function eM(e,t,r,n){for(var a=[],i="",o=0,u="",c="t",f,d,p,m="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!bd(e,o))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(p=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++o;break;case"\\":var v=e.charAt(++o),x=v==="("||v===")"?v:"t";a[a.length]={t:x,v},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=Bf(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Bf(t,r),f==null))return"";for(i=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&c.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=m),a[a.length]={t:u,v:i},c=u;break;case"A":case"a":case"上":var y={t:u,v:u};if(f==null&&(f=Bf(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(f!=null&&(y.v=f.H>=12?"下午":"上午"),y.t="T",o+=5,m="h"):(y.t="t",++o),f==null&&y.t==="T")return"";a[a.length]=y,c=u;break;case"[":for(i=u;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(HT)){if(f==null&&(f=Bf(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",VT(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=u;++o<e.length&&(u=e.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;e.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},c=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++o;break}var S=0,T=0,k;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=m,c="h",S<1&&(S=1);break;case"s":(k=a[o].v.match(/\.0+$/))&&(T=Math.max(T,k[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[o].v.match(/[Hh]/)&&(S=1),S<2&&a[o].v.match(/[Mm]/)&&(S=2),S<3&&a[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var A="",P;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=KD(a[o].t.charCodeAt(0),a[o].v,f,T),a[o].t="t";break;case"n":case"?":for(P=o+1;a[P]!=null&&((u=a[P].t)==="?"||u==="D"||(u===" "||u==="t")&&a[P+1]!=null&&(a[P+1].t==="?"||a[P+1].t==="t"&&a[P+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[P].v==="/"||a[P].v===" "&&a[P+1]!=null&&a[P+1].t=="?"));)a[o].v+=a[P].v,a[P]={v:"",t:";"},++P;A+=a[o].v,o=P-1;break;case"G":a[o].t="t",a[o].v=Fg(t,r);break}var N="",I,D;if(A.length>0){A.charCodeAt(0)==40?(I=t<0&&A.charCodeAt(0)===45?-t:t,D=Ga("n",A,I)):(I=t<0&&n>1?-t:t,D=Ga("n",A,I),I<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),P=D.length-1;var z=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){z=o;break}var H=a.length;if(z===a.length&&D.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(P>=a[o].v.length-1?(P-=a[o].v.length,a[o].v=D.substr(P+1,a[o].v.length)):P<0?a[o].v="":(a[o].v=D.substr(0,P+1),P=-1),a[o].t="t",H=o);P>=0&&H<a.length&&(a[H].v=D.substr(0,P+1)+a[H].v)}else if(z!==a.length&&D.indexOf("E")===-1){for(P=D.indexOf(".")-1,o=z;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===z?a[o].v.indexOf(".")-1:a[o].v.length-1,N=a[o].v.substr(d+1);d>=0;--d)P>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(N=D.charAt(P--)+N);a[o].v=N,a[o].t="t",H=o}for(P>=0&&H<a.length&&(a[H].v=D.substr(0,P+1)+a[H].v),P=D.indexOf(".")+1,o=z;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==z)){for(d=a[o].v.indexOf(".")>-1&&o===z?a[o].v.indexOf(".")+1:0,N=a[o].v.substr(0,d);d<a[o].v.length;++d)P<D.length&&(N+=D.charAt(P++));a[o].v=N,a[o].t="t",H=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(I=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Ga(a[o].t,a[o].v,I),a[o].t="t");var te="";for(o=0;o!==a.length;++o)a[o]!=null&&(te+=a[o].v);return te}var KS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function HS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function tM(e,t){var r=JD(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(KS),u=r[1].match(KS);return HS(t,o)?[n,r[0]]:HS(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function Vi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Xt)[e],n==null&&(n=r.table&&r.table[US[e]]||Xt[US[e]]),n==null&&(n=FD[e]||"General");break}if(bd(n,0))return Fg(t,r);t instanceof Date&&(t=jT(t,r.date1904));var a=tM(n,t);if(bd(a[1]))return Fg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return eM(a[1],t,r,a[0])}function GT(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Xt[r]==null){t<0&&(t=r);continue}if(Xt[r]==e){t=r;break}}t<0&&(t=391)}return Xt[t]=e,t}function x0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&GT(e[t],t)}function w0(){Xt=ID()}var YT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function rM(e){var t=typeof e=="number"?Xt[e]:e;return t=t.replace(YT,"(\\d+)"),new RegExp("^"+t+"$")}function nM(e,t,r){var n=-1,a=-1,i=-1,o=-1,u=-1,c=-1;(t.match(YT)||[]).forEach(function(p,m){var v=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":o=v;break;case"s":c=v;break;case"m":o>=0?u=v:a=v;break}}),c>=0&&u==-1&&a>=0&&(u=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&u==-1&&c==-1?f:n==-1&&a==-1&&i==-1?d:f+"T"+d}var aM=function(){var e={};e.version="1.2.0";function t(){for(var D=0,z=new Array(256),H=0;H!=256;++H)D=H,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,z[H]=D;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(D){var z=0,H=0,te=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)q[te]=D[te];for(te=0;te!=256;++te)for(H=D[te],z=256+te;z<4096;z+=256)H=q[z]=H>>>8^D[H&255];var V=[];for(te=1;te!=16;++te)V[te-1]=typeof Int32Array<"u"?q.subarray(te*256,te*256+256):q.slice(te*256,te*256+256);return V}var a=n(r),i=a[0],o=a[1],u=a[2],c=a[3],f=a[4],d=a[5],p=a[6],m=a[7],v=a[8],x=a[9],y=a[10],S=a[11],T=a[12],k=a[13],A=a[14];function P(D,z){for(var H=z^-1,te=0,q=D.length;te<q;)H=H>>>8^r[(H^D.charCodeAt(te++))&255];return~H}function N(D,z){for(var H=z^-1,te=D.length-15,q=0;q<te;)H=A[D[q++]^H&255]^k[D[q++]^H>>8&255]^T[D[q++]^H>>16&255]^S[D[q++]^H>>>24]^y[D[q++]]^x[D[q++]]^v[D[q++]]^m[D[q++]]^p[D[q++]]^d[D[q++]]^f[D[q++]]^c[D[q++]]^u[D[q++]]^o[D[q++]]^i[D[q++]]^r[D[q++]];for(te+=15;q<te;)H=H>>>8^r[(H^D[q++])&255];return~H}function I(D,z){for(var H=z^-1,te=0,q=D.length,V=0,ae=0;te<q;)V=D.charCodeAt(te++),V<128?H=H>>>8^r[(H^V)&255]:V<2048?(H=H>>>8^r[(H^(192|V>>6&31))&255],H=H>>>8^r[(H^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ae=D.charCodeAt(te++)&1023,H=H>>>8^r[(H^(240|V>>8&7))&255],H=H>>>8^r[(H^(128|V>>2&63))&255],H=H>>>8^r[(H^(128|ae>>6&15|(V&3)<<4))&255],H=H>>>8^r[(H^(128|ae&63))&255]):(H=H>>>8^r[(H^(224|V>>12&15))&255],H=H>>>8^r[(H^(128|V>>6&63))&255],H=H>>>8^r[(H^(128|V&63))&255]);return~H}return e.table=r,e.bstr=P,e.buf=N,e.str=I,e}(),_t=function(){var t={};t.version="1.2.1";function r(C,j){for(var R=C.split("/"),F=j.split("/"),L=0,B=0,oe=Math.min(R.length,F.length);L<oe;++L){if(B=R[L].length-F[L].length)return B;if(R[L]!=F[L])return R[L]<F[L]?-1:1}return R.length-F.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(0,j+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var j=C.lastIndexOf("/");return j===-1?C:C.slice(j+1)}function i(C,j){typeof j=="string"&&(j=new Date(j));var R=j.getHours();R=R<<6|j.getMinutes(),R=R<<5|j.getSeconds()>>>1,C.write_shift(2,R);var F=j.getFullYear()-1980;F=F<<4|j.getMonth()+1,F=F<<5|j.getDate(),C.write_shift(2,F)}function o(C){var j=C.read_shift(2)&65535,R=C.read_shift(2)&65535,F=new Date,L=R&31;R>>>=5;var B=R&15;R>>>=4,F.setMilliseconds(0),F.setFullYear(R+1980),F.setMonth(B-1),F.setDate(L);var oe=j&31;j>>>=5;var xe=j&63;return j>>>=6,F.setHours(j),F.setMinutes(xe),F.setSeconds(oe<<1),F}function u(C){kn(C,0);for(var j={},R=0;C.l<=C.length-4;){var F=C.read_shift(2),L=C.read_shift(2),B=C.l+L,oe={};switch(F){case 21589:R=C.read_shift(1),R&1&&(oe.mtime=C.read_shift(4)),L>5&&(R&2&&(oe.atime=C.read_shift(4)),R&4&&(oe.ctime=C.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}C.l=B,j[F]=oe}return j}var c;function f(){return c||(c={})}function d(C,j){if(C[0]==80&&C[1]==75)return so(C,j);if((C[0]|32)==109&&(C[1]|32)==105)return Cc(C,j);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var R=3,F=512,L=0,B=0,oe=0,xe=0,se=0,ue=[],ce=C.slice(0,512);kn(ce,0);var Pe=p(ce);switch(R=Pe[0],R){case 3:F=512;break;case 4:F=4096;break;case 0:if(Pe[1]==0)return so(C,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}F!==512&&(ce=C.slice(0,F),kn(ce,28));var je=C.slice(0,F);m(ce,R);var $e=ce.read_shift(4,"i");if(R===3&&$e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+$e);ce.l+=4,oe=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),xe=ce.read_shift(4,"i"),L=ce.read_shift(4,"i"),se=ce.read_shift(4,"i"),B=ce.read_shift(4,"i");for(var Me=-1,De=0;De<109&&(Me=ce.read_shift(4,"i"),!(Me<0));++De)ue[De]=Me;var nt=v(C,F);S(se,B,nt,F,ue);var Tt=k(nt,oe,ue,F);Tt[oe].name="!Directory",L>0&&xe!==ae&&(Tt[xe].name="!MiniFAT"),Tt[ue[0]].name="!FAT",Tt.fat_addrs=ue,Tt.ssz=F;var kt={},Qt=[],us=[],vi=[];A(oe,Tt,nt,Qt,L,kt,us,xe),x(us,vi,Qt),Qt.shift();var xa={FileIndex:us,FullPaths:vi};return j&&j.raw&&(xa.raw={header:je,sectors:nt}),xa}function p(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Ee,"Header Signature: "),C.l+=16;var j=C.read_shift(2,"u");return[C.read_shift(2,"u"),j]}function m(C,j){var R=9;switch(C.l+=2,R=C.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function v(C,j){for(var R=Math.ceil(C.length/j)-1,F=[],L=1;L<R;++L)F[L-1]=C.slice(L*j,(L+1)*j);return F[R-1]=C.slice(R*j),F}function x(C,j,R){for(var F=0,L=0,B=0,oe=0,xe=0,se=R.length,ue=[],ce=[];F<se;++F)ue[F]=ce[F]=F,j[F]=R[F];for(;xe<ce.length;++xe)F=ce[xe],L=C[F].L,B=C[F].R,oe=C[F].C,ue[F]===F&&(L!==-1&&ue[L]!==L&&(ue[F]=ue[L]),B!==-1&&ue[B]!==B&&(ue[F]=ue[B])),oe!==-1&&(ue[oe]=F),L!==-1&&F!=ue[F]&&(ue[L]=ue[F],ce.lastIndexOf(L)<xe&&ce.push(L)),B!==-1&&F!=ue[F]&&(ue[B]=ue[F],ce.lastIndexOf(B)<xe&&ce.push(B));for(F=1;F<se;++F)ue[F]===F&&(B!==-1&&ue[B]!==B?ue[F]=ue[B]:L!==-1&&ue[L]!==L&&(ue[F]=ue[L]));for(F=1;F<se;++F)if(C[F].type!==0){if(xe=F,xe!=ue[xe])do xe=ue[xe],j[F]=j[xe]+"/"+j[F];while(xe!==0&&ue[xe]!==-1&&xe!=ue[xe]);ue[F]=-1}for(j[0]+="/",F=1;F<se;++F)C[F].type!==2&&(j[F]+="/")}function y(C,j,R){for(var F=C.start,L=C.size,B=[],oe=F;R&&L>0&&oe>=0;)B.push(j.slice(oe*V,oe*V+V)),L-=V,oe=ks(R,oe*4);return B.length===0?ve(0):Rr(B).slice(0,C.size)}function S(C,j,R,F,L){var B=ae;if(C===ae){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var oe=R[C],xe=(F>>>2)-1;if(!oe)return;for(var se=0;se<xe&&(B=ks(oe,se*4))!==ae;++se)L.push(B);S(ks(oe,F-4),j-1,R,F,L)}}function T(C,j,R,F,L){var B=[],oe=[];L||(L=[]);var xe=F-1,se=0,ue=0;for(se=j;se>=0;){L[se]=!0,B[B.length]=se,oe.push(C[se]);var ce=R[Math.floor(se*4/F)];if(ue=se*4&xe,F<4+ue)throw new Error("FAT boundary crossed: "+se+" 4 "+F);if(!C[ce])break;se=ks(C[ce],ue)}return{nodes:B,data:JS([oe])}}function k(C,j,R,F){var L=C.length,B=[],oe=[],xe=[],se=[],ue=F-1,ce=0,Pe=0,je=0,$e=0;for(ce=0;ce<L;++ce)if(xe=[],je=ce+j,je>=L&&(je-=L),!oe[je]){se=[];var Me=[];for(Pe=je;Pe>=0;){Me[Pe]=!0,oe[Pe]=!0,xe[xe.length]=Pe,se.push(C[Pe]);var De=R[Math.floor(Pe*4/F)];if($e=Pe*4&ue,F<4+$e)throw new Error("FAT boundary crossed: "+Pe+" 4 "+F);if(!C[De]||(Pe=ks(C[De],$e),Me[Pe]))break}B[je]={nodes:xe,data:JS([se])}}return B}function A(C,j,R,F,L,B,oe,xe){for(var se=0,ue=F.length?2:0,ce=j[C].data,Pe=0,je=0,$e;Pe<ce.length;Pe+=128){var Me=ce.slice(Pe,Pe+128);kn(Me,64),je=Me.read_shift(2),$e=Uv(Me,0,je-ue),F.push($e);var De={name:$e,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},nt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);nt!==0&&(De.ct=P(Me,Me.l-8));var Tt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Tt!==0&&(De.mt=P(Me,Me.l-8)),De.start=Me.read_shift(4,"i"),De.size=Me.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=ae,De.name=""),De.type===5?(se=De.start,L>0&&se!==ae&&(j[se].name="!StreamData")):De.size>=4096?(De.storage="fat",j[De.start]===void 0&&(j[De.start]=T(R,De.start,j.fat_addrs,j.ssz)),j[De.start].name=De.name,De.content=j[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:se!==ae&&De.start!==ae&&j[se]&&(De.content=y(De,j[se].data,(j[xe]||{}).data))),De.content&&kn(De.content,0),B[$e]=De,oe.push(De)}}function P(C,j){return new Date((Cn(C,j+4)/1e7*Math.pow(2,32)+Cn(C,j)/1e7-11644473600)*1e3)}function N(C,j){return f(),d(c.readFileSync(C),j)}function I(C,j){var R=j&&j.type;switch(R||mt&&Buffer.isBuffer(C)&&(R="buffer"),R||"base64"){case"file":return N(C,j);case"base64":return d(da(Ja(C)),j);case"binary":return d(da(C),j)}return d(C,j)}function D(C,j){var R=j||{},F=R.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),R.CLSID&&(C.FileIndex[0].clsid=R.CLSID),z(C)}function z(C){var j="Sh33tJ5";if(!_t.find(C,"/"+j)){var R=ve(4);R[0]=55,R[1]=R[3]=50,R[2]=54,C.FileIndex.push({name:j,type:2,content:R,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+j),H(C)}}function H(C,j){D(C);for(var R=!1,F=!1,L=C.FullPaths.length-1;L>=0;--L){var B=C.FileIndex[L];switch(B.type){case 0:F?R=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(B.R*B.L*B.C)&&(R=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!j)){var oe=new Date(1987,1,19),xe=0,se=Object.create?Object.create(null):{},ue=[];for(L=0;L<C.FullPaths.length;++L)se[C.FullPaths[L]]=!0,C.FileIndex[L].type!==0&&ue.push([C.FullPaths[L],C.FileIndex[L]]);for(L=0;L<ue.length;++L){var ce=n(ue[L][0]);F=se[ce],F||(ue.push([ce,{name:a(ce).replace("/",""),type:1,clsid:Te,ct:oe,mt:oe,content:null}]),se[ce]=!0)}for(ue.sort(function($e,Me){return r($e[0],Me[0])}),C.FullPaths=[],C.FileIndex=[],L=0;L<ue.length;++L)C.FullPaths[L]=ue[L][0],C.FileIndex[L]=ue[L][1];for(L=0;L<ue.length;++L){var Pe=C.FileIndex[L],je=C.FullPaths[L];if(Pe.name=a(je).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||Te,L===0)Pe.C=ue.length>1?1:-1,Pe.size=0,Pe.type=5;else if(je.slice(-1)=="/"){for(xe=L+1;xe<ue.length&&n(C.FullPaths[xe])!=je;++xe);for(Pe.C=xe>=ue.length?-1:xe,xe=L+1;xe<ue.length&&n(C.FullPaths[xe])!=n(je);++xe);Pe.R=xe>=ue.length?-1:xe,Pe.type=1}else n(C.FullPaths[L+1]||"")==n(je)&&(Pe.R=L+1),Pe.type=2}}}function te(C,j){var R=j||{};if(R.fileType=="mad")return os(C,R);switch(H(C),R.fileType){case"zip":return gi(C,R)}var F=function($e){for(var Me=0,De=0,nt=0;nt<$e.FileIndex.length;++nt){var Tt=$e.FileIndex[nt];if(Tt.content){var kt=Tt.content.length;kt>0&&(kt<4096?Me+=kt+63>>6:De+=kt+511>>9)}}for(var Qt=$e.FullPaths.length+3>>2,us=Me+7>>3,vi=Me+127>>7,xa=us+De+Qt+vi,vr=xa+127>>7,Pl=vr<=109?0:Math.ceil((vr-109)/127);xa+vr+Pl+127>>7>vr;)Pl=++vr<=109?0:Math.ceil((vr-109)/127);var Zt=[1,Pl,vr,vi,Qt,De,Me,0];return $e.FileIndex[0].size=Me<<6,Zt[7]=($e.FileIndex[0].start=Zt[0]+Zt[1]+Zt[2]+Zt[3]+Zt[4]+Zt[5])+(Zt[6]+7>>3),Zt}(C),L=ve(F[7]<<9),B=0,oe=0;{for(B=0;B<8;++B)L.write_shift(1,Z[B]);for(B=0;B<8;++B)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),B=0;B<3;++B)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:ae),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:ae),L.write_shift(4,F[1]),B=0;B<109;++B)L.write_shift(-4,B<F[2]?F[1]+B:-1)}if(F[1])for(oe=0;oe<F[1];++oe){for(;B<236+oe*127;++B)L.write_shift(-4,B<F[2]?F[1]+B:-1);L.write_shift(-4,oe===F[1]-1?ae:oe+1)}var xe=function($e){for(oe+=$e;B<oe-1;++B)L.write_shift(-4,B+1);$e&&(++B,L.write_shift(-4,ae))};for(oe=B=0,oe+=F[1];B<oe;++B)L.write_shift(-4,Se.DIFSECT);for(oe+=F[2];B<oe;++B)L.write_shift(-4,Se.FATSECT);xe(F[3]),xe(F[4]);for(var se=0,ue=0,ce=C.FileIndex[0];se<C.FileIndex.length;++se)ce=C.FileIndex[se],ce.content&&(ue=ce.content.length,!(ue<4096)&&(ce.start=oe,xe(ue+511>>9)));for(xe(F[6]+7>>3);L.l&511;)L.write_shift(-4,Se.ENDOFCHAIN);for(oe=B=0,se=0;se<C.FileIndex.length;++se)ce=C.FileIndex[se],ce.content&&(ue=ce.content.length,!(!ue||ue>=4096)&&(ce.start=oe,xe(ue+63>>6)));for(;L.l&511;)L.write_shift(-4,Se.ENDOFCHAIN);for(B=0;B<F[4]<<2;++B){var Pe=C.FullPaths[B];if(!Pe||Pe.length===0){for(se=0;se<17;++se)L.write_shift(4,0);for(se=0;se<3;++se)L.write_shift(4,-1);for(se=0;se<12;++se)L.write_shift(4,0);continue}ce=C.FileIndex[B],B===0&&(ce.start=ce.size?ce.start-1:ae);var je=B===0&&R.root||ce.name;if(ue=2*(je.length+1),L.write_shift(64,je,"utf16le"),L.write_shift(2,ue),L.write_shift(1,ce.type),L.write_shift(1,ce.color),L.write_shift(-4,ce.L),L.write_shift(-4,ce.R),L.write_shift(-4,ce.C),ce.clsid)L.write_shift(16,ce.clsid,"hex");else for(se=0;se<4;++se)L.write_shift(4,0);L.write_shift(4,ce.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ce.start),L.write_shift(4,ce.size),L.write_shift(4,0)}for(B=1;B<C.FileIndex.length;++B)if(ce=C.FileIndex[B],ce.size>=4096)if(L.l=ce.start+1<<9,mt&&Buffer.isBuffer(ce.content))ce.content.copy(L,L.l,0,ce.size),L.l+=ce.size+511&-512;else{for(se=0;se<ce.size;++se)L.write_shift(1,ce.content[se]);for(;se&511;++se)L.write_shift(1,0)}for(B=1;B<C.FileIndex.length;++B)if(ce=C.FileIndex[B],ce.size>0&&ce.size<4096)if(mt&&Buffer.isBuffer(ce.content))ce.content.copy(L,L.l,0,ce.size),L.l+=ce.size+63&-64;else{for(se=0;se<ce.size;++se)L.write_shift(1,ce.content[se]);for(;se&63;++se)L.write_shift(1,0)}if(mt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function q(C,j){var R=C.FullPaths.map(function(se){return se.toUpperCase()}),F=R.map(function(se){var ue=se.split("/");return ue[ue.length-(se.slice(-1)=="/"?2:1)]}),L=!1;j.charCodeAt(0)===47?(L=!0,j=R[0].slice(0,-1)+j):L=j.indexOf("/")!==-1;var B=j.toUpperCase(),oe=L===!0?R.indexOf(B):F.indexOf(B);if(oe!==-1)return C.FileIndex[oe];var xe=!B.match(Lf);for(B=B.replace(Tu,""),xe&&(B=B.replace(Lf,"!")),oe=0;oe<R.length;++oe)if((xe?R[oe].replace(Lf,"!"):R[oe]).replace(Tu,"")==B||(xe?F[oe].replace(Lf,"!"):F[oe]).replace(Tu,"")==B)return C.FileIndex[oe];return null}var V=64,ae=-2,Ee="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",Se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ae,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(C,j,R){f();var F=te(C,R);c.writeFileSync(j,F)}function we(C){for(var j=new Array(C.length),R=0;R<C.length;++R)j[R]=String.fromCharCode(C[R]);return j.join("")}function be(C,j){var R=te(C,j);switch(j&&j.type||"buffer"){case"file":return f(),c.writeFileSync(j.filename,R),R;case"binary":return typeof R=="string"?R:we(R);case"base64":return Mu(typeof R=="string"?R:we(R));case"buffer":if(mt)return Buffer.isBuffer(R)?R:si(R);case"array":return typeof R=="string"?da(R):R}return R}var X;function M(C){try{var j=C.InflateRaw,R=new j;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)X=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function J(C,j){if(!X)return ao(C,j);var R=X.InflateRaw,F=new R,L=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,L}function G(C){return X?X.deflateRawSync(C):hi(C)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(C){var j=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(j>>16|j>>8|j)&255}for(var re=typeof Uint8Array<"u",ye=re?new Uint8Array(256):[],Be=0;Be<256;++Be)ye[Be]=Ne(Be);function ge(C,j){var R=ye[C&255];return j<=8?R>>>8-j:(R=R<<8|ye[C>>8&255],j<=16?R>>>16-j:(R=R<<8|ye[C>>16&255],R>>>24-j))}function ot(C,j){var R=j&7,F=j>>>3;return(C[F]|(R<=6?0:C[F+1]<<8))>>>R&3}function ze(C,j){var R=j&7,F=j>>>3;return(C[F]|(R<=5?0:C[F+1]<<8))>>>R&7}function bt(C,j){var R=j&7,F=j>>>3;return(C[F]|(R<=4?0:C[F+1]<<8))>>>R&15}function at(C,j){var R=j&7,F=j>>>3;return(C[F]|(R<=3?0:C[F+1]<<8))>>>R&31}function pe(C,j){var R=j&7,F=j>>>3;return(C[F]|(R<=1?0:C[F+1]<<8))>>>R&127}function qe(C,j,R){var F=j&7,L=j>>>3,B=(1<<R)-1,oe=C[L]>>>F;return R<8-F||(oe|=C[L+1]<<8-F,R<16-F)||(oe|=C[L+2]<<16-F,R<24-F)||(oe|=C[L+3]<<24-F),oe&B}function Xe(C,j,R){var F=j&7,L=j>>>3;return F<=5?C[L]|=(R&7)<<F:(C[L]|=R<<F&255,C[L+1]=(R&7)>>8-F),j+3}function rt(C,j,R){var F=j&7,L=j>>>3;return R=(R&1)<<F,C[L]|=R,j+1}function lt(C,j,R){var F=j&7,L=j>>>3;return R<<=F,C[L]|=R&255,R>>>=8,C[L+1]=R,j+8}function Nt(C,j,R){var F=j&7,L=j>>>3;return R<<=F,C[L]|=R&255,R>>>=8,C[L+1]=R&255,C[L+2]=R>>>8,j+16}function Vt(C,j){var R=C.length,F=2*R>j?2*R:j+5,L=0;if(R>=j)return C;if(mt){var B=LS(F);if(C.copy)C.copy(B);else for(;L<C.length;++L)B[L]=C[L];return B}else if(re){var oe=new Uint8Array(F);if(oe.set)oe.set(C);else for(;L<R;++L)oe[L]=C[L];return oe}return C.length=F,C}function or(C){for(var j=new Array(C),R=0;R<C;++R)j[R]=0;return j}function gr(C,j,R){var F=1,L=0,B=0,oe=0,xe=0,se=C.length,ue=re?new Uint16Array(32):or(32);for(B=0;B<32;++B)ue[B]=0;for(B=se;B<R;++B)C[B]=0;se=C.length;var ce=re?new Uint16Array(se):or(se);for(B=0;B<se;++B)ue[L=C[B]]++,F<L&&(F=L),ce[B]=0;for(ue[0]=0,B=1;B<=F;++B)ue[B+16]=xe=xe+ue[B-1]<<1;for(B=0;B<se;++B)xe=C[B],xe!=0&&(ce[B]=ue[xe+16]++);var Pe=0;for(B=0;B<se;++B)if(Pe=C[B],Pe!=0)for(xe=ge(ce[B],F)>>F-Pe,oe=(1<<F+4-Pe)-1;oe>=0;--oe)j[xe|oe<<Pe]=Pe&15|B<<4;return F}var Da=re?new Uint16Array(512):or(512),Ma=re?new Uint16Array(32):or(32);if(!re){for(var sn=0;sn<512;++sn)Da[sn]=0;for(sn=0;sn<32;++sn)Ma[sn]=0}(function(){for(var C=[],j=0;j<32;j++)C.push(5);gr(C,Ma,32);var R=[];for(j=0;j<=143;j++)R.push(8);for(;j<=255;j++)R.push(9);for(;j<=279;j++)R.push(7);for(;j<=287;j++)R.push(8);gr(R,Da,288)})();var Ec=function(){for(var j=re?new Uint8Array(32768):[],R=0,F=0;R<Oe.length-1;++R)for(;F<Oe[R+1];++F)j[F]=R;for(;F<32768;++F)j[F]=29;var L=re?new Uint8Array(259):[];for(R=0,F=0;R<he.length-1;++R)for(;F<he[R+1];++F)L[F]=R;function B(xe,se){for(var ue=0;ue<xe.length;){var ce=Math.min(65535,xe.length-ue),Pe=ue+ce==xe.length;for(se.write_shift(1,+Pe),se.write_shift(2,ce),se.write_shift(2,~ce&65535);ce-- >0;)se[se.l++]=xe[ue++]}return se.l}function oe(xe,se){for(var ue=0,ce=0,Pe=re?new Uint16Array(32768):[];ce<xe.length;){var je=Math.min(65535,xe.length-ce);if(je<10){for(ue=Xe(se,ue,+(ce+je==xe.length)),ue&7&&(ue+=8-(ue&7)),se.l=ue/8|0,se.write_shift(2,je),se.write_shift(2,~je&65535);je-- >0;)se[se.l++]=xe[ce++];ue=se.l*8;continue}ue=Xe(se,ue,+(ce+je==xe.length)+2);for(var $e=0;je-- >0;){var Me=xe[ce];$e=($e<<5^Me)&32767;var De=-1,nt=0;if((De=Pe[$e])&&(De|=ce&-32768,De>ce&&(De-=32768),De<ce))for(;xe[De+nt]==xe[ce+nt]&&nt<250;)++nt;if(nt>2){Me=L[nt],Me<=22?ue=lt(se,ue,ye[Me+1]>>1)-1:(lt(se,ue,3),ue+=5,lt(se,ue,ye[Me-23]>>5),ue+=3);var Tt=Me<8?0:Me-4>>2;Tt>0&&(Nt(se,ue,nt-he[Me]),ue+=Tt),Me=j[ce-De],ue=lt(se,ue,ye[Me]>>3),ue-=3;var kt=Me<4?0:Me-2>>1;kt>0&&(Nt(se,ue,ce-De-Oe[Me]),ue+=kt);for(var Qt=0;Qt<nt;++Qt)Pe[$e]=ce&32767,$e=($e<<5^xe[ce])&32767,++ce;je-=nt-1}else Me<=143?Me=Me+48:ue=rt(se,ue,1),ue=lt(se,ue,ye[Me]),Pe[$e]=ce&32767,++ce}ue=lt(se,ue,0)-1}return se.l=(ue+7)/8|0,se.l}return function(se,ue){return se.length<8?B(se,ue):oe(se,ue)}}();function hi(C){var j=ve(50+Math.floor(C.length*1.1)),R=Ec(C,j);return j.slice(0,R)}var pi=re?new Uint16Array(32768):or(32768),_c=re?new Uint16Array(32768):or(32768),El=re?new Uint16Array(128):or(128),_l=1,Tc=1;function Tl(C,j){var R=at(C,j)+257;j+=5;var F=at(C,j)+1;j+=5;var L=bt(C,j)+4;j+=4;for(var B=0,oe=re?new Uint8Array(19):or(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,ue=re?new Uint8Array(8):or(8),ce=re?new Uint8Array(8):or(8),Pe=oe.length,je=0;je<L;++je)oe[K[je]]=B=ze(C,j),se<B&&(se=B),ue[B]++,j+=3;var $e=0;for(ue[0]=0,je=1;je<=se;++je)ce[je]=$e=$e+ue[je-1]<<1;for(je=0;je<Pe;++je)($e=oe[je])!=0&&(xe[je]=ce[$e]++);var Me=0;for(je=0;je<Pe;++je)if(Me=oe[je],Me!=0){$e=ye[xe[je]]>>8-Me;for(var De=(1<<7-Me)-1;De>=0;--De)El[$e|De<<Me]=Me&7|je<<3}var nt=[];for(se=1;nt.length<R+F;)switch($e=El[pe(C,j)],j+=$e&7,$e>>>=3){case 16:for(B=3+ot(C,j),j+=2,$e=nt[nt.length-1];B-- >0;)nt.push($e);break;case 17:for(B=3+ze(C,j),j+=3;B-- >0;)nt.push(0);break;case 18:for(B=11+pe(C,j),j+=7;B-- >0;)nt.push(0);break;default:nt.push($e),se<$e&&(se=$e);break}var Tt=nt.slice(0,R),kt=nt.slice(R);for(je=R;je<286;++je)Tt[je]=0;for(je=F;je<30;++je)kt[je]=0;return _l=gr(Tt,pi,286),Tc=gr(kt,_c,30),j}function Al(C,j){if(C[0]==3&&!(C[1]&3))return[Bs(j),2];for(var R=0,F=0,L=LS(j||1<<18),B=0,oe=L.length>>>0,xe=0,se=0;(F&1)==0;){if(F=ze(C,R),R+=3,F>>>1)F>>1==1?(xe=9,se=5):(R=Tl(C,R),xe=_l,se=Tc);else{R&7&&(R+=8-(R&7));var ue=C[R>>>3]|C[(R>>>3)+1]<<8;if(R+=32,ue>0)for(!j&&oe<B+ue&&(L=Vt(L,B+ue),oe=L.length);ue-- >0;)L[B++]=C[R>>>3],R+=8;continue}for(;;){!j&&oe<B+32767&&(L=Vt(L,B+32767),oe=L.length);var ce=qe(C,R,xe),Pe=F>>>1==1?Da[ce]:pi[ce];if(R+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)L[B++]=Pe;else{if(Pe==256)break;Pe-=257;var je=Pe<8?0:Pe-4>>2;je>5&&(je=0);var $e=B+he[Pe];je>0&&($e+=qe(C,R,je),R+=je),ce=qe(C,R,se),Pe=F>>>1==1?Ma[ce]:_c[ce],R+=Pe&15,Pe>>>=4;var Me=Pe<4?0:Pe-2>>1,De=Oe[Pe];for(Me>0&&(De+=qe(C,R,Me),R+=Me),!j&&oe<$e&&(L=Vt(L,$e+100),oe=L.length);B<$e;)L[B]=L[B-De],++B}}}return j?[L,R+7>>>3]:[L.slice(0,B),R+7>>>3]}function ao(C,j){var R=C.slice(C.l||0),F=Al(R,j);return C.l+=F[1],F[0]}function io(C,j){if(C)typeof console<"u"&&console.error(j);else throw new Error(j)}function so(C,j){var R=C;kn(R,0);var F=[],L=[],B={FileIndex:F,FullPaths:L};D(B,{root:j.root});for(var oe=R.length-4;(R[oe]!=80||R[oe+1]!=75||R[oe+2]!=5||R[oe+3]!=6)&&oe>=0;)--oe;R.l=oe+4,R.l+=4;var xe=R.read_shift(2);R.l+=6;var se=R.read_shift(4);for(R.l=se,oe=0;oe<xe;++oe){R.l+=20;var ue=R.read_shift(4),ce=R.read_shift(4),Pe=R.read_shift(2),je=R.read_shift(2),$e=R.read_shift(2);R.l+=8;var Me=R.read_shift(4),De=u(R.slice(R.l+Pe,R.l+Pe+je));R.l+=Pe+je+$e;var nt=R.l;R.l=Me+4,mi(R,ue,ce,B,De),R.l=nt}return B}function mi(C,j,R,F,L){C.l+=2;var B=C.read_shift(2),oe=C.read_shift(2),xe=o(C);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var se=C.read_shift(4),ue=C.read_shift(4),ce=C.read_shift(4),Pe=C.read_shift(2),je=C.read_shift(2),$e="",Me=0;Me<Pe;++Me)$e+=String.fromCharCode(C[C.l++]);if(je){var De=u(C.slice(C.l,C.l+je));(De[21589]||{}).mt&&(xe=De[21589].mt),((L||{})[21589]||{}).mt&&(xe=L[21589].mt)}C.l+=je;var nt=C.slice(C.l,C.l+ue);switch(oe){case 8:nt=J(C,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Tt=!1;B&8&&(se=C.read_shift(4),se==134695760&&(se=C.read_shift(4),Tt=!0),ue=C.read_shift(4),ce=C.read_shift(4)),ue!=j&&io(Tt,"Bad compressed size: "+j+" != "+ue),ce!=R&&io(Tt,"Bad uncompressed size: "+R+" != "+ce),Ra(F,$e,nt,{unsafe:!0,mt:xe})}function gi(C,j){var R=j||{},F=[],L=[],B=ve(1),oe=R.compression?8:0,xe=0,se=0,ue=0,ce=0,Pe=0,je=C.FullPaths[0],$e=je,Me=C.FileIndex[0],De=[],nt=0;for(se=1;se<C.FullPaths.length;++se)if($e=C.FullPaths[se].slice(je.length),Me=C.FileIndex[se],!(!Me.size||!Me.content||$e=="Sh33tJ5")){var Tt=ce,kt=ve($e.length);for(ue=0;ue<$e.length;++ue)kt.write_shift(1,$e.charCodeAt(ue)&127);kt=kt.slice(0,kt.l),De[Pe]=aM.buf(Me.content,0);var Qt=Me.content;oe==8&&(Qt=G(Qt)),B=ve(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,xe),B.write_shift(2,oe),Me.mt?i(B,Me.mt):B.write_shift(4,0),B.write_shift(-4,De[Pe]),B.write_shift(4,Qt.length),B.write_shift(4,Me.content.length),B.write_shift(2,kt.length),B.write_shift(2,0),ce+=B.length,F.push(B),ce+=kt.length,F.push(kt),ce+=Qt.length,F.push(Qt),B=ve(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,xe),B.write_shift(2,oe),B.write_shift(4,0),B.write_shift(-4,De[Pe]),B.write_shift(4,Qt.length),B.write_shift(4,Me.content.length),B.write_shift(2,kt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Tt),nt+=B.l,L.push(B),nt+=kt.length,L.push(kt),++Pe}return B=ve(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,Pe),B.write_shift(2,Pe),B.write_shift(4,nt),B.write_shift(4,ce),B.write_shift(2,0),Rr([Rr(F),Rr(L),B])}var ss={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ac(C,j){if(C.ctype)return C.ctype;var R=C.name||"",F=R.match(/\.([^\.]+)$/);return F&&ss[F[1]]||j&&(F=(R=j).match(/[\.\\]([^\.\\])+$/),F&&ss[F[1]])?ss[F[1]]:"application/octet-stream"}function kc(C){for(var j=Mu(C),R=[],F=0;F<j.length;F+=76)R.push(j.slice(F,F+76));return R.join(`\r
`)+`\r
`}function Oc(C){var j=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var ce=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],F=j.split(`\r
`),L=0;L<F.length;++L){var B=F[L];if(B.length==0){R.push("");continue}for(var oe=0;oe<B.length;){var xe=76,se=B.slice(oe,oe+xe);se.charAt(xe-1)=="="?xe--:se.charAt(xe-2)=="="?xe-=2:se.charAt(xe-3)=="="&&(xe-=3),se=B.slice(oe,oe+xe),oe+=xe,oe<B.length&&(se+="="),R.push(se)}}return R.join(`\r
`)}function Pc(C){for(var j=[],R=0;R<C.length;++R){for(var F=C[R];R<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++R];j.push(F)}for(var L=0;L<j.length;++L)j[L]=j[L].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return da(j.join(`\r
`))}function kl(C,j,R){for(var F="",L="",B="",oe,xe=0;xe<10;++xe){var se=j[xe];if(!se||se.match(/^\s*$/))break;var ue=se.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":F=ue[2].trim();break;case"content-type":B=ue[2].trim();break;case"content-transfer-encoding":L=ue[2].trim();break}}switch(++xe,L.toLowerCase()){case"base64":oe=da(Ja(j.slice(xe).join("")));break;case"quoted-printable":oe=Pc(j.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ce=Ra(C,F.slice(R.length),oe,{unsafe:!0});B&&(ce.ctype=B)}function Cc(C,j){if(we(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=j&&j.root||"",F=(mt&&Buffer.isBuffer(C)?C.toString("binary"):we(C)).split(`\r
`),L=0,B="";for(L=0;L<F.length;++L)if(B=F[L],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),R||(R=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),B.slice(0,R.length)!=R););var oe=(F[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var xe="--"+(oe[1]||""),se=[],ue=[],ce={FileIndex:se,FullPaths:ue};D(ce);var Pe,je=0;for(L=0;L<F.length;++L){var $e=F[L];$e!==xe&&$e!==xe+"--"||(je++&&kl(ce,F.slice(Pe,L),R),Pe=L)}return ce}function os(C,j){var R=j||{},F=R.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],B=C.FullPaths[0],oe=B,xe=C.FileIndex[0],se=1;se<C.FullPaths.length;++se)if(oe=C.FullPaths[se].slice(B.length),xe=C.FileIndex[se],!(!xe.size||!xe.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var ue=xe.content,ce=mt&&Buffer.isBuffer(ue)?ue.toString("binary"):we(ue),Pe=0,je=Math.min(1024,ce.length),$e=0,Me=0;Me<=je;++Me)($e=ce.charCodeAt(Me))>=32&&$e<128&&++Pe;var De=Pe>=je*4/5;L.push(F),L.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+oe),L.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),L.push("Content-Type: "+Ac(xe,oe)),L.push(""),L.push(De?Oc(ce):kc(ce))}return L.push(F+`--\r
`),L.join(`\r
`)}function Ol(C){var j={};return D(j,C),j}function Ra(C,j,R,F){var L=F&&F.unsafe;L||D(C);var B=!L&&_t.find(C,j);if(!B){var oe=C.FullPaths[0];j.slice(0,oe.length)==oe?oe=j:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+j).replace("//","/")),B={name:a(j),type:2},C.FileIndex.push(B),C.FullPaths.push(oe),L||_t.utils.cfb_gc(C)}return B.content=R,B.size=R?R.length:0,F&&(F.CLSID&&(B.clsid=F.CLSID),F.mt&&(B.mt=F.mt),F.ct&&(B.ct=F.ct)),B}function ch(C,j){D(C);var R=_t.find(C,j);if(R){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==R)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function ls(C,j,R){D(C);var F=_t.find(C,j);if(F){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==F)return C.FileIndex[L].name=a(R),C.FullPaths[L]=R,!0}return!1}function oo(C){H(C,!0)}return t.find=q,t.read=I,t.parse=d,t.write=be,t.writeFile=me,t.utils={cfb_new:Ol,cfb_add:Ra,cfb_del:ch,cfb_mov:ls,cfb_gc:oo,ReadShift:ku,CheckField:dA,prep_blob:kn,bconcat:Rr,use_zlib:M,_deflateRaw:hi,_inflateRaw:ao,consts:Se},t}();function iM(e){return typeof e=="string"?y0(e):Array.isArray(e)?ND(e):e}function Zu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=y0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Iu(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([iM(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Qu(t)),u.write(t),u.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Lr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function VS(e,t){for(var r=[],n=Lr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function jv(e){for(var t=[],r=Lr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function S0(e){for(var t=[],r=Lr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function sM(e){for(var t=[],r=Lr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var _d=new Date(1899,11,30,0,0,0);function gn(e,t){var r=e.getTime(),n=_d.getTime()+(e.getTimezoneOffset()-_d.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var qT=new Date,oM=_d.getTime()+(qT.getTimezoneOffset()-_d.getTimezoneOffset())*6e4,GS=qT.getTimezoneOffset();function XT(e){var t=new Date;return t.setTime(e*24*60*60*1e3+oM),t.getTimezoneOffset()!==GS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-GS)*6e4),t}var YS=new Date("2017-02-19T19:06:09.000Z"),QT=isNaN(YS.getFullYear())?new Date("2/19/17"):YS,lM=QT.getFullYear()==2017;function nn(e,t){var r=new Date(e);if(lM)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(QT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function b0(e,t){if(mt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function vn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=vn(e[r]));return t}function Yt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ya(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var uM=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ru(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&uM.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function it(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return mt?n=si(r):n=DD(r),_t.utils.cfb_add(e,t,n)}_t.utils.cfb_add(e,t,r)}else e.file(t,r)}function Lv(){return _t.utils.cfb_new()}var sr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cM={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bv=jv(cM),$v=/[&<>'"]/g,fM=/[\u0000-\u0008\u000b-\u001f]/g;function wt(e){var t=e+"";return t.replace($v,function(r){return Bv[r]}).replace(fM,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qS(e){return wt(e).replace(/ /g,"_x0020_")}var ZT=/[\u0000-\u001f]/g;function dM(e){var t=e+"";return t.replace($v,function(r){return Bv[r]}).replace(/\n/g,"<br/>").replace(ZT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function hM(e){var t=e+"";return t.replace($v,function(r){return Bv[r]}).replace(ZT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function pM(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function mM(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xp(e){for(var t="",r=0,n=0,a=0,i=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function XS(e){var t=Bs(2*e.length),r,n,a=1,i=0,o=0,u;for(n=0;n<e.length;n+=a)a=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function QS(e){return si(e,"binary").toString("utf8")}var $f="foo bar bazâð£",Au=mt&&(QS($f)==Xp($f)&&QS||XS($f)==Xp($f)&&XS)||Xp,Iu=mt?function(e){return si(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gM=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),JT=/(^\s|\s$|\n)/;function Ir(e,t){return"<"+e+(t.match(JT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Fu(e){return Lr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ie(e,t,r){return"<"+e+(r!=null?Fu(r):"")+(t!=null?(t.match(JT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function vM(e,t){switch(typeof e){case"string":var r=Ie("vt:lpwstr",wt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ie((e|0)==e?"vt:i4":"vt:r8",wt(String(e)));case"boolean":return Ie("vt:bool",e?"true":"false")}if(e instanceof Date)return Ie("vt:filetime",jg(e));throw new Error("Unable to serialize "+e)}var _r={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ll=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yM(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function xM(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var u=0;u<=5;++u,i/=256)e[r+u]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var ZS=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},JS=mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:si(t)})):ZS(e)}:ZS,e2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(bu(e,a)));return n.join("").replace(Tu,"")},Uv=mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Tu,""):e2(e,t,r)}:e2,t2=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},eA=mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):t2(e,t,r)}:t2,r2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Bo(e,a)));return n.join("")},Ju=mt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):r2(t,r,n)}:r2,tA=function(e,t){var r=Cn(e,t);return r>0?Ju(e,t+4,t+4+r-1):""},rA=tA,nA=function(e,t){var r=Cn(e,t);return r>0?Ju(e,t+4,t+4+r-1):""},aA=nA,iA=function(e,t){var r=2*Cn(e,t);return r>0?Ju(e,t+4,t+4+r-1):""},sA=iA,oA=function(t,r){var n=Cn(t,r);return n>0?Uv(t,r+4,r+4+n):""},lA=oA,uA=function(e,t){var r=Cn(e,t);return r>0?Ju(e,t+4,t+4+r):""},cA=uA,fA=function(e,t){return yM(e,t)},Td=fA,Wv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};mt&&(rA=function(t,r){if(!Buffer.isBuffer(t))return tA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},aA=function(t,r){if(!Buffer.isBuffer(t))return nA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},sA=function(t,r){if(!Buffer.isBuffer(t))return iA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},lA=function(t,r){if(!Buffer.isBuffer(t))return oA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},cA=function(t,r){if(!Buffer.isBuffer(t))return uA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Td=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):fA(t,r)},Wv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bo=function(e,t){return e[t]},bu=function(e,t){return e[t+1]*256+e[t]},wM=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ks=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},SM=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ku(e,t){var r="",n,a,i=[],o,u,c,f;switch(t){case"dbcs":if(f=this.l,mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(bu(this,f)),f+=2;e*=2;break;case"utf8":r=Ju(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Uv(this,this.l,this.l+e);break;case"wstr":return ku.call(this,e,"dbcs");case"lpstr-ansi":r=rA(this,this.l),e=4+Cn(this,this.l);break;case"lpstr-cp":r=aA(this,this.l),e=4+Cn(this,this.l);break;case"lpwstr":r=sA(this,this.l),e=4+2*Cn(this,this.l);break;case"lpp4":e=4+Cn(this,this.l),r=lA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cn(this,this.l),r=cA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Bo(this,this.l+e++))!==0;)i.push(jf(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=bu(this,this.l+e))!==0;)i.push(jf(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Bo(this,f),this.l=f+1,u=ku.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(jf(bu(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Bo(this,f),this.l=f+1,u=ku.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(jf(Bo(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Bo(this,this.l),this.l++,n;case 2:return n=(t==="i"?wM:bu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?ks:SM)(this,this.l),this.l+=4,n):(a=Cn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Td(this,this.l):a=Td([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=eA(this,this.l,e);break}}return this.l+=e,r}var bM=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},EM=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},_M=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function TM(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)_M(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,bM(this,t,this.l);break;case 8:if(n=8,r==="f"){xM(this,t,this.l);break}case 16:break;case-4:n=4,EM(this,t,this.l);break}return this.l+=n,this}function dA(e,t){var r=eA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function kn(e,t){e.l=t,e.read_shift=ku,e.chk=dA,e.write_shift=TM}function Oa(e,t){e.l+=t}function ve(e){var t=Bs(e);return kn(t,0),t}function mn(){var e=[],t=mt?256:2048,r=function(f){var d=ve(f);return kn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),Rr(e)},u=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:u,end:o,_bufs:e}}function _e(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=y5[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Wv(r)&&e.push(r)}}function Ou(e,t,r){var n=vn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function n2(e,t,r){var n=vn(e);return n.s=Ou(n.s,t.s,r),n.e=Ou(n.e,t.s,r),n}function Pu(e,t){if(e.cRel&&e.c<0)for(e=vn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=vn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=St(e);return!e.cRel&&e.cRel!=null&&(r=OM(r)),!e.rRel&&e.rRel!=null&&(r=AM(r)),r}function Qp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Hr(e.s.c)+":"+(e.e.cRel?"":"$")+Hr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jr(e.s.r)+":"+(e.e.rRel?"":"$")+jr(e.e.r):Pu(e.s,t.biff)+":"+Pu(e.e,t.biff)}function zv(e){return parseInt(kM(e),10)-1}function jr(e){return""+(e+1)}function AM(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function kM(e){return e.replace(/\$(\d+)$/,"$1")}function Kv(e){for(var t=PM(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Hr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OM(e){return e.replace(/^([A-Z])/,"$$$1")}function PM(e){return e.replace(/^\$([A-Z])/,"$1")}function CM(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function St(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rn(e){var t=e.indexOf(":");return t==-1?{s:Tr(e),e:Tr(e)}:{s:Tr(e.slice(0,t)),e:Tr(e.slice(t+1))}}function ar(e,t){return typeof t>"u"||typeof t=="number"?ar(e.s,e.e):(typeof e!="string"&&(e=St(e)),typeof t!="string"&&(t=St(t)),e==t?e:e+":"+t)}function It(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function a2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Vi(e.z,r?gn(t):t)}catch{}try{return e.w=Vi((e.XF||{}).numFmtId||(r?14:0),r?gn(t):t)}catch{return""+t}}function ei(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ec[e.v]||e.v:t==null?a2(e,e.v):a2(e,t))}function Qs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function hA(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Tr(n.origin):n.origin;o=c.r,u=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=It(i["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(f.e.r=o=d.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var v={v:t[p][m]},x=o+p,y=u+m;if(f.s.r>x&&(f.s.r=x),f.s.c>y&&(f.s.c=y),f.e.r<x&&(f.e.r=x),f.e.c<y&&(f.e.c=y),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))v=t[p][m];else if(Array.isArray(v.v)&&(v.f=t[p][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||Xt[14],n.cellDates?(v.t="d",v.w=Vi(v.z,gn(v.v))):(v.t="n",v.v=gn(v.v),v.w=Vi(v.z,v.v))):v.t="s";if(a)i[x]||(i[x]=[]),i[x][y]&&i[x][y].z&&(v.z=i[x][y].z),i[x][y]=v;else{var S=St({c:y,r:x});i[S]&&i[S].z&&(v.z=i[S].z),i[S]=v}}}return f.s.c<1e7&&(i["!ref"]=ar(f)),i}function ul(e,t){return hA(null,e,t)}function NM(e){return e.read_shift(4,"i")}function ga(e,t){return t||(t=ve(4)),t.write_shift(4,e),t}function Vr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ar(e,t){var r=!1;return t==null&&(r=!0,t=ve(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function DM(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function MM(e,t){return t||(t=ve(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Hv(e,t){var r=e.l,n=e.read_shift(1),a=Vr(e),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=e.read_shift(4),c=0;c!=u;++c)i.push(DM(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function RM(e,t){var r=!1;return t==null&&(r=!0,t=ve(15+4*e.t.length)),t.write_shift(1,0),Ar(e.t,t),r?t.slice(0,t.l):t}var IM=Hv;function FM(e,t){var r=!1;return t==null&&(r=!0,t=ve(23+4*e.t.length)),t.write_shift(1,1),Ar(e.t,t),t.write_shift(4,1),MM({},t),r?t.slice(0,t.l):t}function ea(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Zs(e,t){return t==null&&(t=ve(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Js(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function eo(e,t){return t==null&&(t=ve(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var jM=Vr,pA=Ar;function Vv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ad(e,t){var r=!1;return t==null&&(r=!0,t=ve(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var LM=Vr,Lg=Vv,Gv=Ad;function mA(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Td([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ks(t,0)>>2;return r?a/100:a}function gA(e,t){t==null&&(t=ve(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function vA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function BM(e,t){return t||(t=ve(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var to=vA,cl=BM;function fl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $s(e,t){return(t||ve(8)).write_shift(8,e,"f")}function $M(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=qM[a];f&&(t.rgb=m2(f));break;case 2:t.rgb=m2([o,u,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function kd(e,t){if(t||(t=ve(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function UM(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function WM(e,t){t||(t=ve(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var yA=2,Tn=3,Uf=11,Od=19,Wf=64,zM=65,KM=71,HM=4108,VM=4126,Dr=80,i2={1:{n:"CodePage",t:yA},2:{n:"Category",t:Dr},3:{n:"PresentationFormat",t:Dr},4:{n:"ByteCount",t:Tn},5:{n:"LineCount",t:Tn},6:{n:"ParagraphCount",t:Tn},7:{n:"SlideCount",t:Tn},8:{n:"NoteCount",t:Tn},9:{n:"HiddenCount",t:Tn},10:{n:"MultimediaClipCount",t:Tn},11:{n:"ScaleCrop",t:Uf},12:{n:"HeadingPairs",t:HM},13:{n:"TitlesOfParts",t:VM},14:{n:"Manager",t:Dr},15:{n:"Company",t:Dr},16:{n:"LinksUpToDate",t:Uf},17:{n:"CharacterCount",t:Tn},19:{n:"SharedDoc",t:Uf},22:{n:"HyperlinksChanged",t:Uf},23:{n:"AppVersion",t:Tn,p:"version"},24:{n:"DigSig",t:zM},26:{n:"ContentType",t:Dr},27:{n:"ContentStatus",t:Dr},28:{n:"Language",t:Dr},29:{n:"Version",t:Dr},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},s2={1:{n:"CodePage",t:yA},2:{n:"Title",t:Dr},3:{n:"Subject",t:Dr},4:{n:"Author",t:Dr},5:{n:"Keywords",t:Dr},6:{n:"Comments",t:Dr},7:{n:"Template",t:Dr},8:{n:"LastAuthor",t:Dr},9:{n:"RevNumber",t:Dr},10:{n:"EditTime",t:Wf},11:{n:"LastPrinted",t:Wf},12:{n:"CreatedDate",t:Wf},13:{n:"ModifiedDate",t:Wf},14:{n:"PageCount",t:Tn},15:{n:"WordCount",t:Tn},16:{n:"CharCount",t:Tn},17:{n:"Thumbnail",t:KM},18:{n:"Application",t:Dr},19:{n:"DocSecurity",t:Tn},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}};function GM(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var YM=GM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qM=vn(YM),ec={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},XM={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},zf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wA(e,t){var r=sM(XM),n=[],a;n[n.length]=sr,n[n.length]=Ie("Types",null,{xmlns:_r.CT,"xmlns:xsd":_r.xsd,"xmlns:xsi":_r.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ie("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Ie("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:zf[c][t.bookType]||zf[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Ie("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:zf[c][t.bookType]||zf[c].xlsx})})},u=function(c){(e[c]||[]).forEach(function(f){n[n.length]=Ie("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var dt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function SA(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ho(e){var t=[sr,Ie("Relationships",null,{xmlns:_r.RELS})];return Lr(e["!id"]).forEach(function(r){t[t.length]=Ie("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[dt.HLINK,dt.XPATH,dt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function QM(e){var t=[sr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function o2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ZM(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function JM(e){var t=[sr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(o2(e[r][0],e[r][1])),t.push(ZM("",e[r][0]));return t.push(o2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function bA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xd.version+"</meta:generator></office:meta></office:document-meta>"}var Ds=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Zp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=wt(t),n[n.length]=r?Ie(e,t,r):Ir(e,t))}function EA(e,t){var r=t||{},n=[sr,Ie("cp:coreProperties",null,{"xmlns:cp":_r.CORE_PROPS,"xmlns:dc":_r.dc,"xmlns:dcterms":_r.dcterms,"xmlns:dcmitype":_r.dcmitype,"xmlns:xsi":_r.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Zp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:jg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Zp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:jg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ds.length;++i){var o=Ds[i],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Zp(o[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_A=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TA(e){var t=[],r=Ie;return e||(e={}),e.Application="SheetJS",t[t.length]=sr,t[t.length]=Ie("Properties",null,{xmlns:_r.EXT_PROPS,"xmlns:vt":_r.vt}),Vo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=wt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+wt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function AA(e){var t=[sr,Ie("Properties",null,{xmlns:_r.CUST_PROPS,"xmlns:vt":_r.vt})];if(!e)return t.join("");var r=1;return Lr(e).forEach(function(a){++r,t[t.length]=Ie("property",vM(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var l2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function eR(e,t){var r=[];return Lr(l2).map(function(n){for(var a=0;a<Ds.length;++a)if(Ds[a][1]==n)return Ds[a];for(a=0;a<Vo.length;++a)if(Vo[a][1]==n)return Vo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ir(l2[n[1]]||n[1],a))}}),Ie("DocumentProperties",r.join(""),{xmlns:Pn.o})}function tR(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Lr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ds.length;++o)if(i==Ds[o][1])return;for(o=0;o<Vo.length;++o)if(i==Vo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var u=e[i],c="string";typeof u=="number"?(c="float",u=String(u)):u===!0||u===!1?(c="boolean",u=u?"1":"0"):u=String(u),a.push(Ie(qS(i),u,{"dt:dt":c}))}}),t&&Lr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Ie(qS(i),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Pn.o+'">'+a.join("")+"</"+n+">"}function rR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=ve(8);return o.write_shift(4,n),o.write_shift(4,a),o}function u2(e,t){var r=ve(4),n=ve(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ve(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=rR(t);break;case 31:case 80:for(n=ve(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rr([r,n])}var kA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function c2(e,t,r){var n=ve(8),a=[],i=[],o=8,u=0,c=ve(8),f=ve(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),i.push(c),a.push(f),o+=8+c.length,!t){f=ve(8),f.write_shift(4,0),a.unshift(f);var d=[ve(4)];for(d[0].write_shift(4,e.length),u=0;u<e.length;++u){var p=e[u][0];for(c=ve(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,u+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Rr(d),i.unshift(c),o+=8+c.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(kA.indexOf(e[u][0])>-1||_A.indexOf(e[u][0])>-1)&&e[u][1]!=null){var m=e[u][1],v=0;if(t){v=+t[e[u][0]];var x=r[v];if(x.p=="version"&&typeof m=="string"){var y=m.split(".");m=(+y[0]<<16)+(+y[1]||0)}c=u2(x.t,m)}else{var S=nR(m);S==-1&&(S=31,m=String(m)),c=u2(S,m)}i.push(c),f=ve(8),f.write_shift(4,t?v:2+u),a.push(f),o+=8+c.length}var T=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,T),T+=i[u].length;return n.write_shift(4,o),n.write_shift(4,i.length),Rr([n].concat(a).concat(i))}function f2(e,t,r,n,a,i){var o=ve(a?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,_t.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=c2(e,r,n);if(u.push(c),a){var f=c2(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),u.push(f)}return Rr(u)}function aR(e,t){t||(t=ve(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function iR(e,t){return e.read_shift(t)===1}function Jr(e,t){return t||(t=ve(2)),t.write_shift(2,+!!e),t}function OA(e){return e.read_shift(2,"u")}function Yn(e,t){return t||(t=ve(2)),t.write_shift(2,e),t}function PA(e,t,r){return r||(r=ve(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function CA(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function sR(e){var t=e.t||"",r=ve(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ve(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Rr(a)}function oR(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function lR(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):oR(e,n,r)}function uR(e,t,r){if(r.biff>5)return lR(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function NA(e,t,r){return r||(r=ve(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function d2(e,t){t||(t=ve(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cR(e){var t=ve(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),d2(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),i&8&&d2(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Us(e,t,r,n){return n||(n=ve(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function fR(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function dR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function DA(e,t){return t||(t=ve(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Yv(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ve(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function hR(e,t){var r=!t||t.biff==8,n=ve(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function pR(e,t){var r=!t||t.biff>=8?2:1,n=ve(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function mR(e,t){var r=ve(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=sR(e[a]);var i=Rr([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function gR(){var e=ve(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function vR(e){var t=ve(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yR(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=ve(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function xR(e,t,r,n){var a=ve(10);return Us(e,t,n,a),a.write_shift(4,r),a}function wR(e,t,r,n,a){var i=!a||a.biff==8,o=ve(8+ +i+(1+i)*r.length);return Us(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function SR(e,t,r,n){var a=r&&r.biff==5;n||(n=ve(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function bR(e,t){var r=t.biff==8||!t.biff?4:2,n=ve(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function h2(e,t,r,n){var a=r&&r.biff==5;n||(n=ve(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function ER(e){var t=ve(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _R(e,t,r,n,a,i){var o=ve(8);return Us(e,t,n,o),PA(r,i,o),o}function TR(e,t,r,n){var a=ve(14);return Us(e,t,n,a),$s(r,a),a}function AR(e,t,r){if(r.biff<8)return kR(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(fR(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function kR(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=CA(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function OR(e){var t=ve(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)DA(e[r],t);return t}function PR(e){var t=ve(24),r=Tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Rr([t,cR(e[1])])}function CR(e){var t=e[1].Tooltip,r=ve(10+2*(t.length+1));r.write_shift(2,2048);var n=Tr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function NR(e){return e||(e=ve(4)),e.write_shift(2,1),e.write_shift(2,1),e}function DR(e,t,r){if(!r.cellStyles)return Oa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:u,flags:c};return(r.biff>=5||!r.biff)&&(f.level=c>>8&7),f}function MR(e,t){var r=ve(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function RR(e){for(var t=ve(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function IR(e,t,r){var n=ve(15);return rc(n,e,t),n.write_shift(8,r,"f"),n}function FR(e,t,r){var n=ve(9);return rc(n,e,t),n.write_shift(2,r),n}var jR=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,c){var f=[],d=Bs(1);switch(c.type){case"base64":d=da(Ja(u));break;case"binary":d=da(u);break;case"buffer":case"array":d=u;break}kn(d,0);var p=d.read_shift(1),m=!!(p&136),v=!1,x=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,S=521;p==2&&(y=d.read_shift(2)),d.l+=3,p!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(S=d.read_shift(2));var T=d.read_shift(2),k=c.codepage||1252;p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var A=[],P={},N=Math.min(d.length,p==2?521:S-10-(v?264:0)),I=x?32:11;d.l<N&&d[d.l]!=13;)switch(P={},P.name=wd.utils.decode(k,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,P.type=String.fromCharCode(d.read_shift(1)),p!=2&&!x&&(P.offset=d.read_shift(4)),P.len=d.read_shift(1),p==2&&(P.offset=d.read_shift(2)),P.dec=d.read_shift(1),P.name.length&&A.push(P),p!=2&&(d.l+=x?13:14),P.type){case"B":(!v||P.len!=8)&&c.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var D=0,z=0;for(f[0]=[],z=0;z!=A.length;++z)f[0][z]=A[z].name;for(;y-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,f[++D]=[],z=0,z=0;z!=A.length;++z){var H=d.slice(d.l,d.l+A[z].len);d.l+=A[z].len,kn(H,0);var te=wd.utils.decode(k,H);switch(A[z].type){case"C":te.trim().length&&(f[D][z]=te.replace(/\s+$/,""));break;case"D":te.length===8?f[D][z]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):f[D][z]=te;break;case"F":f[D][z]=parseFloat(te.trim());break;case"+":case"I":f[D][z]=x?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":f[D][z]=!0;break;case"N":case"F":f[D][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[D][z]="##MEMO##"+(x?parseInt(te.trim(),10):H.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(f[D][z]=+te||0);break;case"@":f[D][z]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":f[D][z]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":f[D][z]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[D][z]=-H.read_shift(-8,"f");break;case"B":if(v&&A[z].len==8){f[D][z]=H.read_shift(8,"f");break}case"G":case"P":H.l+=A[z].len;break;case"0":if(A[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[z].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=A,f}function n(u,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var d=ul(r(u,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function a(u,c){try{return Qs(n(u,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,c){var f=c||{};if(+f.codepage>=0&&Du(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=mn(),p=Md(u,{header:1,raw:!0,cellDates:!0}),m=p[0],v=p.slice(1),x=u["!cols"]||[],y=0,S=0,T=0,k=1;for(y=0;y<m.length;++y){if(((x[y]||{}).DBF||{}).name){m[y]=x[y].DBF.name,++T;continue}if(m[y]!=null){if(++T,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(S=0;S<1024;++S)if(m.indexOf(m[y]+"_"+S)==-1){m[y]+="_"+S;break}}}}var A=It(u["!ref"]),P=[],N=[],I=[];for(y=0;y<=A.e.c-A.s.c;++y){var D="",z="",H=0,te=[];for(S=0;S<v.length;++S)v[S][y]!=null&&te.push(v[S][y]);if(te.length==0||m[y]==null){P[y]="?";continue}for(S=0;S<te.length;++S){switch(typeof te[S]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=te[S]instanceof Date?"D":"C";break;default:z="C"}H=Math.max(H,String(te[S]).length),D=D&&D!=z?"C":z}H>250&&(H=250),z=((x[y]||{}).DBF||{}).type,z=="C"&&x[y].DBF.len>H&&(H=x[y].DBF.len),D=="B"&&z=="N"&&(D="N",I[y]=x[y].DBF.dec,H=x[y].DBF.len),N[y]=D=="C"||z=="N"?H:i[D]||0,k+=N[y],P[y]=D}var q=d.next(32);for(q.write_shift(4,318902576),q.write_shift(4,v.length),q.write_shift(2,296+32*T),q.write_shift(2,k),y=0;y<4;++y)q.write_shift(4,0);for(q.write_shift(4,0|(+t[RT]||3)<<8),y=0,S=0;y<m.length;++y)if(m[y]!=null){var V=d.next(32),ae=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ae,"sbcs"),V.write_shift(1,P[y]=="?"?"C":P[y],"sbcs"),V.write_shift(4,S),V.write_shift(1,N[y]||i[P[y]]||0),V.write_shift(1,I[y]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),S+=N[y]||i[P[y]]||0}var Ee=d.next(264);for(Ee.write_shift(4,13),y=0;y<65;++y)Ee.write_shift(4,0);for(y=0;y<v.length;++y){var Z=d.next(k);for(Z.write_shift(1,0),S=0;S<m.length;++S)if(m[S]!=null)switch(P[S]){case"L":Z.write_shift(1,v[y][S]==null?63:v[y][S]?84:70);break;case"B":Z.write_shift(8,v[y][S]||0,"f");break;case"N":var Te="0";for(typeof v[y][S]=="number"&&(Te=v[y][S].toFixed(I[S]||0)),T=0;T<N[S]-Te.length;++T)Z.write_shift(1,32);Z.write_shift(1,Te,"sbcs");break;case"D":v[y][S]?(Z.write_shift(4,("0000"+v[y][S].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(v[y][S].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+v[y][S].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(v[y][S]!=null?v[y][S]:"").slice(0,N[S]);for(Z.write_shift(1,Se,"sbcs"),T=0;T<N[S]-Se.length;++T)Z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),LR=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Lr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var x=e[v];return typeof x=="number"?jS(x):x},n=function(m,v,x){var y=v.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return y==59?m:jS(y)};e["|"]=254;function a(m,v){switch(v.type){case"base64":return i(Ja(m),v);case"binary":return i(m,v);case"buffer":return i(mt&&Buffer.isBuffer(m)?m.toString("binary"):Qu(m),v);case"array":return i(b0(m),v)}throw new Error("Unrecognized type "+v.type)}function i(m,v){var x=m.split(/[\n\r]+/),y=-1,S=-1,T=0,k=0,A=[],P=[],N=null,I={},D=[],z=[],H=[],te=0,q;for(+v.codepage>=0&&Du(+v.codepage);T!==x.length;++T){te=0;var V=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ae=V.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Ee=ae[0],Z;if(V.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ae[1].charAt(0)=="P"&&P.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,Se=!1,me=!1,we=!1,be=-1,X=-1;for(k=1;k<ae.length;++k)switch(ae[k].charAt(0)){case"A":break;case"X":S=parseInt(ae[k].slice(1))-1,Se=!0;break;case"Y":for(y=parseInt(ae[k].slice(1))-1,Se||(S=0),q=A.length;q<=y;++q)A[q]=[];break;case"K":Z=ae[k].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(Ya(Z))?isNaN(Ru(Z).getDate())||(Z=nn(Z)):(Z=Ya(Z),N!==null&&VT(N)&&(Z=XT(Z))),Te=!0;break;case"E":we=!0;var M=FI(ae[k].slice(1),{r:y,c:S});A[y][S]=[A[y][S],M];break;case"S":me=!0,A[y][S]=[A[y][S],"S5S"];break;case"G":break;case"R":be=parseInt(ae[k].slice(1))-1;break;case"C":X=parseInt(ae[k].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}if(Te&&(A[y][S]&&A[y][S].length==2?A[y][S][0]=Z:A[y][S]=Z,N=null),me){if(we)throw new Error("SYLK shared formula cannot have own formula");var J=be>-1&&A[be][X];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");A[y][S][1]=jI(J[1],{r:y-be,c:S-X})}break;case"F":var G=0;for(k=1;k<ae.length;++k)switch(ae[k].charAt(0)){case"X":S=parseInt(ae[k].slice(1))-1,++G;break;case"Y":for(y=parseInt(ae[k].slice(1))-1,q=A.length;q<=y;++q)A[q]=[];break;case"M":te=parseInt(ae[k].slice(1))/20;break;case"F":break;case"G":break;case"P":N=P[parseInt(ae[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=ae[k].slice(1).split(" "),q=parseInt(H[0],10);q<=parseInt(H[1],10);++q)te=parseInt(H[2],10),z[q-1]=te===0?{hidden:!0}:{wch:te},qv(z[q-1]);break;case"C":S=parseInt(ae[k].slice(1))-1,z[S]||(z[S]={});break;case"R":y=parseInt(ae[k].slice(1))-1,D[y]||(D[y]={}),te>0?(D[y].hpt=te,D[y].hpx=jA(te)):te===0&&(D[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}G<1&&(N=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+V)}}return D.length>0&&(I["!rows"]=D),z.length>0&&(I["!cols"]=z),v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),[A,I]}function o(m,v){var x=a(m,v),y=x[0],S=x[1],T=ul(y,v);return Lr(S).forEach(function(k){T[k]=S[k]}),T}function u(m,v){return Qs(o(m,v),v)}function c(m,v,x,y){var S="C;Y"+(x+1)+";X"+(y+1)+";K";switch(m.t){case"n":S+=m.v||0,m.f&&!m.F&&(S+=";E"+Qv(m.f,{r:x,c:y}));break;case"b":S+=m.v?"TRUE":"FALSE";break;case"e":S+=m.w||m.v;break;case"d":S+='"'+(m.w||m.v)+'"';break;case"s":S+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(m,v){v.forEach(function(x,y){var S="F;W"+(y+1)+" "+(y+1)+" ";x.hidden?S+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Pd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Cd(x.wpx)),typeof x.wch=="number"&&(S+=Math.round(x.wch))),S.charAt(S.length-1)!=" "&&m.push(S)})}function d(m,v){v.forEach(function(x,y){var S="F;";x.hidden?S+="M0;":x.hpt?S+="M"+20*x.hpt+";":x.hpx&&(S+="M"+20*Nd(x.hpx)+";"),S.length>2&&m.push(S+"R"+(y+1))})}function p(m,v){var x=["ID;PWXL;N;E"],y=[],S=It(m["!ref"]),T,k=Array.isArray(m),A=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&f(x,m["!cols"]),m["!rows"]&&d(x,m["!rows"]),x.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var P=S.s.r;P<=S.e.r;++P)for(var N=S.s.c;N<=S.e.c;++N){var I=St({r:P,c:N});T=k?(m[P]||[])[N]:m[I],!(!T||T.v==null&&(!T.f||T.F))&&y.push(c(T,m,P,N))}return x.join(A)+A+y.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:o,from_sheet:p}}(),BR=function(){function e(i,o){switch(o.type){case"base64":return t(Ja(i),o);case"binary":return t(i,o);case"buffer":return t(mt&&Buffer.isBuffer(i)?i.toString("binary"):Qu(i),o);case"array":return t(b0(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var u=i.split(`
`),c=-1,f=-1,d=0,p=[];d!==u.length;++d){if(u[d].trim()==="BOT"){p[++c]=[],f=0;continue}if(!(c<0)){var m=u[d].trim().split(","),v=m[0],x=m[1];++d;for(var y=u[d]||"";(y.match(/["]/g)||[]).length&1&&d<u.length-1;)y+=`
`+u[++d];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++c]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[c][f]=!0:y==="FALSE"?p[c][f]=!1:isNaN(Ya(x))?isNaN(Ru(x).getDate())?p[c][f]=x:p[c][f]=nn(x):p[c][f]=Ya(x),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[c][f++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function r(i,o){return ul(e(i,o),o)}function n(i,o){return Qs(r(i,o),o)}var a=function(){var i=function(c,f,d,p,m){c.push(f),c.push(d+","+p),c.push('"'+m.replace(/"/g,'""')+'"')},o=function(c,f,d,p){c.push(f+","+d),c.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var f=[],d=It(c["!ref"]),p,m=Array.isArray(c);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,d.e.r-d.s.r+1,""),i(f,"TUPLES",0,d.e.c-d.s.c+1,""),i(f,"DATA",0,0,"");for(var v=d.s.r;v<=d.e.r;++v){o(f,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var y=St({r:v,c:x});if(p=m?(c[v]||[])[x]:c[y],!p){o(f,1,0,"");continue}switch(p.t){case"n":var S=p.w;!S&&p.v!=null&&(S=p.v),S==null?p.f&&!p.F?o(f,1,0,"="+p.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Vi(p.z||Xt[14],gn(nn(p.v)))),o(f,0,p.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var T=`\r
`,k=f.join(T);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),MA=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var v=p.split(`
`),x=-1,y=-1,S=0,T=[];S!==v.length;++S){var k=v[S].trim().split(":");if(k[0]==="cell"){var A=Tr(k[1]);if(T.length<=A.r)for(x=T.length;x<=A.r;++x)T[x]||(T[x]=[]);switch(x=A.r,y=A.c,k[2]){case"t":T[x][y]=e(k[3]);break;case"v":T[x][y]=+k[3];break;case"vtf":var P=k[k.length-1];case"vtc":switch(k[3]){case"nl":T[x][y]=!!+k[4];break;default:T[x][y]=+k[4];break}k[2]=="vtf"&&(T[x][y]=[T[x][y],P])}}}return m&&m.sheetRows&&(T=T.slice(0,m.sheetRows)),T}function n(p,m){return ul(r(p,m),m)}function a(p,m){return Qs(n(p,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],x,y="",S=Rn(p["!ref"]),T=Array.isArray(p),k=S.s.r;k<=S.e.r;++k)for(var A=S.s.c;A<=S.e.c;++A)if(y=St({r:k,c:A}),x=T?(p[k]||[])[A]:p[y],!(!x||x.v==null||x.t==="z")){switch(v=["cell",y,"t"],x.t){case"s":case"str":v.push(t(x.v));break;case"n":x.f?(v[2]="vtf",v[3]="n",v[4]=x.v,v[5]=t(x.f)):(v[2]="v",v[3]=x.v);break;case"b":v[2]="vt"+(x.f?"f":"c"),v[3]="nl",v[4]=x.v?"1":"0",v[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var P=gn(nn(x.v));v[2]="vtc",v[3]="nd",v[4]=""+P,v[5]=x.w||Vi(x.z||Xt[14],P);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[i,o,u,o,f(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),$R=function(){function e(d,p,m,v,x){x.raw?p[m][v]=d:d===""||(d==="TRUE"?p[m][v]=!0:d==="FALSE"?p[m][v]=!1:isNaN(Ya(d))?isNaN(Ru(d).getDate())?p[m][v]=d:p[m][v]=nn(d):p[m][v]=Ya(d))}function t(d,p){var m=p||{},v=[];if(!d||d.length===0)return v;for(var x=d.split(/[\r\n]/),y=x.length-1;y>=0&&x[y].length===0;)--y;for(var S=10,T=0,k=0;k<=y;++k)T=x[k].indexOf(" "),T==-1?T=x[k].length:T++,S=Math.max(S,T);for(k=0;k<=y;++k){v[k]=[];var A=0;for(e(x[k].slice(0,S).trim(),v,k,A,m),A=1;A<=(x[k].length-S)/10+1;++A)e(x[k].slice(S+(A-1)*10,S+A*10).trim(),v,k,A,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var p={},m=!1,v=0,x=0;v<d.length;++v)(x=d.charCodeAt(v))==34?m=!m:!m&&x in r&&(p[x]=(p[x]||0)+1);x=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v]);if(!x.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v])}return x.sort(function(y,S){return y[0]-S[0]||n[y[1]]-n[S[1]]}),r[x.pop()[1]]||44}function i(d,p){var m=p||{},v="",x=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=a(d.slice(0,1024)):m&&m.FS?v=m.FS:v=a(d.slice(0,1024));var S=0,T=0,k=0,A=0,P=0,N=v.charCodeAt(0),I=!1,D=0,z=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var H=m.dateNF!=null?rM(m.dateNF):null;function te(){var q=d.slice(A,P),V={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)V.t="z";else if(m.raw)V.t="s",V.v=q;else if(q.trim().length===0)V.t="s",V.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(V.t="s",V.v=q.slice(2,-1).replace(/""/g,'"')):LI(q)?(V.t="n",V.f=q.slice(1)):(V.t="s",V.v=q);else if(q=="TRUE")V.t="b",V.v=!0;else if(q=="FALSE")V.t="b",V.v=!1;else if(!isNaN(k=Ya(q)))V.t="n",m.cellText!==!1&&(V.w=q),V.v=k;else if(!isNaN(Ru(q).getDate())||H&&q.match(H)){V.z=m.dateNF||Xt[14];var ae=0;H&&q.match(H)&&(q=nM(q,m.dateNF,q.match(H)||[]),ae=1),m.cellDates?(V.t="d",V.v=nn(q,ae)):(V.t="n",V.v=gn(nn(q,ae))),m.cellText!==!1&&(V.w=Vi(V.z,V.v instanceof Date?gn(V.v):V.v)),m.cellNF||delete V.z}else V.t="s",V.v=q;if(V.t=="z"||(m.dense?(x[S]||(x[S]=[]),x[S][T]=V):x[St({c:T,r:S})]=V),A=P+1,z=d.charCodeAt(A),y.e.c<T&&(y.e.c=T),y.e.r<S&&(y.e.r=S),D==N)++T;else if(T=0,++S,m.sheetRows&&m.sheetRows<=S)return!0}e:for(;P<d.length;++P)switch(D=d.charCodeAt(P)){case 34:z===34&&(I=!I);break;case N:case 10:case 13:if(!I&&te())break e;break}return P-A>0&&te(),x["!ref"]=ar(y),x}function o(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,p):ul(t(d,p),p)}function u(d,p){var m="",v=p.type=="string"?[0,0,0,0]:Z5(d,p);switch(p.type){case"base64":m=Ja(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):p.codepage&&typeof wd<"u"||(m=mt&&Buffer.isBuffer(d)?d.toString("binary"):Qu(d));break;case"array":m=b0(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=Au(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=Au(m):p.type=="binary"&&typeof wd<"u",m.slice(0,19)=="socialcalc:version:"?MA.to_sheet(p.type=="string"?m:Au(m),p):o(m,p)}function c(d,p){return Qs(u(d,p),p)}function f(d){for(var p=[],m=It(d["!ref"]),v,x=Array.isArray(d),y=m.s.r;y<=m.e.r;++y){for(var S=[],T=m.s.c;T<=m.e.c;++T){var k=St({r:y,c:T});if(v=x?(d[y]||[])[T]:d[k],!v||v.v==null){S.push("          ");continue}for(var A=(v.w||(ei(v),v.w)||"").slice(0,10);A.length<10;)A+=" ";S.push(A+(T===0?" ":""))}p.push(S.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:u,from_sheet:f}}(),p2=function(){function e(M,J,G){if(M){kn(M,M.l||0);for(var K=G.Enum||be;M.l<M.length;){var he=M.read_shift(2),Oe=K[he]||K[65535],Ne=M.read_shift(2),re=M.l+Ne,ye=Oe.f&&Oe.f(M,Ne,G);if(M.l=re,J(ye,Oe,he))return}}}function t(M,J){switch(J.type){case"base64":return r(da(Ja(M)),J);case"binary":return r(da(M),J);case"buffer":case"array":return r(M,J)}throw"Unsupported type "+J.type}function r(M,J){if(!M)return M;var G=J||{},K=G.dense?[]:{},he="Sheet1",Oe="",Ne=0,re={},ye=[],Be=[],ge={s:{r:0,c:0},e:{r:0,c:0}},ot=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=be,e(M,function(pe,qe,Xe){switch(Xe){case 0:G.vers=pe,pe>=4096&&(G.qpro=!0);break;case 6:ge=pe;break;case 204:pe&&(Oe=pe);break;case 222:Oe=pe;break;case 15:case 51:G.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=G.dateNF||Xt[14],G.cellDates&&(pe[1].t="d",pe[1].v=XT(pe[1].v))),G.qpro&&pe[3]>Ne&&(K["!ref"]=ar(ge),re[he]=K,ye.push(he),K=G.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},Ne=pe[3],he=Oe||"Sheet"+(Ne+1),Oe="");var rt=G.dense?(K[pe[0].r]||[])[pe[0].c]:K[St(pe[0])];if(rt){rt.t=pe[1].t,rt.v=pe[1].v,pe[1].z!=null&&(rt.z=pe[1].z),pe[1].f!=null&&(rt.f=pe[1].f);break}G.dense?(K[pe[0].r]||(K[pe[0].r]=[]),K[pe[0].r][pe[0].c]=pe[1]):K[St(pe[0])]=pe[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=X,M[2]==14&&(G.qpro=!0,M.l=0),e(M,function(pe,qe,Xe){switch(Xe){case 204:he=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>Ne&&(K["!ref"]=ar(ge),re[he]=K,ye.push(he),K=G.dense?[]:{},ge={s:{r:0,c:0},e:{r:0,c:0}},Ne=pe[3],he="Sheet"+(Ne+1)),ot>0&&pe[0].r>=ot)break;G.dense?(K[pe[0].r]||(K[pe[0].r]=[]),K[pe[0].r][pe[0].c]=pe[1]):K[St(pe[0])]=pe[1],ge.e.c<pe[0].c&&(ge.e.c=pe[0].c),ge.e.r<pe[0].r&&(ge.e.r=pe[0].r);break;case 27:pe[14e3]&&(Be[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Be[pe[0]]=pe[1],pe[0]==Ne&&(he=pe[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(K["!ref"]=ar(ge),re[Oe||he]=K,ye.push(Oe||he),!Be.length)return{SheetNames:ye,Sheets:re};for(var ze={},bt=[],at=0;at<Be.length;++at)re[ye[at]]?(bt.push(Be[at]||ye[at]),ze[Be[at]]=re[Be[at]]||re[ye[at]]):(bt.push(Be[at]),ze[Be[at]]={"!ref":"A1"});return{SheetNames:bt,Sheets:ze}}function n(M,J){var G=J||{};if(+G.codepage>=0&&Du(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var K=mn(),he=It(M["!ref"]),Oe=Array.isArray(M),Ne=[];Fe(K,0,i(1030)),Fe(K,6,c(he));for(var re=Math.min(he.e.r,8191),ye=he.s.r;ye<=re;++ye)for(var Be=jr(ye),ge=he.s.c;ge<=he.e.c;++ge){ye===he.s.r&&(Ne[ge]=Hr(ge));var ot=Ne[ge]+Be,ze=Oe?(M[ye]||[])[ge]:M[ot];if(!(!ze||ze.t=="z"))if(ze.t=="n")(ze.v|0)==ze.v&&ze.v>=-32768&&ze.v<=32767?Fe(K,13,v(ye,ge,ze.v)):Fe(K,14,y(ye,ge,ze.v));else{var bt=ei(ze);Fe(K,15,p(ye,ge,bt.slice(0,239)))}}return Fe(K,1),K.end()}function a(M,J){var G=J||{};if(+G.codepage>=0&&Du(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var K=mn();Fe(K,0,o(M));for(var he=0,Oe=0;he<M.SheetNames.length;++he)(M.Sheets[M.SheetNames[he]]||{})["!ref"]&&Fe(K,27,we(M.SheetNames[he],Oe++));var Ne=0;for(he=0;he<M.SheetNames.length;++he){var re=M.Sheets[M.SheetNames[he]];if(!(!re||!re["!ref"])){for(var ye=It(re["!ref"]),Be=Array.isArray(re),ge=[],ot=Math.min(ye.e.r,8191),ze=ye.s.r;ze<=ot;++ze)for(var bt=jr(ze),at=ye.s.c;at<=ye.e.c;++at){ze===ye.s.r&&(ge[at]=Hr(at));var pe=ge[at]+bt,qe=Be?(re[ze]||[])[at]:re[pe];if(!(!qe||qe.t=="z"))if(qe.t=="n")Fe(K,23,te(ze,at,Ne,qe.v));else{var Xe=ei(qe);Fe(K,22,D(ze,at,Ne,Xe.slice(0,239)))}}++Ne}}return Fe(K,1),K.end()}function i(M){var J=ve(2);return J.write_shift(2,M),J}function o(M){var J=ve(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var G=0,K=0,he=0,Oe=0;Oe<M.SheetNames.length;++Oe){var Ne=M.SheetNames[Oe],re=M.Sheets[Ne];if(!(!re||!re["!ref"])){++he;var ye=Rn(re["!ref"]);G<ye.e.r&&(G=ye.e.r),K<ye.e.c&&(K=ye.e.c)}}return G>8191&&(G=8191),J.write_shift(2,G),J.write_shift(1,he),J.write_shift(1,K),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(M,J,G){var K={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&G.qpro?(K.s.c=M.read_shift(1),M.l++,K.s.r=M.read_shift(2),K.e.c=M.read_shift(1),M.l++,K.e.r=M.read_shift(2),K):(K.s.c=M.read_shift(2),K.s.r=M.read_shift(2),J==12&&G.qpro&&(M.l+=2),K.e.c=M.read_shift(2),K.e.r=M.read_shift(2),J==12&&G.qpro&&(M.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function c(M){var J=ve(8);return J.write_shift(2,M.s.c),J.write_shift(2,M.s.r),J.write_shift(2,M.e.c),J.write_shift(2,M.e.r),J}function f(M,J,G){var K=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(K[0].c=M.read_shift(1),K[3]=M.read_shift(1),K[0].r=M.read_shift(2),M.l+=2):(K[2]=M.read_shift(1),K[0].c=M.read_shift(2),K[0].r=M.read_shift(2)),K}function d(M,J,G){var K=M.l+J,he=f(M,J,G);if(he[1].t="s",G.vers==20768){M.l++;var Oe=M.read_shift(1);return he[1].v=M.read_shift(Oe,"utf8"),he}return G.qpro&&M.l++,he[1].v=M.read_shift(K-M.l,"cstr"),he}function p(M,J,G){var K=ve(7+G.length);K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,M),K.write_shift(1,39);for(var he=0;he<K.length;++he){var Oe=G.charCodeAt(he);K.write_shift(1,Oe>=128?95:Oe)}return K.write_shift(1,0),K}function m(M,J,G){var K=f(M,J,G);return K[1].v=M.read_shift(2,"i"),K}function v(M,J,G){var K=ve(7);return K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,M),K.write_shift(2,G,"i"),K}function x(M,J,G){var K=f(M,J,G);return K[1].v=M.read_shift(8,"f"),K}function y(M,J,G){var K=ve(13);return K.write_shift(1,255),K.write_shift(2,J),K.write_shift(2,M),K.write_shift(8,G,"f"),K}function S(M,J,G){var K=M.l+J,he=f(M,J,G);if(he[1].v=M.read_shift(8,"f"),G.qpro)M.l=K;else{var Oe=M.read_shift(2);P(M.slice(M.l,M.l+Oe),he),M.l+=Oe}return he}function T(M,J,G){var K=J&32768;return J&=-32769,J=(K?M:0)+(J>=8192?J-16384:J),(K?"":"$")+(G?Hr(J):jr(J))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(M,J){kn(M,0);for(var G=[],K=0,he="",Oe="",Ne="",re="";M.l<M.length;){var ye=M[M.l++];switch(ye){case 0:G.push(M.read_shift(8,"f"));break;case 1:Oe=T(J[0].c,M.read_shift(2),!0),he=T(J[0].r,M.read_shift(2),!1),G.push(Oe+he);break;case 2:{var Be=T(J[0].c,M.read_shift(2),!0),ge=T(J[0].r,M.read_shift(2),!1);Oe=T(J[0].c,M.read_shift(2),!0),he=T(J[0].r,M.read_shift(2),!1),G.push(Be+ge+":"+Oe+he)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var ot="";ye=M[M.l++];)ot+=String.fromCharCode(ye);G.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:re=G.pop(),Ne=G.pop(),G.push(["AND","OR"][ye-20]+"("+Ne+","+re+")");break;default:if(ye<32&&A[ye])re=G.pop(),Ne=G.pop(),G.push(Ne+A[ye]+re);else if(k[ye]){if(K=k[ye][1],K==69&&(K=M[M.l++]),K>G.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+G.join("|")+"|");return}var ze=G.slice(-K);G.length-=K,G.push(k[ye][0]+"("+ze.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}G.length==1?J[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function N(M){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=M.read_shift(2),J[3]=M[M.l++],J[0].c=M[M.l++],J}function I(M,J){var G=N(M);return G[1].t="s",G[1].v=M.read_shift(J-4,"cstr"),G}function D(M,J,G,K){var he=ve(6+K.length);he.write_shift(2,M),he.write_shift(1,G),he.write_shift(1,J),he.write_shift(1,39);for(var Oe=0;Oe<K.length;++Oe){var Ne=K.charCodeAt(Oe);he.write_shift(1,Ne>=128?95:Ne)}return he.write_shift(1,0),he}function z(M,J){var G=N(M);G[1].v=M.read_shift(2);var K=G[1].v>>1;if(G[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return G[1].v=K,G}function H(M,J){var G=N(M),K=M.read_shift(4),he=M.read_shift(4),Oe=M.read_shift(2);if(Oe==65535)return K===0&&he===3221225472?(G[1].t="e",G[1].v=15):K===0&&he===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ne=Oe&32768;return Oe=(Oe&32767)-16446,G[1].v=(1-Ne*2)*(he*Math.pow(2,Oe+32)+K*Math.pow(2,Oe)),G}function te(M,J,G,K){var he=ve(14);if(he.write_shift(2,M),he.write_shift(1,G),he.write_shift(1,J),K==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Oe=0,Ne=0,re=0,ye=0;return K<0&&(Oe=1,K=-K),Ne=Math.log2(K)|0,K/=Math.pow(2,Ne-31),ye=K>>>0,(ye&2147483648)==0&&(K/=2,++Ne,ye=K>>>0),K-=ye,ye|=2147483648,ye>>>=0,K*=Math.pow(2,32),re=K>>>0,he.write_shift(4,re),he.write_shift(4,ye),Ne+=16383+(Oe?32768:0),he.write_shift(2,Ne),he}function q(M,J){var G=H(M);return M.l+=J-14,G}function V(M,J){var G=N(M),K=M.read_shift(4);return G[1].v=K>>6,G}function ae(M,J){var G=N(M),K=M.read_shift(8,"f");return G[1].v=K,G}function Ee(M,J){var G=ae(M);return M.l+=J-10,G}function Z(M,J){return M[M.l+J-1]==0?M.read_shift(J,"cstr"):""}function Te(M,J){var G=M[M.l++];G>J-1&&(G=J-1);for(var K="";K.length<G;)K+=String.fromCharCode(M[M.l++]);return K}function Se(M,J,G){if(!(!G.qpro||J<21)){var K=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var he=M.read_shift(J-21,"cstr");return[K,he]}}function me(M,J){for(var G={},K=M.l+J;M.l<K;){var he=M.read_shift(2);if(he==14e3){for(G[he]=[0,""],G[he][0]=M.read_shift(2);M[M.l];)G[he][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function we(M,J){var G=ve(5+M.length);G.write_shift(2,14e3),G.write_shift(2,J);for(var K=0;K<M.length;++K){var he=M.charCodeAt(K);G[G.l++]=he>127?95:he}return G[G.l++]=0,G}var be={0:{n:"BOF",f:OA},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:Te},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ae},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),UR=/^\s|\s$|[\t\n\r]/;function RA(e,t){if(!t.bookSST)return"";var r=[sr];r[r.length]=Ie("sst",null,{xmlns:ll[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(UR)&&(i+=' xml:space="preserve"'),i+=">"+wt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function WR(e){return[e.read_shift(4),e.read_shift(4)]}function zR(e,t){return t||(t=ve(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var KR=RM;function HR(e){var t=mn();_e(t,159,zR(e));for(var r=0;r<e.length;++r)_e(t,19,KR(e[r]));return _e(t,160),t.end()}function VR(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function IA(e){var t=0,r,n=VR(e),a=n.length+1,i,o,u,c,f;for(r=Bs(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(t&16384)===0?0:1,c=t<<1&32767,f=u|c,t=f^o;return t^52811}var GR=function(){function e(a,i){switch(i.type){case"base64":return t(Ja(a),i);case"binary":return t(a,i);case"buffer":return t(mt&&Buffer.isBuffer(a)?a.toString("binary"):Qu(a),i);case"array":return t(b0(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},u=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,p){Array.isArray(u)&&(u[p]=[]);for(var m=/\\\w+\b/g,v=0,x,y=-1;x=m.exec(d);){switch(x[0]){case"\\cell":var S=d.slice(v,m.lastIndex-x[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var T={v:S,t:"s"};Array.isArray(u)?u[p][y]=T:u[St({r:p,c:y})]=T}break}v=m.lastIndex}y>f.e.c&&(f.e.c=y)}),u["!ref"]=ar(f),u}function r(a,i){return Qs(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=It(a["!ref"]),u,c=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var p=St({r:f,c:d});u=c?(a[f]||[])[d]:a[p],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(ei(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function m2(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var YR=6,qa=YR;function Pd(e){return Math.floor((e+Math.round(128/qa)/256)*qa)}function Cd(e){return Math.floor((e-5)/qa*100+.5)/100}function Bg(e){return Math.round((e*qa+5)/qa*256)/256}function qv(e){e.width?(e.wpx=Pd(e.width),e.wch=Cd(e.wpx),e.MDW=qa):e.wpx?(e.wch=Cd(e.wpx),e.width=Bg(e.wch),e.MDW=qa):typeof e.wch=="number"&&(e.width=Bg(e.wch),e.wpx=Pd(e.width),e.MDW=qa),e.customWidth&&delete e.customWidth}var qR=96,FA=qR;function Nd(e){return e*96/FA}function jA(e){return e*FA/96}function XR(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ie("numFmt",null,{numFmtId:n,formatCode:wt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function QR(e){var t=[];return t[t.length]=Ie("cellXfs",null),e.forEach(function(r){t[t.length]=Ie("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function LA(e,t){var r=[sr,Ie("styleSheet",null,{xmlns:ll[0],"xmlns:vt":_r.vt})],n;return e.SSF&&(n=XR(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=QR(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ZR(e,t){var r=e.read_shift(2),n=Vr(e);return[r,n]}function JR(e,t,r){r||(r=ve(6+4*t.length)),r.write_shift(2,e),Ar(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function eI(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=UM(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=$M(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vr(e),n}function tI(e,t){t||(t=ve(153)),t.write_shift(2,e.sz*20),WM(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),kd(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ar(e.name,t),t.length>t.l?t.slice(0,t.l):t}var rI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Jp,nI=Oa;function g2(e,t){t||(t=ve(84)),Jp||(Jp=jv(rI));var r=Jp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(kd({auto:1},t),kd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function aI(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function BA(e,t,r){r||(r=ve(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hu(e,t){return t||(t=ve(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var iI=Oa;function sI(e,t){return t||(t=ve(51)),t.write_shift(1,0),hu(null,t),hu(null,t),hu(null,t),hu(null,t),hu(null,t),t.length>t.l?t.slice(0,t.l):t}function oI(e,t){return t||(t=ve(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ad(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function lI(e,t,r){var n=ve(2052);return n.write_shift(4,e),Ad(t,n),Ad(r,n),n.length>n.l?n.slice(0,n.l):n}function uI(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(_e(e,615,ga(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&_e(e,44,JR(a,t[a]))}),_e(e,616))}}function cI(e){var t=1;_e(e,611,ga(t)),_e(e,43,tI({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(e,612)}function fI(e){var t=2;_e(e,603,ga(t)),_e(e,45,g2({patternType:"none"})),_e(e,45,g2({patternType:"gray125"})),_e(e,604)}function dI(e){var t=1;_e(e,613,ga(t)),_e(e,46,sI()),_e(e,614)}function hI(e){var t=1;_e(e,626,ga(t)),_e(e,47,BA({numFmtId:0},65535)),_e(e,627)}function pI(e,t){_e(e,617,ga(t.length)),t.forEach(function(r){_e(e,47,BA(r,0))}),_e(e,618)}function mI(e){var t=1;_e(e,619,ga(t)),_e(e,48,oI({xfId:0,name:"Normal"})),_e(e,620)}function gI(e){var t=0;_e(e,505,ga(t)),_e(e,506)}function vI(e){var t=0;_e(e,508,lI(t,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function yI(e,t){var r=mn();return _e(r,278),uI(r,e.SSF),cI(r),fI(r),dI(r),hI(r),pI(r,t.cellXfs),mI(r),gI(r),vI(r),_e(r,279),r.end()}function $A(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[sr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function xI(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vr(e)}}function wI(e){var t=ve(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ar(e.name,t),t.slice(0,t.l)}function SI(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function bI(e){var t=ve(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function EI(e,t){var r=ve(8+2*t.length);return r.write_shift(4,e),Ar(t,r),r.slice(0,r.l)}function _I(e){return e.l+=4,e.read_shift(4)!=0}function TI(e,t){var r=ve(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AI(){var e=mn();return _e(e,332),_e(e,334,ga(1)),_e(e,335,wI({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,EI(1,"XLDAPR")),_e(e,52),_e(e,35,ga(514)),_e(e,4096,ga(0)),_e(e,4097,Yn(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,TI(1)),_e(e,51,bI([[1,0]])),_e(e,338),_e(e,333),e.end()}function UA(){var e=[sr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function kI(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=St(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Uo=1024;function WA(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ie("xml",null,{"xmlns:v":Pn.v,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:mv":Pn.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Uo<e*1e3;)Uo+=1e3;return t.forEach(function(i){var o=Tr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var c=u.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ie("v:fill",c,u),d={on:"t",obscured:"t"};++Uo,a=a.concat(["<v:shape"+Fu({id:"_x0000_s"+Uo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ie("v:shadow",null,d),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ir("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ir("x:AutoFill","False"),Ir("x:Row",String(o.r)),Ir("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function zA(e){var t=[sr,Ie("comments",null,{xmlns:ll[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=wt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(wt(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Ir("t",wt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)o+=`Reply:
    `+i[u]+`
`;t.push(Ir("t",wt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function OI(e,t,r){var n=[sr,Ie("ThreadedComments",null,{xmlns:_r.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Ie("threadedComment",Ir("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function PI(e){var t=[sr,Ie("personList",null,{xmlns:_r.TCMNT,"xmlns:x":ll[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function CI(e){var t={};t.iauthor=e.read_shift(4);var r=to(e);return t.rfx=r.s,t.ref=St(r.s),e.l+=16,t}function NI(e,t){return t==null&&(t=ve(36)),t.write_shift(4,e[1].iauthor),cl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var DI=Vr;function MI(e){return Ar(e.slice(0,54))}function RI(e){var t=mn(),r=[];return _e(t,628),_e(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),_e(t,632,MI(a.a)))})}),_e(t,631),_e(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Tr(n[0]),e:Tr(n[0])};_e(t,635,NI([i,a])),a.t&&a.t.length>0&&_e(t,637,FM(a)),_e(t,636),delete a.iauthor})}),_e(t,634),_e(t,629),t.end()}function II(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&_t.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var KA=["xlsb","xlsm","xlam","biff8","xla"],FI=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var u=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return u?d+=t.c:--d,c?f+=t.r:--f,a+(u?"":"$")+Hr(d)+(c?"":"$")+jr(f)}return function(a,i){return t=i,a.replace(e,r)}}(),Xv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Qv=function(){return function(t,r){return t.replace(Xv,function(n,a,i,o,u,c){var f=Kv(o)-(i?0:r.c),d=zv(c)-(u?0:r.r),p=d==0?"":u?d+1:"["+d+"]",m=f==0?"":i?f+1:"["+f+"]";return a+"R"+p+"C"+m})}}();function jI(e,t){return e.replace(Xv,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Hr(Kv(i)+t.c))+(o=="$"?o+u:jr(zv(u)+t.r))})}function LI(e){return e.length!=1}function rr(e){e.l+=1}function Gi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function HA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return VA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Gi(e),u=Gi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function VA(e){var t=Gi(e),r=Gi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function BI(e,t,r){if(r.biff<8)return VA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Gi(e),o=Gi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function GA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return $I(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Gi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function $I(e){var t=Gi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function UI(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function WI(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return zI(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function zI(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function KI(e,t,r){var n=(e[e.l++]&96)>>5,a=HA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function HI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=HA(e,i,r);return[n,a,o]}function VI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function GI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function YI(e,t,r){var n=(e[e.l++]&96)>>5,a=BI(e,t-1,r);return[n,a]}function qI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function XI(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function QI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ZI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function JI(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function eF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function YA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function tF(e){return e.read_shift(2),YA(e)}function rF(e){return e.read_shift(2),YA(e)}function nF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=GA(e,0,r);return[n,a]}function aF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=WI(e,0,r);return[n,a]}function iF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=GA(e,0,r);return[n,a,i]}function sF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[sj[a],QA[a],n]}function oF(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:lF(e);return[a,(i[0]===0?QA:ij)[i[1]]]}function lF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uF(e,t,r){e.l+=r&&r.biff==2?3:4}function cF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fF(e){return e.l++,ec[e.read_shift(1)]}function dF(e){return e.l++,e.read_shift(2)}function hF(e){return e.l++,e.read_shift(1)!==0}function pF(e){return e.l++,fl(e)}function mF(e,t,r){return e.l++,CA(e,t-1,r)}function gF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=iR(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ec[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=fl(e);break;case 2:r[1]=uR(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function vF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?to:dR)(e));return a}function yF(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=gF(e,r.biff);return o}function xF(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function wF(e,t,r){if(r.biff==5)return SF(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function SF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function bF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function EF(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _F(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function TF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var AF=Oa,kF=Oa,OF=Oa;function tc(e,t,r){return e.l+=2,[UI(e)]}function Zv(e){return e.l+=6,[]}var PF=tc,CF=Zv,NF=Zv,DF=tc;function qA(e){return e.l+=2,[OA(e),e.read_shift(2)&1]}var MF=tc,RF=qA,IF=Zv,FF=tc,jF=tc,LF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=LF[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function $F(e){return e.l+=2,[e.read_shift(4)]}function UF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function WF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function zF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function KF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function HF(e){return e.l+=4,[0,0]}var y2={1:{n:"PtgExp",f:cF},2:{n:"PtgTbl",f:OF},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:mF},26:{n:"PtgSheet",f:UF},27:{n:"PtgEndSheet",f:WF},28:{n:"PtgErr",f:fF},29:{n:"PtgBool",f:hF},30:{n:"PtgInt",f:dF},31:{n:"PtgNum",f:pF},32:{n:"PtgArray",f:qI},33:{n:"PtgFunc",f:sF},34:{n:"PtgFuncVar",f:oF},35:{n:"PtgName",f:xF},36:{n:"PtgRef",f:nF},37:{n:"PtgArea",f:KI},38:{n:"PtgMemArea",f:bF},39:{n:"PtgMemErr",f:AF},40:{n:"PtgMemNoMem",f:kF},41:{n:"PtgMemFunc",f:EF},42:{n:"PtgRefErr",f:_F},43:{n:"PtgAreaErr",f:VI},44:{n:"PtgRefN",f:aF},45:{n:"PtgAreaN",f:YI},46:{n:"PtgMemAreaN",f:zF},47:{n:"PtgMemNoMemN",f:KF},57:{n:"PtgNameX",f:wF},58:{n:"PtgRef3d",f:iF},59:{n:"PtgArea3d",f:HI},60:{n:"PtgRefErr3d",f:TF},61:{n:"PtgAreaErr3d",f:GI},255:{}},VF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GF={1:{n:"PtgElfLel",f:qA},2:{n:"PtgElfRw",f:FF},3:{n:"PtgElfCol",f:PF},6:{n:"PtgElfRwV",f:jF},7:{n:"PtgElfColV",f:DF},10:{n:"PtgElfRadical",f:MF},11:{n:"PtgElfRadicalS",f:IF},13:{n:"PtgElfColS",f:CF},15:{n:"PtgElfColSV",f:NF},16:{n:"PtgElfRadicalLel",f:RF},25:{n:"PtgList",f:BF},29:{n:"PtgSxName",f:$F},255:{}},YF={0:{n:"PtgAttrNoop",f:HF},1:{n:"PtgAttrSemi",f:eF},2:{n:"PtgAttrIf",f:ZI},4:{n:"PtgAttrChoose",f:XI},8:{n:"PtgAttrGoto",f:QI},16:{n:"PtgAttrSum",f:uF},32:{n:"PtgAttrBaxcel",f:v2},33:{n:"PtgAttrBaxcel",f:v2},64:{n:"PtgAttrSpace",f:tF},65:{n:"PtgAttrSpaceSemi",f:rF},128:{n:"PtgAttrIfError",f:JI},255:{}};function qF(e,t,r,n){if(n.biff<8)return Oa(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=yF(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=vF(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Oa(e,t)),i}function XF(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=y2[i]||y2[VF[i]],(i===24||i===25)&&(a=(i===24?GF:YF)[e[e.l+1]]),!a||!a.f?Oa(e,t):o.push([a.n,a.f(e,t,r)]);return o}function QF(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var ZF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JF(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function XA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function x2(e,t,r){var n=XA(e,t,r);return n=="#REF"?n:JF(n,r)}function Qo(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],c,f,d,p=0,m=0,v,x="";if(!e[0]||!e[0][0])return"";for(var y=-1,S="",T=0,k=e[0].length;T<k;++T){var A=e[0][T];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=u.pop(),f=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:S=Yt(" ",e[0][y][1][1]);break;case 1:S=Yt("\r",e[0][y][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+S,y=-1}u.push(f+ZF[A[0]]+c);break;case"PtgIsect":c=u.pop(),f=u.pop(),u.push(f+" "+c);break;case"PtgUnion":c=u.pop(),f=u.pop(),u.push(f+","+c);break;case"PtgRange":c=u.pop(),f=u.pop(),u.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ou(A[1][1],o,a),u.push(Pu(d,i));break;case"PtgRefN":d=r?Ou(A[1][1],r,a):A[1][1],u.push(Pu(d,i));break;case"PtgRef3d":p=A[1][1],d=Ou(A[1][2],o,a),x=x2(n,p,a),u.push(x+"!"+Pu(d,i));break;case"PtgFunc":case"PtgFuncVar":var P=A[1][0],N=A[1][1];P||(P=0),P&=127;var I=P==0?[]:u.slice(-P);u.length-=P,N==="User"&&(N=I.shift()),u.push(N+"("+I.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":v=n2(A[1][1],r?{s:r}:o,a),u.push(Qp(v,a));break;case"PtgArea":v=n2(A[1][1],o,a),u.push(Qp(v,a));break;case"PtgArea3d":p=A[1][1],v=A[1][2],x=x2(n,p,a),u.push(x+"!"+Qp(v,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=A[1][2];var D=(n.names||[])[m-1]||(n[0]||[])[m],z=D?D.Name:"SH33TJSNAME"+String(m);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var H=A[1][1];m=A[1][2];var te;if(a.biff<=5)H<0&&(H=-H),n[H]&&(te=n[H][m]);else{var q="";if(((n[H]||[])[0]||[])[0]==14849||(((n[H]||[])[0]||[])[0]==1025?n[H][m]&&n[H][m].itab>0&&(q=n.SheetNames[n[H][m].itab-1]+"!"):q=n.SheetNames[m-1]+"!"),n[H]&&n[H][m])q+=n[H][m].Name;else if(n[0]&&n[0][m])q+=n[0][m].Name;else{var V=(XA(n,H,a)||"").split(";;");V[m-1]?q=V[m-1]:q+="SH33TJSERRX"}u.push(q);break}te||(te={Name:"SH33TJSERRY"}),u.push(te.Name);break;case"PtgParen":var ae="(",Ee=")";if(y>=0){switch(S="",e[0][y][1][0]){case 2:ae=Yt(" ",e[0][y][1][1])+ae;break;case 3:ae=Yt("\r",e[0][y][1][1])+ae;break;case 4:Ee=Yt(" ",e[0][y][1][1])+Ee;break;case 5:Ee=Yt("\r",e[0][y][1][1])+Ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(ae+u.pop()+Ee);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":d={c:A[1][1],r:A[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[St(d)]){var Te=n.sharedf[St(d)];u.push(Qo(Te,o,Z,n,a))}else{var Se=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){u.push(Qo(f[1],o,Z,n,a)),Se=!0;break}Se||u.push(A[1])}break;case"PtgArray":u.push("{"+QF(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&me.indexOf(e[0][T][0])==-1){A=e[0][y];var we=!0;switch(A[1][0]){case 4:we=!1;case 0:S=Yt(" ",A[1][1]);break;case 5:we=!1;case 1:S=Yt("\r",A[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((we?S:"")+u.pop()+(we?"":S)),y=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function ej(e){if(e==null){var t=ve(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $s(e);return $s(0)}function tj(e,t,r,n,a){var i=Us(t,r,a),o=ej(e.v),u=ve(6),c=33;u.write_shift(2,c),u.write_shift(4,0);for(var f=ve(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var p=Rr([i,o,u,f]);return p}function E0(e,t,r){var n=e.read_shift(4),a=XF(e,n,r),i=e.read_shift(4),o=i>0?qF(e,i,a,r):null;return[a,o]}var rj=E0,_0=E0,nj=E0,aj=E0,ij={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},QA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oj(e){var t="of:="+e.replace(Xv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function lj(e){return e.replace(/\./,"!")}var Cu=typeof Map<"u";function Jv(e,t,r){var n=0,a=e.length;if(r){if(Cu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Cu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Cu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function T0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(qa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Cd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Bg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ZA(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function es(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){GT(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function uj(e,t,r){if(e&&e["!ref"]){var n=It(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function cj(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ar(e[r])+'"/>';return t+"</mergeCells>"}function fj(e,t,r,n,a){var i=!1,o={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=Iu(wt(c))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),u=(u||"")+Ie("outlinePr",null,f)}!i&&!u||(a[a.length]=Ie("sheetPr",u,o))}var dj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pj(e){var t={sheet:1};return dj.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),hj.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=IA(e.password).toString(16).toUpperCase()),Ie("sheetProtection",null,t)}function mj(e){return ZA(e),Ie("pageMargins",null,e)}function gj(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ie("col",null,T0(a,n)));return r[r.length]="</cols>",r.join("")}function vj(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ar(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Rn(a);o.s.r==o.e.r&&(o.e.r=Rn(t["!ref"]).e.r,a=ar(o));for(var u=0;u<i.length;++u){var c=i[u];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ie("autoFilter",null,{ref:a})}function yj(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,a),{})}function xj(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ec[e.v];break;case"d":n&&n.cellDates?a=nn(e.v,-1).toISOString():(e=vn(e),e.t="n",a=""+(e.v=gn(nn(e.v)))),typeof e.z>"u"&&(e.z=Xt[14]);break;default:a=e.v;break}var u=Ir("v",wt(a)),c={r:t},f=es(n.cellXfs,e,n);switch(f!==0&&(c.s=f),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Ir("v",""+Jv(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Ie("f",wt(e.f),d)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ie("c",u,c)}function wj(e,t,r,n){var a=[],i=[],o=It(e["!ref"]),u="",c,f="",d=[],p=0,m=0,v=e["!rows"],x=Array.isArray(e),y={r:f},S,T=-1;for(m=o.s.c;m<=o.e.c;++m)d[m]=Hr(m);for(p=o.s.r;p<=o.e.r;++p){for(i=[],f=jr(p),m=o.s.c;m<=o.e.c;++m){c=d[m]+f;var k=x?(e[p]||[])[m]:e[c];k!==void 0&&(u=xj(k,c,e,t))!=null&&i.push(u)}(i.length>0||v&&v[p])&&(y={r:f},v&&v[p]&&(S=v[p],S.hidden&&(y.hidden=1),T=-1,S.hpx?T=Nd(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(y.ht=T,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),a[a.length]=Ie("row",i.join(""),y))}if(v)for(;p<v.length;++p)v&&v[p]&&(y={r:p+1},S=v[p],S.hidden&&(y.hidden=1),T=-1,S.hpx?T=Nd(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(y.ht=T,y.customHeight=1),S.level&&(y.outlineLevel=S.level),a[a.length]=Ie("row","",y));return a.join("")}function JA(e,t,r,n){var a=[sr,Ie("worksheet",null,{xmlns:ll[0],"xmlns:r":_r.r})],i=r.SheetNames[e],o=0,u="",c=r.Sheets[i];c==null&&(c={});var f=c["!ref"]||"A1",d=It(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=ar(d)}n||(n={}),c["!comments"]=[];var p=[];fj(c,r,e,t,a),a[a.length]=Ie("dimension",null,{ref:f}),a[a.length]=yj(c,t,e,r),t.sheetFormat&&(a[a.length]=Ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=gj(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(u=wj(c,t),u.length>0&&(a[a.length]=u)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=pj(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=vj(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=cj(c["!merges"]));var m=-1,v,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(y){y[1].Target&&(v={ref:y[0]},y[1].Target.charAt(0)!="#"&&(x=yt(n,-1,wt(y[1].Target).replace(/#.*$/,""),dt.HLINK),v["r:id"]="rId"+x),(m=y[1].Target.indexOf("#"))>-1&&(v.location=wt(y[1].Target.slice(m+1))),y[1].Tooltip&&(v.tooltip=wt(y[1].Tooltip)),a[a.length]=Ie("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=mj(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ir("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(x=yt(n,-1,"../drawings/drawing"+(e+1)+".xml",dt.DRAW),a[a.length]=Ie("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=p),c["!comments"].length>0&&(x=yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dt.VML),a[a.length]=Ie("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Sj(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function bj(e,t,r){var n=ve(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Nd(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,c=n.l;n.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var p=-1,m=-1,v=d<<10;v<d+1<<10;++v){f.c=v;var x=Array.isArray(r)?(r[f.r]||[])[f.c]:r[St(f)];x&&(p<0&&(p=v),m=v)}p<0||(++u,n.write_shift(4,p),n.write_shift(4,m))}var y=n.l;return n.l=c,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function Ej(e,t,r,n){var a=bj(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&_e(e,0,a)}var _j=to,Tj=cl;function Aj(){}function kj(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=jM(e),r}function Oj(e,t,r){r==null&&(r=ve(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return kd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),pA(e,r),r.slice(0,r.l)}function Pj(e){var t=ea(e);return[t]}function Cj(e,t,r){return r==null&&(r=ve(8)),Zs(t,r)}function Nj(e){var t=Js(e);return[t]}function Dj(e,t,r){return r==null&&(r=ve(4)),eo(t,r)}function Mj(e){var t=ea(e),r=e.read_shift(1);return[t,r,"b"]}function Rj(e,t,r){return r==null&&(r=ve(9)),Zs(t,r),r.write_shift(1,e.v?1:0),r}function Ij(e){var t=Js(e),r=e.read_shift(1);return[t,r,"b"]}function Fj(e,t,r){return r==null&&(r=ve(5)),eo(t,r),r.write_shift(1,e.v?1:0),r}function jj(e){var t=ea(e),r=e.read_shift(1);return[t,r,"e"]}function Lj(e,t,r){return r==null&&(r=ve(9)),Zs(t,r),r.write_shift(1,e.v),r}function Bj(e){var t=Js(e),r=e.read_shift(1);return[t,r,"e"]}function $j(e,t,r){return r==null&&(r=ve(8)),eo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Uj(e){var t=ea(e),r=e.read_shift(4);return[t,r,"s"]}function Wj(e,t,r){return r==null&&(r=ve(12)),Zs(t,r),r.write_shift(4,t.v),r}function zj(e){var t=Js(e),r=e.read_shift(4);return[t,r,"s"]}function Kj(e,t,r){return r==null&&(r=ve(8)),eo(t,r),r.write_shift(4,t.v),r}function Hj(e){var t=ea(e),r=fl(e);return[t,r,"n"]}function Vj(e,t,r){return r==null&&(r=ve(16)),Zs(t,r),$s(e.v,r),r}function Gj(e){var t=Js(e),r=fl(e);return[t,r,"n"]}function Yj(e,t,r){return r==null&&(r=ve(12)),eo(t,r),$s(e.v,r),r}function qj(e){var t=ea(e),r=mA(e);return[t,r,"n"]}function Xj(e,t,r){return r==null&&(r=ve(12)),Zs(t,r),gA(e.v,r),r}function Qj(e){var t=Js(e),r=mA(e);return[t,r,"n"]}function Zj(e,t,r){return r==null&&(r=ve(8)),eo(t,r),gA(e.v,r),r}function Jj(e){var t=ea(e),r=Hv(e);return[t,r,"is"]}function eL(e){var t=ea(e),r=Vr(e);return[t,r,"str"]}function tL(e,t,r){return r==null&&(r=ve(12+4*e.v.length)),Zs(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function rL(e){var t=Js(e),r=Vr(e);return[t,r,"str"]}function nL(e,t,r){return r==null&&(r=ve(8+4*e.v.length)),eo(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aL(e,t,r){var n=e.l+t,a=ea(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var u=_0(e,n-e.l,r);o[3]=Qo(u,null,a,r.supbooks,r)}else e.l=n;return o}function iL(e,t,r){var n=e.l+t,a=ea(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var u=_0(e,n-e.l,r);o[3]=Qo(u,null,a,r.supbooks,r)}else e.l=n;return o}function sL(e,t,r){var n=e.l+t,a=ea(e);a.r=r["!row"];var i=fl(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var u=_0(e,n-e.l,r);o[3]=Qo(u,null,a,r.supbooks,r)}else e.l=n;return o}function oL(e,t,r){var n=e.l+t,a=ea(e);a.r=r["!row"];var i=Vr(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var u=_0(e,n-e.l,r);o[3]=Qo(u,null,a,r.supbooks,r)}else e.l=n;return o}var lL=to,uL=cl;function cL(e,t){return t==null&&(t=ve(4)),t.write_shift(4,e),t}function fL(e,t){var r=e.l+t,n=to(e),a=Vv(e),i=Vr(e),o=Vr(e),u=Vr(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:u};return o&&(c.Tooltip=o),c}function dL(e,t){var r=ve(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));cl({s:Tr(e[0]),e:Tr(e[0])},r),Gv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Ar(a||"",r),Ar(e[1].Tooltip||"",r),Ar("",r),r.slice(0,r.l)}function hL(){}function pL(e,t,r){var n=e.l+t,a=vA(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=rj(e,n-e.l,r);o[1]=u}else e.l=n;return o}function mL(e,t,r){var n=e.l+t,a=to(e),i=[a];if(r.cellFormula){var o=aj(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function gL(e,t,r){r==null&&(r=ve(18));var n=T0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var ek=["left","right","top","bottom","header","footer"];function vL(e){var t={};return ek.forEach(function(r){t[r]=fl(e)}),t}function yL(e,t){return t==null&&(t=ve(48)),ZA(e),ek.forEach(function(r){$s(e[r],t)}),t}function xL(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function wL(e,t,r){r==null&&(r=ve(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function SL(e){var t=ve(24);return t.write_shift(4,4),t.write_shift(4,1),cl(e,t),t}function bL(e,t){return t==null&&(t=ve(66)),t.write_shift(2,e.password?IA(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function EL(){}function _L(){}function TL(e,t,r,n,a,i,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=vn(t),t.z=t.z||Xt[14],t.v=gn(nn(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var c={r,c:n};switch(c.s=es(a.cellXfs,t,a),t.l&&i["!links"].push([St(c),t.l]),t.c&&i["!comments"].push([St(c),t.c]),t.t){case"s":case"str":return a.bookSST?(u=Jv(a.Strings,t.v,a.revStrings),c.t="s",c.v=u,o?_e(e,18,Kj(t,c)):_e(e,7,Wj(t,c))):(c.t="str",o?_e(e,17,nL(t,c)):_e(e,6,tL(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?_e(e,13,Zj(t,c)):_e(e,2,Xj(t,c)):o?_e(e,16,Yj(t,c)):_e(e,5,Vj(t,c)),!0;case"b":return c.t="b",o?_e(e,15,Fj(t,c)):_e(e,4,Rj(t,c)),!0;case"e":return c.t="e",o?_e(e,14,$j(t,c)):_e(e,3,Lj(t,c)),!0}return o?_e(e,12,Dj(t,c)):_e(e,1,Cj(t,c)),!0}function AL(e,t,r,n){var a=It(t["!ref"]||"A1"),i,o="",u=[];_e(e,145);var c=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=f;++d){o=jr(d),Ej(e,t,a,d);var p=!1;if(d<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){d===a.s.r&&(u[m]=Hr(m)),i=u[m]+o;var v=c?(t[d]||[])[m]:t[i];if(!v){p=!1;continue}p=TL(e,v,d,m,n,t,p)}}_e(e,146)}function kL(e,t){!t||!t["!merges"]||(_e(e,177,cL(t["!merges"].length)),t["!merges"].forEach(function(r){_e(e,176,uL(r))}),_e(e,178))}function OL(e,t){!t||!t["!cols"]||(_e(e,390),t["!cols"].forEach(function(r,n){r&&_e(e,60,gL(n,r))}),_e(e,391))}function PL(e,t){!t||!t["!ref"]||(_e(e,648),_e(e,649,SL(It(t["!ref"]))),_e(e,650))}function CL(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=yt(r,-1,n[1].Target.replace(/#.*$/,""),dt.HLINK);_e(e,494,dL(n,a))}}),delete t["!links"]}function NL(e,t,r,n){if(t["!comments"].length>0){var a=yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",dt.VML);_e(e,551,Gv("rId"+a)),t["!legacy"]=a}}function DL(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:ar(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=Rn(i);u.s.r==u.e.r&&(u.e.r=Rn(t["!ref"]).e.r,i=ar(u));for(var c=0;c<o.length;++c){var f=o[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),_e(e,161,cl(It(i))),_e(e,162)}}function ML(e,t,r){_e(e,133),_e(e,137,wL(t,r)),_e(e,138),_e(e,134)}function RL(e,t){t["!protect"]&&_e(e,535,bL(t["!protect"]))}function IL(e,t,r,n){var a=mn(),i=r.SheetNames[e],o=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var c=It(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],_e(a,129),(r.vbaraw||o["!outline"])&&_e(a,147,Oj(u,o["!outline"])),_e(a,148,Tj(c)),ML(a,o,r.Workbook),OL(a,o),AL(a,o,e,t),RL(a,o),DL(a,o,r,e),kL(a,o),CL(a,o,n),o["!margins"]&&_e(a,476,yL(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&PL(a,o),NL(a,o,e,n),_e(a,130),a.end()}function FL(e,t){e.l+=10;var r=Vr(e);return{name:r}}var jL=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function LL(e){return!e.Workbook||!e.Workbook.WBProps?"false":mM(e.Workbook.WBProps.date1904)?"true":"false"}var BL="][*?/\\".split("");function tk(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return BL.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function $L(e,t,r){e.forEach(function(n,a){tk(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function UL(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];$L(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)uj(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function rk(e){var t=[sr];t[t.length]=Ie("workbook",null,{xmlns:ll[0],"xmlns:r":_r.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(jL.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ie("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:wt(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ie("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var c={name:u.Name};u.Comment&&(c.comment=u.Comment),u.Sheet!=null&&(c.localSheetId=""+u.Sheet),u.Hidden&&(c.hidden="1"),u.Ref&&(t[t.length]=Ie("definedName",wt(u.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function WL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Lg(e),r.name=Vr(e),r}function zL(e,t){return t||(t=ve(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Gv(e.strRelID,t),Ar(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function KL(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Vr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HL(e,t){t||(t=ve(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),pA(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function VL(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=LM(e),o=nj(e,0,r),u=Vv(e);e.l=n;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),u&&(c.Comment=u),c}function GL(e,t){_e(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};_e(e,156,zL(a))}_e(e,144)}function YL(e,t){t||(t=ve(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ar("SheetJS",t),Ar(xd.version,t),Ar(xd.version,t),Ar("7262",t),t.length>t.l?t.slice(0,t.l):t}function qL(e,t){t||(t=ve(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function XL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(_e(e,135),_e(e,158,qL(a)),_e(e,136))}}function QL(e,t){var r=mn();return _e(r,131),_e(r,128,YL()),_e(r,153,HL(e.Workbook&&e.Workbook.WBProps||null)),XL(r,e),GL(r,e),_e(r,132),r.end()}function ZL(e,t,r){return(t.slice(-4)===".bin"?QL:rk)(e)}function JL(e,t,r,n,a){return(t.slice(-4)===".bin"?IL:JA)(e,r,n,a)}function e5(e,t,r){return(t.slice(-4)===".bin"?yI:LA)(e,r)}function t5(e,t,r){return(t.slice(-4)===".bin"?HR:RA)(e,r)}function r5(e,t,r){return(t.slice(-4)===".bin"?RI:zA)(e)}function n5(e){return(e.slice(-4)===".bin"?AI:UA)()}function a5(e,t){var r=[];return e.Props&&r.push(eR(e.Props,t)),e.Custprops&&r.push(tR(e.Props,e.Custprops)),r.join("")}function i5(){return""}function s5(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ie("NumberFormat",null,{"ss:Format":wt(Xt[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Ie("Style",i.join(""),o))}),Ie("Styles",r.join(""))}function nk(e){return Ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Qv(e.Ref,{r:0,c:0})})}function o5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(nk(a)))}return Ie("Names",r.join(""))}function l5(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var u=a[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(nk(u)))}return i.join("")}function u5(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ie("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ie("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ir("ProtectContents","True")),e["!protect"].objects&&a.push(Ir("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ir("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ir("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ir("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Ie("WorksheetOptions",a.join(""),{xmlns:Pn.x})}function c5(e){return e.map(function(t){var r=pM(t.t||""),n=Ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",n,{"ss:Author":t.a})}).join("")}function f5(e,t,r,n,a,i,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+wt(Qv(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Tr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=wt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=wt(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],d=0;d!=f.length;++d)f[d].s.c!=o.c||f[d].s.r!=o.r||(f[d].e.c>f[d].s.c&&(u["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(u["ss:MergeDown"]=f[d].e.r-f[d].s.r));var p="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(e.v);break;case"b":p="Boolean",m=e.v?"1":"0";break;case"e":p="Error",m=ec[e.v];break;case"d":p="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Xt[14]);break;case"s":p="String",m=hM(e.v||"");break}var v=es(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+v),u["ss:Index"]=o.c+1;var x=e.v!=null?m:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+x+"</Data>";return(e.c||[]).length>0&&(y+=c5(e.c)),Ie("Cell",y,u)}function d5(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=jA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function h5(e,t,r,n){if(!e["!ref"])return"";var a=It(e["!ref"]),i=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,T){qv(S);var k=!!S.width,A=T0(T,S),P={"ss:Index":T+1};k&&(P["ss:Width"]=Pd(A.width)),S.hidden&&(P["ss:Hidden"]="1"),u.push(Ie("Column",null,P))});for(var c=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var d=[d5(f,(e["!rows"]||[])[f])],p=a.s.c;p<=a.e.c;++p){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>p)&&!(i[o].s.r>f)&&!(i[o].e.c<p)&&!(i[o].e.r<f)){(i[o].s.c!=p||i[o].s.r!=f)&&(m=!0);break}if(!m){var v={r:f,c:p},x=St(v),y=c?(e[f]||[])[p]:e[x];d.push(f5(y,x,e,t,r,n,v))}}d.push("</Row>"),d.length>2&&u.push(d.join(""))}return u.join("")}function p5(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],o=i?l5(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?h5(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(u5(i,t,e,r)),n.join("")}function m5(e,t){t||(t={}),e.SSF||(e.SSF=vn(Xt)),e.SSF&&(w0(),x0(e.SSF),t.revssf=S0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(a5(e,t)),r.push(i5()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ie("Worksheet",p5(n,t,e),{"ss:Name":wt(e.SheetNames[n])}));return r[2]=s5(e,t),r[3]=o5(e),sr+Ie("Workbook",r.join(""),{xmlns:Pn.ss,"xmlns:o":Pn.o,"xmlns:x":Pn.x,"xmlns:ss":Pn.ss,"xmlns:dt":Pn.dt,"xmlns:html":Pn.html})}var em={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function g5(e,t){var r=[],n=[],a=[],i=0,o,u=VS(i2,"n"),c=VS(s2,"n");if(e.Props)for(o=Lr(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Lr(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Custprops[o[i]]]);var f=[];for(i=0;i<a.length;++i)kA.indexOf(a[i][0])>-1||_A.indexOf(a[i][0])>-1||a[i][1]!=null&&f.push(a[i]);n.length&&_t.utils.cfb_add(t,"/SummaryInformation",f2(n,em.SI,c,s2)),(r.length||f.length)&&_t.utils.cfb_add(t,"/DocumentSummaryInformation",f2(r,em.DSI,u,i2,f.length?f:null,em.UDI))}function v5(e,t){var r=t||{},n=_t.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return _t.utils.cfb_add(n,a,ak(e,r)),r.biff==8&&(e.Props||e.Custprops)&&g5(e,n),r.biff==8&&e.vbaraw&&II(n,_t.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var y5={0:{f:Sj},1:{f:Pj},2:{f:qj},3:{f:jj},4:{f:Mj},5:{f:Hj},6:{f:eL},7:{f:Uj},8:{f:oL},9:{f:sL},10:{f:aL},11:{f:iL},12:{f:Nj},13:{f:Qj},14:{f:Bj},15:{f:Ij},16:{f:Gj},17:{f:rL},18:{f:zj},19:{f:Hv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VL},40:{},42:{},43:{f:eI},44:{f:ZR},45:{f:nI},46:{f:iI},47:{f:aI},48:{},49:{f:NM},50:{},51:{f:SI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:DR},62:{f:Jj},63:{f:kI},64:{f:EL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Oa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:kj},148:{f:_j,p:16},151:{f:hL},152:{},153:{f:KL},154:{},155:{},156:{f:WL},157:{},158:{},159:{T:1,f:WR},160:{T:-1},161:{T:1,f:to},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xI},336:{T:-1},337:{f:_I,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Lg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pL},427:{f:mL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Aj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Lg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DI},633:{T:1},634:{T:-1},635:{T:1,f:CI},636:{T:-1},637:{f:IM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_L},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Fe(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Wv(r)&&e.push(r)}}function x5(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Fe(e,t,r,a);var i=t;if(!isNaN(i)){for(var o=r.parts||[],u=0,c=0,f=0;f+(o[u]||8224)<=8224;)f+=o[u]||8224,u++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f;c<a;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(o[u]||8224)<=8224;)f+=o[u]||8224,u++;d.write_shift(2,f),e.push(r.slice(c,c+f)),c+=f}}}function rc(e,t,r){return e||(e=ve(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function w5(e,t,r,n){var a=ve(9);return rc(a,e,t),PA(r,n||"b",a),a}function S5(e,t,r){var n=ve(8+2*r.length);return rc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function b5(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?gn(nn(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Fe(e,2,FR(r,n,a)):Fe(e,3,IR(r,n,a));return;case"b":case"e":Fe(e,5,w5(r,n,t.v,t.t));return;case"s":case"str":Fe(e,4,S5(r,n,(t.v||"").slice(0,255)));return}Fe(e,1,rc(null,r,n))}function E5(e,t,r,n){var a=Array.isArray(t),i=It(t["!ref"]||"A1"),o,u="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=ar(i)}for(var f=i.s.r;f<=i.e.r;++f){u=jr(f);for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(c[d]=Hr(d)),o=c[d]+u;var p=a?(t[f]||[])[d]:t[o];p&&b5(e,p,f,d)}}}function _5(e,t){for(var r=t||{},n=mn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Fe(n,r.biff==4?1033:r.biff==3?521:9,Yv(e,16,r)),E5(n,e.Sheets[e.SheetNames[a]],a,r),Fe(n,10),n.end()}function T5(e,t,r){Fe(e,49,yR({sz:12,name:"Arial"},r))}function A5(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Fe(e,1054,SR(a,t[a],r))})}function k5(e,t){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Fe(e,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),DA(It(t["!ref"]||"A1"),r),r.write_shift(4,4),Fe(e,2152,r)}function O5(e,t){for(var r=0;r<16;++r)Fe(e,224,h2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Fe(e,224,h2(n,0,t))})}function P5(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Fe(e,440,PR(n)),n[1].Tooltip&&Fe(e,2048,CR(n))}delete t["!links"]}function C5(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Fe(e,125,MR(T0(a,n),a))})}}function N5(e,t,r,n,a){var i=16+es(a.cellXfs,t,a);if(t.v==null&&!t.bf){Fe(e,513,Us(r,n,i));return}if(t.bf)Fe(e,6,tj(t,r,n,a,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?gn(nn(t.v)):t.v;Fe(e,515,TR(r,n,o,i));break;case"b":case"e":Fe(e,517,_R(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var u=Jv(a.Strings,t.v,a.revStrings);Fe(e,253,xR(r,n,u,i))}else Fe(e,516,wR(r,n,(t.v||"").slice(0,255),i,a));break;default:Fe(e,513,Us(r,n,i))}}function D5(e,t,r){var n=mn(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},c=Array.isArray(i),f=t.biff==8,d,p="",m=[],v=It(i["!ref"]||"A1"),x=f?65536:16384;if(v.e.c>255||v.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,x-1)}Fe(n,2057,Yv(r,16,t)),Fe(n,13,Yn(1)),Fe(n,12,Yn(100)),Fe(n,15,Jr(!0)),Fe(n,17,Jr(!1)),Fe(n,16,$s(.001)),Fe(n,95,Jr(!0)),Fe(n,42,Jr(!1)),Fe(n,43,Jr(!1)),Fe(n,130,Yn(1)),Fe(n,128,ER()),Fe(n,131,Jr(!1)),Fe(n,132,Jr(!1)),f&&C5(n,i["!cols"]),Fe(n,512,bR(v,t)),f&&(i["!links"]=[]);for(var y=v.s.r;y<=v.e.r;++y){p=jr(y);for(var S=v.s.c;S<=v.e.c;++S){y===v.s.r&&(m[S]=Hr(S)),d=m[S]+p;var T=c?(i[y]||[])[S]:i[d];T&&(N5(n,T,y,S,t),f&&T.l&&i["!links"].push([d,T.l]))}}var k=u.CodeName||u.name||a;return f&&Fe(n,574,vR((o.Views||[])[0])),f&&(i["!merges"]||[]).length&&Fe(n,229,OR(i["!merges"])),f&&P5(n,i),Fe(n,442,NA(k)),f&&k5(n,i),Fe(n,10),n.end()}function M5(e,t,r){var n=mn(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},u=r.biff==8,c=r.biff==5;if(Fe(n,2057,Yv(e,5,r)),r.bookType=="xla"&&Fe(n,135),Fe(n,225,u?Yn(1200):null),Fe(n,193,aR(2)),c&&Fe(n,191),c&&Fe(n,192),Fe(n,226),Fe(n,92,hR("SheetJS",r)),Fe(n,66,Yn(u?1200:1252)),u&&Fe(n,353,Yn(0)),u&&Fe(n,448),Fe(n,317,RR(e.SheetNames.length)),u&&e.vbaraw&&Fe(n,211),u&&e.vbaraw){var f=o.CodeName||"ThisWorkbook";Fe(n,442,NA(f))}Fe(n,156,Yn(17)),Fe(n,25,Jr(!1)),Fe(n,18,Jr(!1)),Fe(n,19,Yn(0)),u&&Fe(n,431,Jr(!1)),u&&Fe(n,444,Yn(0)),Fe(n,61,gR()),Fe(n,64,Jr(!1)),Fe(n,141,Yn(0)),Fe(n,34,Jr(LL(e)=="true")),Fe(n,14,Jr(!0)),u&&Fe(n,439,Jr(!1)),Fe(n,218,Yn(0)),T5(n,e,r),A5(n,e.SSF,r),O5(n,r),u&&Fe(n,352,Jr(!1));var d=n.end(),p=mn();u&&Fe(p,140,NR()),u&&r.Strings&&x5(p,252,mR(r.Strings)),Fe(p,10);var m=p.end(),v=mn(),x=0,y=0;for(y=0;y<e.SheetNames.length;++y)x+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var S=d.length+x+m.length;for(y=0;y<e.SheetNames.length;++y){var T=i[y]||{};Fe(v,133,pR({pos:S,hs:T.Hidden||0,dt:0,name:e.SheetNames[y]},r)),S+=t[y].length}var k=v.end();if(x!=k.length)throw new Error("BS8 "+x+" != "+k.length);var A=[];return d.length&&A.push(d),k.length&&A.push(k),m.length&&A.push(m),Rr(A)}function R5(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=vn(Xt)),e&&e.SSF&&(w0(),x0(e.SSF),r.revssf=S0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,e1(r),r.cellXfs=[],es(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=D5(a,r,e);return n.unshift(M5(e,n,r)),Rr(n)}function ak(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Rn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return R5(e,t);case 4:case 3:case 2:return _5(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function I5(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,c=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>o)&&!(a[f].e.r<r||a[f].e.c<o)){if(a[f].s.r<r||a[f].s.c<o){u=-1;break}u=a[f].e.r-a[f].s.r+1,c=a[f].e.c-a[f].s.c+1;break}if(!(u<0)){var d=St({r,c:o}),p=n.dense?(e[r]||[])[o]:e[d],m=p&&p.v!=null&&(p.h||dM(p.w||(ei(p),p.w)||""))||"",v={};u>1&&(v.rowspan=u),c>1&&(v.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+d,i.push(Ie("td",m,v))}}var x="<tr>";return x+i.join("")+"</tr>"}var F5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',j5="</body></html>";function L5(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ik(e,t){var r=t||{},n=r.header!=null?r.header:F5,a=r.footer!=null?r.footer:j5,i=[n],o=Rn(e["!ref"]);r.dense=Array.isArray(e),i.push(L5(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)i.push(I5(e,o,u,r));return i.push("</table>"+a),i.join("")}function sk(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Tr(n.origin):n.origin;a=o.r,i=o.c}var u=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,u.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=Rn(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),a==-1&&(f.e.r=a=d.e.r+1)}var p=[],m=0,v=e["!rows"]||(e["!rows"]=[]),x=0,y=0,S=0,T=0,k=0,A=0;for(e["!cols"]||(e["!cols"]=[]);x<u.length&&y<c;++x){var P=u[x];if(w2(P)){if(n.display)continue;v[y]={hidden:!0}}var N=P.children;for(S=T=0;S<N.length;++S){var I=N[S];if(!(n.display&&w2(I))){var D=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):gM(I.innerHTML),z=I.getAttribute("data-z")||I.getAttribute("z");for(m=0;m<p.length;++m){var H=p[m];H.s.c==T+i&&H.s.r<y+a&&y+a<=H.e.r&&(T=H.e.c+1-i,m=-1)}A=+I.getAttribute("colspan")||1,((k=+I.getAttribute("rowspan")||1)>1||A>1)&&p.push({s:{r:y+a,c:T+i},e:{r:y+a+(k||1)-1,c:T+i+(A||1)-1}});var te={t:"s",v:D},q=I.getAttribute("data-t")||I.getAttribute("t")||"";D!=null&&(D.length==0?te.t=q||"z":n.raw||D.trim().length==0||q=="s"||(D==="TRUE"?te={t:"b",v:!0}:D==="FALSE"?te={t:"b",v:!1}:isNaN(Ya(D))?isNaN(Ru(D).getDate())||(te={t:"d",v:nn(D)},n.cellDates||(te={t:"n",v:gn(te.v)}),te.z=n.dateNF||Xt[14]):te={t:"n",v:Ya(D)})),te.z===void 0&&z!=null&&(te.z=z);var V="",ae=I.getElementsByTagName("A");if(ae&&ae.length)for(var Ee=0;Ee<ae.length&&!(ae[Ee].hasAttribute("href")&&(V=ae[Ee].getAttribute("href"),V.charAt(0)!="#"));++Ee);V&&V.charAt(0)!="#"&&(te.l={Target:V}),n.dense?(e[y+a]||(e[y+a]=[]),e[y+a][T+i]=te):e[St({c:T+i,r:y+a})]=te,f.e.c<T+i&&(f.e.c=T+i),T+=A}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+a),e["!ref"]=ar(f),y>=c&&(e["!fullref"]=ar((f.e.r=u.length-x+y-1+a,f))),e}function ok(e,t){var r=t||{},n=r.dense?[]:{};return sk(n,e,t)}function B5(e,t){return Qs(ok(e,t),t)}function w2(e){var t="",r=$5(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var U5=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Fu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return sr+t}}(),S2=function(){var e=function(i){return wt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,u){var c=[];c.push('      <table:table table:name="'+wt(o.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,d=0,p=Rn(i["!ref"]||"A1"),m=i["!merges"]||[],v=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=p.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var y="",S=i["!rows"]||[];for(f=0;f<p.s.r;++f)y=S[f]?' table:style-name="ro'+S[f].ods+'"':"",c.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=S[f]?' table:style-name="ro'+S[f].ods+'"':"",c.push("        <table:table-row"+y+`>
`),d=0;d<p.s.c;++d)c.push(t);for(;d<=p.e.c;++d){var T=!1,k={},A="";for(v=0;v!=m.length;++v)if(!(m[v].s.c>d)&&!(m[v].s.r>f)&&!(m[v].e.c<d)&&!(m[v].e.r<f)){(m[v].s.c!=d||m[v].s.r!=f)&&(T=!0),k["table:number-columns-spanned"]=m[v].e.c-m[v].s.c+1,k["table:number-rows-spanned"]=m[v].e.r-m[v].s.r+1;break}if(T){c.push(r);continue}var P=St({r:f,c:d}),N=x?(i[f]||[])[d]:i[P];if(N&&N.f&&(k["table:formula"]=wt(oj(N.f)),N.F&&N.F.slice(0,P.length)==P)){var I=Rn(N.F);k["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,k["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":A=N.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=N.v?"true":"false";break;case"n":A=N.w||String(N.v||0),k["office:value-type"]="float",k["office:value"]=N.v||0;break;case"s":case"str":A=N.v==null?"":N.v,k["office:value-type"]="string";break;case"d":A=N.w||nn(N.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=nn(N.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var D=e(A);if(N.l&&N.l.Target){var z=N.l.Target;z=z.charAt(0)=="#"?"#"+lj(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),D=Ie("text:a",D,{"xlink:href":z.replace(/&/g,"&amp;")})}c.push("          "+Ie("table:table-cell",Ie("text:p",D,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var p=f["!cols"][d];if(p.width==null&&p.wpx==null&&p.wch==null)continue;qv(p),p.ods=u;var m=f["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++u}}});var c=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=c;var p=f["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,u){var c=[sr],f=Fu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Fu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(c.push("<office:document"+f+d+`>
`),c.push(bA().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)c.push(n(o.Sheets[o.SheetNames[p]],o,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),u.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function lk(e,t){if(t.bookType=="fods")return S2(e,t);var r=Lv(),n="",a=[],i=[];return n="mimetype",it(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",it(r,n,S2(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",it(r,n,U5(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",it(r,n,sr+bA()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",it(r,n,JM(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",it(r,n,QM(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Dd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function W5(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):da(Iu(e))}function z5(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Yi(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function K5(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function ju(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function vt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Go(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function cr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ju(e,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);u=e.slice(c,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ju(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:u,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Cr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(vt(n*8+a.type)),a.type==2&&t.push(vt(a.data.length)),t.push(a.data))})}),Yi(t)}function ua(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ju(e,n),i=cr(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Go(i[1][0].data),messages:[]};i[2].forEach(function(u){var c=cr(u.data),f=Go(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=Go(i[3][0].data)>>>0>0),r.push(o)}return r}function Mo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:vt(o.data.length)}],n[2].push({data:Cr(o.meta),type:2})});var i=Cr(n);t.push(vt(i.length)),t.push(i),a.forEach(function(o){return t.push(o)})}),Yi(t)}function H5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ju(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Yi(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(a.push(a[0].slice(-c)),f-=c;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-c,-c+f))}}var d=Yi(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ca(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(H5(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Yi(t)}function Ro(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=vt(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Yi(t)}function tm(e,t){var r=new Uint8Array(32),n=Dd(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,K5(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function rm(e,t){var r=new Uint8Array(32),n=Dd(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function ji(e){var t=cr(e);return ju(t[1][0].data)}function V5(e,t,r){var n,a,i,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Go(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var c=0,f=Dd(e[7][0].data),d=0,p=[],m=Dd(e[4][0].data),v=0,x=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535);continue}f.setUint16(y*2,d,!0),m.setUint16(y*2,v,!0);var S,T;switch(typeof t[y]){case"string":S=tm({t:"s",v:t[y]},r),T=rm({t:"s",v:t[y]},r);break;case"number":S=tm({t:"n",v:t[y]},r),T=rm({t:"n",v:t[y]},r);break;case"boolean":S=tm({t:"b",v:t[y]},r),T=rm({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}p.push(S),d+=S.length,x.push(T),v+=T.length,++c}for(e[2][0].data=vt(c);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),m.setUint16(y*2,65535,!0);return e[6][0].data=Yi(p),e[3][0].data=Yi(x),c}function G5(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Rn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ar(n)));var i=Md(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(J){return J.forEach(function(G){typeof G=="string"&&o.push(G)})});var u={},c=[],f=_t.read(t.numbers,{type:"base64"});f.FileIndex.map(function(J,G){return[J,f.FullPaths[G]]}).forEach(function(J){var G=J[0],K=J[1];if(G.type==2&&G.name.match(/\.iwa/)){var he=G.content,Oe=ca(he),Ne=ua(Oe);Ne.forEach(function(re){c.push(re.id),u[re.id]={deps:[],location:K,type:Go(re.messages[0].meta[1][0].data)}})}}),c.sort(function(J,G){return J-G});var d=c.filter(function(J){return J>1}).map(function(J){return[J,vt(J)]});f.FileIndex.map(function(J,G){return[J,f.FullPaths[G]]}).forEach(function(J){var G=J[0];if(J[1],!!G.name.match(/\.iwa/)){var K=ua(ca(G.content));K.forEach(function(he){he.messages.forEach(function(Oe){d.forEach(function(Ne){he.messages.some(function(re){return Go(re.meta[1][0].data)!=11006&&z5(re.data,Ne[1])})&&u[Ne[0]].deps.push(he.id)})})})}});for(var p=_t.find(f,u[1].location),m=ua(ca(p.content)),v,x=0;x<m.length;++x){var y=m[x];y.id==1&&(v=y)}var S=ji(cr(v.messages[0].data)[1][0].data);for(p=_t.find(f,u[S].location),m=ua(ca(p.content)),x=0;x<m.length;++x)y=m[x],y.id==S&&(v=y);for(S=ji(cr(v.messages[0].data)[2][0].data),p=_t.find(f,u[S].location),m=ua(ca(p.content)),x=0;x<m.length;++x)y=m[x],y.id==S&&(v=y);for(S=ji(cr(v.messages[0].data)[2][0].data),p=_t.find(f,u[S].location),m=ua(ca(p.content)),x=0;x<m.length;++x)y=m[x],y.id==S&&(v=y);var T=cr(v.messages[0].data);{T[6][0].data=vt(n.e.r+1),T[7][0].data=vt(n.e.c+1);var k=ji(T[46][0].data),A=_t.find(f,u[k].location),P=ua(ca(A.content));{for(var N=0;N<P.length&&P[N].id!=k;++N);if(P[N].id!=k)throw"Bad ColumnRowUIDMapArchive";var I=cr(P[N].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var D=0;D<=n.e.c;++D){var z=[];z[1]=z[2]=[{type:0,data:vt(D+420690)}],I[1].push({type:2,data:Cr(z)}),I[2].push({type:0,data:vt(D)}),I[3].push({type:0,data:vt(D)})}I[4]=[],I[5]=[],I[6]=[];for(var H=0;H<=n.e.r;++H)z=[],z[1]=z[2]=[{type:0,data:vt(H+726270)}],I[4].push({type:2,data:Cr(z)}),I[5].push({type:0,data:vt(H)}),I[6].push({type:0,data:vt(H)});P[N].messages[0].data=Cr(I)}A.content=Ro(Mo(P)),A.size=A.content.length,delete T[46];var te=cr(T[4][0].data);{te[7][0].data=vt(n.e.r+1);var q=cr(te[1][0].data),V=ji(q[2][0].data);A=_t.find(f,u[V].location),P=ua(ca(A.content));{if(P[0].id!=V)throw"Bad HeaderStorageBucket";var ae=cr(P[0].messages[0].data);for(H=0;H<i.length;++H){var Ee=cr(ae[2][0].data);Ee[1][0].data=vt(H),Ee[4][0].data=vt(i[H].length),ae[2][H]={type:ae[2][0].type,data:Cr(Ee)}}P[0].messages[0].data=Cr(ae)}A.content=Ro(Mo(P)),A.size=A.content.length;var Z=ji(te[2][0].data);A=_t.find(f,u[Z].location),P=ua(ca(A.content));{if(P[0].id!=Z)throw"Bad HeaderStorageBucket";for(ae=cr(P[0].messages[0].data),D=0;D<=n.e.c;++D)Ee=cr(ae[2][0].data),Ee[1][0].data=vt(D),Ee[4][0].data=vt(n.e.r+1),ae[2][D]={type:ae[2][0].type,data:Cr(Ee)};P[0].messages[0].data=Cr(ae)}A.content=Ro(Mo(P)),A.size=A.content.length;var Te=ji(te[4][0].data);(function(){for(var J=_t.find(f,u[Te].location),G=ua(ca(J.content)),K,he=0;he<G.length;++he){var Oe=G[he];Oe.id==Te&&(K=Oe)}var Ne=cr(K.messages[0].data);{Ne[3]=[];var re=[];o.forEach(function(ge,ot){re[1]=[{type:0,data:vt(ot)}],re[2]=[{type:0,data:vt(1)}],re[3]=[{type:2,data:W5(ge)}],Ne[3].push({type:2,data:Cr(re)})})}K.messages[0].data=Cr(Ne);var ye=Mo(G),Be=Ro(ye);J.content=Be,J.size=J.content.length})();var Se=cr(te[3][0].data);{var me=Se[1][0];delete Se[2];var we=cr(me.data);{var be=ji(we[2][0].data);(function(){for(var J=_t.find(f,u[be].location),G=ua(ca(J.content)),K,he=0;he<G.length;++he){var Oe=G[he];Oe.id==be&&(K=Oe)}var Ne=cr(K.messages[0].data);{delete Ne[6],delete Se[7];var re=new Uint8Array(Ne[5][0].data);Ne[5]=[];for(var ye=0,Be=0;Be<=n.e.r;++Be){var ge=cr(re);ye+=V5(ge,i[Be],o),ge[1][0].data=vt(Be),Ne[5].push({data:Cr(ge),type:2})}Ne[1]=[{type:0,data:vt(n.e.c+1)}],Ne[2]=[{type:0,data:vt(n.e.r+1)}],Ne[3]=[{type:0,data:vt(ye)}],Ne[4]=[{type:0,data:vt(n.e.r+1)}]}K.messages[0].data=Cr(Ne);var ot=Mo(G),ze=Ro(ot);J.content=ze,J.size=J.content.length})()}me.data=Cr(we)}te[3][0].data=Cr(Se)}T[4][0].data=Cr(te)}v.messages[0].data=Cr(T);var X=Mo(m),M=Ro(X);return p.content=M,p.size=p.content.length,f}function Y5(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function e1(e){Y5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function q5(e,t){return t.bookType=="ods"?lk(e,t):t.bookType=="numbers"?G5(e,t):t.bookType=="xlsb"?X5(e,t):Q5(e,t)}function X5(e,t){Uo=1024,e&&!e.SSF&&(e.SSF=vn(Xt)),e&&e.SSF&&(w0(),x0(e.SSF),t.revssf=S0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Cu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=KA.indexOf(t.bookType)>-1,a=xA();e1(t=t||{});var i=Lv(),o="",u=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",it(i,o,EA(e.Props,t)),a.coreprops.push(o),yt(t.rels,2,o,dt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,it(i,o,TA(e.Props)),a.extprops.push(o),yt(t.rels,3,o,dt.EXT_PROPS),e.Custprops!==e.Props&&Lr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",it(i,o,AA(e.Custprops)),a.custprops.push(o),yt(t.rels,4,o,dt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var d={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,it(i,o,JL(u-1,o,t,e,d)),a.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,dt.WS[0])}if(p){var v=p["!comments"],x=!1,y="";v&&v.length>0&&(y="xl/comments"+u+"."+r,it(i,y,r5(v,y)),a.comments.push(y),yt(d,-1,"../comments"+u+"."+r,dt.CMNT),x=!0),p["!legacy"]&&x&&it(i,"xl/drawings/vmlDrawing"+u+".vml",WA(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&it(i,SA(o),Ho(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,it(i,o,t5(t.Strings,o,t)),a.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+r,dt.SST)),o="xl/workbook."+r,it(i,o,ZL(e,o)),a.workbooks.push(o),yt(t.rels,1,o,dt.WB),o="xl/theme/theme1.xml",it(i,o,$A(e.Themes,t)),a.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",dt.THEME),o="xl/styles."+r,it(i,o,e5(e,o,t)),a.styles.push(o),yt(t.wbrels,-1,"styles."+r,dt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",it(i,o,e.vbaraw),a.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",dt.VBA)),o="xl/metadata."+r,it(i,o,n5(o)),a.metadata.push(o),yt(t.wbrels,-1,"metadata."+r,dt.XLMETA),it(i,"[Content_Types].xml",wA(a,t)),it(i,"_rels/.rels",Ho(t.rels)),it(i,"xl/_rels/workbook."+r+".rels",Ho(t.wbrels)),delete t.revssf,delete t.ssf,i}function Q5(e,t){Uo=1024,e&&!e.SSF&&(e.SSF=vn(Xt)),e&&e.SSF&&(w0(),x0(e.SSF),t.revssf=S0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Cu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=KA.indexOf(t.bookType)>-1,a=xA();e1(t=t||{});var i=Lv(),o="",u=0;if(t.cellXfs=[],es(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",it(i,o,EA(e.Props,t)),a.coreprops.push(o),yt(t.rels,2,o,dt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(e.SheetNames[f]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,it(i,o,TA(e.Props)),a.extprops.push(o),yt(t.rels,3,o,dt.EXT_PROPS),e.Custprops!==e.Props&&Lr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",it(i,o,AA(e.Custprops)),a.custprops.push(o),yt(t.rels,4,o,dt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},m=e.Sheets[e.SheetNames[u-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,it(i,o,JA(u-1,t,e,p)),a.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,dt.WS[0])}if(m){var x=m["!comments"],y=!1,S="";if(x&&x.length>0){var T=!1;x.forEach(function(k){k[1].forEach(function(A){A.T==!0&&(T=!0)})}),T&&(S="xl/threadedComments/threadedComment"+u+"."+r,it(i,S,OI(x,d,t)),a.threadedcomments.push(S),yt(p,-1,"../threadedComments/threadedComment"+u+"."+r,dt.TCMNT)),S="xl/comments"+u+"."+r,it(i,S,zA(x)),a.comments.push(S),yt(p,-1,"../comments"+u+"."+r,dt.CMNT),y=!0}m["!legacy"]&&y&&it(i,"xl/drawings/vmlDrawing"+u+".vml",WA(u,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&it(i,SA(o),Ho(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,it(i,o,RA(t.Strings,t)),a.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+r,dt.SST)),o="xl/workbook."+r,it(i,o,rk(e)),a.workbooks.push(o),yt(t.rels,1,o,dt.WB),o="xl/theme/theme1.xml",it(i,o,$A(e.Themes,t)),a.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",dt.THEME),o="xl/styles."+r,it(i,o,LA(e,t)),a.styles.push(o),yt(t.wbrels,-1,"styles."+r,dt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",it(i,o,e.vbaraw),a.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",dt.VBA)),o="xl/metadata."+r,it(i,o,UA()),a.metadata.push(o),yt(t.wbrels,-1,"metadata."+r,dt.XLMETA),d.length>1&&(o="xl/persons/person.xml",it(i,o,PI(d)),a.people.push(o),yt(t.wbrels,-1,"persons/person.xml",dt.PEOPLE)),it(i,"[Content_Types].xml",wA(a,t)),it(i,"_rels/.rels",Ho(t.rels)),it(i,"xl/_rels/workbook."+r+".rels",Ho(t.wbrels)),delete t.revssf,delete t.ssf,i}function Z5(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ja(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uk(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Zu(t.file,_t.write(e,{type:mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return _t.write(e,t)}function J5(e,t){var r=vn(t||{}),n=q5(e,r);return e8(n,r)}function e8(e,t){var r={},n=mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?_t.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(y0(a))}return t.password&&typeof encrypt_agile<"u"?uk(encrypt_agile(a,t.password),t):t.type==="file"?Zu(t.file,a):t.type=="string"?Au(a):a}function t8(e,t){var r=t||{},n=v5(e,r);return uk(n,r)}function Ta(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Mu(Iu(n));case"binary":return Iu(n);case"string":return e;case"file":return Zu(t.file,n,"utf8");case"buffer":return mt?si(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ta(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function r8(e,t){switch(t.type){case"base64":return Mu(e);case"binary":return e;case"string":return e;case"file":return Zu(t.file,e,"binary");case"buffer":return mt?si(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Kf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Mu(r):t.type=="string"?Au(r):r;case"file":return Zu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ck(e,t){CD(),UL(e);var r=vn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ck(e,r);return r.type="array",y0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ta(m5(e,r),r);case"slk":case"sylk":return Ta(LR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ta(ik(e.Sheets[e.SheetNames[a]],r),r);case"txt":return r8(fk(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ta(t1(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ta(BR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Kf(jR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ta($R.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ta(GR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ta(MA.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ta(lk(e,r),r);case"wk1":return Kf(p2.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Kf(p2.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Kf(ak(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),t8(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return J5(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function n8(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function b2(e,t,r){var n={};return n.type="file",n.file=t,n8(n),ck(e,n)}function a8(e,t,r,n,a,i,o,u){var c=jr(r),f=u.defval,d=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),p=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var x=o?e[r][v]:e[n[v]+c];if(x===void 0||x.t===void 0){if(f===void 0)continue;i[v]!=null&&(m[i[v]]=f);continue}var y=x.v;switch(x.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[v]!=null){if(y==null)if(x.t=="e"&&y===null)m[i[v]]=null;else if(f!==void 0)m[i[v]]=f;else if(d&&y===null)m[i[v]]=null;else continue;else m[i[v]]=d&&(x.t!=="n"||x.t==="n"&&u.rawNumbers!==!1)?y:ei(x,y,u);y!=null&&(p=!1)}}return{row:m,isempty:p}}function Md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",c={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof d){case"string":c=It(d);break;case"number":c=It(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var p=jr(c.s.r),m=[],v=[],x=0,y=0,S=Array.isArray(e),T=c.s.r,k=0,A={};S&&!e[T]&&(e[T]=[]);var P=f.skipHidden&&e["!cols"]||[],N=f.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(P[k]||{}).hidden)switch(m[k]=Hr(k),r=S?e[T][k]:e[m[k]+p],n){case 1:i[k]=k-c.s.c;break;case 2:i[k]=m[k];break;case 3:i[k]=f.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ei(r,null,f),y=A[o]||0,!y)A[o]=1;else{do u=o+"_"+y++;while(A[u]);A[o]=y,A[u]=1}i[k]=u}for(T=c.s.r+a;T<=c.e.r;++T)if(!(N[T]||{}).hidden){var I=a8(e,c,T,m,n,i,S,f);(I.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[x++]=I.row)}return v.length=x,v}var E2=/"/g;function i8(e,t,r,n,a,i,o,u){for(var c=!0,f=[],d="",p=jr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var v=u.dense?(e[r]||[])[m]:e[n[m]+p];if(v==null)d="";else if(v.v!=null){c=!1,d=""+(u.rawNumbers&&v.t=="n"?v.v:ei(v,null,u));for(var x=0,y=0;x!==d.length;++x)if((y=d.charCodeAt(x))===a||y===i||y===34||u.forceQuotes){d='"'+d.replace(E2,'""')+'"';break}d=="ID"&&(d='"ID"')}else v.f!=null&&!v.F?(c=!1,d="="+v.f,d.indexOf(",")>=0&&(d='"'+d.replace(E2,'""')+'"')):d="";f.push(d)}return u.blankrows===!1&&c?null:f.join(o)}function t1(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=It(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,c=u.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),d="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(m[x]||{}).hidden||(p[x]=Hr(x));for(var y=0,S=a.s.r;S<=a.e.r;++S)(v[S]||{}).hidden||(d=i8(e,a,S,p,o,c,i,n),d!=null&&(n.strip&&(d=d.replace(f,"")),(d||n.blankrows!==!1)&&r.push((y++?u:"")+d)));return delete n.dense,r.join("")}function fk(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=t1(e,t);return r}function s8(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=It(e["!ref"]),i="",o=[],u,c=[],f=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)o[u]=Hr(u);for(var d=a.s.r;d<=a.e.r;++d)for(i=jr(d),u=a.s.c;u<=a.e.c;++u)if(t=o[u]+i,r=f?(e[d]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function dk(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Tr(n.origin):n.origin;o=c.r,u=c.c}var f,d={s:{c:0,r:0},e:{c:u,r:o+t.length-1+a}};if(i["!ref"]){var p=It(i["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(o=p.e.r+1,d.e.r=o+t.length-1+a)}else o==-1&&(o=0,d.e.r=t.length-1+a);var m=n.header||[],v=0;t.forEach(function(y,S){Lr(y).forEach(function(T){(v=m.indexOf(T))==-1&&(m[v=m.length]=T);var k=y[T],A="z",P="",N=St({c:u+v,r:o+S+a});f=Lu(i,N),k&&typeof k=="object"&&!(k instanceof Date)?i[N]=k:(typeof k=="number"?A="n":typeof k=="boolean"?A="b":typeof k=="string"?A="s":k instanceof Date?(A="d",n.cellDates||(A="n",k=gn(k)),P=n.dateNF||Xt[14]):k===null&&n.nullError&&(A="e",k=0),f?(f.t=A,f.v=k,delete f.w,delete f.R,P&&(f.z=P)):i[N]=f={t:A,v:k},P&&(f.z=P))})}),d.e.c=Math.max(d.e.c,u+m.length-1);var x=jr(o);if(a)for(v=0;v<m.length;++v)i[Hr(v+u)+x]={t:"s",v:m[v]};return i["!ref"]=ar(d),i}function o8(e,t){return dk(null,e,t)}function Lu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Lu(e,St(t)):Lu(e,St({r:t,c:r||0}))}function l8(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function u8(){return{SheetNames:[],Sheets:{}}}function c8(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(tk(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function f8(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=l8(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function d8(e,t){return e.z=t,e}function hk(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function h8(e,t,r){return hk(e,"#"+t,r)}function p8(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function m8(e,t,r,n){for(var a=typeof t!="string"?t:It(t),i=typeof t=="string"?t:ar(t),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var c=Lu(e,o,u);c.t="n",c.F=i,delete c.v,o==a.s.r&&u==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Sr={encode_col:Hr,encode_row:jr,encode_cell:St,encode_range:ar,decode_col:Kv,decode_row:zv,split_cell:CM,decode_cell:Tr,decode_range:Rn,format_cell:ei,sheet_add_aoa:hA,sheet_add_json:dk,sheet_add_dom:sk,aoa_to_sheet:ul,json_to_sheet:o8,table_to_sheet:ok,table_to_book:B5,sheet_to_csv:t1,sheet_to_txt:fk,sheet_to_json:Md,sheet_to_html:ik,sheet_to_formulae:s8,sheet_to_row_object_array:Md,sheet_get_cell:Lu,book_new:u8,book_append_sheet:c8,book_set_sheet_visibility:f8,cell_set_number_format:d8,cell_set_hyperlink:hk,cell_set_internal_link:h8,cell_add_comment:p8,sheet_set_array_formula:m8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const pk={exportSaveToExcel(e,t){const r=`pathOfHeroes_save_${e}_${t}`,n=localStorage.getItem(r);if(!n){alert("No save data found for this slot!");return}try{const a=JSON.parse(n),i=Sr.book_new(),o=[["Path of Heroes - Character Export"],[""],["Character",this.getCharacterName(a.characterId)],["Save Slot",t],["Exported",new Date().toLocaleString()],[""],["=== PROGRESS ==="],["Level",a.level||1],["Current Floor",a.currentFloor||1],["Experience",a.experience||0],["Gold",a.gold||0],[""],["=== STATS ==="],["HP",`${a.player?.stats?.hp||0} / ${a.player?.stats?.maxHp||0}`],["Attack",a.player?.stats?.attack||0],["Defense",a.player?.stats?.defense||0],["Speed",a.player?.stats?.speed||0],[""],["=== RESOURCES ==="],[this.getResourceName(a.characterId),`${a.player?.resource||0} / ${a.player?.maxResource||0}`],[""],["=== HERO SOULS ==="],["Current Run Souls",a.currentRunSouls||0],["Total Souls (All Time)",a.characterSouls?.[e]||0]],u=Sr.aoa_to_sheet(o);u["!cols"]=[{wch:25},{wch:15}],Sr.book_append_sheet(i,u,"Summary");const c=[["Combat Statistics"],[""],["Metric","Value"],["Total Battles",a.stats?.totalBattles||0],["Battles Won",a.stats?.battlesWon||0],["Battles Lost",a.stats?.battlesLost||0],["Win Rate",a.stats?.totalBattles>0?`${(a.stats.battlesWon/a.stats.totalBattles*100).toFixed(1)}%`:"0%"],[""],["Total Damage Dealt",a.stats?.totalDamageDealt||0],["Total Damage Taken",a.stats?.totalDamageTaken||0],["Avg Damage/Battle",a.stats?.totalBattles>0?Math.round((a.stats.totalDamageDealt||0)/a.stats.totalBattles):0],[""],["Floors Completed",a.stats?.floorsCompleted||0],["Highest Floor",a.stats?.highestFloor||a.currentFloor||1],["Total Deaths",a.stats?.totalDeaths||0]],f=Sr.aoa_to_sheet(c);if(f["!cols"]=[{wch:25},{wch:15}],Sr.book_append_sheet(i,f,"Combat Stats"),a.inventory&&a.inventory.length>0){const x=[["Inventory"],[""],["Item","Quantity","Type"]];a.inventory.forEach(S=>{x.push([S.name||"Unknown",S.quantity||1,S.type||"Item"])});const y=Sr.aoa_to_sheet(x);y["!cols"]=[{wch:30},{wch:10},{wch:15}],Sr.book_append_sheet(i,y,"Inventory")}if(a.characterUpgrades&&a.characterUpgrades[e]){const x=[["Hero Soul Upgrades"],[""],["Upgrade","Unlocked"]],y=a.characterUpgrades[e]?.[`slot${t}`]||{};Object.entries(y).forEach(([T,k])=>{x.push([this.formatUpgradeName(T),k?"Yes":"No"])});const S=Sr.aoa_to_sheet(x);S["!cols"]=[{wch:30},{wch:10}],Sr.book_append_sheet(i,S,"Upgrades")}const d=fa.stats.characterStats[e.toLowerCase()];if(d){const x=[["Global Analytics - All Runs"],[""],["Metric","Value"],["Total Battles (All Saves)",d.battles||0],["Total Wins",d.wins||0],["Total Losses",d.losses||0],["Win Rate",d.battles>0?`${(d.wins/d.battles*100).toFixed(1)}%`:"0%"],[""],["Highest Floor Ever",d.maxFloor||0],["Total Damage (All Runs)",d.damageDealt||0],["Total Gold Earned",d.goldEarned||0],["Playtime (minutes)",Math.round((d.playtime||0)/60)]],y=Sr.aoa_to_sheet(x);y["!cols"]=[{wch:30},{wch:15}],Sr.book_append_sheet(i,y,"Global Analytics")}const p=new Date().toISOString().split("T")[0],v=`POH_${this.getCharacterName(e)}_Slot${t}_${p}.xlsx`;return b2(i,v),console.log("Excel file exported:",v),!0}catch(a){return console.error("Failed to export save:",a),alert("Failed to export save file. Check console for details."),!1}},exportAnalyticsToExcel(){try{const e=fa.stats,t=Sr.book_new(),r=[["Path of Heroes - Analytics Export"],[""],["Exported",new Date().toLocaleString()],[""],["=== OVERALL STATISTICS ==="],["Total Battles",e.totalBattles],["Battles Won",e.battlesWon],["Battles Lost",e.battlesLost],["Win Rate",e.totalBattles>0?`${(e.battlesWon/e.totalBattles*100).toFixed(1)}%`:"0%"],[""],["Highest Floor",e.highestFloor],["Floors Completed",e.floorsCompleted],["Total Deaths",e.totalDeaths],[""],["Total Gold Earned",e.goldEarned],["Total Gold Spent",e.goldSpent],["Net Gold",e.goldEarned-e.goldSpent],[""],["Total Damage Dealt",e.totalDamageDealt],["Total Damage Taken",e.totalDamageTaken],["Playtime (hours)",(e.playtime/3600).toFixed(1)]],n=Sr.aoa_to_sheet(r);n["!cols"]=[{wch:25},{wch:15}],Sr.book_append_sheet(t,n,"Overview");const a=[["Character Statistics"],[""],["Character","Battles","Wins","Losses","Win Rate","Max Floor","Damage Dealt","Gold Earned"]];["omar","salma","shadi"].forEach(c=>{const f=e.characterStats[c];a.push([this.getCharacterName(c),f.battles,f.wins,f.losses,f.battles>0?`${(f.wins/f.battles*100).toFixed(1)}%`:"0%",f.maxFloor,f.damageDealt,f.goldEarned])});const i=Sr.aoa_to_sheet(a);if(i["!cols"]=[{wch:12},{wch:10},{wch:10},{wch:10},{wch:12},{wch:12},{wch:15},{wch:15}],Sr.book_append_sheet(t,i,"Characters"),e.battleHistory&&e.battleHistory.length>0){const c=[["Battle History (Last 50)"],[""],["Date","Character","Floor","Result","Gold","Damage Dealt"]];e.battleHistory.slice(0,50).forEach(d=>{c.push([new Date(d.timestamp).toLocaleString(),this.getCharacterName(d.character),d.floor,d.victory?"Victory":"Defeat",d.goldGained,d.damageDealt])});const f=Sr.aoa_to_sheet(c);f["!cols"]=[{wch:20},{wch:12},{wch:8},{wch:10},{wch:10},{wch:15}],Sr.book_append_sheet(t,f,"Battle History")}const u=`POH_Analytics_${new Date().toISOString().split("T")[0]}.xlsx`;return b2(t,u),console.log("Analytics exported:",u),!0}catch(e){return console.error("Failed to export analytics:",e),alert("Failed to export analytics. Check console for details."),!1}},getCharacterName(e){return{omar:"Omar (Warrior)",salma:"Salma (Sorceress)",shadi:"Shadi (Rogue)"}[e?.toLowerCase()]||e},getResourceName(e){return{omar:"Vigor",salma:"Mana",shadi:"Energy"}[e?.toLowerCase()]||"Resource"},formatUpgradeName(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}};function _2({characterId:e,onBack:t,onGameStart:r}){const[n,a]=_.useState([]),[i,o]=_.useState(null),[u,c]=_.useState(null),[f,d]=_.useState(1);_.useEffect(()=>{const T=[];for(let k=1;k<=3;k++){const A=U.getSaveSlotInfo(e,k);T.push({slotNumber:k,...A})}a(T)},[e]);const p=T=>{const k=n.find(A=>A.slotNumber===T);k&&k.exists?o({type:"overwrite",slotNumber:T,message:ee("saveSlots.confirmOverwrite",{slot:T})}):v(T)},m=T=>{U.loadGame(e,T)?(As.initialize(e),yd.initialize(e),de.log(`Initialized services for ${e}`,"SYSTEM"),Ig(),de.log(`Loaded ${e} from slot ${T}`,"SYSTEM"),r&&r()):de.log(`Failed to load save slot ${T}`,"ERROR")},v=T=>{de.log(`Starting new game for ${e} in slot ${T}`,"SYSTEM"),U.newGame(e),As.initialize(e),yd.initialize(e),de.log(`Initialized services for ${e}`,"SYSTEM"),U.saveGame(e,T),setTimeout(()=>{Ig(),r&&r()},10),o(null)},x=T=>{o({type:"delete",slotNumber:T,message:ee("saveSlots.confirmDelete",{slot:T})})},y=()=>{if(i.type==="overwrite")v(i.slotNumber);else if(i.type==="delete"){U.deleteSave(e,i.slotNumber);const T=[];for(let k=1;k<=3;k++){const A=U.getSaveSlotInfo(e,k);T.push({slotNumber:k,...A})}a(T)}o(null)},S=T=>T?new Date(T).toLocaleString():"";return i?b.jsx("div",{className:"fixed inset-0 bg-rpg-bg-darkest/90 flex items-center justify-center z-[200] p-4",children:b.jsxs("div",{className:"bg-rpg-bg-darker border-2 border-rpg-primary rounded-lg p-6 max-w-md w-full text-center backdrop-blur-sm",children:[b.jsx("h2",{className:"text-2xl font-bold text-rpg-primary mb-4",children:ee("saveSlots.confirm")}),b.jsx("p",{className:"text-rpg-text opacity-80 mb-6",children:i.message}),b.jsxs("div",{className:"flex gap-4",children:[b.jsx("button",{onClick:()=>o(null),className:"flex-1 bg-rpg-secondary hover:bg-rpg-primary text-rpg-text font-bold py-2 px-4 rounded-lg",children:ee("saveSlots.cancel")}),b.jsx("button",{onClick:y,className:"flex-1 bg-health-full hover:bg-health-mid text-rpg-text font-bold py-2 px-4 rounded-lg",children:ee("saveSlots.confirm")})]})]})}):b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"h-[90vh] bg-rpg-radial text-rpg-text p-2 flex flex-col",children:b.jsxs("div",{className:"max-w-md mx-auto w-full flex-1 flex flex-col min-h-0",children:[b.jsxs("div",{className:"text-center mb-2 flex-shrink-0",children:[b.jsxs("div",{className:"flex justify-between items-center mb-2",children:[b.jsxs("button",{onClick:t,className:"text-rpg-primary hover:text-rpg-secondary text-sm",children:["← ",ee("saveSlots.back")]}),b.jsx("button",{onClick:t,className:"text-rpg-text opacity-70 hover:text-rpg-primary text-xs bg-rpg-secondary hover:bg-rpg-primary px-2 py-0.5 rounded",children:ee("saveSlots.switchCharacter")})]}),b.jsx("h1",{className:"text-2xl font-bold text-rpg-primary mb-1",children:ee(`characters.${e}.name`)}),b.jsx("p",{className:"text-rpg-text opacity-70 text-xs",children:ee("saveSlots.selectSlot")})]}),b.jsx("div",{className:"flex flex-col gap-2 flex-1 min-h-0",children:n.map(T=>{const k=f===T.slotNumber;return b.jsx("div",{className:`flex-1 bg-rpg-bg-darker bg-opacity-80 border-2 rounded-lg backdrop-blur-sm transition-all flex flex-col ${k?"border-rpg-primary p-4":"border-rpg-secondary p-3 cursor-pointer hover:border-rpg-primary justify-center"}`,onClick:()=>!k&&d(T.slotNumber),children:k?b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"flex justify-between items-start mb-3 flex-shrink-0",children:[b.jsxs("h3",{className:"text-xl font-bold text-rpg-primary",children:[ee("saveSlots.slot")," ",T.slotNumber]}),b.jsxs("button",{onClick:A=>{A.stopPropagation(),x(T.slotNumber)},className:`text-sm ${T.exists?"text-health-mid hover:text-health-full":"invisible"}`,children:["🗑️ ",ee("saveSlots.delete")]})]}),b.jsx("div",{className:"mb-4 flex-1 min-h-0 flex flex-col justify-center",children:T.exists?b.jsxs(b.Fragment,{children:[b.jsxs("p",{className:"text-rpg-text opacity-80 text-base mb-1",children:[ee("saveSlots.level"),": ",T.level," | ",ee("saveSlots.floor"),": ",T.floor]}),b.jsxs("p",{className:"text-rpg-text opacity-80 text-base mb-1",children:[ee("saveSlots.gold"),": ",T.gold]}),b.jsxs("p",{className:"text-epic text-base mb-1",children:["👻 ",U.getCharacterSouls(e,T.slotNumber)," ",ee("souls.heroSouls")]}),b.jsx("p",{className:"text-rpg-text opacity-50 text-sm",children:S(T.timestamp)})]}):b.jsx("p",{className:"text-rpg-text opacity-50 text-lg text-center",children:ee("saveSlots.empty")})}),b.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[T.exists?b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:A=>{A.stopPropagation(),m(T.slotNumber)},className:"flex-1 bg-uncommon hover:bg-rare text-rpg-text font-bold py-2 px-3 rounded-lg text-sm",children:ee("saveSlots.load")}),b.jsx("button",{onClick:A=>{A.stopPropagation(),pk.exportSaveToExcel(e,T.slotNumber)},className:"bg-green-600 hover:bg-green-700 text-rpg-text font-bold py-2 px-3 rounded-lg text-sm",title:"Export save to Excel",children:"📊"})]}):b.jsx("button",{onClick:A=>{A.stopPropagation(),p(T.slotNumber)},className:"flex-1 bg-rpg-primary hover:bg-rpg-secondary text-rpg-text font-bold py-2 px-4 rounded-lg text-sm",children:ee("saveSlots.newGame")}),b.jsxs("button",{onClick:A=>{A.stopPropagation(),c({characterId:e,slotNumber:T.slotNumber})},className:"flex-1 bg-rpg-secondary hover:bg-rpg-primary text-rpg-text font-bold py-2 px-4 rounded-lg text-sm",children:["⚡ ",ee("souls.forge")]})]})]}):b.jsxs("div",{className:"flex items-center justify-between h-full",children:[b.jsxs("h3",{className:"text-lg font-bold text-rpg-primary",children:[ee("saveSlots.slot")," ",T.slotNumber]}),b.jsx("p",{className:`text-sm ${T.exists?"text-rpg-text opacity-80":"text-rpg-text opacity-50 italic"}`,children:T.exists?`Lv.${T.level} | Floor ${T.floor}`:ee("saveSlots.empty")})]})},T.slotNumber)})})]})}),u&&b.jsx(AD,{characterId:u.characterId,slotNumber:u.slotNumber,onClose:()=>c(null)})]})}function g8({type:e,eventType:t,eventData:r,message:n,autoAdvance:a=!0,delay:i=2e3,onContinue:o}){_.useEffect(()=>{if(a&&o){const d=setTimeout(()=>{o()},i);return()=>clearTimeout(d)}},[a,i,o]);const u=()=>{switch(t){case"battle":return"⚔️";case"boss":return"👹";case"shop":return"🏪";case"shrine":return"⛩️";case"treasure":return"💎";case"elite":return"💀";default:return"❓"}},c=()=>{if(n)return n;if(e==="intro")switch(t){case"battle":const d=r?.map(v=>ee(`enemies.${v.id}`)||v.nameKey).join(", ")||ee("events.unknownEnemies");return ee("events.battleIntro",{enemies:d});case"boss":const p=r?.[0]?.nameKey||ee("enemies.boss");return ee("events.bossIntro",{boss:p});case"shop":return ee("events.shopIntro");case"shrine":return ee("events.shrineIntro");case"treasure":return ee("events.treasureIntro");case"elite":const m=r?.[0]?.nameKey||ee("enemies.elite");return ee("events.eliteIntro",{elite:m});default:return ee("events.encounterIntro",{event:ee(`rooms.${t}`)})}else switch(t){case"battle":case"boss":case"elite":return ee("events.battleOutro");case"shop":return ee("events.shopOutro");case"shrine":return ee("events.shrineOutro");case"treasure":return ee("events.treasureOutro");default:return ee("events.encounterOutro")}},f=()=>{switch(t){case"battle":case"elite":return"bg-gradient-to-b from-red-900 to-gray-900";case"boss":return"bg-gradient-to-b from-purple-900 to-black";case"shop":return"bg-gradient-to-b from-blue-900 to-gray-900";case"shrine":return"bg-gradient-to-b from-yellow-900 to-gray-900";case"treasure":return"bg-gradient-to-b from-amber-900 to-gray-900";default:return"bg-gradient-to-b from-gray-900 to-black"}};return b.jsx(Rv,{className:`${f()} justify-center items-center`,children:b.jsxs("div",{className:"text-center max-w-md mx-auto space-y-4",children:[b.jsx(MT,{className:"animate-pulse",children:u()}),b.jsx(Xu,{className:"text-white",children:c()}),b.jsx(An,{className:"text-gray-300",children:ee(e==="intro"?"events.preparing":"events.returning")}),!a&&o&&b.jsx(ol,{onClick:o,className:"bg-amber-600 hover:bg-amber-500",children:ee("events.continue")}),a&&b.jsxs(Za,{className:"text-gray-400",children:[ee("events.autoAdvancing"),"..."]})]})})}function v8({onBuffSelected:e}){const[t,r]=_.useState([]),[n,a]=_.useState(null);_.useEffect(()=>{const c=Bi.generateBuffChoices(3);r(c),de.log(`Generated buff choices: ${c.map(f=>f.key).join(", ")}`,"SYSTEM")},[]);const i=c=>{a(c)},o=()=>{n&&(Bi.applyBuff(n),de.log(`Buff selected and applied: ${n}`,"SYSTEM"),e(n))},u=()=>{de.log("Buff selection skipped","SYSTEM"),e(null)};return b.jsx(Rv,{children:b.jsxs(OT,{className:"justify-between py-4",children:[b.jsxs("div",{className:"text-center",children:[b.jsxs(Xu,{children:["✨ ",ee("buffs.chooseYourBlessing")," ✨"]}),b.jsx(An,{className:"opacity-80 mt-2",children:ee("buffs.selectOneBuffForBattle")})]}),b.jsx(bD,{className:"my-4",children:t.map(c=>b.jsxs("button",{onClick:()=>i(c.key),className:`p-3 rounded-lg border-2 transition-all duration-200 text-left ${n===c.key?"bg-rpg-primary border-legendary shadow-lg scale-105":"bg-rpg-bg-darker border-rpg-secondary hover:border-rpg-primary hover:scale-102"}`,children:[b.jsx(MT,{className:"text-center mb-2",children:c.icon}),b.jsx(NT,{className:"text-rpg-primary text-center mb-1",children:typeof c.name=="object"?c.name[Er.getCurrentLanguage()]:c.name}),b.jsx(Za,{className:"opacity-90 text-center",children:typeof c.description=="object"?c.description[Er.getCurrentLanguage()]:c.description}),n===c.key&&b.jsxs(An,{className:"mt-2 text-center text-uncommon font-bold",children:["✓ ",ee("buffs.selected")]})]},c.key))}),b.jsxs("div",{className:"flex gap-3 justify-center",children:[b.jsx(DT,{onClick:u,children:ee("buffs.skip")}),b.jsx(ol,{onClick:o,disabled:!n,className:n?"":"opacity-50 cursor-not-allowed",children:ee("buffs.confirm")})]}),b.jsx(Za,{className:"text-center opacity-60 mt-3",children:ee("buffs.buffsStackAcrossBattles")})]})})}function y8({onClose:e}){const[t,r]=_.useState(U.current.player),[n,a]=_.useState(U.current.inventory||[]),[i,o]=_.useState(U.current.equipped||{}),[u,c]=_.useState(U.current.potions||{}),[f,d]=_.useState(null),[p,m]=_.useState("equipment");_.useEffect(()=>{const P=U.subscribe(()=>{r(U.current.player),a(U.current.inventory||[]),o(U.current.equipped||{}),c(U.current.potions||{})});return()=>P()},[]);const v=P=>{if(!P||!P.slot)return;const N=i[P.slot];N&&U.current.inventory.push(N),U.current.equipped[P.slot]=P,U.current.inventory=U.current.inventory.filter(I=>I.id!==P.id),U.updatePlayerStats(),U._notify()},x=P=>{const N=i[P];N&&(U.current.inventory.push(N),delete U.current.equipped[P],U.updatePlayerStats(),U._notify())},y=P=>tt.RARITIES[P]?.color||"#95a5a6",S=P=>{const N=tt.EQUIPMENT_SLOTS[P];if(!N)return null;const I=i[P],D=typeof N.name=="string"?N.name:N.name[U.current.language]||N.name.en;return b.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded p-2 border border-gray-700",children:[b.jsxs("div",{className:"flex items-center justify-between mb-1",children:[b.jsxs("div",{className:"flex items-center gap-1.5",children:[b.jsx("span",{className:"text-lg",children:N.icon}),b.jsx("span",{className:"text-rpg-text font-semibold text-xs",children:D})]}),I&&b.jsx("button",{onClick:()=>x(P),className:"text-[10px] px-1.5 py-0.5 bg-red-600 hover:bg-red-700 text-white rounded",children:"Unequip"})]}),I?b.jsxs("div",{className:"bg-black bg-opacity-40 rounded p-1.5 cursor-pointer hover:bg-opacity-60 transition-all",onClick:()=>d(I),children:[b.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[I.prefixKey&&b.jsx("span",{className:"text-[10px] text-blue-400",children:ee(I.prefixKey)}),b.jsx("span",{className:"font-semibold text-xs",style:{color:y(I.rarity)},children:ee(I.nameKey)})]}),b.jsx("div",{className:"flex flex-wrap gap-1 text-[10px]",children:Object.entries(I.stats).map(([z,H])=>b.jsxs("span",{className:"text-green-400",children:["+",H," ",z.toUpperCase()]},z))})]}):b.jsx("div",{className:"bg-black bg-opacity-20 rounded p-1.5 text-center text-gray-500 italic text-xs",children:"Empty"})]},P)},T=P=>b.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg p-3 border border-gray-700 cursor-pointer hover:border-rpg-primary transition-all",onClick:()=>d(P),children:[b.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[P.prefixKey&&b.jsx("span",{className:"text-xs text-blue-400",children:ee(P.prefixKey)}),b.jsx("span",{className:"font-semibold text-sm",style:{color:y(P.rarity)},children:ee(P.nameKey)})]}),b.jsx("div",{className:"flex flex-wrap gap-2 text-xs mb-2",children:Object.entries(P.stats).map(([N,I])=>b.jsxs("span",{className:"text-green-400",children:["+",I," ",N.toUpperCase()]},N))}),P.slot&&b.jsx("button",{onClick:N=>{N.stopPropagation(),v(P)},className:"text-xs px-3 py-1 bg-rpg-primary hover:bg-rpg-secondary text-black rounded w-full font-semibold",children:"Equip"})]},P.id),k=()=>b.jsxs("div",{className:"space-y-2",children:[b.jsx("h3",{className:"text-sm font-bold text-rpg-primary mb-1.5",children:"Potions & Consumables"}),b.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(u).map(([P,N])=>{const I=tt.ITEM_TYPES[P];if(!I)return null;const D=typeof I.name=="string"?I.name:I.name[U.current.language]||I.name.en;return b.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded p-2 border border-gray-700",children:b.jsxs("div",{className:"flex items-center gap-1.5",children:[b.jsx("span",{className:"text-xl",children:I.icon}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("div",{className:"font-semibold text-rpg-text text-xs truncate",children:D}),b.jsxs("div",{className:"text-xs text-rpg-primary",children:["x",N]})]})]})},P)})}),Object.keys(u).length===0&&b.jsx("div",{className:"text-center text-gray-500 italic py-8",children:"No consumables in inventory"})]}),A=()=>{const P=t.stats,N=t.resource;return b.jsxs("div",{className:"space-y-2",children:[b.jsx("h3",{className:"text-sm font-bold text-rpg-primary mb-1.5",children:"Character Stats"}),b.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded p-2 border border-gray-700",children:b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("div",{className:"text-3xl",children:t.icon}),b.jsxs("div",{children:[b.jsx("div",{className:"text-base font-bold text-rpg-primary",children:ee(t.nameKey)}),b.jsxs("div",{className:"text-xs text-rpg-text",children:["Level ",U.current.level]})]})]})}),b.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded p-2 border border-gray-700",children:[b.jsx("h4",{className:"text-xs font-semibold text-rpg-text mb-1.5",children:"Combat Stats"}),b.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[b.jsx(Io,{label:"HP",value:P.hp,icon:"❤️"}),b.jsx(Io,{label:ee(N.nameKey),value:`${N.current}/${N.max}`,icon:N.icon}),b.jsx(Io,{label:"ATK",value:P.atk,icon:"⚔️"}),b.jsx(Io,{label:"DEF",value:P.def,icon:"🛡️"}),b.jsx(Io,{label:"SPD",value:P.spd,icon:"⚡"}),b.jsx(Io,{label:"CRIT",value:`${(P.crit*100).toFixed(0)}%`,icon:"💥"})]})]}),b.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded p-2 border border-gray-700",children:[b.jsx("h4",{className:"text-xs font-semibold text-rpg-text mb-1.5",children:"Resources"}),b.jsxs("div",{className:"space-y-1",children:[b.jsxs("div",{className:"flex justify-between text-xs",children:[b.jsx("span",{className:"text-rpg-text",children:"💰 Gold"}),b.jsx("span",{className:"text-rpg-primary font-bold",children:U.current.gold})]}),b.jsxs("div",{className:"flex justify-between text-xs",children:[b.jsx("span",{className:"text-rpg-text",children:"✨ Hero Souls"}),b.jsx("span",{className:"text-rpg-primary font-bold",children:U.current.souls})]}),b.jsxs("div",{className:"flex justify-between text-xs",children:[b.jsx("span",{className:"text-rpg-text",children:"📊 Experience"}),b.jsx("span",{className:"text-rpg-primary font-bold",children:U.current.experience})]})]})]})]})};return b.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 p-2",children:[b.jsxs("div",{className:"w-full max-w-2xl h-[90vh] bg-gradient-to-br from-rpg-bg via-gray-900 to-black rounded-lg shadow-2xl border-2 border-rpg-primary overflow-hidden flex flex-col",children:[b.jsxs("div",{className:"bg-gradient-to-r from-rpg-secondary to-rpg-primary p-2 flex items-center justify-between flex-shrink-0",children:[b.jsx("h2",{className:"text-base font-bold text-black",children:"🎒 Inventory"}),b.jsx("button",{onClick:e,className:"text-lg font-bold text-black hover:text-red-600 transition-colors",children:"✕"})]}),b.jsxs("div",{className:"flex bg-gray-900 border-b border-gray-700 flex-shrink-0",children:[b.jsx("button",{onClick:()=>m("equipment"),className:`flex-1 py-1.5 text-sm font-semibold transition-colors ${p==="equipment"?"bg-rpg-primary text-black":"text-rpg-text hover:bg-gray-800"}`,children:"⚔️ Equipment"}),b.jsx("button",{onClick:()=>m("consumables"),className:`flex-1 py-1.5 text-sm font-semibold transition-colors ${p==="consumables"?"bg-rpg-primary text-black":"text-rpg-text hover:bg-gray-800"}`,children:"🧪 Items"}),b.jsx("button",{onClick:()=>m("stats"),className:`flex-1 py-1.5 text-sm font-semibold transition-colors ${p==="stats"?"bg-rpg-primary text-black":"text-rpg-text hover:bg-gray-800"}`,children:"📊 Stats"})]}),b.jsxs("div",{className:"flex-1 overflow-y-auto p-2 min-h-0",children:[p==="equipment"&&b.jsxs("div",{className:"space-y-2",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"text-sm font-bold text-rpg-primary mb-1.5",children:"Equipped"}),b.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.keys(tt.EQUIPMENT_SLOTS).map(P=>S(P))})]}),b.jsxs("div",{children:[b.jsxs("h3",{className:"text-sm font-bold text-rpg-primary mb-1.5",children:["Inventory (",n.length,"/",tt.INVENTORY.maxSlots,")"]}),n.length>0?b.jsx("div",{className:"grid grid-cols-1 gap-2",children:n.map(P=>T(P))}):b.jsx("div",{className:"text-center text-gray-500 italic py-3 text-xs",children:"No items in inventory. Visit shops to purchase equipment!"})]})]}),p==="consumables"&&k(),p==="stats"&&A()]}),b.jsxs("div",{className:"bg-gray-900 border-t border-gray-700 p-1.5 flex justify-between items-center gap-2 flex-shrink-0",children:[b.jsxs("div",{className:"text-rpg-text text-xs",children:["Floor ",U.current.currentFloor," • ",ee(t.nameKey)," • Lv.",U.current.level]}),b.jsx("button",{onClick:e,className:"px-3 py-1 bg-rpg-primary hover:bg-rpg-secondary text-black font-bold rounded transition-colors text-sm",children:"Close"})]})]}),f&&b.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",onClick:()=>d(null),children:b.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md border-2 border-rpg-primary",onClick:P=>P.stopPropagation(),children:[b.jsxs("h3",{className:"text-xl font-bold mb-2",style:{color:y(f.rarity)},children:[f.prefixKey&&`${ee(f.prefixKey)} `,ee(f.nameKey)]}),b.jsxs("div",{className:"space-y-2 mb-4",children:[b.jsxs("div",{className:"text-sm text-gray-400",children:["Rarity: ",b.jsx("span",{style:{color:y(f.rarity)},children:ee(`rarities.${f.rarity}`)})]}),b.jsxs("div",{className:"text-sm text-gray-400",children:["Slot: ",f.slot||"None"]}),b.jsx("div",{className:"space-y-1 mt-3",children:Object.entries(f.stats).map(([P,N])=>b.jsxs("div",{className:"text-green-400",children:["+",N," ",P.toUpperCase()]},P))})]}),b.jsx("button",{onClick:()=>d(null),className:"w-full px-4 py-2 bg-rpg-primary hover:bg-rpg-secondary text-black font-bold rounded",children:"Close"})]})})]})}function Io({label:e,value:t,icon:r}){return b.jsx("div",{className:"bg-black bg-opacity-40 rounded p-1.5",children:b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx("span",{className:"text-sm",children:r}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("div",{className:"text-[10px] text-gray-400 truncate",children:e}),b.jsx("div",{className:"text-xs font-bold text-rpg-primary truncate",children:t})]})]})})}function mk(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=mk(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ht(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=mk(e))&&(n&&(n+=" "),n+=t);return n}var x8=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function r1(e){if(typeof e!="string")return!1;var t=x8;return t.includes(e)}var w8=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function gk(e){if(typeof e!="string")return!1;var t=w8;return t.includes(e)}function vk(e){return typeof e=="string"&&e.startsWith("data-")}function Qn(e){var t=Object.entries(e).filter(r=>{var[n]=r;return gk(n)||vk(n)});return Object.fromEntries(t)}function Ws(e){if(e==null)return null;if(_.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Qn(t)}return typeof e=="object"&&!Array.isArray(e)?Qn(e):null}function an(e){var t=Object.entries(e).filter(r=>{var[n]=r;return gk(n)||vk(n)||r1(n)});return Object.fromEntries(t)}function S8(e){return e==null?null:_.isValidElement(e)?an(e.props):typeof e=="object"&&!Array.isArray(e)?an(e):null}var b8=["children","width","height","viewBox","className","style","title","desc"];function $g(){return $g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$g.apply(null,arguments)}function E8(e,t){if(e==null)return{};var r,n,a=_8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var n1=_.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:o,style:u,title:c,desc:f}=e,d=E8(e,b8),p=i||{width:n,height:a,x:0,y:0},m=ht("recharts-surface",o);return _.createElement("svg",$g({},an(d),{className:m,width:n,height:a,style:u,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),_.createElement("title",null,c),_.createElement("desc",null,f),r)}),T8=["children","className"];function Ug(){return Ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ug.apply(null,arguments)}function A8(e,t){if(e==null)return{};var r,n,a=k8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function k8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Br=_.forwardRef((e,t)=>{var{children:r,className:n}=e,a=A8(e,T8),i=ht("recharts-layer",n);return _.createElement("g",Ug({className:i},an(a),{ref:t}),r)}),yk=AT(),xk=_.createContext(null),O8=()=>_.useContext(xk);function Pt(e){return function(){return e}}const wk=Math.cos,Rd=Math.sin,ya=Math.sqrt,Id=Math.PI,A0=2*Id,Wg=Math.PI,zg=2*Wg,Es=1e-6,P8=zg-Es;function Sk(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function C8(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Sk;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class N8{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Sk:C8(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,u=this._y1,c=n-t,f=a-r,d=o-t,p=u-r,m=d*d+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Es)if(!(Math.abs(p*c-f*d)>Es)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let v=n-o,x=a-u,y=c*c+f*f,S=v*v+x*x,T=Math.sqrt(y),k=Math.sqrt(m),A=i*Math.tan((Wg-Math.acos((y+m-S)/(2*T*k)))/2),P=A/k,N=A/T;Math.abs(P-1)>Es&&this._append`L${t+P*d},${r+P*p}`,this._append`A${i},${i},0,0,${+(p*v>d*x)},${this._x1=t+N*c},${this._y1=r+N*f}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let u=n*Math.cos(a),c=n*Math.sin(a),f=t+u,d=r+c,p=1^o,m=o?a-i:i-a;this._x1===null?this._append`M${f},${d}`:(Math.abs(this._x1-f)>Es||Math.abs(this._y1-d)>Es)&&this._append`L${f},${d}`,n&&(m<0&&(m=m%zg+zg),m>P8?this._append`A${n},${n},0,1,${p},${t-u},${r-c}A${n},${n},0,1,${p},${this._x1=f},${this._y1=d}`:m>Es&&this._append`A${n},${n},0,${+(m>=Wg)},${p},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function a1(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new N8(t)}function i1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function bk(e){this._context=e}bk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function k0(e){return new bk(e)}function Ek(e){return e[0]}function _k(e){return e[1]}function Tk(e,t){var r=Pt(!0),n=null,a=k0,i=null,o=a1(u);e=typeof e=="function"?e:e===void 0?Ek:Pt(e),t=typeof t=="function"?t:t===void 0?_k:Pt(t);function u(c){var f,d=(c=i1(c)).length,p,m=!1,v;for(n==null&&(i=a(v=o())),f=0;f<=d;++f)!(f<d&&r(p=c[f],f,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(p,f,c),+t(p,f,c));if(v)return i=null,v+""||null}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Pt(+c),u):e},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Pt(+c),u):t},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Pt(!!c),u):r},u.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),u):a},u.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),u):n},u}function Hf(e,t,r){var n=null,a=Pt(!0),i=null,o=k0,u=null,c=a1(f);e=typeof e=="function"?e:e===void 0?Ek:Pt(+e),t=typeof t=="function"?t:Pt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?_k:Pt(+r);function f(p){var m,v,x,y=(p=i1(p)).length,S,T=!1,k,A=new Array(y),P=new Array(y);for(i==null&&(u=o(k=c())),m=0;m<=y;++m){if(!(m<y&&a(S=p[m],m,p))===T)if(T=!T)v=m,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),x=m-1;x>=v;--x)u.point(A[x],P[x]);u.lineEnd(),u.areaEnd()}T&&(A[m]=+e(S,m,p),P[m]=+t(S,m,p),u.point(n?+n(S,m,p):A[m],r?+r(S,m,p):P[m]))}if(k)return u=null,k+""||null}function d(){return Tk().defined(a).curve(o).context(i)}return f.x=function(p){return arguments.length?(e=typeof p=="function"?p:Pt(+p),n=null,f):e},f.x0=function(p){return arguments.length?(e=typeof p=="function"?p:Pt(+p),f):e},f.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:Pt(+p),f):n},f.y=function(p){return arguments.length?(t=typeof p=="function"?p:Pt(+p),r=null,f):t},f.y0=function(p){return arguments.length?(t=typeof p=="function"?p:Pt(+p),f):t},f.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:Pt(+p),f):r},f.lineX0=f.lineY0=function(){return d().x(e).y(t)},f.lineY1=function(){return d().x(e).y(r)},f.lineX1=function(){return d().x(n).y(t)},f.defined=function(p){return arguments.length?(a=typeof p=="function"?p:Pt(!!p),f):a},f.curve=function(p){return arguments.length?(o=p,i!=null&&(u=o(i)),f):o},f.context=function(p){return arguments.length?(p==null?i=u=null:u=o(i=p),f):i},f}class Ak{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function D8(e){return new Ak(e,!0)}function M8(e){return new Ak(e,!1)}const s1={draw(e,t){const r=ya(t/Id);e.moveTo(r,0),e.arc(0,0,r,0,A0)}},R8={draw(e,t){const r=ya(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},kk=ya(1/3),I8=kk*2,F8={draw(e,t){const r=ya(t/I8),n=r*kk;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},j8={draw(e,t){const r=ya(t),n=-r/2;e.rect(n,n,r,r)}},L8=.8908130915292852,Ok=Rd(Id/10)/Rd(7*Id/10),B8=Rd(A0/10)*Ok,$8=-wk(A0/10)*Ok,U8={draw(e,t){const r=ya(t*L8),n=B8*r,a=$8*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=A0*i/5,u=wk(o),c=Rd(o);e.lineTo(c*r,-u*r),e.lineTo(u*n-c*a,c*n+u*a)}e.closePath()}},nm=ya(3),W8={draw(e,t){const r=-ya(t/(nm*3));e.moveTo(0,r*2),e.lineTo(-nm*r,-r),e.lineTo(nm*r,-r),e.closePath()}},zn=-.5,Kn=ya(3)/2,Kg=1/ya(12),z8=(Kg/2+1)*3,K8={draw(e,t){const r=ya(t/z8),n=r/2,a=r*Kg,i=n,o=r*Kg+r,u=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(u,c),e.lineTo(zn*n-Kn*a,Kn*n+zn*a),e.lineTo(zn*i-Kn*o,Kn*i+zn*o),e.lineTo(zn*u-Kn*c,Kn*u+zn*c),e.lineTo(zn*n+Kn*a,zn*a-Kn*n),e.lineTo(zn*i+Kn*o,zn*o-Kn*i),e.lineTo(zn*u+Kn*c,zn*c-Kn*u),e.closePath()}};function H8(e,t){let r=null,n=a1(a);e=typeof e=="function"?e:Pt(e||s1),t=typeof t=="function"?t:Pt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Pt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Pt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Fd(){}function jd(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Pk(e){this._context=e}Pk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:jd(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:jd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function V8(e){return new Pk(e)}function Ck(e){this._context=e}Ck.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:jd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function G8(e){return new Ck(e)}function Nk(e){this._context=e}Nk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:jd(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Y8(e){return new Nk(e)}function Dk(e){this._context=e}Dk.prototype={areaStart:Fd,areaEnd:Fd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function q8(e){return new Dk(e)}function T2(e){return e<0?-1:1}function A2(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),u=(i*a+o*n)/(n+a);return(T2(i)+T2(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function k2(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function am(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-n)/3;e._context.bezierCurveTo(n+u,a+u*t,i-u,o-u*r,i,o)}function Ld(e){this._context=e}Ld.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:am(this,this._t0,k2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,am(this,k2(this,r=A2(this,e,t)),r);break;default:am(this,this._t0,r=A2(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Mk(e){this._context=new Rk(e)}(Mk.prototype=Object.create(Ld.prototype)).point=function(e,t){Ld.prototype.point.call(this,t,e)};function Rk(e){this._context=e}Rk.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function X8(e){return new Ld(e)}function Q8(e){return new Mk(e)}function Ik(e){this._context=e}Ik.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=O2(e),a=O2(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function O2(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Z8(e){return new Ik(e)}function O0(e,t){this._context=e,this._t=t}O0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function J8(e){return new O0(e,.5)}function e6(e){return new O0(e,0)}function t6(e){return new O0(e,1)}function Zo(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,u=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<u;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Hg(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function r6(e,t){return e[t]}function n6(e){const t=[];return t.key=e,t}function a6(){var e=Pt([]),t=Hg,r=Zo,n=r6;function a(i){var o=Array.from(e.apply(this,arguments),n6),u,c=o.length,f=-1,d;for(const p of i)for(u=0,++f;u<c;++u)(o[u][f]=[0,+n(p,o[u].key,f,i)]).data=p;for(u=0,d=i1(t(o));u<c;++u)o[d[u]].index=u;return r(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Pt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Pt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Hg:typeof i=="function"?i:Pt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Zo,a):r},a}function i6(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Zo(e,t)}}function s6(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,u=0;o<a;++o)u+=e[o][r][1]||0;n[r][1]+=n[r][0]=-u/2}Zo(e,t)}}function o6(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var u=0,c=0,f=0;u<o;++u){for(var d=e[t[u]],p=d[n][1]||0,m=d[n-1][1]||0,v=(p-m)/2,x=0;x<u;++x){var y=e[t[x]],S=y[n][1]||0,T=y[n-1][1]||0;v+=S-T}c+=p,f+=v*p}a[n-1][1]+=a[n-1][0]=r,c&&(r-=f/c)}a[n-1][1]+=a[n-1][0]=r,Zo(e,t)}}var im={},sm={},P2;function l6(){return P2||(P2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t}(sm)),sm}var om={},C2;function Fk(){return C2||(C2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t}(om)),om}var lm={},N2;function o1(){return N2||(N2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t}(lm)),lm}var um={},cm={},D2;function u6(){return D2||(D2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t}(cm)),cm}var M2;function l1(){return M2||(M2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u6(),r=o1();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],o=a.length;if(o===0)return i;let u=0,c="",f="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),u++);u<o;){const p=a[u];f?p==="\\"&&u+1<o?(u++,c+=a[u]):p===f?f="":c+=p:d?p==='"'||p==="'"?f=p:p==="]"?(d=!1,i.push(c),c=""):c+=p:p==="["?(d=!0,c&&(i.push(c),c="")):p==="."?c&&(i.push(c),c=""):c+=p,u++}return c&&i.push(c),i}e.toPath=n}(um)),um}var R2;function u1(){return R2||(R2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l6(),r=Fk(),n=o1(),a=l1();function i(u,c,f){if(u==null)return f;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return f;const d=u[c];return d===void 0?r.isDeepKey(c)?i(u,a.toPath(c),f):f:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=u[c];return d===void 0?f:d}default:{if(Array.isArray(c))return o(u,c,f);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return f;const d=u[c];return d===void 0?f:d}}}function o(u,c,f){if(c.length===0)return f;let d=u;for(let p=0;p<c.length;p++){if(d==null||t.isUnsafeProperty(c[p]))return f;d=d[c[p]]}return d===void 0?f:d}e.get=i}(im)),im}var fm,I2;function c6(){return I2||(I2=1,fm=u1().get),fm}var f6=c6();const zs=Na(f6);var Fr=e=>e===0?0:e>0?1:-1,va=e=>typeof e=="number"&&e!=+e,ti=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Je=e=>(typeof e=="number"||e instanceof Number)&&!va(e),Pa=e=>Je(e)||typeof e=="string",d6=0,Bu=e=>{var t=++d6;return"".concat(e||"").concat(t)},Gr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Je(t)&&typeof t!="string")return n;var i;if(ti(t)){if(r==null)return n;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return va(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},jk=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function qt(e,t,r){return Je(e)&&Je(t)?e+r*(t-e):t}function Lk(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):zs(n,t))===r)}var $t=e=>e===null||typeof e>"u",nc=e=>$t(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),h6=["type","size","sizeType"];function Vg(){return Vg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vg.apply(null,arguments)}function F2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function j2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F2(Object(r),!0).forEach(function(n){p6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p6(e,t,r){return(t=m6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m6(e){var t=g6(e,"string");return typeof t=="symbol"?t:t+""}function g6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v6(e,t){if(e==null)return{};var r,n,a=y6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function y6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Bk={symbolCircle:s1,symbolCross:R8,symbolDiamond:F8,symbolSquare:j8,symbolStar:U8,symbolTriangle:W8,symbolWye:K8},x6=Math.PI/180,w6=e=>{var t="symbol".concat(nc(e));return Bk[t]||s1},S6=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*x6;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},b6=(e,t)=>{Bk["symbol".concat(nc(e))]=t},c1=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=v6(e,h6),i=j2(j2({},a),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var u=()=>{var m=w6(o),v=H8().type(m).size(S6(r,n,o)),x=v();if(x!==null)return x},{className:c,cx:f,cy:d}=i,p=an(i);return f===+f&&d===+d&&r===+r?_.createElement("path",Vg({},p,{className:ht("recharts-symbols",c),transform:"translate(".concat(f,", ").concat(d,")"),d:u()})):null};c1.registerSymbol=b6;var f1=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(_.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{r1(a)&&(n[a]=i=>r[a](r,i))}),n},E6=(e,t,r)=>n=>(e(t,r,n),null),ac=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];r1(a)&&typeof i=="function"&&(n||(n={}),n[a]=E6(i,t,r))}),n};function Gg(){return Gg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gg.apply(null,arguments)}function L2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L2(Object(r),!0).forEach(function(n){d1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d1(e,t,r){return(t=T6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T6(e){var t=A6(e,"string");return typeof t=="symbol"?t:t+""}function A6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hn=32;class h1 extends _.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Hn/2,i=Hn/6,o=Hn/3,u=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return _.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Hn,y2:a,className:"recharts-legend-icon"});if(c==="line")return _.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Hn,"M").concat(2*o,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return _.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Hn/8,"h").concat(Hn,"v").concat(Hn*3/4,"h").concat(-Hn,"z"),className:"recharts-legend-icon"});if(_.isValidElement(t.legendIcon)){var f=_6({},t);return delete f.legendIcon,_.cloneElement(t.legendIcon,f)}return _.createElement(c1,{fill:u,cx:a,cy:a,size:Hn,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:o}=this.props,u={x:0,y:0,width:Hn,height:Hn},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,p)=>{var m=d.formatter||a,v=ht({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?i:d.color,y=m?m(d.value,d,p):d.value;return _.createElement("li",Gg({className:v,style:c,key:"legend-item-".concat(p)},ac(this.props,d,p)),_.createElement(n1,{width:r,height:r,viewBox:u,style:f,"aria-label":"".concat(y," legend icon")},this.renderIcon(d,o)),_.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},y))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return _.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}d1(h1,"displayName","Legend");d1(h1,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var dm={},hm={},B2;function k6(){return B2||(B2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const o=r[i],u=n(o);a.has(u)||a.set(u,o)}return Array.from(a.values())}e.uniqBy=t}(hm)),hm}var pm={},$2;function $k(){return $2||($2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t}(pm)),pm}var mm={},gm={},vm={},U2;function O6(){return U2||(U2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t}(vm)),vm}var W2;function p1(){return W2||(W2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O6();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r}(gm)),gm}var ym={},z2;function P6(){return z2||(z2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t}(ym)),ym}var K2;function C6(){return K2||(K2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=p1(),r=P6();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n}(mm)),mm}var xm={},wm={},H2;function N6(){return H2||(H2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u1();function r(n){return function(a){return t.get(a,n)}}e.property=r}(wm)),wm}var Sm={},bm={},Em={},_m={},V2;function Uk(){return V2||(V2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t}(_m)),_m}var Tm={},G2;function Wk(){return G2||(G2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t}(Tm)),Tm}var Am={},Y2;function zk(){return Y2||(Y2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t}(Am)),Am}var q2;function D6(){return q2||(q2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m1(),r=Uk(),n=Wk(),a=zk();function i(p,m,v){return typeof v!="function"?t.isMatch(p,m):o(p,m,function x(y,S,T,k,A,P){const N=v(y,S,T,k,A,P);return N!==void 0?!!N:o(y,S,x,P)},new Map)}function o(p,m,v,x){if(m===p)return!0;switch(typeof m){case"object":return u(p,m,v,x);case"function":return Object.keys(m).length>0?o(p,{...m},v,x):a.eq(p,m);default:return r.isObject(p)?typeof m=="string"?m==="":!0:a.eq(p,m)}}function u(p,m,v,x){if(m==null)return!0;if(Array.isArray(m))return f(p,m,v,x);if(m instanceof Map)return c(p,m,v,x);if(m instanceof Set)return d(p,m,v,x);const y=Object.keys(m);if(p==null)return y.length===0;if(y.length===0)return!0;if(x&&x.has(m))return x.get(m)===p;x&&x.set(m,p);try{for(let S=0;S<y.length;S++){const T=y[S];if(!n.isPrimitive(p)&&!(T in p)||m[T]===void 0&&p[T]!==void 0||m[T]===null&&p[T]!==null||!v(p[T],m[T],T,p,m,x))return!1}return!0}finally{x&&x.delete(m)}}function c(p,m,v,x){if(m.size===0)return!0;if(!(p instanceof Map))return!1;for(const[y,S]of m.entries()){const T=p.get(y);if(v(T,S,y,p,m,x)===!1)return!1}return!0}function f(p,m,v,x){if(m.length===0)return!0;if(!Array.isArray(p))return!1;const y=new Set;for(let S=0;S<m.length;S++){const T=m[S];let k=!1;for(let A=0;A<p.length;A++){if(y.has(A))continue;const P=p[A];let N=!1;if(v(P,T,S,p,m,x)&&(N=!0),N){y.add(A),k=!0;break}}if(!k)return!1}return!0}function d(p,m,v,x){return m.size===0?!0:p instanceof Set?f([...p],[...m],v,x):!1}e.isMatchWith=i,e.isSetMatch=d}(Em)),Em}var X2;function m1(){return X2||(X2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D6();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(bm)),bm}var km={},Om={},Pm={},Q2;function M6(){return Q2||(Q2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t}(Pm)),Pm}var Cm={},Z2;function Kk(){return Z2||(Z2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t}(Cm)),Cm}var Nm={},J2;function Hk(){return J2||(J2=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",o="[object Symbol]",u="[object Date]",c="[object Map]",f="[object Set]",d="[object Array]",p="[object Function]",m="[object ArrayBuffer]",v="[object Object]",x="[object Error]",y="[object DataView]",S="[object Uint8Array]",T="[object Uint8ClampedArray]",k="[object Uint16Array]",A="[object Uint32Array]",P="[object BigUint64Array]",N="[object Int8Array]",I="[object Int16Array]",D="[object Int32Array]",z="[object BigInt64Array]",H="[object Float32Array]",te="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=m,e.arrayTag=d,e.bigInt64ArrayTag=z,e.bigUint64ArrayTag=P,e.booleanTag=a,e.dataViewTag=y,e.dateTag=u,e.errorTag=x,e.float32ArrayTag=H,e.float64ArrayTag=te,e.functionTag=p,e.int16ArrayTag=I,e.int32ArrayTag=D,e.int8ArrayTag=N,e.mapTag=c,e.numberTag=n,e.objectTag=v,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=k,e.uint32ArrayTag=A,e.uint8ArrayTag=S,e.uint8ClampedArrayTag=T}(Nm)),Nm}var Dm={},eb;function R6(){return eb||(eb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t}(Dm)),Dm}var tb;function Vk(){return tb||(tb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M6(),r=Kk(),n=Hk(),a=Wk(),i=R6();function o(d,p){return u(d,void 0,d,new Map,p)}function u(d,p,m,v=new Map,x=void 0){const y=x?.(d,p,m,v);if(y!==void 0)return y;if(a.isPrimitive(d))return d;if(v.has(d))return v.get(d);if(Array.isArray(d)){const S=new Array(d.length);v.set(d,S);for(let T=0;T<d.length;T++)S[T]=u(d[T],T,m,v,x);return Object.hasOwn(d,"index")&&(S.index=d.index),Object.hasOwn(d,"input")&&(S.input=d.input),S}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const S=new RegExp(d.source,d.flags);return S.lastIndex=d.lastIndex,S}if(d instanceof Map){const S=new Map;v.set(d,S);for(const[T,k]of d)S.set(T,u(k,T,m,v,x));return S}if(d instanceof Set){const S=new Set;v.set(d,S);for(const T of d)S.add(u(T,void 0,m,v,x));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const S=new(Object.getPrototypeOf(d)).constructor(d.length);v.set(d,S);for(let T=0;T<d.length;T++)S[T]=u(d[T],T,m,v,x);return S}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const S=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return v.set(d,S),c(S,d,m,v,x),S}if(typeof File<"u"&&d instanceof File){const S=new File([d],d.name,{type:d.type});return v.set(d,S),c(S,d,m,v,x),S}if(typeof Blob<"u"&&d instanceof Blob){const S=new Blob([d],{type:d.type});return v.set(d,S),c(S,d,m,v,x),S}if(d instanceof Error){const S=new d.constructor;return v.set(d,S),S.message=d.message,S.name=d.name,S.stack=d.stack,S.cause=d.cause,c(S,d,m,v,x),S}if(d instanceof Boolean){const S=new Boolean(d.valueOf());return v.set(d,S),c(S,d,m,v,x),S}if(d instanceof Number){const S=new Number(d.valueOf());return v.set(d,S),c(S,d,m,v,x),S}if(d instanceof String){const S=new String(d.valueOf());return v.set(d,S),c(S,d,m,v,x),S}if(typeof d=="object"&&f(d)){const S=Object.create(Object.getPrototypeOf(d));return v.set(d,S),c(S,d,m,v,x),S}return d}function c(d,p,m=d,v,x){const y=[...Object.keys(p),...t.getSymbols(p)];for(let S=0;S<y.length;S++){const T=y[S],k=Object.getOwnPropertyDescriptor(d,T);(k==null||k.writable)&&(d[T]=u(p[T],T,m,v,x))}}function f(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=u,e.copyProperties=c}(Om)),Om}var rb;function I6(){return rb||(rb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vk();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r}(km)),km}var nb;function F6(){return nb||(nb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m1(),r=I6();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n}(Sm)),Sm}var Mm={},Rm={},Im={},ab;function j6(){return ab||(ab=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vk(),r=Hk();function n(a,i){return t.cloneDeepWith(a,(o,u,c,f)=>{const d=i?.(o,u,c,f);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new a.constructor(a?.valueOf());return t.copyProperties(p,a),p}case r.argumentsTag:{const p={};return t.copyProperties(p,a),p.length=a.length,p[Symbol.iterator]=a[Symbol.iterator],p}default:return}})}e.cloneDeepWith=n}(Im)),Im}var ib;function L6(){return ib||(ib=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j6();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r}(Rm)),Rm}var Fm={},jm={},sb;function Gk(){return sb||(sb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r}(jm)),jm}var Lm={},ob;function B6(){return ob||(ob=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kk();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r}(Lm)),Lm}var lb;function $6(){return lb||(lb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fk(),r=Gk(),n=B6(),a=l1();function i(o,u){let c;if(Array.isArray(u)?c=u:typeof u=="string"&&t.isDeepKey(u)&&o?.[u]==null?c=a.toPath(u):c=[u],c.length===0)return!1;let f=o;for(let d=0;d<c.length;d++){const p=c[d];if((f==null||!Object.hasOwn(f,p))&&!((Array.isArray(f)||n.isArguments(f))&&r.isIndex(p)&&p<f.length))return!1;f=f[p]}return!0}e.has=i}(Fm)),Fm}var ub;function U6(){return ub||(ub=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m1(),r=o1(),n=L6(),a=u1(),i=$6();function o(u,c){switch(typeof u){case"object":{Object.is(u?.valueOf(),-0)&&(u="-0");break}case"number":{u=r.toKey(u);break}}return c=n.cloneDeep(c),function(f){const d=a.get(f,u);return d===void 0?i.has(f,u):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o}(Mm)),Mm}var cb;function W6(){return cb||(cb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$k(),r=N6(),n=F6(),a=U6();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i}(xm)),xm}var fb;function z6(){return fb||(fb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=k6(),r=$k(),n=C6(),a=W6();function i(o,u=r.identity){return n.isArrayLikeObject(o)?t.uniqBy(Array.from(o),a.iteratee(u)):[]}e.uniqBy=i}(dm)),dm}var Bm,db;function K6(){return db||(db=1,Bm=z6().uniqBy),Bm}var H6=K6();const hb=Na(H6);function Yk(e,t,r){return t===!0?hb(e,r):typeof t=="function"?hb(e,t):e}var $m={exports:{}},Um={},Wm={exports:{}},zm={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb;function V6(){if(pb)return zm;pb=1;var e=sl();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function u(p,m){var v=m(),x=n({inst:{value:v,getSnapshot:m}}),y=x[0].inst,S=x[1];return i(function(){y.value=v,y.getSnapshot=m,c(y)&&S({inst:y})},[p,v,m]),a(function(){return c(y)&&S({inst:y}),p(function(){c(y)&&S({inst:y})})},[p]),o(v),v}function c(p){var m=p.getSnapshot;p=p.value;try{var v=m();return!r(p,v)}catch{return!0}}function f(p,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:u;return zm.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,zm}var mb;function G6(){return mb||(mb=1,Wm.exports=V6()),Wm.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function Y6(){if(gb)return Um;gb=1;var e=sl(),t=G6();function r(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,u=e.useMemo,c=e.useDebugValue;return Um.useSyncExternalStoreWithSelector=function(f,d,p,m,v){var x=i(null);if(x.current===null){var y={hasValue:!1,value:null};x.current=y}else y=x.current;x=u(function(){function T(I){if(!k){if(k=!0,A=I,I=m(I),v!==void 0&&y.hasValue){var D=y.value;if(v(D,I))return P=D}return P=I}if(D=P,n(A,I))return D;var z=m(I);return v!==void 0&&v(D,z)?(A=I,D):(A=I,P=z)}var k=!1,A,P,N=p===void 0?null:p;return[function(){return T(d())},N===null?void 0:function(){return T(N())}]},[d,p,m,v]);var S=a(f,x[0],x[1]);return o(function(){y.hasValue=!0,y.value=S},[S]),c(S),S},Um}var vb;function q6(){return vb||(vb=1,$m.exports=Y6()),$m.exports}var X6=q6(),g1=_.createContext(null),Q6=e=>e,Ut=()=>{var e=_.useContext(g1);return e?e.store.dispatch:Q6},ud=()=>{},Z6=()=>ud,J6=(e,t)=>e===t;function Ge(e){var t=_.useContext(g1);return X6.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Z6,t?t.store.getState:ud,t?t.store.getState:ud,t?e:ud,J6)}function eB(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function tB(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function rB(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var yb=e=>Array.isArray(e)?e:[e];function nB(e){const t=Array.isArray(e[0])?e[0]:e;return rB(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function aB(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var iB=class{constructor(e){this.value=e}deref(){return this.value}},sB=typeof WeakRef<"u"?WeakRef:iB,oB=0,xb=1;function Vf(){return{s:oB,v:void 0,o:null,p:null}}function qk(e,t={}){let r=Vf();const{resultEqualityCheck:n}=t;let a,i=0;function o(){let u=r;const{length:c}=arguments;for(let p=0,m=c;p<m;p++){const v=arguments[p];if(typeof v=="function"||typeof v=="object"&&v!==null){let x=u.o;x===null&&(u.o=x=new WeakMap);const y=x.get(v);y===void 0?(u=Vf(),x.set(v,u)):u=y}else{let x=u.p;x===null&&(u.p=x=new Map);const y=x.get(v);y===void 0?(u=Vf(),x.set(v,u)):u=y}}const f=u;let d;if(u.s===xb)d=u.v;else if(d=e.apply(null,arguments),i++,n){const p=a?.deref?.()??a;p!=null&&n(p,d)&&(d=p,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new sB(d):d}return f.s=xb,f.v=d,d}return o.clearCache=()=>{r=Vf(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function lB(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,o=0,u,c={},f=a.pop();typeof f=="object"&&(c=f,f=a.pop()),eB(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const d={...r,...c},{memoize:p,memoizeOptions:m=[],argsMemoize:v=qk,argsMemoizeOptions:x=[]}=d,y=yb(m),S=yb(x),T=nB(a),k=p(function(){return i++,f.apply(null,arguments)},...y),A=v(function(){o++;const N=aB(T,arguments);return u=k.apply(null,N),u},...S);return Object.assign(A,{resultFunc:f,memoizedResultFunc:k,dependencies:T,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>u,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:p,argsMemoize:v})};return Object.assign(n,{withTypes:()=>n}),n}var le=lB(qk),uB=Object.assign((e,t=le)=>{tB(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((o,u,c)=>(o[r[c]]=u,o),{}))},{withTypes:()=>uB}),Km={},Hm={},Vm={},wb;function cB(){return wb||(wb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const o=t(n),u=t(a);if(o===u&&o===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?u-o:o-u}return 0};e.compareValues=r}(Vm)),Vm}var Gm={},Ym={},Sb;function Xk(){return Sb||(Sb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t}(Ym)),Ym}var bb;function fB(){return bb||(bb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Xk(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=a}(Gm)),Gm}var Eb;function dB(){return Eb||(Eb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cB(),r=fB(),n=l1();function a(i,o,u,c){if(i==null)return[];u=c?void 0:u,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(u)||(u=u==null?[]:[u]),u=u.map(v=>String(v));const f=(v,x)=>{let y=v;for(let S=0;S<x.length&&y!=null;++S)y=y[x[S]];return y},d=(v,x)=>x==null||v==null?x:typeof v=="object"&&"key"in v?Object.hasOwn(x,v.key)?x[v.key]:f(x,v.path):typeof v=="function"?v(x):Array.isArray(v)?f(x,v):typeof x=="object"?x[v]:x,p=o.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||r.isKey(v)?v:{key:v,path:n.toPath(v)}));return i.map(v=>({original:v,criteria:p.map(x=>d(x,v))})).slice().sort((v,x)=>{for(let y=0;y<p.length;y++){const S=t.compareValues(v.criteria[y],x.criteria[y],u[y]);if(S!==0)return S}return 0}).map(v=>v.original)}e.orderBy=a}(Hm)),Hm}var qm={},_b;function hB(){return _b||(_b=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),o=(u,c)=>{for(let f=0;f<u.length;f++){const d=u[f];Array.isArray(d)&&c<i?o(d,c+1):a.push(d)}};return o(r,0),a}e.flatten=t}(qm)),qm}var Xm={},Tb;function Qk(){return Tb||(Tb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Gk(),r=p1(),n=Uk(),a=zk();function i(o,u,c){return n.isObject(c)&&(typeof u=="number"&&r.isArrayLike(c)&&t.isIndex(u)&&u<c.length||typeof u=="string"&&u in c)?a.eq(c[u],o):!1}e.isIterateeCall=i}(Xm)),Xm}var Ab;function pB(){return Ab||(Ab=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dB(),r=hB(),n=Qk();function a(i,...o){const u=o.length;return u>1&&n.isIterateeCall(i,o[0],o[1])?o=[]:u>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=a}(Km)),Km}var Qm,kb;function mB(){return kb||(kb=1,Qm=pB().sortBy),Qm}var gB=mB();const P0=Na(gB);var Zk=e=>e.legend.settings,vB=e=>e.legend.size,yB=e=>e.legend.payload,xB=le([yB,Zk],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?P0(n,r):n});function wB(){return Ge(xB)}var Gf=1;function Jk(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=_.useState({height:0,left:0,top:0,width:0}),n=_.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>Gf||Math.abs(o.left-t.left)>Gf||Math.abs(o.top-t.top)>Gf||Math.abs(o.width-t.width)>Gf)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Nr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var SB=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ob=SB,Zm=()=>Math.random().toString(36).substring(7).split("").join("."),bB={INIT:`@@redux/INIT${Zm()}`,REPLACE:`@@redux/REPLACE${Zm()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Zm()}`},Bd=bB;function v1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function eO(e,t,r){if(typeof e!="function")throw new Error(Nr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Nr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Nr(1));return r(eO)(e,t)}let n=e,a=t,i=new Map,o=i,u=0,c=!1;function f(){o===i&&(o=new Map,i.forEach((S,T)=>{o.set(T,S)}))}function d(){if(c)throw new Error(Nr(3));return a}function p(S){if(typeof S!="function")throw new Error(Nr(4));if(c)throw new Error(Nr(5));let T=!0;f();const k=u++;return o.set(k,S),function(){if(T){if(c)throw new Error(Nr(6));T=!1,f(),o.delete(k),i=null}}}function m(S){if(!v1(S))throw new Error(Nr(7));if(typeof S.type>"u")throw new Error(Nr(8));if(typeof S.type!="string")throw new Error(Nr(17));if(c)throw new Error(Nr(9));try{c=!0,a=n(a,S)}finally{c=!1}return(i=o).forEach(k=>{k()}),S}function v(S){if(typeof S!="function")throw new Error(Nr(10));n=S,m({type:Bd.REPLACE})}function x(){const S=p;return{subscribe(T){if(typeof T!="object"||T===null)throw new Error(Nr(11));function k(){const P=T;P.next&&P.next(d())}return k(),{unsubscribe:S(k)}},[Ob](){return this}}}return m({type:Bd.INIT}),{dispatch:m,subscribe:p,getState:d,replaceReducer:v,[Ob]:x}}function EB(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Bd.INIT})>"u")throw new Error(Nr(12));if(typeof r(void 0,{type:Bd.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Nr(13))})}function tO(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{EB(r)}catch(i){a=i}return function(o={},u){if(a)throw a;let c=!1;const f={};for(let d=0;d<n.length;d++){const p=n[d],m=r[p],v=o[p],x=m(v,u);if(typeof x>"u")throw u&&u.type,new Error(Nr(14));f[p]=x,c=c||x!==v}return c=c||n.length!==Object.keys(o).length,c?f:o}}function $d(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function _B(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Nr(15))};const o={getState:a.getState,dispatch:(c,...f)=>i(c,...f)},u=e.map(c=>c(o));return i=$d(...u)(a.dispatch),{...a,dispatch:i}}}function rO(e){return v1(e)&&"type"in e&&typeof e.type=="string"}var nO=Symbol.for("immer-nothing"),Pb=Symbol.for("immer-draftable"),In=Symbol.for("immer-state");function ha(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Jo=Object.getPrototypeOf;function Ks(e){return!!e&&!!e[In]}function ri(e){return e?aO(e)||Array.isArray(e)||!!e[Pb]||!!e.constructor?.[Pb]||ic(e)||N0(e):!1}var TB=Object.prototype.constructor.toString();function aO(e){if(!e||typeof e!="object")return!1;const t=Jo(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===TB}function Ud(e,t){C0(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function C0(e){const t=e[In];return t?t.type_:Array.isArray(e)?1:ic(e)?2:N0(e)?3:0}function Yg(e,t){return C0(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function iO(e,t,r){const n=C0(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function AB(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ic(e){return e instanceof Map}function N0(e){return e instanceof Set}function _s(e){return e.copy_||e.base_}function qg(e,t){if(ic(e))return new Map(e);if(N0(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=aO(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[In];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],u=n[o];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(n[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[o]})}return Object.create(Jo(e),n)}else{const n=Jo(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function y1(e,t=!1){return D0(e)||Ks(e)||!ri(e)||(C0(e)>1&&Object.defineProperties(e,{set:{value:Yf},add:{value:Yf},clear:{value:Yf},delete:{value:Yf}}),Object.freeze(e),t&&Object.values(e).forEach(r=>y1(r,!0))),e}function Yf(){ha(2)}function D0(e){return Object.isFrozen(e)}var kB={};function Hs(e){const t=kB[e];return t||ha(0,e),t}var $u;function sO(){return $u}function OB(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Cb(e,t){t&&(Hs("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Xg(e){Qg(e),e.drafts_.forEach(PB),e.drafts_=null}function Qg(e){e===$u&&($u=e.parent_)}function Nb(e){return $u=OB($u,e)}function PB(e){const t=e[In];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Db(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[In].modified_&&(Xg(t),ha(4)),ri(e)&&(e=Wd(t,e),t.parent_||zd(t,e)),t.patches_&&Hs("Patches").generateReplacementPatches_(r[In].base_,e,t.patches_,t.inversePatches_)):e=Wd(t,r,[]),Xg(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==nO?e:void 0}function Wd(e,t,r){if(D0(t))return t;const n=t[In];if(!n)return Ud(t,(a,i)=>Mb(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return zd(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,o=!1;n.type_===3&&(i=new Set(a),a.clear(),o=!0),Ud(i,(u,c)=>Mb(e,n,a,u,c,r,o)),zd(e,a,!1),r&&e.patches_&&Hs("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Mb(e,t,r,n,a,i,o){if(Ks(a)){const u=i&&t&&t.type_!==3&&!Yg(t.assigned_,n)?i.concat(n):void 0,c=Wd(e,a,u);if(iO(r,n,c),Ks(c))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(ri(a)&&!D0(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Wd(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(ic(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&zd(e,a)}}function zd(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&y1(t,r)}function CB(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:sO(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=x1;r&&(a=[n],i=Uu);const{revoke:o,proxy:u}=Proxy.revocable(a,i);return n.draft_=u,n.revoke_=o,u}var x1={get(e,t){if(t===In)return e;const r=_s(e);if(!Yg(r,t))return NB(e,r,t);const n=r[t];return e.finalized_||!ri(n)?n:n===Jm(e.base_,t)?(eg(e),e.copy_[t]=Jg(n,e)):n},has(e,t){return t in _s(e)},ownKeys(e){return Reflect.ownKeys(_s(e))},set(e,t,r){const n=oO(_s(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Jm(_s(e),t),i=a?.[In];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(AB(r,a)&&(r!==void 0||Yg(e.base_,t)))return!0;eg(e),Zg(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Jm(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,eg(e),Zg(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=_s(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ha(11)},getPrototypeOf(e){return Jo(e.base_)},setPrototypeOf(){ha(12)}},Uu={};Ud(x1,(e,t)=>{Uu[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Uu.deleteProperty=function(e,t){return Uu.set.call(this,e,t,void 0)};Uu.set=function(e,t,r){return x1.set.call(this,e[0],t,r,e[0])};function Jm(e,t){const r=e[In];return(r?_s(r):e)[t]}function NB(e,t,r){const n=oO(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function oO(e,t){if(!(t in e))return;let r=Jo(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Jo(r)}}function Zg(e){e.modified_||(e.modified_=!0,e.parent_&&Zg(e.parent_))}function eg(e){e.copy_||(e.copy_=qg(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var DB=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...f){return o.produce(c,d=>r.call(this,d,...f))}}typeof r!="function"&&ha(6),n!==void 0&&typeof n!="function"&&ha(7);let a;if(ri(t)){const i=Nb(this),o=Jg(t,void 0);let u=!0;try{a=r(o),u=!1}finally{u?Xg(i):Qg(i)}return Cb(i,n),Db(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===nO&&(a=void 0),this.autoFreeze_&&y1(a,!0),n){const i=[],o=[];Hs("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else ha(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...u)=>this.produceWithPatches(o,c=>t(c,...u));let n,a;return[this.produce(t,r,(o,u)=>{n=o,a=u}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ri(e)||ha(8),Ks(e)&&(e=Xa(e));const t=Nb(this),r=Jg(e,void 0);return r[In].isManual_=!0,Qg(t),r}finishDraft(e,t){const r=e&&e[In];(!r||!r.isManual_)&&ha(9);const{scope_:n}=r;return Cb(n,t),Db(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Hs("Patches").applyPatches_;return Ks(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Jg(e,t){const r=ic(e)?Hs("MapSet").proxyMap_(e,t):N0(e)?Hs("MapSet").proxySet_(e,t):CB(e,t);return(t?t.scope_:sO()).drafts_.push(r),r}function Xa(e){return Ks(e)||ha(10,e),lO(e)}function lO(e){if(!ri(e)||D0(e))return e;const t=e[In];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=qg(e,t.scope_.immer_.useStrictShallowCopy_)}else r=qg(e,!0);return Ud(r,(n,a)=>{iO(r,n,lO(a))}),t&&(t.finalized_=!1),r}var MB=new DB,uO=MB.produce;function cO(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var RB=cO(),IB=cO,FB=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$d:$d.apply(null,arguments)};function Zn(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Mn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>rO(n)&&n.type===e,r}var fO=class Eu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Eu.prototype)}static get[Symbol.species](){return Eu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Eu(...t[0].concat(this)):new Eu(...t.concat(this))}};function Rb(e){return ri(e)?uO(e,()=>{}):e}function qf(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function jB(e){return typeof e=="boolean"}var LB=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let o=new fO;return r&&(jB(r)?o.push(RB):o.push(IB(r.extraArgument))),o},dO="RTK_autoBatch",en=()=>e=>({payload:e,meta:{[dO]:!0}}),Ib=e=>t=>{setTimeout(t,e)},hO=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,o=!1;const u=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Ib(10):e.type==="callback"?e.queueNotification:Ib(e.timeout),f=()=>{o=!1,i&&(i=!1,u.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const p=()=>a&&d(),m=n.subscribe(p);return u.add(d),()=>{m(),u.delete(d)}},dispatch(d){try{return a=!d?.meta?.[dO],i=!a,i&&(o||(o=!0,c(f))),n.dispatch(d)}finally{a=!0}}})},BB=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new fO(e);return n&&a.push(hO(typeof n=="object"?n:void 0)),a};function $B(e){const t=LB(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let u;if(typeof r=="function")u=r;else if(v1(r))u=tO(r);else throw new Error(Mn(1));let c;typeof n=="function"?c=n(t):c=t();let f=$d;a&&(f=FB({trace:!1,...typeof a=="object"&&a}));const d=_B(...c),p=BB(d);let m=typeof o=="function"?o(p):p();const v=f(...m);return eO(u,i,v)}function pO(e){const t={},r=[];let n;const a={addCase(i,o){const u=typeof i=="string"?i:i.type;if(!u)throw new Error(Mn(28));if(u in t)throw new Error(Mn(29));return t[u]=o,a},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),a},addMatcher(i,o){return r.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function UB(e){return typeof e=="function"}function WB(e,t){let[r,n,a]=pO(t),i;if(UB(e))i=()=>Rb(e());else{const u=Rb(e);i=()=>u}function o(u=i(),c){let f=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return f.filter(d=>!!d).length===0&&(f=[a]),f.reduce((d,p)=>{if(p)if(Ks(d)){const v=p(d,c);return v===void 0?d:v}else{if(ri(d))return uO(d,m=>p(m,c));{const m=p(d,c);if(m===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return d},u)}return o.getInitialState=i,o}var zB="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",KB=(e=21)=>{let t="",r=e;for(;r--;)t+=zB[Math.random()*64|0];return t},HB=Symbol.for("rtk-slice-createasyncthunk");function VB(e,t){return`${e}/${t}`}function GB({creators:e}={}){const t=e?.asyncThunk?.[HB];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(Mn(11));const o=(typeof n.reducers=="function"?n.reducers(qB()):n.reducers)||{},u=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(A,P){const N=typeof A=="string"?A:A.type;if(!N)throw new Error(Mn(12));if(N in c.sliceCaseReducersByType)throw new Error(Mn(13));return c.sliceCaseReducersByType[N]=P,f},addMatcher(A,P){return c.sliceMatchers.push({matcher:A,reducer:P}),f},exposeAction(A,P){return c.actionCreators[A]=P,f},exposeCaseReducer(A,P){return c.sliceCaseReducersByName[A]=P,f}};u.forEach(A=>{const P=o[A],N={reducerName:A,type:VB(a,A),createNotation:typeof n.reducers=="function"};QB(P)?JB(N,P,f,t):XB(N,P,f)});function d(){const[A={},P=[],N=void 0]=typeof n.extraReducers=="function"?pO(n.extraReducers):[n.extraReducers],I={...A,...c.sliceCaseReducersByType};return WB(n.initialState,D=>{for(let z in I)D.addCase(z,I[z]);for(let z of c.sliceMatchers)D.addMatcher(z.matcher,z.reducer);for(let z of P)D.addMatcher(z.matcher,z.reducer);N&&D.addDefaultCase(N)})}const p=A=>A,m=new Map,v=new WeakMap;let x;function y(A,P){return x||(x=d()),x(A,P)}function S(){return x||(x=d()),x.getInitialState()}function T(A,P=!1){function N(D){let z=D[A];return typeof z>"u"&&P&&(z=qf(v,N,S)),z}function I(D=p){const z=qf(m,P,()=>new WeakMap);return qf(z,D,()=>{const H={};for(const[te,q]of Object.entries(n.selectors??{}))H[te]=YB(q,D,()=>qf(v,D,S),P);return H})}return{reducerPath:A,getSelectors:I,get selectors(){return I(N)},selectSlice:N}}const k={name:a,reducer:y,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:S,...T(i),injectInto(A,{reducerPath:P,...N}={}){const I=P??i;return A.inject({reducerPath:I,reducer:y},N),{...k,...T(I,!0)}}};return k}}function YB(e,t,r,n){function a(i,...o){let u=t(i);return typeof u>"u"&&n&&(u=r()),e(u,...o)}return a.unwrapped=e,a}var Fn=GB();function qB(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function XB({type:e,reducerName:t,createNotation:r},n,a){let i,o;if("reducer"in n){if(r&&!ZB(n))throw new Error(Mn(17));i=n.reducer,o=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?Zn(e,o):Zn(e))}function QB(e){return e._reducerDefinitionType==="asyncThunk"}function ZB(e){return e._reducerDefinitionType==="reducerWithPrepare"}function JB({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Mn(18));const{payloadCreator:i,fulfilled:o,pending:u,rejected:c,settled:f,options:d}=r,p=a(e,i,d);n.exposeAction(t,p),o&&n.addCase(p.fulfilled,o),u&&n.addCase(p.pending,u),c&&n.addCase(p.rejected,c),f&&n.addMatcher(p.settled,f),n.exposeCaseReducer(t,{fulfilled:o||Xf,pending:u||Xf,rejected:c||Xf,settled:f||Xf})}function Xf(){}var e$="task",mO="listener",gO="completed",w1="cancelled",t$=`task-${w1}`,r$=`task-${gO}`,ev=`${mO}-${w1}`,n$=`${mO}-${gO}`,M0=class{constructor(e){this.code=e,this.message=`${e$} ${w1} (reason: ${e})`}name="TaskAbortError";message},S1=(e,t)=>{if(typeof e!="function")throw new TypeError(Mn(32))},Kd=()=>{},vO=(e,t=Kd)=>(e.catch(t),e),yO=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ms=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Rs=e=>{if(e.aborted){const{reason:t}=e;throw new M0(t)}};function xO(e,t){let r=Kd;return new Promise((n,a)=>{const i=()=>a(new M0(e.reason));if(e.aborted){i();return}r=yO(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Kd})}var a$=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof M0?"cancelled":"rejected",error:r}}finally{t?.()}},Hd=e=>t=>vO(xO(e,t).then(r=>(Rs(e),r))),wO=e=>{const t=Hd(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Yo}=Object,Fb={},R0="listenerMiddleware",i$=(e,t)=>{const r=n=>yO(e,()=>Ms(n,e.reason));return(n,a)=>{S1(n);const i=new AbortController;r(i);const o=a$(async()=>{Rs(e),Rs(i.signal);const u=await n({pause:Hd(i.signal),delay:wO(i.signal),signal:i.signal});return Rs(i.signal),u},()=>Ms(i,r$));return a?.autoJoin&&t.push(o.catch(Kd)),{result:Hd(e)(o),cancel(){Ms(i,t$)}}}},s$=(e,t)=>{const r=async(n,a)=>{Rs(t);let i=()=>{};const u=[new Promise((c,f)=>{let d=e({predicate:n,effect:(p,m)=>{m.unsubscribe(),c([p,m.getState(),m.getOriginalState()])}});i=()=>{d(),f()}})];a!=null&&u.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await xO(t,Promise.race(u));return Rs(t),c}finally{i()}};return(n,a)=>vO(r(n,a))},SO=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Zn(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Mn(21));return S1(i),{predicate:a,type:t,effect:i}},bO=Yo(e=>{const{type:t,predicate:r,effect:n}=SO(e);return{id:KB(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Mn(22))}}},{withTypes:()=>bO}),jb=(e,t)=>{const{type:r,effect:n,predicate:a}=SO(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},tv=e=>{e.pending.forEach(t=>{Ms(t,ev)})},o$=(e,t)=>()=>{for(const r of t.keys())tv(r);e.clear()},Lb=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},EO=Yo(Zn(`${R0}/add`),{withTypes:()=>EO}),l$=Zn(`${R0}/removeAll`),_O=Yo(Zn(`${R0}/remove`),{withTypes:()=>_O}),u$=(...e)=>{console.error(`${R0}/error`,...e)},sc=(e={})=>{const t=new Map,r=new Map,n=v=>{const x=r.get(v)??0;r.set(v,x+1)},a=v=>{const x=r.get(v)??1;x===1?r.delete(v):r.set(v,x-1)},{extra:i,onError:o=u$}=e;S1(o);const u=v=>(v.unsubscribe=()=>t.delete(v.id),t.set(v.id,v),x=>{v.unsubscribe(),x?.cancelActive&&tv(v)}),c=v=>{const x=jb(t,v)??bO(v);return u(x)};Yo(c,{withTypes:()=>c});const f=v=>{const x=jb(t,v);return x&&(x.unsubscribe(),v.cancelActive&&tv(x)),!!x};Yo(f,{withTypes:()=>f});const d=async(v,x,y,S)=>{const T=new AbortController,k=s$(c,T.signal),A=[];try{v.pending.add(T),n(v),await Promise.resolve(v.effect(x,Yo({},y,{getOriginalState:S,condition:(P,N)=>k(P,N).then(Boolean),take:k,delay:wO(T.signal),pause:Hd(T.signal),extra:i,signal:T.signal,fork:i$(T.signal,A),unsubscribe:v.unsubscribe,subscribe:()=>{t.set(v.id,v)},cancelActiveListeners:()=>{v.pending.forEach((P,N,I)=>{P!==T&&(Ms(P,ev),I.delete(P))})},cancel:()=>{Ms(T,ev),v.pending.delete(T)},throwIfCancelled:()=>{Rs(T.signal)}})))}catch(P){P instanceof M0||Lb(o,P,{raisedBy:"effect"})}finally{await Promise.all(A),Ms(T,n$),a(v),v.pending.delete(T)}},p=o$(t,r);return{middleware:v=>x=>y=>{if(!rO(y))return x(y);if(EO.match(y))return c(y.payload);if(l$.match(y)){p();return}if(_O.match(y))return f(y.payload);let S=v.getState();const T=()=>{if(S===Fb)throw new Error(Mn(23));return S};let k;try{if(k=x(y),t.size>0){const A=v.getState(),P=Array.from(t.values());for(const N of P){let I=!1;try{I=N.predicate(y,A,S)}catch(D){I=!1,Lb(o,D,{raisedBy:"predicate"})}I&&d(N,y,v,T)}}}finally{S=Fb}return k},startListening:c,stopListening:f,clearListeners:p}};function Mn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var c$={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},TO=Fn({name:"chartLayout",initialState:c$,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:f$,setLayout:d$,setChartSize:h$,setScale:p$}=TO.actions,m$=TO.reducer;function Bb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $b(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bb(Object(r),!0).forEach(function(n){g$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g$(e,t,r){return(t=v$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v$(e){var t=y$(e,"string");return typeof t=="symbol"?t:t+""}function y$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vd=Math.PI/180,x$=e=>e*180/Math.PI,nr=(e,t,r,n)=>({x:e+Math.cos(-Vd*n)*r,y:t+Math.sin(-Vd*n)*r}),AO=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},w$=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},S$=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,o=w$({x:r,y:n},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var u=(r-a)/o,c=Math.acos(u);return n>i&&(c=2*Math.PI-c),{radius:o,angle:x$(c),angleInRadian:c}},b$=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},E$=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return e+o*360},_$=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=S$({x:r,y:n},t),{innerRadius:o,outerRadius:u}=t;if(a<o||a>u||a===0)return null;var{startAngle:c,endAngle:f}=b$(t),d=i,p;if(c<=f){for(;d>f;)d-=360;for(;d<c;)d+=360;p=d>=c&&d<=f}else{for(;d>c;)d-=360;for(;d<f;)d+=360;p=d>=f&&d<=c}return p?$b($b({},t),{},{radius:a,angle:E$(d,t)}):null};function kO(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Ub(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ub(Object(r),!0).forEach(function(n){T$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ub(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T$(e,t,r){return(t=A$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A$(e){var t=k$(e,"string");return typeof t=="symbol"?t:t+""}function k$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ct(e,t,r){return $t(e)||$t(t)?r:Pa(t)?zs(e,t,r):typeof t=="function"?t(e):r}var O$=(e,t,r,n,a)=>{var i,o=-1,u=(i=t?.length)!==null&&i!==void 0?i:0;if(u<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<u;c++){var f=c>0?r[c-1].coordinate:r[u-1].coordinate,d=r[c].coordinate,p=c>=u-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(Fr(d-f)!==Fr(p-d)){var v=[];if(Fr(p-d)===Fr(a[1]-a[0])){m=p;var x=d+a[1]-a[0];v[0]=Math.min(x,(x+f)/2),v[1]=Math.max(x,(x+f)/2)}else{m=f;var y=p+a[1]-a[0];v[0]=Math.min(d,(y+d)/2),v[1]=Math.max(d,(y+d)/2)}var S=[Math.min(d,(m+d)/2),Math.max(d,(m+d)/2)];if(e>S[0]&&e<=S[1]||e>=v[0]&&e<=v[1]){({index:o}=r[c]);break}}else{var T=Math.min(f,p),k=Math.max(f,p);if(e>(T+d)/2&&e<=(k+d)/2){({index:o}=r[c]);break}}}else if(t){for(var A=0;A<u;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===u-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:o}=t[A]);break}}return o},P$=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:o,layout:u}=t;if((u==="vertical"||u==="horizontal"&&o==="middle")&&i!=="center"&&Je(e[i]))return qn(qn({},e),{},{[i]:e[i]+(n||0)});if((u==="horizontal"||u==="vertical"&&i==="center")&&o!=="middle"&&Je(e[o]))return qn(qn({},e),{},{[o]:e[o]+(a||0)})}return e},ts=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Wb=1e-4,C$=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Wb,i=Math.max(n[0],n[1])+Wb,o=e(t[0]),u=e(t[r-1]);(o<a||o>i||u<a||u>i)&&e.domain([t[0],t[r-1]])}},N$=(e,t)=>{if(!t||t.length!==2||!Je(t[0])||!Je(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Je(e[0])||e[0]<r)&&(a[0]=r),(!Je(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},D$=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,o=0;o<t;++o){var u=va(e[o][r][1])?e[o][r][0]:e[o][r][1];u>=0?(e[o][r][0]=a,e[o][r][1]=a+u,a=e[o][r][1]):(e[o][r][0]=i,e[o][r][1]=i+u,i=e[o][r][1])}},M$=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var o=va(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},R$={sign:D$,expand:i6,none:Zo,silhouette:s6,wiggle:o6,positive:M$},I$=(e,t,r)=>{var n=R$[r],a=a6().keys(t).value((i,o)=>+Ct(i,o,0)).order(Hg).offset(n);return a(e)};function F$(e){return e==null?void 0:String(e)}function zb(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!$t(a[t.dataKey])){var u=Lk(r,"value",a[t.dataKey]);if(u)return u.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Ct(a,$t(o)?t.dataKey:o);return $t(c)?null:t.scale(c)}var Kb=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var u=Ct(i,t.dataKey,t.scale.domain()[o]);return $t(u)?null:t.scale(u)-a/2+n},j$=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},L$=e=>{var t=e.flat(2).filter(Je);return[Math.min(...t),Math.max(...t)]},B$=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],$$=(e,t,r)=>{if(e!=null)return B$(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:o}=i,u=o.reduce((c,f)=>{var d=kO(f,t,r),p=L$(d);return[Math.min(c[0],p[0]),Math.max(c[1],p[1])]},[1/0,-1/0]);return[Math.min(u[0],n[0]),Math.max(u[1],n[1])]},[1/0,-1/0]))},Hb=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Vb=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Wu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=P0(t,d=>d.coordinate),i=1/0,o=1,u=a.length;o<u;o++){var c=a[o],f=a[o-1];i=Math.min((c.coordinate||0)-(f.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Gb(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return qn(qn({},t),{},{dataKey:r,payload:n,value:a,name:i})}function dl(e,t){if(e)return String(e);if(typeof t=="string")return t}function U$(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?_$({x:e,y:t},n):null}var W$=(e,t,r,n)=>{var a=t.find(f=>f&&f.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:o}=n;return qn(qn(qn({},n),nr(n.cx,n.cy,o,i)),{},{angle:i,radius:o})}var u=a.coordinate,{angle:c}=n;return qn(qn(qn({},n),nr(n.cx,n.cy,u,c)),{},{angle:c,radius:u})}return{x:0,y:0}},z$=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,oi=e=>e.layout.width,li=e=>e.layout.height,K$=e=>e.layout.scale,OO=e=>e.layout.margin,I0=le(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),F0=le(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),PO="data-recharts-item-index",CO="data-recharts-item-data-key",oc=60;function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(n){H$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H$(e,t,r){return(t=V$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V$(e){var t=G$(e,"string");return typeof t=="symbol"?t:t+""}function G$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y$=e=>e.brush.height;function q$(e){var t=F0(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:oc;return r+a}return r},0)}function X$(e){var t=F0(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:oc;return r+a}return r},0)}function Q$(e){var t=I0(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Z$(e){var t=I0(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var dr=le([oi,li,OO,Y$,q$,X$,Q$,Z$,Zk,vB],(e,t,r,n,a,i,o,u,c,f)=>{var d={left:(r.left||0)+a,right:(r.right||0)+i},p={top:(r.top||0)+o,bottom:(r.bottom||0)+u},m=Qf(Qf({},p),d),v=m.bottom;m.bottom+=n,m=P$(m,c,f);var x=e-m.left-m.right,y=t-m.top-m.bottom;return Qf(Qf({brushBottom:v},m),{},{width:Math.max(x,0),height:Math.max(y,0)})}),J$=le(dr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),b1=le(oi,li,(e,t)=>({x:0,y:0,width:e,height:t})),e7=_.createContext(null),yn=()=>_.useContext(e7)!=null,j0=e=>e.brush,L0=le([j0,dr,OO],(e,t,r)=>({height:e.height,x:Je(e.x)?e.x:t.left,y:Je(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Je(e.width)?e.width:t.width})),tg={},rg={},ng={},qb;function t7(){return qb||(qb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let o,u=null;const c=i!=null&&i.includes("leading"),f=i==null||i.includes("trailing"),d=()=>{u!==null&&(r.apply(o,u),o=void 0,u=null)},p=()=>{f&&d(),y()};let m=null;const v=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,p()},n)},x=()=>{m!==null&&(clearTimeout(m),m=null)},y=()=>{x(),o=void 0,u=null},S=()=>{d()},T=function(...k){if(a?.aborted)return;o=this,u=k;const A=m==null;v(),c&&A&&d()};return T.schedule=v,T.cancel=y,T.flush=S,a?.addEventListener("abort",y,{once:!0}),T}e.debounce=t}(ng)),ng}var Xb;function r7(){return Xb||(Xb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t7();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:u=!0,maxWait:c}=i,f=Array(2);o&&(f[0]="leading"),u&&(f[1]="trailing");let d,p=null;const m=t.debounce(function(...y){d=n.apply(this,y),p=null},a,{edges:f}),v=function(...y){return c!=null&&(p===null&&(p=Date.now()),Date.now()-p>=c)?(d=n.apply(this,y),p=Date.now(),m.cancel(),m.schedule(),d):(m.apply(this,y),d)},x=()=>(m.flush(),d);return v.cancel=m.cancel,v.flush=x,v}e.debounce=r}(rg)),rg}var Qb;function n7(){return Qb||(Qb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=r7();function r(n,a=0,i={}){const{leading:o=!0,trailing:u=!0}=i;return t.debounce(n,a,{leading:o,maxWait:a,trailing:u})}e.throttle=r}(tg)),tg}var ag,Zb;function a7(){return Zb||(Zb=1,ag=n7().throttle),ag}var i7=a7();const s7=Na(i7);var Jb=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},NO=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:o}=r,u=ti(n)?e:Number(n),c=ti(a)?t:Number(a);return i&&i>0&&(u?c=u/i:c&&(u=c*i),o&&c>o&&(c=o)),{calculatedWidth:u,calculatedHeight:c}},o7={width:0,height:0,overflow:"visible"},l7={width:0,overflowX:"visible"},u7={height:0,overflowY:"visible"},c7={},f7=e=>{var{width:t,height:r}=e,n=ti(t),a=ti(r);return n&&a?o7:n?l7:a?u7:c7};function d7(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function Yr(e){return Number.isFinite(e)}function el(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rv.apply(null,arguments)}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){h7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h7(e,t,r){return(t=p7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p7(e){var t=m7(e,"string");return typeof t=="symbol"?t:t+""}function m7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DO=_.createContext({width:-1,height:-1});function MO(e){var{children:t,width:r,height:n}=e,a=_.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:_.createElement(DO.Provider,{value:a},t)}var E1=()=>_.useContext(DO),g7=_.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:o=0,minHeight:u,maxHeight:c,children:f,debounce:d=0,id:p,className:m,onResize:v,style:x={}}=e,y=_.useRef(null),S=_.useRef();S.current=v,_.useImperativeHandle(t,()=>y.current);var[T,k]=_.useState({containerWidth:n.width,containerHeight:n.height}),A=_.useCallback((z,H)=>{k(te=>{var q=Math.round(z),V=Math.round(H);return te.containerWidth===q&&te.containerHeight===V?te:{containerWidth:q,containerHeight:V}})},[]);_.useEffect(()=>{var z=V=>{var ae,{width:Ee,height:Z}=V[0].contentRect;A(Ee,Z),(ae=S.current)===null||ae===void 0||ae.call(S,Ee,Z)};d>0&&(z=s7(z,d,{trailing:!0,leading:!1}));var H=new ResizeObserver(z),{width:te,height:q}=y.current.getBoundingClientRect();return A(te,q),H.observe(y.current),()=>{H.disconnect()}},[A,d]);var{containerWidth:P,containerHeight:N}=T;Jb(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:D}=NO(P,N,{width:a,height:i,aspect:r,maxHeight:c});return Jb(I>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,D,a,i,o,u,r),_.createElement("div",{id:p?"".concat(p):void 0,className:ht("recharts-responsive-container",m),style:tE(tE({},x),{},{width:a,height:i,minWidth:o,minHeight:u,maxHeight:c}),ref:y},_.createElement("div",{style:f7({width:a,height:i})},_.createElement(MO,{width:I,height:D},f)))}),Zf=_.forwardRef((e,t)=>{var r=E1();if(el(r.width)&&el(r.height))return e.children;var{width:n,height:a}=d7({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:o}=NO(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Je(i)&&Je(o)?_.createElement(MO,{width:i,height:o},e.children):_.createElement(g7,rv({},e,{width:n,height:a,ref:t}))}),B0=()=>{var e,t=yn(),r=Ge(J$),n=Ge(L0),a=(e=Ge(j0))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},v7={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},y7=()=>{var e;return(e=Ge(dr))!==null&&e!==void 0?e:v7},RO=()=>Ge(oi),IO=()=>Ge(li),x7=()=>Ge(e=>e.layout.margin),ut=e=>e.layout.layoutType,$0=()=>Ge(ut),U0=e=>{var t=Ut(),r=yn(),{width:n,height:a}=e,i=E1(),o=n,u=a;return i&&(o=i.width>0?i.width:n,u=i.height>0?i.height:a),_.useEffect(()=>{!r&&el(o)&&el(u)&&t(h$({width:o,height:u}))},[t,r,o,u]),null},w7={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},FO=Fn({name:"legend",initialState:w7,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:en()},removeLegendPayload:{reducer(e,t){var r=Xa(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:en()}}}),{setLegendSize:rE,setLegendSettings:S7,addLegendPayload:jO,removeLegendPayload:LO}=FO.actions,b7=FO.reducer,E7=["contextPayload"];function nv(){return nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nv.apply(null,arguments)}function nE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nE(Object(r),!0).forEach(function(n){_1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _1(e,t,r){return(t=_7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _7(e){var t=T7(e,"string");return typeof t=="symbol"?t:t+""}function T7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A7(e,t){if(e==null)return{};var r,n,a=k7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function k7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function O7(e){return e.value}function P7(e){var{contextPayload:t}=e,r=A7(e,E7),n=Yk(t,e.payloadUniqBy,O7),a=tl(tl({},r),{},{payload:n});return _.isValidElement(e.content)?_.cloneElement(e.content,a):typeof e.content=="function"?_.createElement(e.content,a):_.createElement(h1,a)}function C7(e,t,r,n,a,i){var{layout:o,align:u,verticalAlign:c}=t,f,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(u==="center"&&o==="vertical"?f={left:((n||0)-i.width)/2}:f=u==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),tl(tl({},f),d)}function N7(e){var t=Ut();return _.useEffect(()=>{t(S7(e))},[t,e]),null}function D7(e){var t=Ut();return _.useEffect(()=>(t(rE(e)),()=>{t(rE({width:0,height:0}))}),[t,e]),null}function M7(e){var t=wB(),r=O8(),n=x7(),{width:a,height:i,wrapperStyle:o,portal:u}=e,[c,f]=Jk([t]),d=RO(),p=IO();if(d==null||p==null)return null;var m=d-(n.left||0)-(n.right||0),v=Os.getWidthOrHeight(e.layout,i,a,m),x=u?o:tl(tl({position:"absolute",width:v?.width||a||"auto",height:v?.height||i||"auto"},C7(o,e,n,d,p,c)),o),y=u??r;if(y==null)return null;var S=_.createElement("div",{className:"recharts-legend-wrapper",style:x,ref:f},_.createElement(N7,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),_.createElement(D7,{width:c.width,height:c.height}),_.createElement(P7,nv({},e,v,{margin:n,chartWidth:d,chartHeight:p,contextPayload:t})));return yk.createPortal(S,y)}class Os extends _.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&Je(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return _.createElement(M7,this.props)}}_1(Os,"displayName","Legend");_1(Os,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},av.apply(null,arguments)}function aE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ig(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aE(Object(r),!0).forEach(function(n){R7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R7(e,t,r){return(t=I7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I7(e){var t=F7(e,"string");return typeof t=="symbol"?t:t+""}function F7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j7(e){return Array.isArray(e)&&Pa(e[0])&&Pa(e[1])?e.join(" ~ "):e}var L7=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:o,itemSorter:u,wrapperClassName:c,labelClassName:f,label:d,labelFormatter:p,accessibilityLayer:m=!1}=e,v=()=>{if(i&&i.length){var N={padding:0,margin:0},I=(u?P0(i,u):i).map((D,z)=>{if(D.type==="none")return null;var H=D.formatter||o||j7,{value:te,name:q}=D,V=te,ae=q;if(H){var Ee=H(te,q,D,z,i);if(Array.isArray(Ee))[V,ae]=Ee;else if(Ee!=null)V=Ee;else return null}var Z=ig({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},n);return _.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:Z},Pa(ae)?_.createElement("span",{className:"recharts-tooltip-item-name"},ae):null,Pa(ae)?_.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,_.createElement("span",{className:"recharts-tooltip-item-value"},V),_.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return _.createElement("ul",{className:"recharts-tooltip-item-list",style:N},I)}return null},x=ig({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),y=ig({margin:0},a),S=!$t(d),T=S?d:"",k=ht("recharts-default-tooltip",c),A=ht("recharts-tooltip-label",f);S&&p&&i!==void 0&&i!==null&&(T=p(d,i));var P=m?{role:"status","aria-live":"assertive"}:{};return _.createElement("div",av({className:k,style:x},P),_.createElement("p",{className:A,style:y},_.isValidElement(T)?T:"".concat(T)),v())},pu="recharts-tooltip-wrapper",B7={visibility:"hidden"};function $7(e){var{coordinate:t,translateX:r,translateY:n}=e;return ht(pu,{["".concat(pu,"-right")]:Je(r)&&t&&Je(t.x)&&r>=t.x,["".concat(pu,"-left")]:Je(r)&&t&&Je(t.x)&&r<t.x,["".concat(pu,"-bottom")]:Je(n)&&t&&Je(t.y)&&n>=t.y,["".concat(pu,"-top")]:Je(n)&&t&&Je(t.y)&&n<t.y})}function iE(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:o,tooltipDimension:u,viewBox:c,viewBoxDimension:f}=e;if(i&&Je(i[n]))return i[n];var d=r[n]-u-(a>0?a:0),p=r[n]+a;if(t[n])return o[n]?d:p;var m=c[n];if(m==null)return 0;if(o[n]){var v=d,x=m;return v<x?Math.max(p,m):Math.max(d,m)}if(f==null)return 0;var y=p+u,S=m+f;return y>S?Math.max(d,m):Math.max(p,m)}function U7(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function W7(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:o,useTranslate3d:u,viewBox:c}=e,f,d,p;return o.height>0&&o.width>0&&r?(d=iE({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),p=iE({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),f=U7({translateX:d,translateY:p,useTranslate3d:u})):f=B7,{cssProperties:f,cssClasses:$7({translateX:d,translateY:p,coordinate:r})}}function sE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sE(Object(r),!0).forEach(function(n){iv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iv(e,t,r){return(t=z7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z7(e){var t=K7(e,"string");return typeof t=="symbol"?t:t+""}function K7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class H7 extends _.PureComponent{constructor(){super(...arguments),iv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),iv(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:o,hasPayload:u,isAnimationActive:c,offset:f,position:d,reverseDirection:p,useTranslate3d:m,viewBox:v,wrapperStyle:x,lastBoundingBox:y,innerRef:S,hasPortalFromProps:T}=this.props,{cssClasses:k,cssProperties:A}=W7({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:f,position:d,reverseDirection:p,tooltipBox:{height:y.height,width:y.width},useTranslate3d:m,viewBox:v}),P=T?{}:Jf(Jf({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&u?"visible":"hidden",position:"absolute",top:0,left:0}),N=Jf(Jf({},P),{},{visibility:!this.state.dismissed&&t&&u?"visible":"hidden"},x);return _.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:N,ref:S},i)}}var V7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),rs={devToolsEnabled:!1,isSsr:V7()},BO=()=>Ge(e=>e.rootProps.accessibilityLayer);function sv(){return sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sv.apply(null,arguments)}function oE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oE(Object(r),!0).forEach(function(n){G7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G7(e,t,r){return(t=Y7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y7(e){var t=q7(e,"string");return typeof t=="symbol"?t:t+""}function q7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uE={curveBasisClosed:G8,curveBasisOpen:Y8,curveBasis:V8,curveBumpX:D8,curveBumpY:M8,curveLinearClosed:q8,curveLinear:k0,curveMonotoneX:X8,curveMonotoneY:Q8,curveNatural:Z8,curveStep:J8,curveStepAfter:t6,curveStepBefore:e6},ed=e=>Yr(e.x)&&Yr(e.y),mu=e=>e.x,gu=e=>e.y,X7=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(nc(e));return(r==="curveMonotone"||r==="curveBump")&&t?uE["".concat(r).concat(t==="vertical"?"Y":"X")]:uE[r]||k0},Q7=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,o=X7(t,a),u=i?r.filter(ed):r,c;if(Array.isArray(n)){var f=i?n.filter(p=>ed(p)):n,d=u.map((p,m)=>lE(lE({},p),{},{base:f[m]}));return a==="vertical"?c=Hf().y(gu).x1(mu).x0(p=>p.base.x):c=Hf().x(mu).y1(gu).y0(p=>p.base.y),c.defined(ed).curve(o),c(d)}return a==="vertical"&&Je(n)?c=Hf().y(gu).x1(mu).x0(n):Je(n)?c=Hf().x(mu).y1(gu).y0(n):c=Tk().x(mu).y(gu),c.defined(ed).curve(o),c(u)},T1=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?Q7(e):n;return _.createElement("path",sv({},Qn(e),f1(e),{className:ht("recharts-curve",t),d:i===null?void 0:i,ref:a}))},Z7=["x","y","top","left","width","height","className"];function ov(){return ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ov.apply(null,arguments)}function cE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function J7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(r),!0).forEach(function(n){e9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e9(e,t,r){return(t=t9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t9(e){var t=r9(e,"string");return typeof t=="symbol"?t:t+""}function r9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function n9(e,t){if(e==null)return{};var r,n,a=a9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function a9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var i9=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),s9=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:o=0,className:u}=e,c=n9(e,Z7),f=J7({x:t,y:r,top:n,left:a,width:i,height:o},c);return!Je(t)||!Je(r)||!Je(i)||!Je(o)||!Je(n)||!Je(a)?null:_.createElement("path",ov({},an(f),{className:ht("recharts-cross",u),d:i9(t,r,i,o,n,a)}))};function o9(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function fE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fE(Object(r),!0).forEach(function(n){u9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u9(e,t,r){return(t=c9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c9(e){var t=f9(e,"string");return typeof t=="symbol"?t:t+""}function f9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qr(e,t){var r=l9({},e),n=t,a=Object.keys(t),i=a.reduce((o,u)=>(o[u]===void 0&&n[u]!==void 0&&(o[u]=n[u]),o),r);return i}function d9(){}function h9(e){return e!=null}function dE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dE(Object(r),!0).forEach(function(n){p9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p9(e,t,r){return(t=m9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m9(e){var t=g9(e,"string");return typeof t=="symbol"?t:t+""}function g9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v9=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),$O=(e,t,r)=>e.map(n=>"".concat(v9(n)," ").concat(t,"ms ").concat(r)).join(","),y9=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),zu=(e,t)=>Object.keys(t).reduce((r,n)=>hE(hE({},r),{},{[n]:e(n,t[n])}),{});function pE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pE(Object(r),!0).forEach(function(n){x9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x9(e,t,r){return(t=w9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w9(e){var t=S9(e,"string");return typeof t=="symbol"?t:t+""}function S9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gd=(e,t,r)=>e+(t-e)*r,lv=e=>{var{from:t,to:r}=e;return t!==r},UO=(e,t,r)=>{var n=zu((a,i)=>{if(lv(i)){var[o,u]=e(i.from,i.to,i.velocity);return Mr(Mr({},i),{},{from:o,velocity:u})}return i},t);return r<1?zu((a,i)=>lv(i)?Mr(Mr({},i),{},{velocity:Gd(i.velocity,n[a].velocity,r),from:Gd(i.from,n[a].from,r)}):i,t):UO(e,n,r-1)};function b9(e,t,r,n,a,i){var o,u=n.reduce((m,v)=>Mr(Mr({},m),{},{[v]:{from:e[v],velocity:0,to:t[v]}}),{}),c=()=>zu((m,v)=>v.from,u),f=()=>!Object.values(u).filter(lv).length,d=null,p=m=>{o||(o=m);var v=m-o,x=v/r.dt;u=UO(r,u,x),a(Mr(Mr(Mr({},e),t),c())),o=m,f()||(d=i.setTimeout(p))};return()=>(d=i.setTimeout(p),()=>{d()})}function E9(e,t,r,n,a,i,o){var u=null,c=a.reduce((p,m)=>Mr(Mr({},p),{},{[m]:[e[m],t[m]]}),{}),f,d=p=>{f||(f=p);var m=(p-f)/n,v=zu((y,S)=>Gd(...S,r(m)),c);if(i(Mr(Mr(Mr({},e),t),v)),m<1)u=o.setTimeout(d);else{var x=zu((y,S)=>Gd(...S,r(1)),c);i(Mr(Mr(Mr({},e),t),x))}};return()=>(u=o.setTimeout(d),()=>{u()})}const _9=(e,t,r,n,a,i)=>{var o=y9(e,t);return r.isStepper===!0?b9(e,t,r,o,a,i):E9(e,t,r,n,o,a,i)};var Yd=1e-4,WO=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],zO=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),mE=(e,t)=>r=>{var n=WO(e,t);return zO(n,r)},T9=(e,t)=>r=>{var n=WO(e,t),a=[...n.map((i,o)=>i*o).slice(1),0];return zO(a,r)},gE=function(){for(var t,r,n,a,i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];if(o.length===1)switch(o[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=o[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else o.length===4&&([t,n,r,a]=o);var f=mE(t,r),d=mE(n,a),p=T9(t,r),m=x=>x>1?1:x<0?0:x,v=x=>{for(var y=x>1?1:x,S=y,T=0;T<8;++T){var k=f(S)-y,A=p(S);if(Math.abs(k-y)<Yd||A<Yd)return d(S);S=m(S-k/A)}return d(S)};return v.isStepper=!1,v},A9=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(o,u,c)=>{var f=-(o-u)*r,d=c*n,p=c+(f-d)*a/1e3,m=c*a/1e3+o;return Math.abs(m-u)<Yd&&Math.abs(p)<Yd?[u,0]:[m,p]};return i.isStepper=!0,i.dt=a,i},k9=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return gE(e);case"spring":return A9();default:if(e.split("(")[0]==="cubic-bezier")return gE(e)}return typeof e=="function"?e:null};function O9(e){var t,r=()=>null,n=!1,a=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var u=o,[c,...f]=u;if(typeof c=="number"){a=e.setTimeout(i.bind(null,f),c);return}i(c),a=e.setTimeout(i.bind(null,f));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class P9{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function C9(){return O9(new P9)}var N9=_.createContext(C9);function D9(e,t){var r=_.useContext(N9);return _.useMemo(()=>t??r(e),[e,t,r])}var M9={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},vE={t:0},sg={t:1};function lc(e){var t=qr(e,M9),{isActive:r,canBegin:n,duration:a,easing:i,begin:o,onAnimationEnd:u,onAnimationStart:c,children:f}=t,d=D9(t.animationId,t.animationManager),[p,m]=_.useState(r?vE:sg),v=_.useRef(null);return _.useEffect(()=>{r||m(sg)},[r]),_.useEffect(()=>{if(!r||!n)return d9;var x=_9(vE,sg,k9(i),a,m,d.getTimeoutController()),y=()=>{v.current=x()};return d.start([c,o,y,a,u]),()=>{d.stop(),v.current&&v.current(),u()}},[r,n,a,i,o,c,u,d]),f(p.t)}function uc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=_.useRef(Bu(t)),n=_.useRef(e);return n.current!==e&&(r.current=Bu(t),n.current=e),r.current}var R9=["radius"],I9=["radius"];function yE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(r),!0).forEach(function(n){F9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F9(e,t,r){return(t=j9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j9(e){var t=L9(e,"string");return typeof t=="symbol"?t:t+""}function L9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qd(){return qd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qd.apply(null,arguments)}function wE(e,t){if(e==null)return{};var r,n,a=B9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function B9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SE=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),o=n>=0?1:-1,u=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,f;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],p=0,m=4;p<m;p++)d[p]=a[p]>i?i:a[p];f="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(f+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+u*d[0],",").concat(t)),f+="L ".concat(e+r-u*d[1],",").concat(t),d[1]>0&&(f+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+o*d[1])),f+="L ".concat(e+r,",").concat(t+n-o*d[2]),d[2]>0&&(f+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-u*d[2],",").concat(t+n)),f+="L ".concat(e+u*d[3],",").concat(t+n),d[3]>0&&(f+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-o*d[3])),f+="Z"}else if(i>0&&a===+a&&a>0){var v=Math.min(i,a);f="M ".concat(e,",").concat(t+o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(e+u*v,",").concat(t,`
            L `).concat(e+r-u*v,",").concat(t,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*v,`
            L `).concat(e+r,",").concat(t+n-o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(e+r-u*v,",").concat(t+n,`
            L `).concat(e+u*v,",").concat(t+n,`
            A `).concat(v,",").concat(v,",0,0,").concat(c,",").concat(e,",").concat(t+n-o*v," Z")}else f="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return f},$9={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},KO=e=>{var t=qr(e,$9),r=_.useRef(null),[n,a]=_.useState(-1);_.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var Se=r.current.getTotalLength();Se&&a(Se)}catch{}},[]);var{x:i,y:o,width:u,height:c,radius:f,className:d}=t,{animationEasing:p,animationDuration:m,animationBegin:v,isAnimationActive:x,isUpdateAnimationActive:y}=t,S=_.useRef(u),T=_.useRef(c),k=_.useRef(i),A=_.useRef(o),P=_.useMemo(()=>({x:i,y:o,width:u,height:c,radius:f}),[i,o,u,c,f]),N=uc(P,"rectangle-");if(i!==+i||o!==+o||u!==+u||c!==+c||u===0||c===0)return null;var I=ht("recharts-rectangle",d);if(!y){var D=an(t),{radius:z}=D,H=wE(D,R9);return _.createElement("path",qd({},H,{radius:typeof f=="number"?f:void 0,className:I,d:SE(i,o,u,c,f)}))}var te=S.current,q=T.current,V=k.current,ae=A.current,Ee="0px ".concat(n===-1?1:n,"px"),Z="".concat(n,"px 0px"),Te=$O(["strokeDasharray"],m,typeof p=="string"?p:void 0);return _.createElement(lc,{animationId:N,key:N,canBegin:n>0,duration:m,easing:p,isActive:y,begin:v},Se=>{var me=qt(te,u,Se),we=qt(q,c,Se),be=qt(V,i,Se),X=qt(ae,o,Se);r.current&&(S.current=me,T.current=we,k.current=be,A.current=X);var M;x?Se>0?M={transition:Te,strokeDasharray:Z}:M={strokeDasharray:Ee}:M={strokeDasharray:Z};var J=an(t),{radius:G}=J,K=wE(J,I9);return _.createElement("path",qd({},K,{radius:typeof f=="number"?f:void 0,className:I,d:SE(be,X,me,we,f),ref:r,style:xE(xE({},M),t.style)}))})};function HO(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,o=nr(t,r,n,a),u=nr(t,r,n,i);return{points:[o,u],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function uv(){return uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uv.apply(null,arguments)}var U9=(e,t)=>{var r=Fr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},td=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:o,cornerRadius:u,cornerIsExternal:c}=e,f=u*(o?1:-1)+n,d=Math.asin(u/f)/Vd,p=c?a:a+i*d,m=nr(t,r,f,p),v=nr(t,r,n,p),x=c?a-i*d:a,y=nr(t,r,f*Math.cos(d*Vd),x);return{center:m,circleTangency:v,lineTangency:y,theta:d}},VO=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:o}=e,u=U9(i,o),c=i+u,f=nr(t,r,a,i),d=nr(t,r,a,c),p="M ".concat(f.x,",").concat(f.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var m=nr(t,r,n,i),v=nr(t,r,n,c);p+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(i<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else p+="L ".concat(t,",").concat(r," Z");return p},W9=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:u,startAngle:c,endAngle:f}=e,d=Fr(f-c),{circleTangency:p,lineTangency:m,theta:v}=td({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:i,cornerIsExternal:u}),{circleTangency:x,lineTangency:y,theta:S}=td({cx:t,cy:r,radius:a,angle:f,sign:-d,cornerRadius:i,cornerIsExternal:u}),T=u?Math.abs(c-f):Math.abs(c-f)-v-S;if(T<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):VO({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:f});var k="M ".concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(T>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(y.x,",").concat(y.y,`
  `);if(n>0){var{circleTangency:A,lineTangency:P,theta:N}=td({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),{circleTangency:I,lineTangency:D,theta:z}=td({cx:t,cy:r,radius:n,angle:f,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:u}),H=u?Math.abs(c-f):Math.abs(c-f)-N-z;if(H<0&&i===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(D.x,",").concat(D.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(I.x,",").concat(I.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(H>180),",").concat(+(d>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},z9={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},GO=e=>{var t=qr(e,z9),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:c,startAngle:f,endAngle:d,className:p}=t;if(i<a||f===d)return null;var m=ht("recharts-sector",p),v=i-a,x=Gr(o,v,0,!0),y;return x>0&&Math.abs(f-d)<360?y=W9({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,v/2),forceCornerRadius:u,cornerIsExternal:c,startAngle:f,endAngle:d}):y=VO({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:f,endAngle:d}),_.createElement("path",uv({},an(t),{className:m,d:y}))};function K9(e,t,r){var n,a,i,o;if(e==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:u,cy:c,innerRadius:f,outerRadius:d,angle:p}=t,m=nr(u,c,f,p),v=nr(u,c,d,p);n=m.x,a=m.y,i=v.x,o=v.y}else return HO(t);return[{x:n,y:a},{x:i,y:o}]}var og={},lg={},ug={},bE;function H9(){return bE||(bE=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Xk();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r}(ug)),ug}var EE;function V9(){return EE||(EE=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H9();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r}(lg)),lg}var _E;function G9(){return _E||(_E=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Qk(),r=V9();function n(a,i,o){o&&typeof o!="number"&&t.isIterateeCall(a,i,o)&&(i=o=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),o=o===void 0?a<i?1:-1:r.toFinite(o);const u=Math.max(Math.ceil((i-a)/(o||1)),0),c=new Array(u);for(let f=0;f<u;f++)c[f]=a,a+=o;return c}e.range=n}(og)),og}var cg,TE;function Y9(){return TE||(TE=1,cg=G9().range),cg}var q9=Y9();const YO=Na(q9);function Hi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function X9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function A1(e){let t,r,n;e.length!==2?(t=Hi,r=(u,c)=>Hi(e(u),c),n=(u,c)=>e(u)-c):(t=e===Hi||e===X9?e:Q9,r=e,n=e);function a(u,c,f=0,d=u.length){if(f<d){if(t(c,c)!==0)return d;do{const p=f+d>>>1;r(u[p],c)<0?f=p+1:d=p}while(f<d)}return f}function i(u,c,f=0,d=u.length){if(f<d){if(t(c,c)!==0)return d;do{const p=f+d>>>1;r(u[p],c)<=0?f=p+1:d=p}while(f<d)}return f}function o(u,c,f=0,d=u.length){const p=a(u,c,f,d-1);return p>f&&n(u[p-1],c)>-n(u[p],c)?p-1:p}return{left:a,center:o,right:i}}function Q9(){return 0}function qO(e){return e===null?NaN:+e}function*Z9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const J9=A1(Hi),cc=J9.right;A1(qO).center;class AE extends Map{constructor(t,r=rU){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(kE(this,t))}has(t){return super.has(kE(this,t))}set(t,r){return super.set(eU(this,t),r)}delete(t){return super.delete(tU(this,t))}}function kE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function eU({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function tU({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function rU(e){return e!==null&&typeof e=="object"?e.valueOf():e}function nU(e=Hi){if(e===Hi)return XO;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function XO(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const aU=Math.sqrt(50),iU=Math.sqrt(10),sU=Math.sqrt(2);function Xd(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=aU?10:i>=iU?5:i>=sU?2:1;let u,c,f;return a<0?(f=Math.pow(10,-a)/o,u=Math.round(e*f),c=Math.round(t*f),u/f<e&&++u,c/f>t&&--c,f=-f):(f=Math.pow(10,a)*o,u=Math.round(e/f),c=Math.round(t/f),u*f<e&&++u,c*f>t&&--c),c<u&&.5<=r&&r<2?Xd(e,t,r*2):[u,c,f]}function cv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?Xd(t,e,r):Xd(e,t,r);if(!(i>=a))return[];const u=i-a+1,c=new Array(u);if(n)if(o<0)for(let f=0;f<u;++f)c[f]=(i-f)/-o;else for(let f=0;f<u;++f)c[f]=(i-f)*o;else if(o<0)for(let f=0;f<u;++f)c[f]=(a+f)/-o;else for(let f=0;f<u;++f)c[f]=(a+f)*o;return c}function fv(e,t,r){return t=+t,e=+e,r=+r,Xd(e,t,r)[2]}function dv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?fv(t,e,r):fv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function OE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function PE(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function QO(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?XO:nU(a);n>r;){if(n-r>600){const c=n-r+1,f=t-r+1,d=Math.log(c),p=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*p*(c-p)/c)*(f-c/2<0?-1:1),v=Math.max(r,Math.floor(t-f*p/c+m)),x=Math.min(n,Math.floor(t+(c-f)*p/c+m));QO(e,t,v,x,a)}const i=e[t];let o=r,u=n;for(vu(e,r,t),a(e[n],i)>0&&vu(e,r,n);o<u;){for(vu(e,o,u),++o,--u;a(e[o],i)<0;)++o;for(;a(e[u],i)>0;)--u}a(e[r],i)===0?vu(e,r,u):(++u,vu(e,u,n)),u<=t&&(r=u+1),t<=u&&(n=u-1)}return e}function vu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function oU(e,t,r){if(e=Float64Array.from(Z9(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return PE(e);if(t>=1)return OE(e);var n,a=(n-1)*t,i=Math.floor(a),o=OE(QO(e,i).subarray(0,i+1)),u=PE(e.subarray(i+1));return o+(u-o)*(a-i)}}function lU(e,t,r=qO){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),u=+r(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function uU(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ta(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ui(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const hv=Symbol("implicit");function k1(){var e=new AE,t=[],r=[],n=hv;function a(i){let o=e.get(i);if(o===void 0){if(n!==hv)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new AE;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return k1(t,r).unknown(n)},ta.apply(a,arguments),a}function O1(){var e=k1().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,u=!1,c=0,f=0,d=.5;delete e.unknown;function p(){var m=t().length,v=a<n,x=v?a:n,y=v?n:a;i=(y-x)/Math.max(1,m-c+f*2),u&&(i=Math.floor(i)),x+=(y-x-i*(m-c))*d,o=i*(1-c),u&&(x=Math.round(x),o=Math.round(o));var S=uU(m).map(function(T){return x+i*T});return r(v?S.reverse():S)}return e.domain=function(m){return arguments.length?(t(m),p()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,p()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,u=!0,p()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(m){return arguments.length?(u=!!m,p()):u},e.padding=function(m){return arguments.length?(c=Math.min(1,f=+m),p()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),p()):c},e.paddingOuter=function(m){return arguments.length?(f=+m,p()):f},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),p()):d},e.copy=function(){return O1(t(),[n,a]).round(u).paddingInner(c).paddingOuter(f).align(d)},ta.apply(p(),arguments)}function ZO(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ZO(t())},e}function cU(){return ZO(O1.apply(null,arguments).paddingInner(1))}function P1(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function JO(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function fc(){}var Ku=.7,Qd=1/Ku,qo="\\s*([+-]?\\d+)\\s*",Hu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ka="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fU=/^#([0-9a-f]{3,8})$/,dU=new RegExp(`^rgb\\(${qo},${qo},${qo}\\)$`),hU=new RegExp(`^rgb\\(${ka},${ka},${ka}\\)$`),pU=new RegExp(`^rgba\\(${qo},${qo},${qo},${Hu}\\)$`),mU=new RegExp(`^rgba\\(${ka},${ka},${ka},${Hu}\\)$`),gU=new RegExp(`^hsl\\(${Hu},${ka},${ka}\\)$`),vU=new RegExp(`^hsla\\(${Hu},${ka},${ka},${Hu}\\)$`),CE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};P1(fc,Vu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:NE,formatHex:NE,formatHex8:yU,formatHsl:xU,formatRgb:DE,toString:DE});function NE(){return this.rgb().formatHex()}function yU(){return this.rgb().formatHex8()}function xU(){return eP(this).formatHsl()}function DE(){return this.rgb().formatRgb()}function Vu(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=fU.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?ME(t):r===3?new pn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?rd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?rd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dU.exec(e))?new pn(t[1],t[2],t[3],1):(t=hU.exec(e))?new pn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=pU.exec(e))?rd(t[1],t[2],t[3],t[4]):(t=mU.exec(e))?rd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gU.exec(e))?FE(t[1],t[2]/100,t[3]/100,1):(t=vU.exec(e))?FE(t[1],t[2]/100,t[3]/100,t[4]):CE.hasOwnProperty(e)?ME(CE[e]):e==="transparent"?new pn(NaN,NaN,NaN,0):null}function ME(e){return new pn(e>>16&255,e>>8&255,e&255,1)}function rd(e,t,r,n){return n<=0&&(e=t=r=NaN),new pn(e,t,r,n)}function wU(e){return e instanceof fc||(e=Vu(e)),e?(e=e.rgb(),new pn(e.r,e.g,e.b,e.opacity)):new pn}function pv(e,t,r,n){return arguments.length===1?wU(e):new pn(e,t,r,n??1)}function pn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}P1(pn,pv,JO(fc,{brighter(e){return e=e==null?Qd:Math.pow(Qd,e),new pn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ku:Math.pow(Ku,e),new pn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new pn(Is(this.r),Is(this.g),Is(this.b),Zd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RE,formatHex:RE,formatHex8:SU,formatRgb:IE,toString:IE}));function RE(){return`#${Ps(this.r)}${Ps(this.g)}${Ps(this.b)}`}function SU(){return`#${Ps(this.r)}${Ps(this.g)}${Ps(this.b)}${Ps((isNaN(this.opacity)?1:this.opacity)*255)}`}function IE(){const e=Zd(this.opacity);return`${e===1?"rgb(":"rgba("}${Is(this.r)}, ${Is(this.g)}, ${Is(this.b)}${e===1?")":`, ${e})`}`}function Zd(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Is(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ps(e){return e=Is(e),(e<16?"0":"")+e.toString(16)}function FE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new pa(e,t,r,n)}function eP(e){if(e instanceof pa)return new pa(e.h,e.s,e.l,e.opacity);if(e instanceof fc||(e=Vu(e)),!e)return new pa;if(e instanceof pa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,u=i-a,c=(i+a)/2;return u?(t===i?o=(r-n)/u+(r<n)*6:r===i?o=(n-t)/u+2:o=(t-r)/u+4,u/=c<.5?i+a:2-i-a,o*=60):u=c>0&&c<1?0:o,new pa(o,u,c,e.opacity)}function bU(e,t,r,n){return arguments.length===1?eP(e):new pa(e,t,r,n??1)}function pa(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}P1(pa,bU,JO(fc,{brighter(e){return e=e==null?Qd:Math.pow(Qd,e),new pa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ku:Math.pow(Ku,e),new pa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new pn(fg(e>=240?e-240:e+120,a,n),fg(e,a,n),fg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new pa(jE(this.h),nd(this.s),nd(this.l),Zd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zd(this.opacity);return`${e===1?"hsl(":"hsla("}${jE(this.h)}, ${nd(this.s)*100}%, ${nd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function jE(e){return e=(e||0)%360,e<0?e+360:e}function nd(e){return Math.max(0,Math.min(1,e||0))}function fg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const C1=e=>()=>e;function EU(e,t){return function(r){return e+r*t}}function _U(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function TU(e){return(e=+e)==1?tP:function(t,r){return r-t?_U(t,r,e):C1(isNaN(t)?r:t)}}function tP(e,t){var r=t-e;return r?EU(e,r):C1(isNaN(e)?t:e)}const LE=function e(t){var r=TU(t);function n(a,i){var o=r((a=pv(a)).r,(i=pv(i)).r),u=r(a.g,i.g),c=r(a.b,i.b),f=tP(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=u(d),a.b=c(d),a.opacity=f(d),a+""}}return n.gamma=e,n}(1);function AU(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function kU(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function OU(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=hl(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(u){for(o=0;o<n;++o)i[o]=a[o](u);return i}}function PU(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Jd(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function CU(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=hl(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var mv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dg=new RegExp(mv.source,"g");function NU(e){return function(){return e}}function DU(e){return function(t){return e(t)+""}}function MU(e,t){var r=mv.lastIndex=dg.lastIndex=0,n,a,i,o=-1,u=[],c=[];for(e=e+"",t=t+"";(n=mv.exec(e))&&(a=dg.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),u[o]?u[o]+=i:u[++o]=i),(n=n[0])===(a=a[0])?u[o]?u[o]+=a:u[++o]=a:(u[++o]=null,c.push({i:o,x:Jd(n,a)})),r=dg.lastIndex;return r<t.length&&(i=t.slice(r),u[o]?u[o]+=i:u[++o]=i),u.length<2?c[0]?DU(c[0].x):NU(t):(t=c.length,function(f){for(var d=0,p;d<t;++d)u[(p=c[d]).i]=p.x(f);return u.join("")})}function hl(e,t){var r=typeof t,n;return t==null||r==="boolean"?C1(t):(r==="number"?Jd:r==="string"?(n=Vu(t))?(t=n,LE):MU:t instanceof Vu?LE:t instanceof Date?PU:kU(t)?AU:Array.isArray(t)?OU:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?CU:Jd)(e,t)}function N1(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function RU(e,t){t===void 0&&(t=e,e=hl);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var u=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[u](o-u)}}function IU(e){return function(){return e}}function e0(e){return+e}var BE=[0,1];function rn(e){return e}function gv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:IU(isNaN(t)?NaN:.5)}function FU(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function jU(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=gv(a,n),i=r(o,i)):(n=gv(n,a),i=r(i,o)),function(u){return i(n(u))}}function LU(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=gv(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(u){var c=cc(e,u,1,n)-1;return i[c](a[c](u))}}function dc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function W0(){var e=BE,t=BE,r=hl,n,a,i,o=rn,u,c,f;function d(){var m=Math.min(e.length,t.length);return o!==rn&&(o=FU(e[0],e[m-1])),u=m>2?LU:jU,c=f=null,p}function p(m){return m==null||isNaN(m=+m)?i:(c||(c=u(e.map(n),t,r)))(n(o(m)))}return p.invert=function(m){return o(a((f||(f=u(t,e.map(n),Jd)))(m)))},p.domain=function(m){return arguments.length?(e=Array.from(m,e0),d()):e.slice()},p.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},p.rangeRound=function(m){return t=Array.from(m),r=N1,d()},p.clamp=function(m){return arguments.length?(o=m?!0:rn,d()):o!==rn},p.interpolate=function(m){return arguments.length?(r=m,d()):r},p.unknown=function(m){return arguments.length?(i=m,p):i},function(m,v){return n=m,a=v,d()}}function D1(){return W0()(rn,rn)}function BU(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function t0(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function rl(e){return e=t0(Math.abs(e)),e?e[1]:NaN}function $U(e,t){return function(r,n){for(var a=r.length,i=[],o=0,u=e[0],c=0;a>0&&u>0&&(c+u+1>n&&(u=Math.max(1,n-c)),i.push(r.substring(a-=u,a+u)),!((c+=u+1)>n));)u=e[o=(o+1)%e.length];return i.reverse().join(t)}}function UU(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var WU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gu(e){if(!(t=WU.exec(e)))throw new Error("invalid format: "+e);var t;return new M1({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Gu.prototype=M1.prototype;function M1(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}M1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zU(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var rP;function KU(e,t){var r=t0(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(rP=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+t0(e,Math.max(0,t+i-1))[0]}function $E(e,t){var r=t0(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const UE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:BU,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$E(e*100,t),r:$E,s:KU,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function WE(e){return e}var zE=Array.prototype.map,KE=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function HU(e){var t=e.grouping===void 0||e.thousands===void 0?WE:$U(zE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?WE:UU(zE.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function f(p){p=Gu(p);var m=p.fill,v=p.align,x=p.sign,y=p.symbol,S=p.zero,T=p.width,k=p.comma,A=p.precision,P=p.trim,N=p.type;N==="n"?(k=!0,N="g"):UE[N]||(A===void 0&&(A=12),P=!0,N="g"),(S||m==="0"&&v==="=")&&(S=!0,m="0",v="=");var I=y==="$"?r:y==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",D=y==="$"?n:/[%p]/.test(N)?o:"",z=UE[N],H=/[defgprs%]/.test(N);A=A===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function te(q){var V=I,ae=D,Ee,Z,Te;if(N==="c")ae=z(q)+ae,q="";else{q=+q;var Se=q<0||1/q<0;if(q=isNaN(q)?c:z(Math.abs(q),A),P&&(q=zU(q)),Se&&+q==0&&x!=="+"&&(Se=!1),V=(Se?x==="("?x:u:x==="-"||x==="("?"":x)+V,ae=(N==="s"?KE[8+rP/3]:"")+ae+(Se&&x==="("?")":""),H){for(Ee=-1,Z=q.length;++Ee<Z;)if(Te=q.charCodeAt(Ee),48>Te||Te>57){ae=(Te===46?a+q.slice(Ee+1):q.slice(Ee))+ae,q=q.slice(0,Ee);break}}}k&&!S&&(q=t(q,1/0));var me=V.length+q.length+ae.length,we=me<T?new Array(T-me+1).join(m):"";switch(k&&S&&(q=t(we+q,we.length?T-ae.length:1/0),we=""),v){case"<":q=V+q+ae+we;break;case"=":q=V+we+q+ae;break;case"^":q=we.slice(0,me=we.length>>1)+V+q+ae+we.slice(me);break;default:q=we+V+q+ae;break}return i(q)}return te.toString=function(){return p+""},te}function d(p,m){var v=f((p=Gu(p),p.type="f",p)),x=Math.max(-8,Math.min(8,Math.floor(rl(m)/3)))*3,y=Math.pow(10,-x),S=KE[8+x/3];return function(T){return v(y*T)+S}}return{format:f,formatPrefix:d}}var ad,R1,nP;VU({thousands:",",grouping:[3],currency:["$",""]});function VU(e){return ad=HU(e),R1=ad.format,nP=ad.formatPrefix,ad}function GU(e){return Math.max(0,-rl(Math.abs(e)))}function YU(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rl(t)/3)))*3-rl(Math.abs(e)))}function qU(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rl(t)-rl(e))+1}function aP(e,t,r,n){var a=dv(e,t,r),i;switch(n=Gu(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=YU(a,o))&&(n.precision=i),nP(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=qU(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=GU(a))&&(n.precision=i-(n.type==="%")*2);break}}return R1(n)}function ns(e){var t=e.domain;return e.ticks=function(r){var n=t();return cv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return aP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],u=n[i],c,f,d=10;for(u<o&&(f=o,o=u,u=f,f=a,a=i,i=f);d-- >0;){if(f=fv(o,u,r),f===c)return n[a]=o,n[i]=u,t(n);if(f>0)o=Math.floor(o/f)*f,u=Math.ceil(u/f)*f;else if(f<0)o=Math.ceil(o*f)/f,u=Math.floor(u*f)/f;else break;c=f}return e},e}function iP(){var e=D1();return e.copy=function(){return dc(e,iP())},ta.apply(e,arguments),ns(e)}function sP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,e0),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return sP(e).unknown(t)},e=arguments.length?Array.from(e,e0):[0,1],ns(r)}function oP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function HE(e){return Math.log(e)}function VE(e){return Math.exp(e)}function XU(e){return-Math.log(-e)}function QU(e){return-Math.exp(-e)}function ZU(e){return isFinite(e)?+("1e"+e):e<0?0:e}function JU(e){return e===10?ZU:e===Math.E?Math.exp:t=>Math.pow(e,t)}function eW(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function GE(e){return(t,r)=>-e(-t,r)}function I1(e){const t=e(HE,VE),r=t.domain;let n=10,a,i;function o(){return a=eW(n),i=JU(n),r()[0]<0?(a=GE(a),i=GE(i),e(XU,QU)):e(HE,VE),t}return t.base=function(u){return arguments.length?(n=+u,o()):n},t.domain=function(u){return arguments.length?(r(u),o()):r()},t.ticks=u=>{const c=r();let f=c[0],d=c[c.length-1];const p=d<f;p&&([f,d]=[d,f]);let m=a(f),v=a(d),x,y;const S=u==null?10:+u;let T=[];if(!(n%1)&&v-m<S){if(m=Math.floor(m),v=Math.ceil(v),f>0){for(;m<=v;++m)for(x=1;x<n;++x)if(y=m<0?x/i(-m):x*i(m),!(y<f)){if(y>d)break;T.push(y)}}else for(;m<=v;++m)for(x=n-1;x>=1;--x)if(y=m>0?x/i(-m):x*i(m),!(y<f)){if(y>d)break;T.push(y)}T.length*2<S&&(T=cv(f,d,S))}else T=cv(m,v,Math.min(v-m,S)).map(i);return p?T.reverse():T},t.tickFormat=(u,c)=>{if(u==null&&(u=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Gu(c)).precision==null&&(c.trim=!0),c=R1(c)),u===1/0)return c;const f=Math.max(1,n*u/t.ticks().length);return d=>{let p=d/i(Math.round(a(d)));return p*n<n-.5&&(p*=n),p<=f?c(d):""}},t.nice=()=>r(oP(r(),{floor:u=>i(Math.floor(a(u))),ceil:u=>i(Math.ceil(a(u)))})),t}function lP(){const e=I1(W0()).domain([1,10]);return e.copy=()=>dc(e,lP()).base(e.base()),ta.apply(e,arguments),e}function YE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function qE(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function F1(e){var t=1,r=e(YE(t),qE(t));return r.constant=function(n){return arguments.length?e(YE(t=+n),qE(t)):t},ns(r)}function uP(){var e=F1(W0());return e.copy=function(){return dc(e,uP()).constant(e.constant())},ta.apply(e,arguments)}function XE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function tW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function rW(e){return e<0?-e*e:e*e}function j1(e){var t=e(rn,rn),r=1;function n(){return r===1?e(rn,rn):r===.5?e(tW,rW):e(XE(r),XE(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ns(t)}function L1(){var e=j1(W0());return e.copy=function(){return dc(e,L1()).exponent(e.exponent())},ta.apply(e,arguments),e}function nW(){return L1.apply(null,arguments).exponent(.5)}function QE(e){return Math.sign(e)*e*e}function aW(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function cP(){var e=D1(),t=[0,1],r=!1,n;function a(i){var o=aW(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(QE(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,e0)).map(QE)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return cP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ta.apply(a,arguments),ns(a)}function fP(){var e=[],t=[],r=[],n;function a(){var o=0,u=Math.max(1,t.length);for(r=new Array(u-1);++o<u;)r[o-1]=lU(e,o/u);return i}function i(o){return o==null||isNaN(o=+o)?n:t[cc(r,o)]}return i.invertExtent=function(o){var u=t.indexOf(o);return u<0?[NaN,NaN]:[u>0?r[u-1]:e[0],u<r.length?r[u]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let u of o)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(Hi),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return fP().domain(e).range(t).unknown(n)},ta.apply(i,arguments)}function dP(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[cc(n,c,0,r)]:i}function u(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,u()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,u()):a.slice()},o.invertExtent=function(c){var f=a.indexOf(c);return f<0?[NaN,NaN]:f<1?[e,n[0]]:f>=r?[n[r-1],t]:[n[f-1],n[f]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return dP().domain([e,t]).range(a).unknown(i)},ta.apply(ns(o),arguments)}function hP(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[cc(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return hP().domain(e).range(t).unknown(r)},ta.apply(a,arguments)}const hg=new Date,pg=new Date;function hr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),u=a.ceil(i);return i-o<u-i?o:u},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,u)=>{const c=[];if(i=a.ceil(i),u=u==null?1:Math.floor(u),!(i<o)||!(u>0))return c;let f;do c.push(f=new Date(+i)),t(i,u),e(i);while(f<i&&i<o);return c},a.filter=i=>hr(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,u)=>{if(o>=o)if(u<0)for(;++u<=0;)for(;t(o,-1),!i(o););else for(;--u>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(hg.setTime(+i),pg.setTime(+o),e(hg),e(pg),Math.floor(r(hg,pg))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const r0=hr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);r0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?hr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):r0);r0.range;const Ha=1e3,Xn=Ha*60,Va=Xn*60,ni=Va*24,B1=ni*7,ZE=ni*30,mg=ni*365,Cs=hr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCSeconds());Cs.range;const $1=hr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ha)},(e,t)=>{e.setTime(+e+t*Xn)},(e,t)=>(t-e)/Xn,e=>e.getMinutes());$1.range;const U1=hr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Xn)},(e,t)=>(t-e)/Xn,e=>e.getUTCMinutes());U1.range;const W1=hr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ha-e.getMinutes()*Xn)},(e,t)=>{e.setTime(+e+t*Va)},(e,t)=>(t-e)/Va,e=>e.getHours());W1.range;const z1=hr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Va)},(e,t)=>(t-e)/Va,e=>e.getUTCHours());z1.range;const hc=hr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xn)/ni,e=>e.getDate()-1);hc.range;const z0=hr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ni,e=>e.getUTCDate()-1);z0.range;const pP=hr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ni,e=>Math.floor(e/ni));pP.range;function ro(e){return hr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Xn)/B1)}const K0=ro(0),n0=ro(1),iW=ro(2),sW=ro(3),nl=ro(4),oW=ro(5),lW=ro(6);K0.range;n0.range;iW.range;sW.range;nl.range;oW.range;lW.range;function no(e){return hr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/B1)}const H0=no(0),a0=no(1),uW=no(2),cW=no(3),al=no(4),fW=no(5),dW=no(6);H0.range;a0.range;uW.range;cW.range;al.range;fW.range;dW.range;const K1=hr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());K1.range;const H1=hr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());H1.range;const ai=hr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ai.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ai.range;const ii=hr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ii.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:hr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ii.range;function mP(e,t,r,n,a,i){const o=[[Cs,1,Ha],[Cs,5,5*Ha],[Cs,15,15*Ha],[Cs,30,30*Ha],[i,1,Xn],[i,5,5*Xn],[i,15,15*Xn],[i,30,30*Xn],[a,1,Va],[a,3,3*Va],[a,6,6*Va],[a,12,12*Va],[n,1,ni],[n,2,2*ni],[r,1,B1],[t,1,ZE],[t,3,3*ZE],[e,1,mg]];function u(f,d,p){const m=d<f;m&&([f,d]=[d,f]);const v=p&&typeof p.range=="function"?p:c(f,d,p),x=v?v.range(f,+d+1):[];return m?x.reverse():x}function c(f,d,p){const m=Math.abs(d-f)/p,v=A1(([,,S])=>S).right(o,m);if(v===o.length)return e.every(dv(f/mg,d/mg,p));if(v===0)return r0.every(Math.max(dv(f,d,p),1));const[x,y]=o[m/o[v-1][2]<o[v][2]/m?v-1:v];return x.every(y)}return[u,c]}const[hW,pW]=mP(ii,H1,H0,pP,z1,U1),[mW,gW]=mP(ai,K1,K0,hc,W1,$1);function gg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function vg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function vW(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,c=e.shortMonths,f=xu(a),d=wu(a),p=xu(i),m=wu(i),v=xu(o),x=wu(o),y=xu(u),S=wu(u),T=xu(c),k=wu(c),A={a:Se,A:me,b:we,B:be,c:null,d:a_,e:a_,f:$W,g:XW,G:ZW,H:jW,I:LW,j:BW,L:gP,m:UW,M:WW,p:X,q:M,Q:o_,s:l_,S:zW,u:KW,U:HW,V:VW,w:GW,W:YW,x:null,X:null,y:qW,Y:QW,Z:JW,"%":s_},P={a:J,A:G,b:K,B:he,c:null,d:i_,e:i_,f:nz,g:hz,G:mz,H:ez,I:tz,j:rz,L:yP,m:az,M:iz,p:Oe,q:Ne,Q:o_,s:l_,S:sz,u:oz,U:lz,V:uz,w:cz,W:fz,x:null,X:null,y:dz,Y:pz,Z:gz,"%":s_},N={a:te,A:q,b:V,B:ae,c:Ee,d:r_,e:r_,f:MW,g:t_,G:e_,H:n_,I:n_,j:PW,L:DW,m:OW,M:CW,p:H,q:kW,Q:IW,s:FW,S:NW,u:bW,U:EW,V:_W,w:SW,W:TW,x:Z,X:Te,y:t_,Y:e_,Z:AW,"%":RW};A.x=I(r,A),A.X=I(n,A),A.c=I(t,A),P.x=I(r,P),P.X=I(n,P),P.c=I(t,P);function I(re,ye){return function(Be){var ge=[],ot=-1,ze=0,bt=re.length,at,pe,qe;for(Be instanceof Date||(Be=new Date(+Be));++ot<bt;)re.charCodeAt(ot)===37&&(ge.push(re.slice(ze,ot)),(pe=JE[at=re.charAt(++ot)])!=null?at=re.charAt(++ot):pe=at==="e"?" ":"0",(qe=ye[at])&&(at=qe(Be,pe)),ge.push(at),ze=ot+1);return ge.push(re.slice(ze,ot)),ge.join("")}}function D(re,ye){return function(Be){var ge=yu(1900,void 0,1),ot=z(ge,re,Be+="",0),ze,bt;if(ot!=Be.length)return null;if("Q"in ge)return new Date(ge.Q);if("s"in ge)return new Date(ge.s*1e3+("L"in ge?ge.L:0));if(ye&&!("Z"in ge)&&(ge.Z=0),"p"in ge&&(ge.H=ge.H%12+ge.p*12),ge.m===void 0&&(ge.m="q"in ge?ge.q:0),"V"in ge){if(ge.V<1||ge.V>53)return null;"w"in ge||(ge.w=1),"Z"in ge?(ze=vg(yu(ge.y,0,1)),bt=ze.getUTCDay(),ze=bt>4||bt===0?a0.ceil(ze):a0(ze),ze=z0.offset(ze,(ge.V-1)*7),ge.y=ze.getUTCFullYear(),ge.m=ze.getUTCMonth(),ge.d=ze.getUTCDate()+(ge.w+6)%7):(ze=gg(yu(ge.y,0,1)),bt=ze.getDay(),ze=bt>4||bt===0?n0.ceil(ze):n0(ze),ze=hc.offset(ze,(ge.V-1)*7),ge.y=ze.getFullYear(),ge.m=ze.getMonth(),ge.d=ze.getDate()+(ge.w+6)%7)}else("W"in ge||"U"in ge)&&("w"in ge||(ge.w="u"in ge?ge.u%7:"W"in ge?1:0),bt="Z"in ge?vg(yu(ge.y,0,1)).getUTCDay():gg(yu(ge.y,0,1)).getDay(),ge.m=0,ge.d="W"in ge?(ge.w+6)%7+ge.W*7-(bt+5)%7:ge.w+ge.U*7-(bt+6)%7);return"Z"in ge?(ge.H+=ge.Z/100|0,ge.M+=ge.Z%100,vg(ge)):gg(ge)}}function z(re,ye,Be,ge){for(var ot=0,ze=ye.length,bt=Be.length,at,pe;ot<ze;){if(ge>=bt)return-1;if(at=ye.charCodeAt(ot++),at===37){if(at=ye.charAt(ot++),pe=N[at in JE?ye.charAt(ot++):at],!pe||(ge=pe(re,Be,ge))<0)return-1}else if(at!=Be.charCodeAt(ge++))return-1}return ge}function H(re,ye,Be){var ge=f.exec(ye.slice(Be));return ge?(re.p=d.get(ge[0].toLowerCase()),Be+ge[0].length):-1}function te(re,ye,Be){var ge=v.exec(ye.slice(Be));return ge?(re.w=x.get(ge[0].toLowerCase()),Be+ge[0].length):-1}function q(re,ye,Be){var ge=p.exec(ye.slice(Be));return ge?(re.w=m.get(ge[0].toLowerCase()),Be+ge[0].length):-1}function V(re,ye,Be){var ge=T.exec(ye.slice(Be));return ge?(re.m=k.get(ge[0].toLowerCase()),Be+ge[0].length):-1}function ae(re,ye,Be){var ge=y.exec(ye.slice(Be));return ge?(re.m=S.get(ge[0].toLowerCase()),Be+ge[0].length):-1}function Ee(re,ye,Be){return z(re,t,ye,Be)}function Z(re,ye,Be){return z(re,r,ye,Be)}function Te(re,ye,Be){return z(re,n,ye,Be)}function Se(re){return o[re.getDay()]}function me(re){return i[re.getDay()]}function we(re){return c[re.getMonth()]}function be(re){return u[re.getMonth()]}function X(re){return a[+(re.getHours()>=12)]}function M(re){return 1+~~(re.getMonth()/3)}function J(re){return o[re.getUTCDay()]}function G(re){return i[re.getUTCDay()]}function K(re){return c[re.getUTCMonth()]}function he(re){return u[re.getUTCMonth()]}function Oe(re){return a[+(re.getUTCHours()>=12)]}function Ne(re){return 1+~~(re.getUTCMonth()/3)}return{format:function(re){var ye=I(re+="",A);return ye.toString=function(){return re},ye},parse:function(re){var ye=D(re+="",!1);return ye.toString=function(){return re},ye},utcFormat:function(re){var ye=I(re+="",P);return ye.toString=function(){return re},ye},utcParse:function(re){var ye=D(re+="",!0);return ye.toString=function(){return re},ye}}}var JE={"-":"",_:" ",0:"0"},kr=/^\s*\d+/,yW=/^%/,xW=/[\\^$*+?|[\]().{}]/g;function pt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function wW(e){return e.replace(xW,"\\$&")}function xu(e){return new RegExp("^(?:"+e.map(wW).join("|")+")","i")}function wu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function SW(e,t,r){var n=kr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function bW(e,t,r){var n=kr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function EW(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function _W(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function TW(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function e_(e,t,r){var n=kr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function t_(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function AW(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function kW(e,t,r){var n=kr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function OW(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function r_(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function PW(e,t,r){var n=kr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function n_(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function CW(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function NW(e,t,r){var n=kr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function DW(e,t,r){var n=kr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function MW(e,t,r){var n=kr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function RW(e,t,r){var n=yW.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function IW(e,t,r){var n=kr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function FW(e,t,r){var n=kr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function a_(e,t){return pt(e.getDate(),t,2)}function jW(e,t){return pt(e.getHours(),t,2)}function LW(e,t){return pt(e.getHours()%12||12,t,2)}function BW(e,t){return pt(1+hc.count(ai(e),e),t,3)}function gP(e,t){return pt(e.getMilliseconds(),t,3)}function $W(e,t){return gP(e,t)+"000"}function UW(e,t){return pt(e.getMonth()+1,t,2)}function WW(e,t){return pt(e.getMinutes(),t,2)}function zW(e,t){return pt(e.getSeconds(),t,2)}function KW(e){var t=e.getDay();return t===0?7:t}function HW(e,t){return pt(K0.count(ai(e)-1,e),t,2)}function vP(e){var t=e.getDay();return t>=4||t===0?nl(e):nl.ceil(e)}function VW(e,t){return e=vP(e),pt(nl.count(ai(e),e)+(ai(e).getDay()===4),t,2)}function GW(e){return e.getDay()}function YW(e,t){return pt(n0.count(ai(e)-1,e),t,2)}function qW(e,t){return pt(e.getFullYear()%100,t,2)}function XW(e,t){return e=vP(e),pt(e.getFullYear()%100,t,2)}function QW(e,t){return pt(e.getFullYear()%1e4,t,4)}function ZW(e,t){var r=e.getDay();return e=r>=4||r===0?nl(e):nl.ceil(e),pt(e.getFullYear()%1e4,t,4)}function JW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pt(t/60|0,"0",2)+pt(t%60,"0",2)}function i_(e,t){return pt(e.getUTCDate(),t,2)}function ez(e,t){return pt(e.getUTCHours(),t,2)}function tz(e,t){return pt(e.getUTCHours()%12||12,t,2)}function rz(e,t){return pt(1+z0.count(ii(e),e),t,3)}function yP(e,t){return pt(e.getUTCMilliseconds(),t,3)}function nz(e,t){return yP(e,t)+"000"}function az(e,t){return pt(e.getUTCMonth()+1,t,2)}function iz(e,t){return pt(e.getUTCMinutes(),t,2)}function sz(e,t){return pt(e.getUTCSeconds(),t,2)}function oz(e){var t=e.getUTCDay();return t===0?7:t}function lz(e,t){return pt(H0.count(ii(e)-1,e),t,2)}function xP(e){var t=e.getUTCDay();return t>=4||t===0?al(e):al.ceil(e)}function uz(e,t){return e=xP(e),pt(al.count(ii(e),e)+(ii(e).getUTCDay()===4),t,2)}function cz(e){return e.getUTCDay()}function fz(e,t){return pt(a0.count(ii(e)-1,e),t,2)}function dz(e,t){return pt(e.getUTCFullYear()%100,t,2)}function hz(e,t){return e=xP(e),pt(e.getUTCFullYear()%100,t,2)}function pz(e,t){return pt(e.getUTCFullYear()%1e4,t,4)}function mz(e,t){var r=e.getUTCDay();return e=r>=4||r===0?al(e):al.ceil(e),pt(e.getUTCFullYear()%1e4,t,4)}function gz(){return"+0000"}function s_(){return"%"}function o_(e){return+e}function l_(e){return Math.floor(+e/1e3)}var Fo,wP,SP;vz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function vz(e){return Fo=vW(e),wP=Fo.format,Fo.parse,SP=Fo.utcFormat,Fo.utcParse,Fo}function yz(e){return new Date(e)}function xz(e){return e instanceof Date?+e:+new Date(+e)}function V1(e,t,r,n,a,i,o,u,c,f){var d=D1(),p=d.invert,m=d.domain,v=f(".%L"),x=f(":%S"),y=f("%I:%M"),S=f("%I %p"),T=f("%a %d"),k=f("%b %d"),A=f("%B"),P=f("%Y");function N(I){return(c(I)<I?v:u(I)<I?x:o(I)<I?y:i(I)<I?S:n(I)<I?a(I)<I?T:k:r(I)<I?A:P)(I)}return d.invert=function(I){return new Date(p(I))},d.domain=function(I){return arguments.length?m(Array.from(I,xz)):m().map(yz)},d.ticks=function(I){var D=m();return e(D[0],D[D.length-1],I??10)},d.tickFormat=function(I,D){return D==null?N:f(D)},d.nice=function(I){var D=m();return(!I||typeof I.range!="function")&&(I=t(D[0],D[D.length-1],I??10)),I?m(oP(D,I)):d},d.copy=function(){return dc(d,V1(e,t,r,n,a,i,o,u,c,f))},d}function wz(){return ta.apply(V1(mW,gW,ai,K1,K0,hc,W1,$1,Cs,wP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Sz(){return ta.apply(V1(hW,pW,ii,H1,H0,z0,z1,U1,Cs,SP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function V0(){var e=0,t=1,r,n,a,i,o=rn,u=!1,c;function f(p){return p==null||isNaN(p=+p)?c:o(a===0?.5:(p=(i(p)-r)*a,u?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([e,t]=p,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),f):[e,t]},f.clamp=function(p){return arguments.length?(u=!!p,f):u},f.interpolator=function(p){return arguments.length?(o=p,f):o};function d(p){return function(m){var v,x;return arguments.length?([v,x]=m,o=p(v,x),f):[o(0),o(1)]}}return f.range=d(hl),f.rangeRound=d(N1),f.unknown=function(p){return arguments.length?(c=p,f):c},function(p){return i=p,r=p(e),n=p(t),a=r===n?0:1/(n-r),f}}function as(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function bP(){var e=ns(V0()(rn));return e.copy=function(){return as(e,bP())},ui.apply(e,arguments)}function EP(){var e=I1(V0()).domain([1,10]);return e.copy=function(){return as(e,EP()).base(e.base())},ui.apply(e,arguments)}function _P(){var e=F1(V0());return e.copy=function(){return as(e,_P()).constant(e.constant())},ui.apply(e,arguments)}function G1(){var e=j1(V0());return e.copy=function(){return as(e,G1()).exponent(e.exponent())},ui.apply(e,arguments)}function bz(){return G1.apply(null,arguments).exponent(.5)}function TP(){var e=[],t=rn;function r(n){if(n!=null&&!isNaN(n=+n))return t((cc(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Hi),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>oU(e,i/n))},r.copy=function(){return TP(t).domain(e)},ui.apply(r,arguments)}function G0(){var e=0,t=.5,r=1,n=1,a,i,o,u,c,f=rn,d,p=!1,m;function v(y){return isNaN(y=+y)?m:(y=.5+((y=+d(y))-i)*(n*y<n*i?u:c),f(p?Math.max(0,Math.min(1,y)):y))}v.domain=function(y){return arguments.length?([e,t,r]=y,a=d(e=+e),i=d(t=+t),o=d(r=+r),u=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,v):[e,t,r]},v.clamp=function(y){return arguments.length?(p=!!y,v):p},v.interpolator=function(y){return arguments.length?(f=y,v):f};function x(y){return function(S){var T,k,A;return arguments.length?([T,k,A]=S,f=RU(y,[T,k,A]),v):[f(0),f(.5),f(1)]}}return v.range=x(hl),v.rangeRound=x(N1),v.unknown=function(y){return arguments.length?(m=y,v):m},function(y){return d=y,a=y(e),i=y(t),o=y(r),u=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,v}}function AP(){var e=ns(G0()(rn));return e.copy=function(){return as(e,AP())},ui.apply(e,arguments)}function kP(){var e=I1(G0()).domain([.1,1,10]);return e.copy=function(){return as(e,kP()).base(e.base())},ui.apply(e,arguments)}function OP(){var e=F1(G0());return e.copy=function(){return as(e,OP()).constant(e.constant())},ui.apply(e,arguments)}function Y1(){var e=j1(G0());return e.copy=function(){return as(e,Y1()).exponent(e.exponent())},ui.apply(e,arguments)}function Ez(){return Y1.apply(null,arguments).exponent(.5)}const _u=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:O1,scaleDiverging:AP,scaleDivergingLog:kP,scaleDivergingPow:Y1,scaleDivergingSqrt:Ez,scaleDivergingSymlog:OP,scaleIdentity:sP,scaleImplicit:hv,scaleLinear:iP,scaleLog:lP,scaleOrdinal:k1,scalePoint:cU,scalePow:L1,scaleQuantile:fP,scaleQuantize:dP,scaleRadial:cP,scaleSequential:bP,scaleSequentialLog:EP,scaleSequentialPow:G1,scaleSequentialQuantile:TP,scaleSequentialSqrt:bz,scaleSequentialSymlog:_P,scaleSqrt:nW,scaleSymlog:uP,scaleThreshold:hP,scaleTime:wz,scaleUtc:Sz,tickFormat:aP},Symbol.toStringTag,{value:"Module"}));var is=e=>e.chartData,q1=le([is],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Y0=(e,t,r,n)=>n?q1(e):is(e);function Vs(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Yr(t)&&Yr(r))return!0}return!1}function u_(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function PP(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Yr(r))a=r;else if(typeof r=="function")return;if(Yr(n))i=n;else if(typeof n=="function")return;var o=[a,i];if(Vs(o))return o}}function _z(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Vs(n))return u_(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,o,u;if(a==="auto")t!=null&&(o=Math.min(...t));else if(Je(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[0]))}catch{}else if(typeof a=="string"&&Hb.test(a)){var c=Hb.exec(a);if(c==null||t==null)o=void 0;else{var f=+c[1];o=t[0]-f}}else o=t?.[0];if(i==="auto")t!=null&&(u=Math.max(...t));else if(Je(i))u=i;else if(typeof i=="function")try{t!=null&&(u=i(t?.[1]))}catch{}else if(typeof i=="string"&&Vb.test(i)){var d=Vb.exec(i);if(d==null||t==null)u=void 0;else{var p=+d[1];u=t[1]+p}}else u=t?.[1];var m=[o,u];if(Vs(m))return t==null?m:u_(m,t,r)}}}var pl=1e9,Tz={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Q1,Bt=!0,Jn="[DecimalError] ",Fs=Jn+"Invalid argument: ",X1=Jn+"Exponent out of range: ",ml=Math.floor,Ts=Math.pow,Az=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Dn,br=1e7,Rt=7,CP=9007199254740991,i0=ml(CP/Rt),We={};We.absoluteValue=We.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};We.comparedTo=We.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};We.decimalPlaces=We.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Rt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};We.dividedBy=We.div=function(e){return Qa(this,new this.constructor(e))};We.dividedToIntegerBy=We.idiv=function(e){var t=this,r=t.constructor;return At(Qa(t,new r(e),0,1),r.precision)};We.equals=We.eq=function(e){return!this.cmp(e)};We.exponent=function(){return ir(this)};We.greaterThan=We.gt=function(e){return this.cmp(e)>0};We.greaterThanOrEqualTo=We.gte=function(e){return this.cmp(e)>=0};We.isInteger=We.isint=function(){return this.e>this.d.length-2};We.isNegative=We.isneg=function(){return this.s<0};We.isPositive=We.ispos=function(){return this.s>0};We.isZero=function(){return this.s===0};We.lessThan=We.lt=function(e){return this.cmp(e)<0};We.lessThanOrEqualTo=We.lte=function(e){return this.cmp(e)<1};We.logarithm=We.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Dn))throw Error(Jn+"NaN");if(r.s<1)throw Error(Jn+(r.s?"NaN":"-Infinity"));return r.eq(Dn)?new n(0):(Bt=!1,t=Qa(Yu(r,i),Yu(e,i),i),Bt=!0,At(t,a))};We.minus=We.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?MP(t,e):NP(t,(e.s=-e.s,e))};We.modulo=We.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Jn+"NaN");return r.s?(Bt=!1,t=Qa(r,e,0,1).times(e),Bt=!0,r.minus(t)):At(new n(r),a)};We.naturalExponential=We.exp=function(){return DP(this)};We.naturalLogarithm=We.ln=function(){return Yu(this)};We.negated=We.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};We.plus=We.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?NP(t,e):MP(t,(e.s=-e.s,e))};We.precision=We.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Fs+e);if(t=ir(a)+1,n=a.d.length-1,r=n*Rt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};We.squareRoot=We.sqrt=function(){var e,t,r,n,a,i,o,u=this,c=u.constructor;if(u.s<1){if(!u.s)return new c(0);throw Error(Jn+"NaN")}for(e=ir(u),Bt=!1,a=Math.sqrt(+u),a==0||a==1/0?(t=Aa(u.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ml((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(Qa(u,i,o+2)).times(.5),Aa(i.d).slice(0,o)===(t=Aa(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(At(i,r+1,0),i.times(i).eq(u)){n=i;break}}else if(t!="9999")break;o+=4}return Bt=!0,At(n,r)};We.times=We.mul=function(e){var t,r,n,a,i,o,u,c,f,d=this,p=d.constructor,m=d.d,v=(e=new p(e)).d;if(!d.s||!e.s)return new p(0);for(e.s*=d.s,r=d.e+e.e,c=m.length,f=v.length,c<f&&(i=m,m=v,v=i,o=c,c=f,f=o),i=[],o=c+f,n=o;n--;)i.push(0);for(n=f;--n>=0;){for(t=0,a=c+n;a>n;)u=i[a]+v[n]*m[a-n-1]+t,i[a--]=u%br|0,t=u/br|0;i[a]=(i[a]+t)%br|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Bt?At(e,p.precision):e};We.toDecimalPlaces=We.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ca(e,0,pl),t===void 0?t=n.rounding:Ca(t,0,8),At(r,e+ir(r)+1,t))};We.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Gs(n,!0):(Ca(e,0,pl),t===void 0?t=a.rounding:Ca(t,0,8),n=At(new a(n),e+1,t),r=Gs(n,!0,e+1)),r};We.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Gs(a):(Ca(e,0,pl),t===void 0?t=i.rounding:Ca(t,0,8),n=At(new i(a),e+ir(a)+1,t),r=Gs(n.abs(),!1,e+ir(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};We.toInteger=We.toint=function(){var e=this,t=e.constructor;return At(new t(e),ir(e)+1,t.rounding)};We.toNumber=function(){return+this};We.toPower=We.pow=function(e){var t,r,n,a,i,o,u=this,c=u.constructor,f=12,d=+(e=new c(e));if(!e.s)return new c(Dn);if(u=new c(u),!u.s){if(e.s<1)throw Error(Jn+"Infinity");return u}if(u.eq(Dn))return u;if(n=c.precision,e.eq(Dn))return At(u,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=u.s,o){if((r=d<0?-d:d)<=CP){for(a=new c(Dn),t=Math.ceil(n/Rt+4),Bt=!1;r%2&&(a=a.times(u),f_(a.d,t)),r=ml(r/2),r!==0;)u=u.times(u),f_(u.d,t);return Bt=!0,e.s<0?new c(Dn).div(a):At(a,n)}}else if(i<0)throw Error(Jn+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,u.s=1,Bt=!1,a=e.times(Yu(u,n+f)),Bt=!0,a=DP(a),a.s=i,a};We.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=ir(a),n=Gs(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ca(e,1,pl),t===void 0?t=i.rounding:Ca(t,0,8),a=At(new i(a),e,t),r=ir(a),n=Gs(a,e<=r||r<=i.toExpNeg,e)),n};We.toSignificantDigits=We.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ca(e,1,pl),t===void 0?t=n.rounding:Ca(t,0,8)),At(new n(r),e,t)};We.toString=We.valueOf=We.val=We.toJSON=We[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ir(e),r=e.constructor;return Gs(e,t<=r.toExpNeg||t>=r.toExpPos)};function NP(e,t){var r,n,a,i,o,u,c,f,d=e.constructor,p=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Bt?At(t,p):t;if(c=e.d,f=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,u=f.length):(n=f,a=o,u=c.length),o=Math.ceil(p/Rt),u=o>u?o+1:u+1,i>u&&(i=u,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(u=c.length,i=f.length,u-i<0&&(i=u,n=f,f=c,c=n),r=0;i;)r=(c[--i]=c[i]+f[i]+r)/br|0,c[i]%=br;for(r&&(c.unshift(r),++a),u=c.length;c[--u]==0;)c.pop();return t.d=c,t.e=a,Bt?At(t,p):t}function Ca(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Fs+e)}function Aa(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Rt-n.length,r&&(i+=$i(r)),i+=n;o=e[t],n=o+"",r=Rt-n.length,r&&(i+=$i(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Qa=function(){function e(n,a){var i,o=0,u=n.length;for(n=n.slice();u--;)i=n[u]*a+o,n[u]=i%br|0,o=i/br|0;return o&&n.unshift(o),n}function t(n,a,i,o){var u,c;if(i!=o)c=i>o?1:-1;else for(u=c=0;u<i;u++)if(n[u]!=a[u]){c=n[u]>a[u]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*br+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var u,c,f,d,p,m,v,x,y,S,T,k,A,P,N,I,D,z,H=n.constructor,te=n.s==a.s?1:-1,q=n.d,V=a.d;if(!n.s)return new H(n);if(!a.s)throw Error(Jn+"Division by zero");for(c=n.e-a.e,D=V.length,N=q.length,v=new H(te),x=v.d=[],f=0;V[f]==(q[f]||0);)++f;if(V[f]>(q[f]||0)&&--c,i==null?k=i=H.precision:o?k=i+(ir(n)-ir(a))+1:k=i,k<0)return new H(0);if(k=k/Rt+2|0,f=0,D==1)for(d=0,V=V[0],k++;(f<N||d)&&k--;f++)A=d*br+(q[f]||0),x[f]=A/V|0,d=A%V|0;else{for(d=br/(V[0]+1)|0,d>1&&(V=e(V,d),q=e(q,d),D=V.length,N=q.length),P=D,y=q.slice(0,D),S=y.length;S<D;)y[S++]=0;z=V.slice(),z.unshift(0),I=V[0],V[1]>=br/2&&++I;do d=0,u=t(V,y,D,S),u<0?(T=y[0],D!=S&&(T=T*br+(y[1]||0)),d=T/I|0,d>1?(d>=br&&(d=br-1),p=e(V,d),m=p.length,S=y.length,u=t(p,y,m,S),u==1&&(d--,r(p,D<m?z:V,m))):(d==0&&(u=d=1),p=V.slice()),m=p.length,m<S&&p.unshift(0),r(y,p,S),u==-1&&(S=y.length,u=t(V,y,D,S),u<1&&(d++,r(y,D<S?z:V,S))),S=y.length):u===0&&(d++,y=[0]),x[f++]=d,u&&y[0]?y[S++]=q[P]||0:(y=[q[P]],S=1);while((P++<N||y[0]!==void 0)&&k--)}return x[0]||x.shift(),v.e=c,At(v,o?i+ir(v)+1:i)}}();function DP(e,t){var r,n,a,i,o,u,c=0,f=0,d=e.constructor,p=d.precision;if(ir(e)>16)throw Error(X1+ir(e));if(!e.s)return new d(Dn);for(Bt=!1,u=p,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),f+=5;for(n=Math.log(Ts(2,f))/Math.LN10*2+5|0,u+=n,r=a=i=new d(Dn),d.precision=u;;){if(a=At(a.times(e),u),r=r.times(++c),o=i.plus(Qa(a,r,u)),Aa(o.d).slice(0,u)===Aa(i.d).slice(0,u)){for(;f--;)i=At(i.times(i),u);return d.precision=p,t==null?(Bt=!0,At(i,p)):i}i=o}}function ir(e){for(var t=e.e*Rt,r=e.d[0];r>=10;r/=10)t++;return t}function yg(e,t,r){if(t>e.LN10.sd())throw Bt=!0,r&&(e.precision=r),Error(Jn+"LN10 precision limit exceeded");return At(new e(e.LN10),t)}function $i(e){for(var t="";e--;)t+="0";return t}function Yu(e,t){var r,n,a,i,o,u,c,f,d,p=1,m=10,v=e,x=v.d,y=v.constructor,S=y.precision;if(v.s<1)throw Error(Jn+(v.s?"NaN":"-Infinity"));if(v.eq(Dn))return new y(0);if(t==null?(Bt=!1,f=S):f=t,v.eq(10))return t==null&&(Bt=!0),yg(y,f);if(f+=m,y.precision=f,r=Aa(x),n=r.charAt(0),i=ir(v),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(e),r=Aa(v.d),n=r.charAt(0),p++;i=ir(v),n>1?(v=new y("0."+r),i++):v=new y(n+"."+r.slice(1))}else return c=yg(y,f+2,S).times(i+""),v=Yu(new y(n+"."+r.slice(1)),f-m).plus(c),y.precision=S,t==null?(Bt=!0,At(v,S)):v;for(u=o=v=Qa(v.minus(Dn),v.plus(Dn),f),d=At(v.times(v),f),a=3;;){if(o=At(o.times(d),f),c=u.plus(Qa(o,new y(a),f)),Aa(c.d).slice(0,f)===Aa(u.d).slice(0,f))return u=u.times(2),i!==0&&(u=u.plus(yg(y,f+2,S).times(i+""))),u=Qa(u,new y(p),f),y.precision=S,t==null?(Bt=!0,At(u,S)):u;u=c,a+=2}}function c_(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ml(r/Rt),e.d=[],n=(r+1)%Rt,r<0&&(n+=Rt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Rt;n<a;)e.d.push(+t.slice(n,n+=Rt));t=t.slice(n),n=Rt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Bt&&(e.e>i0||e.e<-i0))throw Error(X1+r)}else e.s=0,e.e=0,e.d=[0];return e}function At(e,t,r){var n,a,i,o,u,c,f,d,p=e.d;for(o=1,i=p[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Rt,a=t,f=p[d=0];else{if(d=Math.ceil((n+1)/Rt),i=p.length,d>=i)return e;for(f=i=p[d],o=1;i>=10;i/=10)o++;n%=Rt,a=n-Rt+o}if(r!==void 0&&(i=Ts(10,o-a-1),u=f/i%10|0,c=t<0||p[d+1]!==void 0||f%i,c=r<4?(u||c)&&(r==0||r==(e.s<0?3:2)):u>5||u==5&&(r==4||c||r==6&&(n>0?a>0?f/Ts(10,o-a):0:p[d-1])%10&1||r==(e.s<0?8:7))),t<1||!p[0])return c?(i=ir(e),p.length=1,t=t-i-1,p[0]=Ts(10,(Rt-t%Rt)%Rt),e.e=ml(-t/Rt)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(n==0?(p.length=d,i=1,d--):(p.length=d+1,i=Ts(10,Rt-n),p[d]=a>0?(f/Ts(10,o-a)%Ts(10,a)|0)*i:0),c)for(;;)if(d==0){(p[0]+=i)==br&&(p[0]=1,++e.e);break}else{if(p[d]+=i,p[d]!=br)break;p[d--]=0,i=1}for(n=p.length;p[--n]===0;)p.pop();if(Bt&&(e.e>i0||e.e<-i0))throw Error(X1+ir(e));return e}function MP(e,t){var r,n,a,i,o,u,c,f,d,p,m=e.constructor,v=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),Bt?At(t,v):t;if(c=e.d,p=t.d,n=t.e,f=e.e,c=c.slice(),o=f-n,o){for(d=o<0,d?(r=c,o=-o,u=p.length):(r=p,n=f,u=c.length),a=Math.max(Math.ceil(v/Rt),u)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,u=p.length,d=a<u,d&&(u=a),a=0;a<u;a++)if(c[a]!=p[a]){d=c[a]<p[a];break}o=0}for(d&&(r=c,c=p,p=r,t.s=-t.s),u=c.length,a=p.length-u;a>0;--a)c[u++]=0;for(a=p.length;a>o;){if(c[--a]<p[a]){for(i=a;i&&c[--i]===0;)c[i]=br-1;--c[i],c[a]+=br}c[a]-=p[a]}for(;c[--u]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Bt?At(t,v):t):new m(0)}function Gs(e,t,r){var n,a=ir(e),i=Aa(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+$i(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+$i(-a-1)+i,r&&(n=r-o)>0&&(i+=$i(n))):a>=o?(i+=$i(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+$i(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=$i(n))),e.s<0?"-"+i:i}function f_(e,t){if(e.length>t)return e.length=t,!0}function RP(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Fs+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return c_(o,i.toString())}else if(typeof i!="string")throw Error(Fs+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,Az.test(i))c_(o,i);else throw Error(Fs+i)}if(a.prototype=We,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=RP,a.config=a.set=kz,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function kz(e){if(!e||typeof e!="object")throw Error(Jn+"Object expected");var t,r,n,a=["precision",1,pl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ml(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Fs+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Fs+r+": "+n);return this}var Q1=RP(Tz);Dn=new Q1(1);const xt=Q1;var Oz=e=>e,IP={},FP=e=>e===IP,d_=e=>function t(){return arguments.length===0||arguments.length===1&&FP(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},jP=(e,t)=>e===1?t:d_(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(o=>o!==IP).length;return i>=e?t(...n):jP(e-i,d_(function(){for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];var f=n.map(d=>FP(d)?u.shift():d);return t(...f,...u)}))}),q0=e=>jP(e.length,e),vv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Pz=q0((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Cz=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return Oz;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce((u,c)=>c(u),i(...arguments))}},yv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),LP=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((o,u)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[u])})||(t=a,r=e(...a)),r}};function BP(e){var t;return e===0?t=1:t=Math.floor(new xt(e).abs().log(10).toNumber())+1,t}function $P(e,t,r){for(var n=new xt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}q0((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});q0((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});q0((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var UP=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},WP=(e,t,r)=>{if(e.lte(0))return new xt(0);var n=BP(e.toNumber()),a=new xt(10).pow(n),i=e.div(a),o=n!==1?.05:.1,u=new xt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=u.mul(a);return t?new xt(c.toNumber()):new xt(Math.ceil(c.toNumber()))},Nz=(e,t,r)=>{var n=new xt(1),a=new xt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new xt(10).pow(BP(e)-1),a=new xt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new xt(Math.floor(e)))}else e===0?a=new xt(Math.floor((t-1)/2)):r||(a=new xt(Math.floor(e)));var o=Math.floor((t-1)/2),u=Cz(Pz(c=>a.add(new xt(c-o).mul(n)).toNumber()),vv);return u(0,t)},zP=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new xt(0),tickMin:new xt(0),tickMax:new xt(0)};var o=WP(new xt(r).sub(t).div(n-1),a,i),u;t<=0&&r>=0?u=new xt(0):(u=new xt(t).add(r).div(2),u=u.sub(new xt(u).mod(o)));var c=Math.ceil(u.sub(t).div(o).toNumber()),f=Math.ceil(new xt(r).sub(u).div(o).toNumber()),d=c+f+1;return d>n?zP(t,r,n,a,i+1):(d<n&&(f=r>0?f+(n-d):f,c=r>0?c:c+(n-d)),{step:o,tickMin:u.sub(new xt(c).mul(o)),tickMax:u.add(new xt(f).mul(o))})};function Dz(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[o,u]=UP([t,r]);if(o===-1/0||u===1/0){var c=u===1/0?[o,...vv(0,n-1).map(()=>1/0)]:[...vv(0,n-1).map(()=>-1/0),u];return t>r?yv(c):c}if(o===u)return Nz(o,n,a);var{step:f,tickMin:d,tickMax:p}=zP(o,u,i,a,0),m=$P(d,p.add(new xt(.1).mul(f)),f);return t>r?yv(m):m}function Mz(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,o]=UP([r,n]);if(i===-1/0||o===1/0)return[r,n];if(i===o)return[i];var u=Math.max(t,2),c=WP(new xt(o).sub(i).div(u-1),a,0),f=[...$P(new xt(i),new xt(o),c),o];return a===!1&&(f=f.map(d=>Math.round(d))),r>n?yv(f):f}var Rz=LP(Dz),Iz=LP(Mz),KP=e=>e.rootProps.maxBarSize,Fz=e=>e.rootProps.barGap,HP=e=>e.rootProps.barCategoryGap,jz=e=>e.rootProps.barSize,pc=e=>e.rootProps.stackOffset,Z1=e=>e.options.chartName,J1=e=>e.rootProps.syncId,VP=e=>e.rootProps.syncMethod,ey=e=>e.options.eventEmitter,za={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},On={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},X0=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Lz={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:za.angleAxisId,includeHidden:!1,name:void 0,reversed:za.reversed,scale:za.scale,tick:za.tick,tickCount:void 0,ticks:void 0,type:za.type,unit:void 0},Bz={allowDataOverflow:On.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:On.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:On.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:On.scale,tick:On.tick,tickCount:On.tickCount,ticks:void 0,type:On.type,unit:void 0},$z={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:za.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:za.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:za.scale,tick:za.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Uz={allowDataOverflow:On.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:On.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:On.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:On.scale,tick:On.tick,tickCount:On.tickCount,ticks:void 0,type:"category",unit:void 0},ty=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?$z:Lz,ry=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Uz:Bz,Q0=e=>e.polarOptions,ny=le([oi,li,dr],AO),GP=le([Q0,ny],(e,t)=>{if(e!=null)return Gr(e.innerRadius,t,0)}),YP=le([Q0,ny],(e,t)=>{if(e!=null)return Gr(e.outerRadius,t,t*.8)}),Wz=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},qP=le([Q0],Wz);le([ty,qP],X0);var XP=le([ny,GP,YP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});le([ry,XP],X0);var QP=le([ut,Q0,GP,YP,oi,li],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:u,startAngle:c,endAngle:f}=t;return{cx:Gr(o,a,a/2),cy:Gr(u,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:f,clockWise:!1}}}),Wt=(e,t)=>t,mc=(e,t,r)=>r;function ay(e){return e?.id}var pr=e=>{var t=ut(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},gl=e=>e.tooltip.settings.axisId,mr=e=>{var t=pr(e),r=gl(e);return gc(e,t,r)},ZP=le([mr],e=>e?.dataKey);function JP(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,o=new Map;return e.forEach(u=>{var c,f=(c=u.data)!==null&&c!==void 0?c:n;if(!(f==null||f.length===0)){var d=ay(u);f.forEach((p,m)=>{var v=i==null||a?m:String(Ct(p,i,null)),x=Ct(p,u.dataKey,0),y;o.has(v)?y=o.get(v):y={},Object.assign(y,{[d]:x}),o.set(v,y)})}}),Array.from(o.values())}function Z0(e){return e.stackId!=null&&e.dataKey!=null}var J0=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function eh(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function h_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h_(Object(r),!0).forEach(function(n){zz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zz(e,t,r){return(t=Kz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kz(e){var t=Hz(e,"string");return typeof t=="symbol"?t:t+""}function Hz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xv=[0,"auto"],En={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},eC=(e,t)=>e.cartesianAxis.xAxis[t],ci=(e,t)=>{var r=eC(e,t);return r??En},_n={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:xv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:oc},tC=(e,t)=>e.cartesianAxis.yAxis[t],fi=(e,t)=>{var r=tC(e,t);return r??_n},Vz={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},iy=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Vz},Ht=(e,t,r)=>{switch(t){case"xAxis":return ci(e,r);case"yAxis":return fi(e,r);case"zAxis":return iy(e,r);case"angleAxis":return ty(e,r);case"radiusAxis":return ry(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Gz=(e,t,r)=>{switch(t){case"xAxis":return ci(e,r);case"yAxis":return fi(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},gc=(e,t,r)=>{switch(t){case"xAxis":return ci(e,r);case"yAxis":return fi(e,r);case"angleAxis":return ty(e,r);case"radiusAxis":return ry(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rC=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function sy(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var th=e=>e.graphicalItems.cartesianItems,Yz=le([Wt,mc],sy),oy=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),vc=le([th,Ht,Yz],oy,{memoizeOptions:{resultEqualityCheck:eh}}),nC=le([vc],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Z0)),aC=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),qz=le([vc],aC),ly=e=>e.map(t=>t.data).filter(Boolean).flat(1),Xz=le([vc],ly,{memoizeOptions:{resultEqualityCheck:eh}}),uy=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},cy=le([Xz,Y0],uy),fy=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Ct(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Ct(a,n)}))):e.map(n=>({value:n})),rh=le([cy,Ht,vc],fy);function iC(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function cd(e){if(Pa(e)||e instanceof Date){var t=Number(e);if(Yr(t))return t}}function p_(e){if(Array.isArray(e)){var t=[cd(e[0]),cd(e[1])];return Vs(t)?t:void 0}var r=cd(e);if(r!=null)return[r,r]}function vl(e){return e.map(cd).filter(h9)}function Qz(e,t,r){return!r||typeof t!="number"||va(t)?[]:r.length?vl(r.flatMap(n=>{var a=Ct(e,n.dataKey),i,o;if(Array.isArray(a)?[i,o]=a:i=o=a,!(!Yr(i)||!Yr(o)))return[t-i,t+o]})):[]}var Zz=le([nC,Y0,mr],JP),sC=(e,t,r)=>{var n={},a=t.reduce((i,o)=>(o.stackId==null||(i[o.stackId]==null&&(i[o.stackId]=[]),i[o.stackId].push(o)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[o,u]=i,c=u.map(ay);return[o,{stackedData:I$(e,c,r),graphicalItems:u}]}))},wv=le([Zz,nC,pc],sC),oC=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var o=$$(e,a,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},Jz=le([Ht],e=>e.allowDataOverflow),dy=e=>{var t;if(e==null||!("domain"in e))return xv;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=vl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:xv},hy=le([Ht],dy),py=le([hy,Jz],PP),eK=le([wv,is,Wt,py],oC,{memoizeOptions:{resultEqualityCheck:J0}}),nh=e=>e.errorBars,tK=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>iC(r,n)),o0=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),o=Math.min(...i),u=Math.max(...i);return[o,u]}},my=(e,t,r,n,a)=>{var i,o;if(r.length>0&&e.forEach(u=>{r.forEach(c=>{var f,d,p=(f=n[c.id])===null||f===void 0?void 0:f.filter(T=>iC(a,T)),m=Ct(u,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),v=Qz(u,m,p);if(v.length>=2){var x=Math.min(...v),y=Math.max(...v);(i==null||x<i)&&(i=x),(o==null||y>o)&&(o=y)}var S=p_(m);S!=null&&(i=i==null?S[0]:Math.min(i,S[0]),o=o==null?S[1]:Math.max(o,S[1]))})}),t?.dataKey!=null&&e.forEach(u=>{var c=p_(Ct(u,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Yr(i)&&Yr(o))return[i,o]},rK=le([cy,Ht,qz,nh,Wt],my,{memoizeOptions:{resultEqualityCheck:J0}});function nK(e){var{value:t}=e;if(Pa(t)||t instanceof Date)return t}var aK=(e,t,r)=>{var n=e.map(nK).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&jk(n))?YO(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},lC=e=>e.referenceElements.dots,yl=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),iK=le([lC,Wt,mc],yl),uC=e=>e.referenceElements.areas,sK=le([uC,Wt,mc],yl),cC=e=>e.referenceElements.lines,oK=le([cC,Wt,mc],yl),fC=(e,t)=>{var r=vl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},lK=le(iK,Wt,fC),dC=(e,t)=>{var r=vl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},uK=le([sK,Wt],dC),hC=(e,t)=>{var r=vl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},cK=le(oK,Wt,hC),fK=le(lK,cK,uK,(e,t,r)=>o0(e,r,t)),gy=(e,t,r,n,a,i,o,u)=>{if(r!=null)return r;var c=o==="vertical"&&u==="xAxis"||o==="horizontal"&&u==="yAxis",f=c?o0(n,i,a):o0(i,a);return _z(t,f,e.allowDataOverflow)},dK=le([Ht,hy,py,eK,rK,fK,ut,Wt],gy,{memoizeOptions:{resultEqualityCheck:J0}}),hK=[0,1],vy=(e,t,r,n,a,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:u,type:c}=e,f=ts(t,i);return f&&u==null?YO(0,r.length):c==="category"?aK(n,e,f):a==="expand"?hK:o}},yy=le([Ht,ut,cy,rh,pc,Wt,dK],vy),pC=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:o}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof i=="string"){var u="scale".concat(nc(i));return u in _u?u:"point"}}},xl=le([Ht,ut,rC,Z1,Wt],pC);function pK(e){if(e!=null){if(e in _u)return _u[e]();var t="scale".concat(nc(e));if(t in _u)return _u[t]()}}function xy(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=pK(t);if(a!=null){var i=a.domain(r).range(n);return C$(i),i}}}var wy=(e,t,r)=>{var n=dy(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Vs(e))return Rz(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Vs(e))return Iz(e,t.tickCount,t.allowDecimals)}},Sy=le([yy,gc,xl],wy),by=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Vs(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],o=t[1],u=r[r.length-1];return[Math.min(a,i),Math.max(o,u)]}return t},mK=le([Ht,yy,Sy,Wt],by),gK=le(rh,Ht,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(vl(e.map(u=>u.value))).sort((u,c)=>u-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var o=n[i+1]-n[i];r=Math.min(r,o)}return r/a}}),mC=le(gK,ut,HP,dr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Yr(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var o=Gr(r,e*i),u=e*i/2;return u-o-(u-o)/i*o}return 0}),vK=(e,t)=>{var r=ci(e,t);return r==null||typeof r.padding!="string"?0:mC(e,"xAxis",t,r.padding)},yK=(e,t)=>{var r=fi(e,t);return r==null||typeof r.padding!="string"?0:mC(e,"yAxis",t,r.padding)},xK=le(ci,vK,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),wK=le(fi,yK,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),SK=le([dr,xK,L0,j0,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),bK=le([dr,ut,wK,L0,j0,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:o}=a;return i?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),yc=(e,t,r,n)=>{var a;switch(t){case"xAxis":return SK(e,r,n);case"yAxis":return bK(e,r,n);case"zAxis":return(a=iy(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return qP(e);case"radiusAxis":return XP(e,r);default:return}},gC=le([Ht,yc],X0),wl=le([Ht,xl,mK,gC],xy);le([vc,nh,Wt],tK);function vC(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var ah=(e,t)=>t,ih=(e,t,r)=>r,EK=le(I0,ah,ih,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(vC)),_K=le(F0,ah,ih,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(vC)),yC=(e,t)=>({width:e.width,height:t.height}),TK=(e,t)=>{var r=typeof t.width=="number"?t.width:oc;return{width:r,height:e.height}},xC=le(dr,ci,yC),AK=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},kK=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},OK=le(li,dr,EK,ah,ih,(e,t,r,n,a)=>{var i={},o;return r.forEach(u=>{var c=yC(t,u);o==null&&(o=AK(t,n,e));var f=n==="top"&&!a||n==="bottom"&&a;i[u.id]=o-Number(f)*c.height,o+=(f?-1:1)*c.height}),i}),PK=le(oi,dr,_K,ah,ih,(e,t,r,n,a)=>{var i={},o;return r.forEach(u=>{var c=TK(t,u);o==null&&(o=kK(t,n,e));var f=n==="left"&&!a||n==="right"&&a;i[u.id]=o-Number(f)*c.width,o+=(f?-1:1)*c.width}),i}),CK=(e,t)=>{var r=ci(e,t);if(r!=null)return OK(e,r.orientation,r.mirror)},NK=le([dr,ci,CK,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),DK=(e,t)=>{var r=fi(e,t);if(r!=null)return PK(e,r.orientation,r.mirror)},MK=le([dr,fi,DK,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),wC=le(dr,fi,(e,t)=>{var r=typeof t.width=="number"?t.width:oc;return{width:r,height:e.height}}),m_=(e,t,r)=>{switch(t){case"xAxis":return xC(e,r).width;case"yAxis":return wC(e,r).height;default:return}},SC=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:o}=r,u=ts(e,n),c=t.map(f=>f.value);if(o&&u&&i==="category"&&a&&jk(c))return c}},Ey=le([ut,rh,Ht,Wt],SC),bC=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,o=ts(e,n);if(o&&(a==="number"||i!=="auto"))return t.map(u=>u.value)}},_y=le([ut,rh,gc,Wt],bC);le([ut,Gz,xl,wl,Ey,_y,yc,Sy,Wt],(e,t,r,n,a,i,o,u,c)=>{if(t==null)return null;var f=ts(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:f,niceTicks:u,range:o,realScaleType:r,scale:n}});var RK=(e,t,r,n,a,i,o,u,c)=>{if(!(t==null||n==null)){var f=ts(e,c),{type:d,ticks:p,tickCount:m}=t,v=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/v:0;x=c==="angleAxis"&&i!=null&&i.length>=2?Fr(i[0]-i[1])*2*x:x;var y=p||a;if(y){var S=y.map((T,k)=>{var A=o?o.indexOf(T):T;return{index:k,coordinate:n(A)+x,value:T,offset:x}});return S.filter(T=>!va(T.coordinate))}return f&&u?u.map((T,k)=>({coordinate:n(T)+x,value:T,index:k,offset:x})):n.ticks?n.ticks(m).map(T=>({coordinate:n(T)+x,value:T,offset:x})):n.domain().map((T,k)=>({coordinate:n(T)+x,value:o?o[T]:T,index:k,offset:x}))}},EC=le([ut,gc,xl,wl,Sy,yc,Ey,_y,Wt],RK),IK=(e,t,r,n,a,i,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var u=ts(e,o),{tickCount:c}=t,f=0;return f=o==="angleAxis"&&n?.length>=2?Fr(n[0]-n[1])*2*f:f,u&&i?i.map((d,p)=>({coordinate:r(d)+f,value:d,index:p,offset:f})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+f,value:d,offset:f})):r.domain().map((d,p)=>({coordinate:r(d)+f,value:a?a[d]:d,index:p,offset:f}))}},qi=le([ut,gc,wl,yc,Ey,_y,Wt],IK),Xi=le(Ht,wl,(e,t)=>{if(!(e==null||t==null))return s0(s0({},e),{},{scale:t})}),FK=le([Ht,xl,yy,gC],xy);le((e,t,r)=>iy(e,r),FK,(e,t)=>{if(!(e==null||t==null))return s0(s0({},e),{},{scale:t})});var jK=le([ut,I0,F0],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),_C=e=>e.options.defaultTooltipEventType,TC=e=>e.options.validateTooltipEventTypes;function AC(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Ty(e,t){var r=_C(e),n=TC(e);return AC(t,r,n)}function LK(e){return Ge(t=>Ty(t,e))}var kC=(e,t)=>{var r,n=Number(t);if(!(va(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},BK=e=>e.tooltip.settings,Wi={active:!1,index:null,dataKey:void 0,coordinate:void 0},$K={itemInteraction:{click:Wi,hover:Wi},axisInteraction:{click:Wi,hover:Wi},keyboardInteraction:Wi,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},OC=Fn({name:"tooltip",initialState:$K,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:en()},removeTooltipEntrySettings:{reducer(e,t){var r=Xa(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:en()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:UK,removeTooltipEntrySettings:WK,setTooltipSettingsState:zK,setActiveMouseOverItemIndex:PC,mouseLeaveItem:KK,mouseLeaveChart:CC,setActiveClickItemIndex:HK,setMouseOverAxisIndex:NC,setMouseClickAxisIndex:VK,setSyncInteraction:Sv,setKeyboardInteraction:bv}=OC.actions,GK=OC.reducer;function g_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function id(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g_(Object(r),!0).forEach(function(n){YK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YK(e,t,r){return(t=qK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qK(e){var t=XK(e,"string");return typeof t=="symbol"?t:t+""}function XK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QK(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function ZK(e){return e.index!=null}var DC=(e,t,r,n)=>{if(t==null)return Wi;var a=QK(e,t,r);if(a==null)return Wi;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(ZK(a)){if(i)return id(id({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return id(id({},Wi),{},{coordinate:a.coordinate})},Ay=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Yr(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},MC=(e,t,r,n,a,i,o,u)=>{if(!(i==null||u==null)){var c=o[0],f=c==null?void 0:u(c.positions,i);if(f!=null)return f;var d=a?.[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},RC=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var o;return((o=i.settings)===null||o===void 0?void 0:o.dataKey)===a})},xc=e=>e.options.tooltipPayloadSearcher,Sl=e=>e.tooltip;function v_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function y_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v_(Object(r),!0).forEach(function(n){JK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JK(e,t,r){return(t=eH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eH(e){var t=tH(e,"string");return typeof t=="symbol"?t:t+""}function tH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rH(e,t){return e??t}var IC=(e,t,r,n,a,i,o)=>{if(!(t==null||i==null)){var{chartData:u,computedData:c,dataStartIndex:f,dataEndIndex:d}=r,p=[];return e.reduce((m,v)=>{var x,{dataDefinedOnItem:y,settings:S}=v,T=rH(y,u),k=Array.isArray(T)?kO(T,f,d):T,A=(x=S?.dataKey)!==null&&x!==void 0?x:n,P=S?.nameKey,N;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&o==="axis"?N=Lk(k,n,a):N=i(k,t,c,P),Array.isArray(N))N.forEach(D=>{var z=y_(y_({},S),{},{name:D.name,unit:D.unit,color:void 0,fill:void 0});m.push(Gb({tooltipEntrySettings:z,dataKey:D.dataKey,payload:D.payload,value:Ct(D.payload,D.dataKey),name:D.name}))});else{var I;m.push(Gb({tooltipEntrySettings:S,dataKey:A,payload:N,value:Ct(N,A),name:(I=Ct(N,P))!==null&&I!==void 0?I:S?.name}))}return m},p)}},ky=le([mr,ut,rC,Z1,pr],pC),nH=le([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),aH=le([pr,gl],sy),wc=le([nH,mr,aH],oy,{memoizeOptions:{resultEqualityCheck:eh}}),iH=le([wc],e=>e.filter(Z0)),sH=le([wc],ly,{memoizeOptions:{resultEqualityCheck:eh}}),bl=le([sH,is],uy),oH=le([iH,is,mr],JP),Oy=le([bl,mr,wc],fy),FC=le([mr],dy),lH=le([mr],e=>e.allowDataOverflow),jC=le([FC,lH],PP),uH=le([wc],e=>e.filter(Z0)),cH=le([oH,uH,pc],sC),fH=le([cH,is,pr,jC],oC),dH=le([wc],aC),hH=le([bl,mr,dH,nh,pr],my,{memoizeOptions:{resultEqualityCheck:J0}}),pH=le([lC,pr,gl],yl),mH=le([pH,pr],fC),gH=le([uC,pr,gl],yl),vH=le([gH,pr],dC),yH=le([cC,pr,gl],yl),xH=le([yH,pr],hC),wH=le([mH,xH,vH],o0),SH=le([mr,FC,jC,fH,hH,wH,ut,pr],gy),LC=le([mr,ut,bl,Oy,pc,pr,SH],vy),bH=le([LC,mr,ky],wy),EH=le([mr,LC,bH,pr],by),BC=e=>{var t=pr(e),r=gl(e),n=!1;return yc(e,t,r,n)},$C=le([mr,BC],X0),UC=le([mr,ky,EH,$C],xy),_H=le([ut,Oy,mr,pr],SC),TH=le([ut,Oy,mr,pr],bC),AH=(e,t,r,n,a,i,o,u)=>{if(t){var{type:c}=t,f=ts(e,u);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return p=u==="angleAxis"&&a!=null&&a?.length>=2?Fr(a[0]-a[1])*2*p:p,f&&o?o.map((m,v)=>({coordinate:n(m)+p,value:m,index:v,offset:p})):n.domain().map((m,v)=>({coordinate:n(m)+p,value:i?i[m]:m,index:v,offset:p}))}}},di=le([ut,mr,ky,UC,BC,_H,TH,pr],AH),Py=le([_C,TC,BK],(e,t,r)=>AC(r.shared,e,t)),WC=e=>e.tooltip.settings.trigger,Cy=e=>e.tooltip.settings.defaultIndex,sh=le([Sl,Py,WC,Cy],DC),Qi=le([sh,bl],Ay),zC=le([di,Qi],kC),KC=le([sh],e=>{if(e)return e.dataKey}),HC=le([Sl,Py,WC,Cy],RC),kH=le([oi,li,ut,dr,di,Cy,HC,xc],MC),OH=le([sh,kH],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),PH=le([sh],e=>e.active),CH=le([HC,Qi,is,ZP,zC,xc,Py],IC),NH=le([CH],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function x_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x_(Object(r),!0).forEach(function(n){DH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DH(e,t,r){return(t=MH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MH(e){var t=RH(e,"string");return typeof t=="symbol"?t:t+""}function RH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IH=()=>Ge(mr),FH=()=>{var e=IH(),t=Ge(di),r=Ge(UC);return Wu(w_(w_({},e),{},{scale:r}),t)},jH=()=>Ge(Z1),Ny=(e,t)=>t,VC=(e,t,r)=>r,Dy=(e,t,r,n)=>n,LH=le(di,e=>P0(e,t=>t.coordinate)),My=le([Sl,Ny,VC,Dy],DC),GC=le([My,bl],Ay),BH=(e,t,r)=>{if(t!=null){var n=Sl(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},YC=le([Sl,Ny,VC,Dy],RC),l0=le([oi,li,ut,dr,di,Dy,YC,xc],MC),$H=le([My,l0],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),qC=le(di,GC,kC),UH=le([YC,GC,is,ZP,qC,xc,Ny],IC),WH=le([My],e=>({isActive:e.active,activeIndex:e.index})),zH=(e,t,r,n,a,i,o,u)=>{if(!(!e||!t||!n||!a||!i)){var c=U$(e.chartX,e.chartY,t,r,u);if(c){var f=z$(c,t),d=O$(f,o,i,n,a),p=W$(t,i,d,c);return{activeIndex:String(d),activeCoordinate:p}}}};function Ev(){return Ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ev.apply(null,arguments)}function S_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S_(Object(r),!0).forEach(function(n){KH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KH(e,t,r){return(t=HH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HH(e){var t=VH(e,"string");return typeof t=="symbol"?t:t+""}function VH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GH(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:o,cursor:u,tooltipEventType:c,chartName:f}=e,d=t,p=r,m=n;if(!u||!d||f!=="ScatterChart"&&c!=="axis")return null;var v,x;if(f==="ScatterChart")v=d,x=s9;else if(f==="BarChart")v=o9(o,d,a,i),x=KO;else if(o==="radial"){var{cx:y,cy:S,radius:T,startAngle:k,endAngle:A}=HO(d);v={cx:y,cy:S,startAngle:k,endAngle:A,innerRadius:T,outerRadius:T},x=GO}else v={points:K9(o,d,a)},x=T1;var P=typeof u=="object"&&"className"in u?u.className:void 0,N=sd(sd(sd(sd({stroke:"#ccc",pointerEvents:"none"},a),v),Ws(u)),{},{payload:p,payloadIndex:m,className:ht("recharts-tooltip-cursor",P)});return _.isValidElement(u)?_.cloneElement(u,N):_.createElement(x,N)}function YH(e){var t=FH(),r=y7(),n=$0(),a=jH();return _.createElement(GH,Ev({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var XC=_.createContext(null),qH=()=>_.useContext(XC),xg={exports:{}},b_;function XH(){return b_||(b_=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,f,d){this.fn=c,this.context=f,this.once=d||!1}function i(c,f,d,p,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var v=new a(d,p||c,m),x=r?r+f:f;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],v]:c._events[x].push(v):(c._events[x]=v,c._eventsCount++),c}function o(c,f){--c._eventsCount===0?c._events=new n:delete c._events[f]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],d,p;if(this._eventsCount===0)return f;for(p in d=this._events)t.call(d,p)&&f.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},u.prototype.listeners=function(f){var d=r?r+f:f,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,v=p.length,x=new Array(v);m<v;m++)x[m]=p[m].fn;return x},u.prototype.listenerCount=function(f){var d=r?r+f:f,p=this._events[d];return p?p.fn?1:p.length:0},u.prototype.emit=function(f,d,p,m,v,x){var y=r?r+f:f;if(!this._events[y])return!1;var S=this._events[y],T=arguments.length,k,A;if(S.fn){switch(S.once&&this.removeListener(f,S.fn,void 0,!0),T){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,d),!0;case 3:return S.fn.call(S.context,d,p),!0;case 4:return S.fn.call(S.context,d,p,m),!0;case 5:return S.fn.call(S.context,d,p,m,v),!0;case 6:return S.fn.call(S.context,d,p,m,v,x),!0}for(A=1,k=new Array(T-1);A<T;A++)k[A-1]=arguments[A];S.fn.apply(S.context,k)}else{var P=S.length,N;for(A=0;A<P;A++)switch(S[A].once&&this.removeListener(f,S[A].fn,void 0,!0),T){case 1:S[A].fn.call(S[A].context);break;case 2:S[A].fn.call(S[A].context,d);break;case 3:S[A].fn.call(S[A].context,d,p);break;case 4:S[A].fn.call(S[A].context,d,p,m);break;default:if(!k)for(N=1,k=new Array(T-1);N<T;N++)k[N-1]=arguments[N];S[A].fn.apply(S[A].context,k)}}return!0},u.prototype.on=function(f,d,p){return i(this,f,d,p,!1)},u.prototype.once=function(f,d,p){return i(this,f,d,p,!0)},u.prototype.removeListener=function(f,d,p,m){var v=r?r+f:f;if(!this._events[v])return this;if(!d)return o(this,v),this;var x=this._events[v];if(x.fn)x.fn===d&&(!m||x.once)&&(!p||x.context===p)&&o(this,v);else{for(var y=0,S=[],T=x.length;y<T;y++)(x[y].fn!==d||m&&!x[y].once||p&&x[y].context!==p)&&S.push(x[y]);S.length?this._events[v]=S.length===1?S[0]:S:o(this,v)}return this},u.prototype.removeAllListeners=function(f){var d;return f?(d=r?r+f:f,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u}(xg)),xg.exports}var QH=XH();const ZH=Na(QH);var qu=new ZH,_v="recharts.syncEvent.tooltip",E_="recharts.syncEvent.brush";function Ry(e,t){if(t){var r=Number.parseInt(t,10);if(!va(r))return e?.[r]}}var JH={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},QC=Fn({name:"options",initialState:JH,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),eV=QC.reducer,{createEventEmitter:tV}=QC.actions;function rV(e){return e.tooltip.syncInteraction}var nV={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},ZC=Fn({name:"chartData",initialState:nV,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:__,setDataStartEndIndexes:aV,setComputedData:sJ}=ZC.actions,iV=ZC.reducer,sV=["x","y"];function T_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T_(Object(r),!0).forEach(function(n){oV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oV(e,t,r){return(t=lV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lV(e){var t=uV(e,"string");return typeof t=="symbol"?t:t+""}function uV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cV(e,t){if(e==null)return{};var r,n,a=fV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var JC=()=>{};function dV(){var e=Ge(J1),t=Ge(ey),r=Ut(),n=Ge(VP),a=Ge(di),i=$0(),o=B0(),u=Ge(c=>c.rootProps.className);_.useEffect(()=>{if(e==null)return JC;var c=(f,d,p)=>{if(t!==p&&e===f){if(n==="index"){var m;if(o&&d!==null&&d!==void 0&&(m=d.payload)!==null&&m!==void 0&&m.coordinate&&d.payload.sourceViewBox){var v=d.payload.coordinate,{x,y}=v,S=cV(v,sV),{x:T,y:k,width:A,height:P}=d.payload.sourceViewBox,N=jo(jo({},S),{},{x:o.x+(A?(x-T)/A:0)*o.width,y:o.y+(P?(y-k)/P:0)*o.height});r(jo(jo({},d),{},{payload:jo(jo({},d.payload),{},{coordinate:N})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var D={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},z=n(a,D);I=a[z]}else n==="value"&&(I=a.find(Te=>String(Te.value)===d.payload.label));var{coordinate:H}=d.payload;if(I==null||d.payload.active===!1||H==null||o==null){r(Sv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:te,y:q}=H,V=Math.min(te,o.x+o.width),ae=Math.min(q,o.y+o.height),Ee={x:i==="horizontal"?I.coordinate:V,y:i==="horizontal"?ae:I.coordinate},Z=Sv({active:d.payload.active,coordinate:Ee,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox});r(Z)}}};return qu.on(_v,c),()=>{qu.off(_v,c)}},[u,r,t,e,n,a,i,o])}function hV(){var e=Ge(J1),t=Ge(ey),r=Ut();_.useEffect(()=>{if(e==null)return JC;var n=(a,i,o)=>{t!==o&&e===a&&r(aV(i))};return qu.on(E_,n),()=>{qu.off(E_,n)}},[r,t,e])}function pV(){var e=Ut();_.useEffect(()=>{e(tV())},[e]),dV(),hV()}function mV(e,t,r,n,a,i){var o=Ge(v=>BH(v,e,t)),u=Ge(ey),c=Ge(J1),f=Ge(VP),d=Ge(rV),p=d?.active,m=B0();_.useEffect(()=>{if(!p&&c!=null&&u!=null){var v=Sv({active:i,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:m});qu.emit(_v,c,v,u)}},[p,r,o,a,n,u,c,f,i,m])}function A_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A_(Object(r),!0).forEach(function(n){gV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gV(e,t,r){return(t=vV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vV(e){var t=yV(e,"string");return typeof t=="symbol"?t:t+""}function yV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xV(e){return e.dataKey}function wV(e,t){return _.isValidElement(e)?_.cloneElement(e,t):typeof e=="function"?_.createElement(e,t):_.createElement(L7,t)}var O_=[],SV={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!rs.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function od(e){var t=qr(e,SV),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:o,filterNull:u,isAnimationActive:c,offset:f,payloadUniqBy:d,position:p,reverseDirection:m,useTranslate3d:v,wrapperStyle:x,cursor:y,shared:S,trigger:T,defaultIndex:k,portal:A,axisId:P}=t,N=Ut(),I=typeof k=="number"?String(k):k;_.useEffect(()=>{N(zK({shared:S,trigger:T,axisId:P,active:r,defaultIndex:I}))},[N,S,T,P,r,I]);var D=B0(),z=BO(),H=LK(S),{activeIndex:te,isActive:q}=Ge(K=>WH(K,H,T,I)),V=Ge(K=>UH(K,H,T,I)),ae=Ge(K=>qC(K,H,T,I)),Ee=Ge(K=>$H(K,H,T,I)),Z=V,Te=qH(),Se=r??q,[me,we]=Jk([Z,Se]),be=H==="axis"?ae:void 0;mV(H,T,Ee,be,te,Se);var X=A??Te;if(X==null)return null;var M=Z??O_;Se||(M=O_),u&&M.length&&(M=Yk(Z.filter(K=>K.value!=null&&(K.hide!==!0||t.includeHidden)),d,xV));var J=M.length>0,G=_.createElement(H7,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:Se,coordinate:Ee,hasPayload:J,offset:f,position:p,reverseDirection:m,useTranslate3d:v,viewBox:D,wrapperStyle:x,lastBoundingBox:me,innerRef:we,hasPortalFromProps:!!A},wV(o,k_(k_({},t),{},{payload:M,label:be,active:Se,coordinate:Ee,accessibilityLayer:z})));return _.createElement(_.Fragment,null,yk.createPortal(G,X),Se&&_.createElement(YH,{cursor:y,tooltipEventType:H,coordinate:Ee,payload:Z,index:te}))}var Sc=e=>null;Sc.displayName="Cell";function bV(e,t,r){return(t=EV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EV(e){var t=_V(e,"string");return typeof t=="symbol"?t:t+""}function _V(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class TV{constructor(t){bV(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function P_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P_(Object(r),!0).forEach(function(n){kV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kV(e,t,r){return(t=OV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OV(e){var t=PV(e,"string");return typeof t=="symbol"?t:t+""}function PV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CV={cacheSize:2e3,enableCache:!0},e4=AV({},CV),C_=new TV(e4.cacheSize),NV={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},N_="recharts_measurement_span";function DV(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",u=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(o,"|").concat(u)}var D_=(e,t)=>{try{var r=document.getElementById(N_);r||(r=document.createElement("span"),r.setAttribute("id",N_),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,NV,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Nu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||rs.isSsr)return{width:0,height:0};if(!e4.enableCache)return D_(t,r);var n=DV(t,r),a=C_.get(n);if(a)return a;var i=D_(t,r);return C_.set(n,i),i},M_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,R_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,MV=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,RV=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,t4={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},IV=Object.keys(t4),Wo="NaN";function FV(e,t){return e*t4[t]}class hn{static parse(t){var r,[,n,a]=(r=RV.exec(t))!==null&&r!==void 0?r:[];return new hn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,va(t)&&(this.unit=""),r!==""&&!MV.test(r)&&(this.num=NaN,this.unit=""),IV.includes(r)&&(this.num=FV(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new hn(NaN,""):new hn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new hn(NaN,""):new hn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new hn(NaN,""):new hn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new hn(NaN,""):new hn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return va(this.num)}}function r4(e){if(e.includes(Wo))return Wo;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=M_.exec(t))!==null&&r!==void 0?r:[],o=hn.parse(n??""),u=hn.parse(i??""),c=a==="*"?o.multiply(u):o.divide(u);if(c.isNaN())return Wo;t=t.replace(M_,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,d,p,m]=(f=R_.exec(t))!==null&&f!==void 0?f:[],v=hn.parse(d??""),x=hn.parse(m??""),y=p==="+"?v.add(x):v.subtract(x);if(y.isNaN())return Wo;t=t.replace(R_,y.toString())}return t}var I_=/\(([^()]*)\)/;function jV(e){for(var t=e,r;(r=I_.exec(t))!=null;){var[,n]=r;t=t.replace(I_,r4(n))}return t}function LV(e){var t=e.replace(/\s+/g,"");return t=jV(t),t=r4(t),t}function BV(e){try{return LV(e)}catch{return Wo}}function wg(e){var t=BV(e.slice(5,-1));return t===Wo?"":t}var $V=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],UV=["dx","dy","angle","className","breakAll"];function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(null,arguments)}function F_(e,t){if(e==null)return{};var r,n,a=WV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var n4=/[ \f\n\r\t\v\u2028\u2029]+/,a4=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];$t(t)||(r?a=t.toString().split(""):a=t.toString().split(n4));var i=a.map(u=>({word:u,width:Nu(u,n).width})),o=r?0:Nu(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}},zV=(e,t,r,n,a)=>{var{maxLines:i,children:o,style:u,breakAll:c}=e,f=Je(i),d=o,p=function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q.reduce((V,ae)=>{var{word:Ee,width:Z}=ae,Te=V[V.length-1];if(Te&&(n==null||a||Te.width+Z+r<Number(n)))Te.words.push(Ee),Te.width+=Z+r;else{var Se={words:[Ee],width:Z};V.push(Se)}return V},[])},m=p(t),v=te=>te.reduce((q,V)=>q.width>V.width?q:V);if(!f||a)return m;var x=m.length>i||v(m).width>Number(n);if(!x)return m;for(var y="…",S=te=>{var q=d.slice(0,te),V=a4({breakAll:c,style:u,children:q+y}).wordsWithComputedWidth,ae=p(V),Ee=ae.length>i||v(ae).width>Number(n);return[Ee,ae]},T=0,k=d.length-1,A=0,P;T<=k&&A<=d.length-1;){var N=Math.floor((T+k)/2),I=N-1,[D,z]=S(I),[H]=S(N);if(!D&&!H&&(T=N+1),D&&H&&(k=N-1),!D&&H){P=z;break}A++}return P||m},j_=e=>{var t=$t(e)?[]:e.toString().split(n4);return[{words:t}]},KV=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:o}=e;if((t||r)&&!rs.isSsr){var u,c,f=a4({breakAll:i,children:n,style:a});if(f){var{wordsWithComputedWidth:d,spaceWidth:p}=f;u=d,c=p}else return j_(n);return zV({breakAll:i,children:n,maxLines:o,style:a},u,c,t,r)}return j_(n)},L_="#808080",oh=_.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:o=!1,textAnchor:u="start",verticalAnchor:c="end",fill:f=L_}=e,d=F_(e,$V),p=_.useMemo(()=>KV({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:o,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,o,d.style,d.width]),{dx:m,dy:v,angle:x,className:y,breakAll:S}=d,T=F_(d,UV);if(!Pa(r)||!Pa(n)||p.length===0)return null;var k=r+(Je(m)?m:0),A=n+(Je(v)?v:0),P;switch(c){case"start":P=wg("calc(".concat(i,")"));break;case"middle":P=wg("calc(".concat((p.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:P=wg("calc(".concat(p.length-1," * -").concat(a,")"));break}var N=[];if(o){var I=p[0].width,{width:D}=d;N.push("scale(".concat(Je(D)?D/I:1,")"))}return x&&N.push("rotate(".concat(x,", ").concat(k,", ").concat(A,")")),N.length&&(T.transform=N.join(" ")),_.createElement("text",Tv({},an(T),{ref:t,x:k,y:A,className:ht("recharts-text",y),textAnchor:u,fill:f.includes("url")?L_:f}),p.map((z,H)=>{var te=z.words.join(S?"":" ");return _.createElement("tspan",{x:k,dy:H===0?P:a,key:"".concat(te,"-").concat(H)},te)}))});oh.displayName="Text";var HV=["labelRef"];function VV(e,t){if(e==null)return{};var r,n,a=GV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function GV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function B_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(r),!0).forEach(function(n){YV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YV(e,t,r){return(t=qV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qV(e){var t=XV(e,"string");return typeof t=="symbol"?t:t+""}function XV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ka(){return Ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ka.apply(null,arguments)}var i4=_.createContext(null),QV=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,o=_.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return _.createElement(i4.Provider,{value:o},i)},s4=()=>{var e=_.useContext(i4),t=B0();return e||t},ZV=_.createContext(null),JV=()=>{var e=_.useContext(ZV),t=Ge(QP);return e||t},eG=e=>{var{value:t,formatter:r}=e,n=$t(e.children)?t:e.children;return typeof r=="function"?r(n):n},Iy=e=>e!=null&&typeof e=="function",tG=(e,t)=>{var r=Fr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},rG=(e,t,r,n,a)=>{var{offset:i,className:o}=e,{cx:u,cy:c,innerRadius:f,outerRadius:d,startAngle:p,endAngle:m,clockWise:v}=a,x=(f+d)/2,y=tG(p,m),S=y>=0?1:-1,T,k;switch(t){case"insideStart":T=p+S*i,k=v;break;case"insideEnd":T=m-S*i,k=!v;break;case"end":T=m+S*i,k=v;break;default:throw new Error("Unsupported position ".concat(t))}k=y<=0?k:!k;var A=nr(u,c,x,T),P=nr(u,c,x,T+(k?1:-1)*359),N="M".concat(A.x,",").concat(A.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(k?0:1,`,
    `).concat(P.x,",").concat(P.y),I=$t(e.id)?Bu("recharts-radial-line-"):e.id;return _.createElement("text",Ka({},n,{dominantBaseline:"central",className:ht("recharts-radial-bar-label",o)}),_.createElement("defs",null,_.createElement("path",{id:I,d:N})),_.createElement("textPath",{xlinkHref:"#".concat(I)},r))},nG=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:u,endAngle:c}=e,f=(u+c)/2;if(r==="outside"){var{x:d,y:p}=nr(n,a,o+t,f);return{x:d,y:p,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(i+o)/2,{x:v,y:x}=nr(n,a,m,f);return{x:v,y:x,textAnchor:"middle",verticalAnchor:"middle"}},o4=e=>"cx"in e&&Je(e.cx),aG=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!o4(r)&&(i=r);var{x:o,y:u,width:c,height:f}=t,d=f>=0?1:-1,p=d*n,m=d>0?"end":"start",v=d>0?"start":"end",x=c>=0?1:-1,y=x*n,S=x>0?"end":"start",T=x>0?"start":"end";if(a==="top"){var k={x:o+c/2,y:u-d*n,textAnchor:"middle",verticalAnchor:m};return er(er({},k),i?{height:Math.max(u-i.y,0),width:c}:{})}if(a==="bottom"){var A={x:o+c/2,y:u+f+p,textAnchor:"middle",verticalAnchor:v};return er(er({},A),i?{height:Math.max(i.y+i.height-(u+f),0),width:c}:{})}if(a==="left"){var P={x:o-y,y:u+f/2,textAnchor:S,verticalAnchor:"middle"};return er(er({},P),i?{width:Math.max(P.x-i.x,0),height:f}:{})}if(a==="right"){var N={x:o+c+y,y:u+f/2,textAnchor:T,verticalAnchor:"middle"};return er(er({},N),i?{width:Math.max(i.x+i.width-N.x,0),height:f}:{})}var I=i?{width:c,height:f}:{};return a==="insideLeft"?er({x:o+y,y:u+f/2,textAnchor:T,verticalAnchor:"middle"},I):a==="insideRight"?er({x:o+c-y,y:u+f/2,textAnchor:S,verticalAnchor:"middle"},I):a==="insideTop"?er({x:o+c/2,y:u+p,textAnchor:"middle",verticalAnchor:v},I):a==="insideBottom"?er({x:o+c/2,y:u+f-p,textAnchor:"middle",verticalAnchor:m},I):a==="insideTopLeft"?er({x:o+y,y:u+p,textAnchor:T,verticalAnchor:v},I):a==="insideTopRight"?er({x:o+c-y,y:u+p,textAnchor:S,verticalAnchor:v},I):a==="insideBottomLeft"?er({x:o+y,y:u+f-p,textAnchor:T,verticalAnchor:m},I):a==="insideBottomRight"?er({x:o+c-y,y:u+f-p,textAnchor:S,verticalAnchor:m},I):a&&typeof a=="object"&&(Je(a.x)||ti(a.x))&&(Je(a.y)||ti(a.y))?er({x:o+Gr(a.x,c),y:u+Gr(a.y,f),textAnchor:"end",verticalAnchor:"end"},I):er({x:o+c/2,y:u+f/2,textAnchor:"middle",verticalAnchor:"middle"},I)},iG={offset:5};function Ui(e){var t=qr(e,iG),{viewBox:r,position:n,value:a,children:i,content:o,className:u="",textBreakAll:c,labelRef:f}=t,d=JV(),p=s4(),m=n==="center"?p:d??p,v=r||m;if(!v||$t(a)&&$t(i)&&!_.isValidElement(o)&&typeof o!="function")return null;var x=er(er({},t),{},{viewBox:v});if(_.isValidElement(o)){var{labelRef:y}=x,S=VV(x,HV);return _.cloneElement(o,S)}var T;if(typeof o=="function"){if(T=_.createElement(o,x),_.isValidElement(T))return T}else T=eG(t);var k=o4(v),A=an(t);if(k&&(n==="insideStart"||n==="insideEnd"||n==="end"))return rG(t,n,T,A,v);var P=k?nG(v,t.offset,t.position):aG(t,v);return _.createElement(oh,Ka({ref:f,className:ht("recharts-label",u)},A,P,{breakAll:c}),T)}Ui.displayName="Label";var sG=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?_.createElement(Ui,Ka({key:"label-implicit"},n)):Pa(e)?_.createElement(Ui,Ka({key:"label-implicit",value:e},n)):_.isValidElement(e)?e.type===Ui?_.cloneElement(e,er({key:"label-implicit"},n)):_.createElement(Ui,Ka({key:"label-implicit",content:e},n)):Iy(e)?_.createElement(Ui,Ka({key:"label-implicit",content:e},n)):e&&typeof e=="object"?_.createElement(Ui,Ka({},e,{key:"label-implicit"},n)):null};function oG(e){var{label:t,labelRef:r}=e,n=s4();return sG(t,n,r)||null}var Sg={},bg={},$_;function lG(){return $_||($_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t}(bg)),bg}var Eg={},U_;function uG(){return U_||(U_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t}(Eg)),Eg}var W_;function cG(){return W_||(W_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lG(),r=uG(),n=p1();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a}(Sg)),Sg}var _g,z_;function fG(){return z_||(z_=1,_g=cG().last),_g}var dG=fG();const hG=Na(dG);var pG=["valueAccessor"],mG=["dataKey","clockWise","id","textBreakAll"];function u0(){return u0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u0.apply(null,arguments)}function K_(e,t){if(e==null)return{};var r,n,a=gG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vG=e=>Array.isArray(e.value)?hG(e.value):e.value,l4=_.createContext(void 0),u4=l4.Provider,c4=_.createContext(void 0),yG=c4.Provider;function xG(){return _.useContext(l4)}function wG(){return _.useContext(c4)}function fd(e){var{valueAccessor:t=vG}=e,r=K_(e,pG),{dataKey:n,clockWise:a,id:i,textBreakAll:o}=r,u=K_(r,mG),c=xG(),f=wG(),d=c||f;return!d||!d.length?null:_.createElement(Br,{className:"recharts-label-list"},d.map((p,m)=>{var v,x=$t(n)?t(p,m):Ct(p&&p.payload,n),y=$t(i)?{}:{id:"".concat(i,"-").concat(m)};return _.createElement(Ui,u0({key:"label-".concat(m)},an(p),u,y,{fill:(v=r.fill)!==null&&v!==void 0?v:p.fill,parentViewBox:p.parentViewBox,value:x,textBreakAll:o,viewBox:p.viewBox,index:m}))}))}fd.displayName="LabelList";function Fy(e){var{label:t}=e;return t?t===!0?_.createElement(fd,{key:"labelList-implicit"}):_.isValidElement(t)||Iy(t)?_.createElement(fd,{key:"labelList-implicit",content:t}):typeof t=="object"?_.createElement(fd,u0({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(null,arguments)}var f4=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=ht("recharts-dot",a);return t===+t&&r===+r&&n===+n?_.createElement("circle",Av({},Qn(e),f1(e),{className:i,cx:t,cy:r,r:n})):null},d4=e=>e.graphicalItems.polarItems,SG=le([Wt,mc],sy),lh=le([d4,Ht,SG],oy),bG=le([lh],ly),uh=le([bG,q1],uy),EG=le([uh,Ht,lh],fy);le([uh,Ht,lh],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,o=Ct(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Ct(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var H_=()=>{},_G=le([uh,Ht,lh,nh,Wt],my),TG=le([Ht,hy,py,H_,_G,H_,ut,Wt],gy),h4=le([Ht,ut,uh,EG,pc,Wt,TG],vy),AG=le([h4,Ht,xl],wy);le([Ht,h4,AG,Wt],by);var kG={radiusAxis:{},angleAxis:{}},p4=Fn({name:"polarAxis",initialState:kG,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:oJ,removeRadiusAxis:lJ,addAngleAxis:uJ,removeAngleAxis:cJ}=p4.actions,OG=p4.reducer;function V_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function G_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V_(Object(r),!0).forEach(function(n){PG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PG(e,t,r){return(t=CG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CG(e){var t=NG(e,"string");return typeof t=="symbol"?t:t+""}function NG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DG=(e,t)=>t,jy=le([d4,DG],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),MG=[],Ly=(e,t,r)=>r?.length===0?MG:r,m4=le([q1,jy,Ly],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>G_(G_({},t.presentationProps),i.props))),a!=null)return a}}),RG=le([m4,jy,Ly],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,o=Ct(n,t.nameKey,t.name),u;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?u=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?u=n.fill:u=t.fill,{value:dl(o,t.dataKey),color:u,payload:n,type:t.legendType}})}),IG=le([m4,jy,Ly,dr],(e,t,r,n)=>{if(!(t==null||e==null))return IY({offset:n,pieSettings:t,displayedData:e,cells:r})}),Tg={exports:{}},Et={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function FG(){if(Y_)return Et;Y_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function x(y){if(typeof y=="object"&&y!==null){var S=y.$$typeof;switch(S){case e:switch(y=y.type,y){case r:case a:case n:case c:case f:case m:return y;default:switch(y=y&&y.$$typeof,y){case o:case u:case p:case d:return y;case i:return y;default:return S}}case t:return S}}}return Et.ContextConsumer=i,Et.ContextProvider=o,Et.Element=e,Et.ForwardRef=u,Et.Fragment=r,Et.Lazy=p,Et.Memo=d,Et.Portal=t,Et.Profiler=a,Et.StrictMode=n,Et.Suspense=c,Et.SuspenseList=f,Et.isContextConsumer=function(y){return x(y)===i},Et.isContextProvider=function(y){return x(y)===o},Et.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===e},Et.isForwardRef=function(y){return x(y)===u},Et.isFragment=function(y){return x(y)===r},Et.isLazy=function(y){return x(y)===p},Et.isMemo=function(y){return x(y)===d},Et.isPortal=function(y){return x(y)===t},Et.isProfiler=function(y){return x(y)===a},Et.isStrictMode=function(y){return x(y)===n},Et.isSuspense=function(y){return x(y)===c},Et.isSuspenseList=function(y){return x(y)===f},Et.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===n||y===c||y===f||typeof y=="object"&&y!==null&&(y.$$typeof===p||y.$$typeof===d||y.$$typeof===o||y.$$typeof===i||y.$$typeof===u||y.$$typeof===v||y.getModuleId!==void 0)},Et.typeOf=x,Et}var q_;function jG(){return q_||(q_=1,Tg.exports=FG()),Tg.exports}var LG=jG(),X_=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Q_=null,Ag=null,g4=e=>{if(e===Q_&&Array.isArray(Ag))return Ag;var t=[];return _.Children.forEach(e,r=>{$t(r)||(LG.isFragment(r)?t=t.concat(g4(r.props.children)):t.push(r))}),Ag=t,Q_=e,t};function By(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>X_(a)):n=[X_(t)],g4(e).forEach(a=>{var i=zs(a,"type.displayName")||zs(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var v4=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,kg={},Z_;function BG(){return Z_||(Z_=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t}(kg)),kg}var Og,J_;function $G(){return J_||(J_=1,Og=BG().isPlainObject),Og}var UG=$G();const WG=Na(UG);function eT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eT(Object(r),!0).forEach(function(n){zG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zG(e,t,r){return(t=KG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KG(e){var t=HG(e,"string");return typeof t=="symbol"?t:t+""}function HG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c0(){return c0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c0.apply(null,arguments)}var rT=(e,t,r,n,a)=>{var i=r-n,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-i/2,",").concat(t+a),o+="L ".concat(e+r-i/2-n,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z"),o},VG={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},GG=e=>{var t=qr(e,VG),{x:r,y:n,upperWidth:a,lowerWidth:i,height:o,className:u}=t,{animationEasing:c,animationDuration:f,animationBegin:d,isUpdateAnimationActive:p}=t,m=_.useRef(null),[v,x]=_.useState(-1),y=_.useRef(a),S=_.useRef(i),T=_.useRef(o),k=_.useRef(r),A=_.useRef(n),P=uc(e,"trapezoid-");if(_.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var Ee=m.current.getTotalLength();Ee&&x(Ee)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||o!==+o||a===0&&i===0||o===0)return null;var N=ht("recharts-trapezoid",u);if(!p)return _.createElement("g",null,_.createElement("path",c0({},an(t),{className:N,d:rT(r,n,a,i,o)})));var I=y.current,D=S.current,z=T.current,H=k.current,te=A.current,q="0px ".concat(v===-1?1:v,"px"),V="".concat(v,"px 0px"),ae=$O(["strokeDasharray"],f,c);return _.createElement(lc,{animationId:P,key:P,canBegin:v>0,duration:f,easing:c,isActive:p,begin:d},Ee=>{var Z=qt(I,a,Ee),Te=qt(D,i,Ee),Se=qt(z,o,Ee),me=qt(H,r,Ee),we=qt(te,n,Ee);m.current&&(y.current=Z,S.current=Te,T.current=Se,k.current=me,A.current=we);var be=Ee>0?{transition:ae,strokeDasharray:V}:{strokeDasharray:q};return _.createElement("path",c0({},an(t),{className:N,d:rT(me,we,Z,Te,Se),ref:m,style:tT(tT({},be),t.style)}))})},YG=["option","shapeType","propTransformer","activeClassName","isActive"];function qG(e,t){if(e==null)return{};var r,n,a=XG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function XG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function nT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nT(Object(r),!0).forEach(function(n){QG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QG(e,t,r){return(t=ZG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZG(e){var t=JG(e,"string");return typeof t=="symbol"?t:t+""}function JG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eY(e,t){return f0(f0({},t),e)}function tY(e,t){return e==="symbols"}function aT(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return _.createElement(KO,r);case"trapezoid":return _.createElement(GG,r);case"sector":return _.createElement(GO,r);case"symbols":if(tY(t))return _.createElement(c1,r);break;default:return null}}function rY(e){return _.isValidElement(e)?e.props:e}function y4(e){var{option:t,shapeType:r,propTransformer:n=eY,activeClassName:a="recharts-active-shape",isActive:i}=e,o=qG(e,YG),u;if(_.isValidElement(t))u=_.cloneElement(t,f0(f0({},o),rY(t)));else if(typeof t=="function")u=t(o);else if(WG(t)&&typeof t!="boolean"){var c=n(t,o);u=_.createElement(aT,{shapeType:r,elementProps:c})}else{var f=o;u=_.createElement(aT,{shapeType:r,elementProps:f})}return i?_.createElement(Br,{className:a},u):u}var $y=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(PC({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Uy=e=>{var t=Ut();return(r,n)=>a=>{e?.(r,n,a),t(KK())}},Wy=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(HK({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function zy(e){var{fn:t,args:r}=e,n=Ut(),a=yn();return _.useLayoutEffect(()=>{if(!a){var i=t(r);return n(UK(i)),()=>{n(WK(i))}}},[t,r,n,a]),null}var x4=()=>{};function w4(e){var{legendPayload:t}=e,r=Ut(),n=yn();return _.useLayoutEffect(()=>n?x4:(r(jO(t)),()=>{r(LO(t))}),[r,n,t]),null}function nY(e){var{legendPayload:t}=e,r=Ut(),n=Ge(ut);return _.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?x4:(r(jO(t)),()=>{r(LO(t))}),[r,n,t]),null}var Pg,aY=()=>{var[e]=_.useState(()=>Bu("uid-"));return e},iY=(Pg=K3.useId)!==null&&Pg!==void 0?Pg:aY;function sY(e,t){var r=iY();return t||(e?"".concat(e,"-").concat(r):r)}var oY=_.createContext(void 0),Ky=e=>{var{id:t,type:r,children:n}=e,a=sY("recharts-".concat(r),t);return _.createElement(oY.Provider,{value:a},n(a))},lY={cartesianItems:[],polarItems:[]},S4=Fn({name:"graphicalItems",initialState:lY,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:en()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Xa(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:en()},removeCartesianGraphicalItem:{reducer(e,t){var r=Xa(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:en()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:en()},removePolarGraphicalItem:{reducer(e,t){var r=Xa(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:en()}}}),{addCartesianGraphicalItem:uY,replaceCartesianGraphicalItem:cY,removeCartesianGraphicalItem:fY,addPolarGraphicalItem:dY,removePolarGraphicalItem:hY}=S4.actions,pY=S4.reducer;function b4(e){var t=Ut(),r=_.useRef(null);return _.useLayoutEffect(()=>{r.current===null?t(uY(e)):r.current!==e&&t(cY({prev:r.current,next:e})),r.current=e},[t,e]),_.useLayoutEffect(()=>()=>{r.current&&(t(fY(r.current)),r.current=null)},[t]),null}function mY(e){var t=Ut();return _.useLayoutEffect(()=>(t(dY(e)),()=>{t(hY(e))}),[t,e]),null}var gY=["onMouseEnter","onClick","onMouseLeave"],vY=["id"],yY=["id"];function Hy(e,t){if(e==null)return{};var r,n,a=xY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function iT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iT(Object(r),!0).forEach(function(n){wY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wY(e,t,r){return(t=SY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SY(e){var t=bY(e,"string");return typeof t=="symbol"?t:t+""}function bY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zi(){return Zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zi.apply(null,arguments)}function EY(e){var t=_.useMemo(()=>By(e.children,Sc),[e.children]),r=Ge(n=>RG(n,e.id,t));return r==null?null:_.createElement(nY,{legendPayload:r})}function _Y(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:o,name:u,hide:c,tooltipType:f}=e;return{dataDefinedOnItem:n.map(d=>d.tooltipPayload),positions:n.map(d=>d.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:dl(u,t),hide:c,type:f,color:o,unit:""}}}var TY=(e,t)=>e>t?"start":e<t?"end":"middle",AY=(e,t,r)=>Gr(typeof t=="function"?t(e):t,r,r*.8),kY=(e,t,r)=>{var{top:n,left:a,width:i,height:o}=t,u=AO(i,o),c=a+Gr(e.cx,i,i/2),f=n+Gr(e.cy,o,o/2),d=Gr(e.innerRadius,u,0),p=AY(r,e.outerRadius,u),m=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:f,innerRadius:d,outerRadius:p,maxRadius:m}},OY=(e,t)=>{var r=Fr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function PY(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var CY=(e,t)=>{if(_.isValidElement(e))return _.cloneElement(e,t);if(typeof e=="function")return e(t);var r=ht("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return _.createElement(T1,Zi({},t,{type:"linear",className:r}))},NY=(e,t,r)=>{if(_.isValidElement(e))return _.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),_.isValidElement(n)))return n;var a=ht("recharts-pie-label-text",PY(e));return _.createElement(oh,Zi({},t,{alignmentBaseline:"middle",className:a}),n)};function DY(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:o}=r;if(!n||!a||!t)return null;var u=Qn(r),c=Ws(a),f=Ws(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,p=t.map((m,v)=>{var x=(m.startAngle+m.endAngle)/2,y=nr(m.cx,m.cy,m.outerRadius+d,x),S=jt(jt(jt(jt({},u),m),{},{stroke:"none"},c),{},{index:v,textAnchor:TY(y.x,m.cx)},y),T=jt(jt(jt(jt({},u),m),{},{fill:"none",stroke:m.fill},f),{},{index:v,points:[nr(m.cx,m.cy,m.outerRadius,x),y],key:"line"});return _.createElement(Br,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(v)},i&&CY(i,T),NY(a,S,Ct(m,o)))});return _.createElement(Br,{className:"recharts-pie-labels"},p)}function MY(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?_.createElement(Fy,{label:a}):_.createElement(DY,{sectors:t,props:r,showLabels:n})}function RY(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=Ge(Qi),{onMouseEnter:o,onClick:u,onMouseLeave:c}=a,f=Hy(a,gY),d=$y(o,a.dataKey),p=Uy(c),m=Wy(u,a.dataKey);return t==null||t.length===0?null:_.createElement(_.Fragment,null,t.map((v,x)=>{if(v?.startAngle===0&&v?.endAngle===0&&t.length!==1)return null;var y=r&&String(x)===i,S=i?n:null,T=y?r:S,k=jt(jt({},v),{},{stroke:v.stroke,tabIndex:-1,[PO]:x,[CO]:a.dataKey});return _.createElement(Br,Zi({key:"sector-".concat(v?.startAngle,"-").concat(v?.endAngle,"-").concat(v.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},ac(f,v,x),{onMouseEnter:d(v,x),onMouseLeave:p(v,x),onClick:m(v,x)}),_.createElement(y4,Zi({option:T,isActive:y,shapeType:"sector"},k)))}))}function IY(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:o,startAngle:u,endAngle:c,dataKey:f,nameKey:d,tooltipType:p}=r,m=Math.abs(r.minAngle),v=OY(u,c),x=Math.abs(v),y=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,S=n.filter(I=>Ct(I,f,0)!==0).length,T=(x>=360?S:S-1)*y,k=x-S*m-T,A=n.reduce((I,D)=>{var z=Ct(D,f,0);return I+(Je(z)?z:0)},0),P;if(A>0){var N;P=n.map((I,D)=>{var z=Ct(I,f,0),H=Ct(I,d,D),te=kY(r,i,I),q=(Je(z)?z:0)/A,V,ae=jt(jt({},I),a&&a[D]&&a[D].props);D?V=N.endAngle+Fr(v)*y*(z!==0?1:0):V=u;var Ee=V+Fr(v)*((z!==0?m:0)+q*k),Z=(V+Ee)/2,Te=(te.innerRadius+te.outerRadius)/2,Se=[{name:H,value:z,payload:ae,dataKey:f,type:p}],me=nr(te.cx,te.cy,Te,Z);return N=jt(jt(jt(jt({},r.presentationProps),{},{percent:q,cornerRadius:o,name:H,tooltipPayload:Se,midAngle:Z,middleRadius:Te,tooltipPosition:me},ae),te),{},{value:z,startAngle:V,endAngle:Ee,payload:ae,paddingAngle:Fr(v)*y}),N})}return P}function FY(e){var{showLabels:t,sectors:r,children:n}=e,a=_.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return _.createElement(yG,{value:t?a:void 0},n)}function jY(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:o,animationEasing:u,activeShape:c,inactiveShape:f,onAnimationStart:d,onAnimationEnd:p}=t,m=uc(t,"recharts-pie-"),v=r.current,[x,y]=_.useState(!1),S=_.useCallback(()=>{typeof p=="function"&&p(),y(!1)},[p]),T=_.useCallback(()=>{typeof d=="function"&&d(),y(!0)},[d]);return _.createElement(FY,{showLabels:!x,sectors:n},_.createElement(lc,{animationId:m,begin:i,duration:o,isActive:a,easing:u,onAnimationStart:T,onAnimationEnd:S,key:m},k=>{var A=[],P=n&&n[0],N=P?.startAngle;return n?.forEach((I,D)=>{var z=v&&v[D],H=D>0?zs(I,"paddingAngle",0):0;if(z){var te=qt(z.endAngle-z.startAngle,I.endAngle-I.startAngle,k),q=jt(jt({},I),{},{startAngle:N+H,endAngle:N+te+H});A.push(q),N=q.endAngle}else{var{endAngle:V,startAngle:ae}=I,Ee=qt(0,V-ae,k),Z=jt(jt({},I),{},{startAngle:N+H,endAngle:N+Ee+H});A.push(Z),N=Z.endAngle}}),r.current=A,_.createElement(Br,null,_.createElement(RY,{sectors:A,activeShape:c,inactiveShape:f,allOtherPieProps:t}))}),_.createElement(MY,{showLabels:!x,sectors:n,props:t}),t.children)}var LY={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!rs.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function BY(e){var{id:t}=e,r=Hy(e,vY),{hide:n,className:a,rootTabIndex:i}=e,o=_.useMemo(()=>By(e.children,Sc),[e.children]),u=Ge(d=>IG(d,t,o)),c=_.useRef(null),f=ht("recharts-pie",a);return n||u==null?(c.current=null,_.createElement(Br,{tabIndex:i,className:f})):_.createElement(_.Fragment,null,_.createElement(zy,{fn:_Y,args:jt(jt({},e),{},{sectors:u})}),_.createElement(Br,{tabIndex:i,className:f},_.createElement(jY,{props:jt(jt({},r),{},{sectors:u}),previousSectorsRef:c})))}function E4(e){var t=qr(e,LY),{id:r}=t,n=Hy(t,yY),a=Qn(n);return _.createElement(Ky,{id:r,type:"pie"},i=>_.createElement(_.Fragment,null,_.createElement(mY,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),_.createElement(EY,Zi({},n,{id:i})),_.createElement(BY,Zi({},n,{id:i}))))}E4.displayName="Pie";function sT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sT(Object(r),!0).forEach(function(n){$Y(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Y(e,t,r){return(t=UY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UY(e){var t=WY(e,"string");return typeof t=="symbol"?t:t+""}function WY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zY={xAxis:{},yAxis:{},zAxis:{}},_4=Fn({name:"cartesianAxis",initialState:zY,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:en()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:en()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:en()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:en()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:en()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:en()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var o=[...i,n].slice(-3);e.yAxis[r]=oT(oT({},e.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:KY,removeXAxis:HY,addYAxis:VY,removeYAxis:GY,addZAxis:fJ,removeZAxis:dJ,updateYAxisWidth:YY}=_4.actions,qY=_4.reducer,XY=le([dr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),QY=le([XY,oi,li],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Vy=()=>Ge(QY),ZY=()=>Ge(NH);function lT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lT(Object(r),!0).forEach(function(n){JY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JY(e,t,r){return(t=eq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eq(e){var t=tq(e,"string");return typeof t=="symbol"?t:t+""}function tq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rq=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var o=uT(uT({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Ws(a)),f1(a)),u;return _.isValidElement(a)?u=_.cloneElement(a,o):typeof a=="function"?u=a(o):u=_.createElement(f4,o),_.createElement(Br,{className:"recharts-active-dot"},u)};function nq(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=Ge(Qi),o=ZY();if(t==null||o==null)return null;var u=t.find(c=>o.includes(c.payload));return $t(u)?null:rq({point:u,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var aq="Invariant failed";function iq(e,t){throw new Error(aq)}var sq=["x","y"];function kv(){return kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kv.apply(null,arguments)}function cT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Su(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cT(Object(r),!0).forEach(function(n){oq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oq(e,t,r){return(t=lq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lq(e){var t=uq(e,"string");return typeof t=="symbol"?t:t+""}function uq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cq(e,t){if(e==null)return{};var r,n,a=fq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dq(e,t){var{x:r,y:n}=e,a=cq(e,sq),i="".concat(r),o=parseInt(i,10),u="".concat(n),c=parseInt(u,10),f="".concat(t.height||a.height),d=parseInt(f,10),p="".concat(t.width||a.width),m=parseInt(p,10);return Su(Su(Su(Su(Su({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:d,width:m,name:t.name,radius:t.radius})}function Gy(e){return _.createElement(y4,kv({shapeType:"rectangle",propTransformer:dq,activeClassName:"recharts-active-bar"},e))}var hq=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Je(t))return t;var i=Je(n)||$t(n);return i?t(n,a):(i||iq(),r)}},pq={},T4=Fn({name:"errorBars",initialState:pq,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:hJ,replaceErrorBar:pJ,removeErrorBar:mJ}=T4.actions,mq=T4.reducer,gq=["children"];function vq(e,t){if(e==null)return{};var r,n,a=yq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xq={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},wq=_.createContext(xq);function A4(e){var{children:t}=e,r=vq(e,gq);return _.createElement(wq.Provider,{value:r},t)}function Yy(e,t){var r,n,a=Ge(f=>ci(f,e)),i=Ge(f=>fi(f,t)),o=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:En.allowDataOverflow,u=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:_n.allowDataOverflow,c=o||u;return{needClip:c,needClipX:o,needClipY:u}}function k4(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Vy(),{needClipX:i,needClipY:o,needClip:u}=Yy(t,r);if(!u)return null;var{x:c,y:f,width:d,height:p}=a;return _.createElement("clipPath",{id:"clipPath-".concat(n)},_.createElement("rect",{x:i?c:c-d/2,y:o?f:f-p/2,width:i?d:d*2,height:o?p:p*2}))}var Sq=["onMouseEnter","onMouseLeave","onClick"],bq=["value","background","tooltipPosition"],Eq=["id"],_q=["onMouseEnter","onClick","onMouseLeave"];function Ji(){return Ji=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ji.apply(null,arguments)}function fT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fT(Object(r),!0).forEach(function(n){Tq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tq(e,t,r){return(t=Aq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aq(e){var t=kq(e,"string");return typeof t=="symbol"?t:t+""}function kq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d0(e,t){if(e==null)return{};var r,n,a=Oq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Oq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Pq=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:dl(r,t),payload:e}]};function Cq(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:o,unit:u}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:dl(i,t),hide:o,type:e.tooltipType,color:e.fill,unit:u}}}function Nq(e){var t=Ge(Qi),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:u,onClick:c}=i,f=d0(i,Sq),d=$y(o,n),p=Uy(u),m=Wy(c,n);if(!a||r==null)return null;var v=Ws(a);return _.createElement(_.Fragment,null,r.map((x,y)=>{var{value:S,background:T,tooltipPosition:k}=x,A=d0(x,bq);if(!T)return null;var P=d(x,y),N=p(x,y),I=m(x,y),D=tn(tn(tn(tn(tn({option:a,isActive:String(y)===t},A),{},{fill:"#eee"},T),v),ac(f,x,y)),{},{onMouseEnter:P,onMouseLeave:N,onClick:I,dataKey:n,index:y,className:"recharts-bar-background-rectangle"});return _.createElement(Gy,Ji({key:"background-bar-".concat(y)},D))}))}function Dq(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var o={x:i.x,y:i.y,width:i.width,height:i.height};return tn(tn({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return _.createElement(u4,{value:t?a:void 0},r)}function Mq(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:o}=e,u=Ge(Qi),c=Ge(KC),f=r&&String(i)===u&&(c==null||o===c),d=f?r:t;return _.createElement(Gy,Ji({},n,{name:String(n.name)},a,{isActive:f,option:d,index:i,dataKey:o}))}function Rq(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return _.createElement(Gy,Ji({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function Iq(e){var{data:t,props:r}=e,n=Qn(r),{id:a}=n,i=d0(n,Eq),{shape:o,dataKey:u,activeBar:c}=r,{onMouseEnter:f,onClick:d,onMouseLeave:p}=r,m=d0(r,_q),v=$y(f,u),x=Uy(p),y=Wy(d,u);return t?_.createElement(_.Fragment,null,t.map((S,T)=>_.createElement(Br,Ji({key:"rectangle-".concat(S?.x,"-").concat(S?.y,"-").concat(S?.value,"-").concat(T),className:"recharts-bar-rectangle"},ac(m,S,T),{onMouseEnter:v(S,T),onMouseLeave:x(S,T),onClick:y(S,T)}),c?_.createElement(Mq,{shape:o,activeBar:c,baseProps:i,entry:S,index:T,dataKey:u}):_.createElement(Rq,{shape:o,baseProps:i,entry:S,index:T,dataKey:u})))):null}function Fq(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:o,animationDuration:u,animationEasing:c,onAnimationEnd:f,onAnimationStart:d}=t,p=r.current,m=uc(t,"recharts-bar-"),[v,x]=_.useState(!1),y=!v,S=_.useCallback(()=>{typeof f=="function"&&f(),x(!1)},[f]),T=_.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return _.createElement(Dq,{showLabels:y,rects:n},_.createElement(lc,{animationId:m,begin:o,duration:u,isActive:i,easing:c,onAnimationEnd:S,onAnimationStart:T,key:m},k=>{var A=k===1?n:n?.map((P,N)=>{var I=p&&p[N];if(I)return tn(tn({},P),{},{x:qt(I.x,P.x,k),y:qt(I.y,P.y,k),width:qt(I.width,P.width,k),height:qt(I.height,P.height,k)});if(a==="horizontal"){var D=qt(0,P.height,k);return tn(tn({},P),{},{y:P.y+P.height-D,height:D})}var z=qt(0,P.width,k);return tn(tn({},P),{},{width:z})});return k>0&&(r.current=A??null),A==null?null:_.createElement(Br,null,_.createElement(Iq,{props:t,data:A}))}),_.createElement(Fy,{label:t.label}),t.children)}function jq(e){var t=_.useRef(null);return _.createElement(Fq,{previousRectanglesRef:t,props:e})}var O4=0,Lq=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ct(e,t)}};class Bq extends _.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:o,needClip:u,background:c,id:f}=this.props;if(t||r==null)return null;var d=ht("recharts-bar",a),p=f;return _.createElement(Br,{className:d,id:f},u&&_.createElement("defs",null,_.createElement(k4,{clipPathId:p,xAxisId:i,yAxisId:o})),_.createElement(Br,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(p,")"):void 0},_.createElement(Nq,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),_.createElement(jq,this.props)))}}var $q={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!rs.isSsr,legendType:"rect",minPointSize:O4,xAxisId:0,yAxisId:0};function Uq(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:u,animationDuration:c,animationEasing:f,isAnimationActive:d}=e,{needClip:p}=Yy(t,r),m=$0(),v=yn(),x=By(e.children,Sc),y=Ge(k=>mX(k,t,r,v,e.id,x));if(m!=="vertical"&&m!=="horizontal")return null;var S,T=y?.[0];return T==null||T.height==null||T.width==null?S=0:S=m==="vertical"?T.height/2:T.width/2,_.createElement(A4,{xAxisId:t,yAxisId:r,data:y,dataPointFormatter:Lq,errorBarOffset:S},_.createElement(Bq,Ji({},e,{layout:m,needClip:p,data:y,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:u,animationDuration:c,animationEasing:f,isAnimationActive:d})))}function Wq(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:o,yAxis:u,xAxisTicks:c,yAxisTicks:f,stackedData:d,displayedData:p,offset:m,cells:v,parentViewBox:x}=e,y=t==="horizontal"?u:o,S=d?y.scale.domain():null,T=j$({numericAxis:y});return p.map((k,A)=>{var P,N,I,D,z,H;d?P=N$(d[A],S):(P=Ct(k,r),Array.isArray(P)||(P=[T,P]));var te=hq(n,O4)(P[1],A);if(t==="horizontal"){var q,[V,ae]=[u.scale(P[0]),u.scale(P[1])];N=Kb({axis:o,ticks:c,bandSize:i,offset:a.offset,entry:k,index:A}),I=(q=ae??V)!==null&&q!==void 0?q:void 0,D=a.size;var Ee=V-ae;if(z=va(Ee)?0:Ee,H={x:N,y:m.top,width:D,height:m.height},Math.abs(te)>0&&Math.abs(z)<Math.abs(te)){var Z=Fr(z||te)*(Math.abs(te)-Math.abs(z));I-=Z,z+=Z}}else{var[Te,Se]=[o.scale(P[0]),o.scale(P[1])];if(N=Te,I=Kb({axis:u,ticks:f,bandSize:i,offset:a.offset,entry:k,index:A}),D=Se-Te,z=a.size,H={x:m.left,y:I,width:m.width,height:z},Math.abs(te)>0&&Math.abs(D)<Math.abs(te)){var me=Fr(D||te)*(Math.abs(te)-Math.abs(D));D+=me}}if(N==null||I==null||D==null||z==null)return null;var we=tn(tn({},k),{},{x:N,y:I,width:D,height:z,value:d?P:P[1],payload:k,background:H,tooltipPosition:{x:N+D/2,y:I+z/2},parentViewBox:x},v&&v[A]&&v[A].props);return we}).filter(Boolean)}function zq(e){var t=qr(e,$q),r=yn();return _.createElement(Ky,{id:t.id,type:"bar"},n=>_.createElement(_.Fragment,null,_.createElement(w4,{legendPayload:Pq(t)}),_.createElement(zy,{fn:Cq,args:t}),_.createElement(b4,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:F$(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),_.createElement(Uq,Ji({},t,{id:n}))))}var dd=_.memo(zq);dd.displayName="Bar";function dT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ld(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dT(Object(r),!0).forEach(function(n){Kq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kq(e,t,r){return(t=Hq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hq(e){var t=Vq(e,"string");return typeof t=="symbol"?t:t+""}function Vq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gq=(e,t)=>t,Yq=(e,t,r)=>r,qq=(e,t,r,n)=>n,Xq=(e,t,r,n,a)=>a,bc=le([th,Xq],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Qq=le([bc],e=>e?.maxBarSize),Zq=(e,t,r,n,a,i)=>i,hT=(e,t,r)=>{var n=r??e;if(!$t(n))return Gr(n,t,0)},Jq=le([ut,th,Gq,Yq,qq],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),eX=(e,t,r,n)=>{var a=ut(e);return a==="horizontal"?wv(e,"yAxis",r,n):wv(e,"xAxis",t,n)},tX=(e,t,r)=>{var n=ut(e);return n==="horizontal"?m_(e,"xAxis",t):m_(e,"yAxis",r)},rX=(e,t,r)=>{var n={},a=e.filter(Z0),i=e.filter(f=>f.stackId==null),o=a.reduce((f,d)=>(f[d.stackId]||(f[d.stackId]=[]),f[d.stackId].push(d),f),n),u=Object.entries(o).map(f=>{var[d,p]=f,m=p.map(x=>x.dataKey),v=hT(t,r,p[0].barSize);return{stackId:d,dataKeys:m,barSize:v}}),c=i.map(f=>{var d=[f.dataKey].filter(m=>m!=null),p=hT(t,r,f.barSize);return{stackId:void 0,dataKeys:d,barSize:p}});return[...u,...c]},nX=le([Jq,jz,tX],rX),aX=(e,t,r,n,a)=>{var i,o,u=bc(e,t,r,n,a);if(u!=null){var c=ut(e),f=KP(e),{maxBarSize:d}=u,p=$t(d)?f:d,m,v;return c==="horizontal"?(m=Xi(e,"xAxis",t,n),v=qi(e,"xAxis",t,n)):(m=Xi(e,"yAxis",r,n),v=qi(e,"yAxis",r,n)),(i=(o=Wu(m,v,!0))!==null&&o!==void 0?o:p)!==null&&i!==void 0?i:0}},P4=(e,t,r,n)=>{var a=ut(e),i,o;return a==="horizontal"?(i=Xi(e,"xAxis",t,n),o=qi(e,"xAxis",t,n)):(i=Xi(e,"yAxis",r,n),o=qi(e,"yAxis",r,n)),Wu(i,o)};function iX(e,t,r,n,a){var i=n.length;if(!(i<1)){var o=Gr(e,r,0,!0),u,c=[];if(Yr(n[0].barSize)){var f=!1,d=r/i,p=n.reduce((T,k)=>T+(k.barSize||0),0);p+=(i-1)*o,p>=r&&(p-=(i-1)*o,o=0),p>=r&&d>0&&(f=!0,d*=.9,p=i*d);var m=(r-p)/2>>0,v={offset:m-o,size:0};u=n.reduce((T,k)=>{var A,P={stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:v.offset+v.size+o,size:f?d:(A=k.barSize)!==null&&A!==void 0?A:0}},N=[...T,P];return v=N[N.length-1].position,N},c)}else{var x=Gr(t,r,0,!0);r-2*x-(i-1)*o<=0&&(o=0);var y=(r-2*x-(i-1)*o)/i;y>1&&(y>>=0);var S=Yr(a)?Math.min(y,a):y;u=n.reduce((T,k,A)=>[...T,{stackId:k.stackId,dataKeys:k.dataKeys,position:{offset:x+(y+o)*A+(y-S)/2,size:S}}],c)}return u}}var sX=(e,t,r,n,a,i,o)=>{var u=$t(o)?t:o,c=iX(r,n,a!==i?a:i,e,u);return a!==i&&c!=null&&(c=c.map(f=>ld(ld({},f),{},{position:ld(ld({},f.position),{},{offset:f.position.offset-a/2})}))),c},oX=le([nX,KP,Fz,HP,aX,P4,Qq],sX),lX=(e,t,r,n)=>Xi(e,"xAxis",t,n),uX=(e,t,r,n)=>Xi(e,"yAxis",r,n),cX=(e,t,r,n)=>qi(e,"xAxis",t,n),fX=(e,t,r,n)=>qi(e,"yAxis",r,n),dX=le([oX,bc],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),hX=(e,t)=>{var r=ay(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(o=>o.key===r)}}}},pX=le([eX,bc],hX),mX=le([dr,b1,lX,uX,cX,fX,dX,ut,Y0,P4,pX,bc,Zq],(e,t,r,n,a,i,o,u,c,f,d,p,m)=>{var{chartData:v,dataStartIndex:x,dataEndIndex:y}=c;if(!(p==null||o==null||t==null||u!=="horizontal"&&u!=="vertical"||r==null||n==null||a==null||i==null||f==null)){var{data:S}=p,T;if(S!=null&&S.length>0?T=S:T=v?.slice(x,y+1),T!=null)return Wq({layout:u,barSettings:p,pos:o,parentViewBox:t,bandSize:f,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:T,offset:e,cells:m})}}),C4=e=>{var{chartData:t}=e,r=Ut(),n=yn();return _.useEffect(()=>n?()=>{}:(r(__(t)),()=>{r(__(void 0))}),[t,r,n]),null},pT={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},N4=Fn({name:"brush",initialState:pT,reducers:{setBrushSettings(e,t){return t.payload==null?pT:t.payload}}}),{setBrushSettings:gJ}=N4.actions,gX=N4.reducer;function vX(e,t,r){return(t=yX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yX(e){var t=xX(e,"string");return typeof t=="symbol"?t:t+""}function xX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class qy{static create(t){return new qy(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}vX(qy,"EPS",1e-4);function wX(e){return(e%180+180)%180}var SX=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=wX(a),o=i*Math.PI/180,u=Math.atan(n/r),c=o>u&&o<Math.PI-u?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},bX={dots:[],areas:[],lines:[]},D4=Fn({name:"referenceElements",initialState:bX,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Xa(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Xa(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Xa(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:vJ,removeDot:yJ,addArea:xJ,removeArea:wJ,addLine:SJ,removeLine:bJ}=D4.actions,EX=D4.reducer,_X=_.createContext(void 0),TX=e=>{var{children:t}=e,[r]=_.useState("".concat(Bu("recharts"),"-clip")),n=Vy();if(n==null)return null;var{x:a,y:i,width:o,height:u}=n;return _.createElement(_X.Provider,{value:r},_.createElement("defs",null,_.createElement("clipPath",{id:r},_.createElement("rect",{x:a,y:i,height:u,width:o}))),t)};function il(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function M4(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function AX(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return SX(n,r)}function kX(e,t,r){var n=r==="width",{x:a,y:i,width:o,height:u}=e;return t===1?{start:n?a:i,end:n?a+o:i+u}:{start:n?a+o:i+u,end:n?a:i}}function h0(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function OX(e,t){return M4(e,t+1)}function PX(e,t,r,n,a){for(var i=(n||[]).slice(),{start:o,end:u}=t,c=0,f=1,d=o,p=function(){var x=n?.[c];if(x===void 0)return{v:M4(n,f)};var y=c,S,T=()=>(S===void 0&&(S=r(x,y)),S),k=x.coordinate,A=c===0||h0(e,k,T,d,u);A||(c=0,d=o,f+=1),A&&(d=k+e*(T()/2+a),c+=f)},m;f<=i.length;)if(m=p(),m)return m.v;return[]}function mT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mT(Object(r),!0).forEach(function(n){CX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CX(e,t,r){return(t=NX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NX(e){var t=DX(e,"string");return typeof t=="symbol"?t:t+""}function DX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MX(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,{start:u}=t,{end:c}=t,f=function(m){var v=i[m],x,y=()=>(x===void 0&&(x=r(v,m)),x);if(m===o-1){var S=e*(v.coordinate+e*y()/2-c);i[m]=v=Kr(Kr({},v),{},{tickCoord:S>0?v.coordinate-S*e:v.coordinate})}else i[m]=v=Kr(Kr({},v),{},{tickCoord:v.coordinate});var T=h0(e,v.tickCoord,y,u,c);T&&(c=v.tickCoord-e*(y()/2+a),i[m]=Kr(Kr({},v),{},{isShow:!0}))},d=o-1;d>=0;d--)f(d);return i}function RX(e,t,r,n,a,i){var o=(n||[]).slice(),u=o.length,{start:c,end:f}=t;if(i){var d=n[u-1],p=r(d,u-1),m=e*(d.coordinate+e*p/2-f);o[u-1]=d=Kr(Kr({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate});var v=h0(e,d.tickCoord,()=>p,c,f);v&&(f=d.tickCoord-e*(p/2+a),o[u-1]=Kr(Kr({},d),{},{isShow:!0}))}for(var x=i?u-1:u,y=function(k){var A=o[k],P,N=()=>(P===void 0&&(P=r(A,k)),P);if(k===0){var I=e*(A.coordinate-e*N()/2-c);o[k]=A=Kr(Kr({},A),{},{tickCoord:I<0?A.coordinate-I*e:A.coordinate})}else o[k]=A=Kr(Kr({},A),{},{tickCoord:A.coordinate});var D=h0(e,A.tickCoord,N,c,f);D&&(c=A.tickCoord+e*(N()/2+a),o[k]=Kr(Kr({},A),{},{isShow:!0}))},S=0;S<x;S++)y(S);return o}function IX(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:o,orientation:u,interval:c,tickFormatter:f,unit:d,angle:p}=e;if(!a||!a.length||!n)return[];if(Je(c)||rs.isSsr){var m;return(m=OX(a,Je(c)?c:0))!==null&&m!==void 0?m:[]}var v=[],x=u==="top"||u==="bottom"?"width":"height",y=d&&x==="width"?Nu(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},S=(A,P)=>{var N=typeof f=="function"?f(A.value,P):A.value;return x==="width"?AX(Nu(N,{fontSize:t,letterSpacing:r}),y,p):Nu(N,{fontSize:t,letterSpacing:r})[x]},T=a.length>=2?Fr(a[1].coordinate-a[0].coordinate):1,k=kX(i,T,x);return c==="equidistantPreserveStart"?PX(T,k,S,a,o):(c==="preserveStart"||c==="preserveStartEnd"?v=RX(T,k,S,a,o,c==="preserveStartEnd"):v=MX(T,k,S,a,o),v.filter(A=>A.isShow))}var FX=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var p=d.getBoundingClientRect();p.width>o&&(o=p.width)}});var u=r?r.getBoundingClientRect().width:0,c=a+i,f=o+c+u+(r?n:0);return Math.round(f)}return 0},jX=["axisLine","width","height","className","hide","ticks"],LX=["viewBox"],BX=["viewBox"];function Ov(e,t){if(e==null)return{};var r,n,a=$X(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $X(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ys(){return Ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ys.apply(null,arguments)}function gT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gT(Object(r),!0).forEach(function(n){UX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UX(e,t,r){return(t=WX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WX(e){var t=zX(e,"string");return typeof t=="symbol"?t:t+""}function zX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KX={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function HX(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:o,axisLine:u,otherSvgProps:c}=e;if(!u)return null;var f=fr(fr(fr({},c),Qn(u)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!o||i==="bottom"&&o);f=fr(fr({},f),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var p=+(i==="left"&&!o||i==="right"&&o);f=fr(fr({},f),{},{x1:t+p*n,y1:r,x2:t+p*n,y2:r+a})}return _.createElement("line",Ys({},f,{className:ht("recharts-cartesian-axis-line",zs(u,"className"))}))}function VX(e,t,r,n,a,i,o,u,c){var f,d,p,m,v,x,y=u?-1:1,S=e.tickSize||o,T=Je(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":f=d=e.coordinate,m=r+ +!u*a,p=m-y*S,x=p-y*c,v=T;break;case"left":p=m=e.coordinate,d=t+ +!u*n,f=d-y*S,v=f-y*c,x=T;break;case"right":p=m=e.coordinate,d=t+ +u*n,f=d+y*S,v=f+y*c,x=T;break;default:f=d=e.coordinate,m=r+ +u*a,p=m+y*S,x=p+y*c,v=T;break}return{line:{x1:f,y1:p,x2:d,y2:m},tick:{x:v,y:x}}}function GX(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function YX(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function qX(e){var{option:t,tickProps:r,value:n}=e,a,i=ht(r.className,"recharts-cartesian-axis-tick-value");if(_.isValidElement(t))a=_.cloneElement(t,fr(fr({},r),{},{className:i}));else if(typeof t=="function")a=t(fr(fr({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=ht(o,t?.className)),a=_.createElement(oh,Ys({},r,{className:o}),n)}return a}function XX(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:o,padding:u,tickTextProps:c,orientation:f,mirror:d,x:p,y:m,width:v,height:x,tickSize:y,tickMargin:S,fontSize:T,letterSpacing:k,getTicksConfig:A,events:P}=e,N=IX(fr(fr({},A),{},{ticks:t}),T,k),I=GX(f,d),D=YX(f,d),z=Qn(A),H=Ws(r),te={};typeof n=="object"&&(te=n);var q=fr(fr({},z),{},{fill:"none"},te),V=N.map((ae,Ee)=>{var{line:Z,tick:Te}=VX(ae,p,m,v,x,f,y,d,S),Se=fr(fr(fr(fr({textAnchor:I,verticalAnchor:D},z),{},{stroke:"none",fill:a},H),Te),{},{index:Ee,payload:ae,visibleTicksCount:N.length,tickFormatter:i,padding:u},c);return _.createElement(Br,Ys({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},ac(P,ae,Ee)),n&&_.createElement("line",Ys({},q,Z,{className:ht("recharts-cartesian-axis-tick-line",zs(n,"className"))})),r&&_.createElement(qX,{option:r,tickProps:Se,value:"".concat(typeof i=="function"?i(ae.value,Ee):ae.value).concat(o||"")}))});return V.length>0?_.createElement("g",{className:"recharts-cartesian-axis-ticks"},V):null}var QX=_.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:o,ticks:u}=e,c=Ov(e,jX),[f,d]=_.useState(""),[p,m]=_.useState(""),v=_.useRef(null);_.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return FX({ticks:v.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=_.useCallback(y=>{if(y){var S=y.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=S;var T=S[0];if(T){var k=window.getComputedStyle(T),A=k.fontSize,P=k.letterSpacing;(A!==f||P!==p)&&(d(A),m(P))}}},[f,p]);return o||n!=null&&n<=0||a!=null&&a<=0?null:_.createElement(Br,{className:ht("recharts-cartesian-axis",i),ref:x},_.createElement(HX,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Qn(e)}),_.createElement(XX,{ticks:u,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:f,letterSpacing:p,getTicksConfig:e,events:c}),_.createElement(QV,{x:e.x,y:e.y,width:e.width,height:e.height},_.createElement(oG,{label:e.label,labelRef:e.labelRef}),e.children))}),ZX=_.memo(QX,(e,t)=>{var{viewBox:r}=e,n=Ov(e,LX),{viewBox:a}=t,i=Ov(t,BX);return il(r,a)&&il(n,i)}),Xy=_.forwardRef((e,t)=>{var r=qr(e,KX);return _.createElement(ZX,Ys({},r,{ref:t}))});Xy.displayName="CartesianAxis";var R4=(e,t,r,n)=>Xi(e,"xAxis",t,n),I4=(e,t,r,n)=>qi(e,"xAxis",t,n),F4=(e,t,r,n)=>Xi(e,"yAxis",r,n),j4=(e,t,r,n)=>qi(e,"yAxis",r,n),JX=le([ut,R4,F4,I4,j4],(e,t,r,n,a)=>ts(e,"xAxis")?Wu(t,n,!1):Wu(r,a,!1)),eQ=(e,t,r,n,a)=>a;function tQ(e){return e.type==="line"}var rQ=le([th,eQ],(e,t)=>e.filter(tQ).find(r=>r.id===t)),nQ=le([ut,R4,F4,I4,j4,rQ,JX,Y0],(e,t,r,n,a,i,o,u)=>{var{chartData:c,dataStartIndex:f,dataEndIndex:d}=u;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||o==null)){var{dataKey:p,data:m}=i,v;if(m!=null&&m.length>0?v=m:v=c?.slice(f,d+1),v!=null)return AQ({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:p,bandSize:o,displayedData:v})}});function aQ(e){var t=Ws(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,o=Number(a),u=Number(i);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(u)||u<0)&&(u=n),{r:o,strokeWidth:u}}return{r,strokeWidth:n}}var iQ=["id"],sQ=["type","layout","connectNulls","needClip"],oQ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function vT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vT(Object(r),!0).forEach(function(n){lQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lQ(e,t,r){return(t=uQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uQ(e){var t=cQ(e,"string");return typeof t=="symbol"?t:t+""}function cQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qy(e,t){if(e==null)return{};var r,n,a=fQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qs(){return qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qs.apply(null,arguments)}var dQ=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:dl(r,t),payload:e}]};function hQ(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:o,hide:u,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:dl(o,t),hide:u,type:e.tooltipType,color:e.stroke,unit:c}}}var L4=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function pQ(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var mQ=(e,t,r)=>{var n=r.reduce((p,m)=>p+m);if(!n)return L4(t,e);for(var a=Math.floor(e/n),i=e%n,o=t-e,u=[],c=0,f=0;c<r.length;f+=r[c],++c)if(f+r[c]>i){u=[...r.slice(0,c),i-f];break}var d=u.length%2===0?[0,o]:[o];return[...pQ(r,a),...u,...d].map(p=>"".concat(p,"px")).join(", ")};function gQ(e,t){var r;if(_.isValidElement(e))r=_.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=ht("recharts-line-dot",typeof e!="boolean"?e.className:"");r=_.createElement(f4,qs({},t,{className:n}))}return r}function vQ(e,t){return e==null?!1:t?!0:e.length===1}function yQ(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:o}=n;if(!vQ(r,a))return null;var{id:u}=n,c=Qy(n,iQ),f=v4(a),d=Qn(c),p=S8(a),m=r.map((x,y)=>{var S=Nn(Nn(Nn({key:"dot-".concat(y),r:3},d),p),{},{index:y,cx:x.x,cy:x.y,dataKey:i,value:x.value,payload:x.payload,points:r});return gQ(a,S)}),v={clipPath:o?"url(#clipPath-".concat(f?"":"dots-").concat(t,")"):void 0};return _.createElement(Br,qs({className:"recharts-line-dots",key:"dots"},v),m)}function xQ(e){var{showLabels:t,children:r,points:n}=e,a=_.useMemo(()=>n?.map(i=>{var o={x:i.x,y:i.y,width:0,height:0};return Nn(Nn({},o),{},{value:i.value,payload:i.payload,viewBox:o,parentViewBox:void 0,fill:void 0})}),[n]);return _.createElement(u4,{value:t?a:null},r)}function yT(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:o,layout:u,connectNulls:c,needClip:f}=i,d=Qy(i,sQ),p=Nn(Nn({},an(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:f?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:u,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return _.createElement(_.Fragment,null,n?.length>1&&_.createElement(T1,qs({},p,{pathRef:r})),_.createElement(yQ,{points:n,clipPathId:t,props:i}))}function wQ(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function SQ(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:u,isAnimationActive:c,animationBegin:f,animationDuration:d,animationEasing:p,animateNewValues:m,width:v,height:x,onAnimationEnd:y,onAnimationStart:S}=r,T=a.current,k=uc(r,"recharts-line-"),[A,P]=_.useState(!1),N=!A,I=_.useCallback(()=>{typeof y=="function"&&y(),P(!1)},[y]),D=_.useCallback(()=>{typeof S=="function"&&S(),P(!0)},[S]),z=wQ(n.current),H=i.current;return _.createElement(xQ,{points:o,showLabels:N},r.children,_.createElement(lc,{animationId:k,begin:f,duration:d,isActive:c,easing:p,onAnimationEnd:I,onAnimationStart:D,key:k},te=>{var q=qt(H,z+H,te),V=Math.min(q,z),ae;if(c)if(u){var Ee="".concat(u).split(/[,\s]+/gim).map(Se=>parseFloat(Se));ae=mQ(V,z,Ee)}else ae=L4(z,V);else ae=u==null?void 0:String(u);if(T){var Z=T.length/o.length,Te=te===1?o:o.map((Se,me)=>{var we=Math.floor(me*Z);if(T[we]){var be=T[we];return Nn(Nn({},Se),{},{x:qt(be.x,Se.x,te),y:qt(be.y,Se.y,te)})}return m?Nn(Nn({},Se),{},{x:qt(v*2,Se.x,te),y:qt(x/2,Se.y,te)}):Nn(Nn({},Se),{},{x:Se.x,y:Se.y})});return a.current=Te,_.createElement(yT,{props:r,points:Te,clipPathId:t,pathRef:n,strokeDasharray:ae})}return te>0&&z>0&&(a.current=o,i.current=V),_.createElement(yT,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:ae})}),_.createElement(Fy,{label:r.label}))}function bQ(e){var{clipPathId:t,props:r}=e,n=_.useRef(null),a=_.useRef(0),i=_.useRef(null);return _.createElement(SQ,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var EQ=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Ct(e.payload,t)});class _Q extends _.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:o,top:u,left:c,width:f,height:d,id:p,needClip:m}=this.props;if(t)return null;var v=ht("recharts-line",a),x=p,{r:y,strokeWidth:S}=aQ(r),T=v4(r),k=y*2+S;return _.createElement(_.Fragment,null,_.createElement(Br,{className:v},m&&_.createElement("defs",null,_.createElement(k4,{clipPathId:x,xAxisId:i,yAxisId:o}),!T&&_.createElement("clipPath",{id:"clipPath-dots-".concat(x)},_.createElement("rect",{x:c-k/2,y:u-k/2,width:f+k,height:d+k}))),_.createElement(A4,{xAxisId:i,yAxisId:o,data:n,dataPointFormatter:EQ,errorBarOffset:0},_.createElement(bQ,{props:this.props,clipPathId:x}))),_.createElement(nq,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var B4={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!rs.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function TQ(e){var t=qr(e,B4),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,connectNulls:u,dot:c,hide:f,isAnimationActive:d,label:p,legendType:m,xAxisId:v,yAxisId:x,id:y}=t,S=Qy(t,oQ),{needClip:T}=Yy(v,x),k=Vy(),A=$0(),P=yn(),N=Ge(te=>nQ(te,v,x,P,y));if(A!=="horizontal"&&A!=="vertical"||N==null||k==null)return null;var{height:I,width:D,x:z,y:H}=k;return _.createElement(_Q,qs({},S,{id:y,connectNulls:u,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,isAnimationActive:d,hide:f,label:p,legendType:m,xAxisId:v,yAxisId:x,points:N,layout:A,height:I,width:D,left:z,top:H,needClip:T}))}function AQ(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:o,bandSize:u,displayedData:c}=e;return c.map((f,d)=>{var p=Ct(f,o);if(t==="horizontal"){var m=zb({axis:r,ticks:a,bandSize:u,entry:f,index:d}),v=$t(p)?null:n.scale(p);return{x:m,y:v,value:p,payload:f}}var x=$t(p)?null:r.scale(p),y=zb({axis:n,ticks:i,bandSize:u,entry:f,index:d});return x==null||y==null?null:{x,y,value:p,payload:f}}).filter(Boolean)}function kQ(e){var t=qr(e,B4),r=yn();return _.createElement(Ky,{id:t.id,type:"line"},n=>_.createElement(_.Fragment,null,_.createElement(w4,{legendPayload:dQ(t)}),_.createElement(zy,{fn:hQ,args:t}),_.createElement(b4,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),_.createElement(TQ,qs({},t,{id:n}))))}var hd=_.memo(kQ);hd.displayName="Line";var OQ=["dangerouslySetInnerHTML","ticks"],PQ=["id"],CQ=["domain"],NQ=["domain"];function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(null,arguments)}function p0(e,t){if(e==null)return{};var r,n,a=DQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function MQ(e){var t=Ut();return _.useLayoutEffect(()=>(t(KY(e)),()=>{t(HY(e))}),[e,t]),null}var RQ=e=>{var{xAxisId:t,className:r}=e,n=Ge(b1),a=yn(),i="xAxis",o=Ge(S=>wl(S,i,t,a)),u=Ge(S=>EC(S,i,t,a)),c=Ge(S=>xC(S,t)),f=Ge(S=>NK(S,t)),d=Ge(S=>eC(S,t));if(c==null||f==null||d==null)return null;var{dangerouslySetInnerHTML:p,ticks:m}=e,v=p0(e,OQ),{id:x}=d,y=p0(d,PQ);return _.createElement(Xy,Pv({},v,y,{scale:o,x:f.x,y:f.y,width:c.width,height:c.height,className:ht("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:u}))},IQ={allowDataOverflow:En.allowDataOverflow,allowDecimals:En.allowDecimals,allowDuplicatedCategory:En.allowDuplicatedCategory,height:En.height,hide:!1,mirror:En.mirror,orientation:En.orientation,padding:En.padding,reversed:En.reversed,scale:En.scale,tickCount:En.tickCount,type:En.type,xAxisId:0},FQ=e=>{var t,r,n,a,i,o=qr(e,IQ);return _.createElement(_.Fragment,null,_.createElement(MQ,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),_.createElement(RQ,o))},jQ=(e,t)=>{var{domain:r}=e,n=p0(e,CQ),{domain:a}=t,i=p0(t,NQ);return il(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:il({domain:r},{domain:a}):!1},pd=_.memo(FQ,jQ);pd.displayName="XAxis";var LQ=["dangerouslySetInnerHTML","ticks"],BQ=["id"],$Q=["domain"],UQ=["domain"];function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(null,arguments)}function m0(e,t){if(e==null)return{};var r,n,a=WQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function zQ(e){var t=Ut();return _.useLayoutEffect(()=>(t(VY(e)),()=>{t(GY(e))}),[e,t]),null}var KQ=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=_.useRef(null),o=_.useRef(null),u=Ge(b1),c=yn(),f=Ut(),d="yAxis",p=Ge(N=>wl(N,d,t,c)),m=Ge(N=>wC(N,t)),v=Ge(N=>MK(N,t)),x=Ge(N=>EC(N,d,t,c)),y=Ge(N=>tC(N,t));if(_.useLayoutEffect(()=>{if(!(n!=="auto"||!m||Iy(a)||_.isValidElement(a)||y==null)){var N=i.current;if(N){var I=N.getCalculatedWidth();Math.round(m.width)!==Math.round(I)&&f(YY({id:t,width:I}))}}},[x,m,f,a,t,n,y]),m==null||v==null||y==null)return null;var{dangerouslySetInnerHTML:S,ticks:T}=e,k=m0(e,LQ),{id:A}=y,P=m0(y,BQ);return _.createElement(Xy,Cv({},k,P,{ref:i,labelRef:o,scale:p,x:v.x,y:v.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:m.width,height:m.height,className:ht("recharts-".concat(d," ").concat(d),r),viewBox:u,ticks:x}))},HQ={allowDataOverflow:_n.allowDataOverflow,allowDecimals:_n.allowDecimals,allowDuplicatedCategory:_n.allowDuplicatedCategory,hide:!1,mirror:_n.mirror,orientation:_n.orientation,padding:_n.padding,reversed:_n.reversed,scale:_n.scale,tickCount:_n.tickCount,type:_n.type,width:_n.width,yAxisId:0},VQ=e=>{var t,r,n,a,i,o=qr(e,HQ);return _.createElement(_.Fragment,null,_.createElement(zQ,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(n=o.angle)!==null&&n!==void 0?n:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(i=o.tick)!==null&&i!==void 0?i:!0,tickFormatter:o.tickFormatter}),_.createElement(KQ,o))},GQ=(e,t)=>{var{domain:r}=e,n=m0(e,$Q),{domain:a}=t,i=m0(t,UQ);return il(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:il({domain:r},{domain:a}):!1},md=_.memo(VQ,GQ);md.displayName="YAxis";var Cg={exports:{}},Ng={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xT;function YQ(){if(xT)return Ng;xT=1;var e=sl();function t(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,u=e.useDebugValue;return Ng.useSyncExternalStoreWithSelector=function(c,f,d,p,m){var v=a(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function S(N){if(!T){if(T=!0,k=N,N=p(N),m!==void 0&&x.hasValue){var I=x.value;if(m(I,N))return A=I}return A=N}if(I=A,r(k,N))return I;var D=p(N);return m!==void 0&&m(I,D)?(k=N,I):(k=N,A=D)}var T=!1,k,A,P=d===void 0?null:d;return[function(){return S(f())},P===null?void 0:function(){return S(P())}]},[f,d,p,m]);var y=n(c,v[0],v[1]);return i(function(){x.hasValue=!0,x.value=y},[y]),u(y),y},Ng}var wT;function qQ(){return wT||(wT=1,Cg.exports=YQ()),Cg.exports}qQ();function XQ(e){e()}function QQ(){let e=null,t=null;return{clear(){e=null,t=null},notify(){XQ(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var ST={notify(){},get:()=>[]};function ZQ(e,t){let r,n=ST,a=0,i=!1;function o(y){d();const S=n.subscribe(y);let T=!1;return()=>{T||(T=!0,S(),p())}}function u(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function f(){return i}function d(){a++,r||(r=e.subscribe(c),n=QQ())}function p(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=ST)}function m(){i||(i=!0,d())}function v(){i&&(i=!1,p())}const x={addNestedSub:o,notifyNestedSubs:u,handleChangeWrapper:c,isSubscribed:f,trySubscribe:m,tryUnsubscribe:v,getListeners:()=>n};return x}var JQ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eZ=JQ(),tZ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",rZ=tZ(),nZ=()=>eZ||rZ?_.useLayoutEffect:_.useEffect,aZ=nZ(),iZ=Symbol.for("react-redux-context"),sZ=typeof globalThis<"u"?globalThis:{};function oZ(){if(!_.createContext)return{};const e=sZ[iZ]??=new Map;let t=e.get(_.createContext);return t||(t=_.createContext(null),e.set(_.createContext,t)),t}var lZ=oZ();function uZ(e){const{children:t,context:r,serverState:n,store:a}=e,i=_.useMemo(()=>{const c=ZQ(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=_.useMemo(()=>a.getState(),[a]);aZ(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const u=r||lZ;return _.createElement(u.Provider,{value:i},t)}var cZ=uZ,fZ=(e,t)=>t,Zy=le([fZ,ut,QP,pr,$C,di,LH,dr],zH),Jy=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},$4=Zn("mouseClick"),U4=sc();U4.startListening({actionCreator:$4,effect:(e,t)=>{var r=e.payload,n=Zy(t.getState(),Jy(r));n?.activeIndex!=null&&t.dispatch(VK({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Nv=Zn("mouseMove"),W4=sc();W4.startListening({actionCreator:Nv,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Ty(n,n.tooltip.settings.shared),i=Zy(n,Jy(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(NC({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(CC()))}});var bT={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},z4=Fn({name:"rootProps",initialState:bT,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:bT.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),dZ=z4.reducer,{updateOptions:hZ}=z4.actions,K4=Fn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:pZ}=K4.actions,mZ=K4.reducer,H4=Zn("keyDown"),V4=Zn("focus"),ex=sc();ex.startListening({actionCreator:H4,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Number(Ay(a,bl(r))),u=di(r);if(i==="Enter"){var c=l0(r,"axis","hover",String(a.index));t.dispatch(bv({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var f=jK(r),d=f==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,m=o+p*d;if(!(u==null||m>=u.length||m<0)){var v=l0(r,"axis","hover",String(m));t.dispatch(bv({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:v}))}}}}});ex.startListening({actionCreator:V4,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",o=l0(r,"axis","hover",String(i));t.dispatch(bv({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:o}))}}}});var Gn=Zn("externalEvent"),G4=sc();G4.startListening({actionCreator:Gn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:OH(r),activeDataKey:KC(r),activeIndex:Qi(r),activeLabel:zC(r),activeTooltipIndex:Qi(r),isTooltipActive:PH(r)};e.payload.handler(n,e.payload.reactEvent)}}});var gZ=le([Sl],e=>e.tooltipItemPayloads),vZ=le([gZ,xc,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(u=>u.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var o=t(i,r);return o}}}),Y4=Zn("touchMove"),q4=sc();q4.startListening({actionCreator:Y4,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Ty(n,n.tooltip.settings.shared);if(a==="axis"){var i=Zy(n,Jy({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(NC({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var o,u=r.touches[0],c=document.elementFromPoint(u.clientX,u.clientY);if(!c||!c.getAttribute)return;var f=c.getAttribute(PO),d=(o=c.getAttribute(CO))!==null&&o!==void 0?o:void 0,p=vZ(t.getState(),f,d);t.dispatch(PC({activeDataKey:d,activeIndex:f,activeCoordinate:p}))}}});var yZ=tO({brush:gX,cartesianAxis:qY,chartData:iV,errorBars:mq,graphicalItems:pY,layout:m$,legend:b7,options:eV,polarAxis:OG,polarOptions:mZ,referenceElements:EX,rootProps:dZ,tooltip:GK}),xZ=function(t){return $B({reducer:yZ,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([U4.middleware,W4.middleware,ex.middleware,G4.middleware,q4.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(hO({type:"raf"}))},devTools:rs.devToolsEnabled})};function X4(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=yn(),i=_.useRef(null);if(a)return r;i.current==null&&(i.current=xZ(t));var o=g1;return _.createElement(cZ,{context:o,store:i.current},r)}function Q4(e){var{layout:t,margin:r}=e,n=Ut(),a=yn();return _.useEffect(()=>{a||(n(d$(t)),n(f$(r)))},[n,a,t,r]),null}function Z4(e){var t=Ut();return _.useEffect(()=>{t(hZ(e))},[t,e]),null}var wZ=["children"];function SZ(e,t){if(e==null)return{};var r,n,a=bZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function g0(){return g0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g0.apply(null,arguments)}var EZ={width:"100%",height:"100%",display:"block"},_Z=_.forwardRef((e,t)=>{var r=RO(),n=IO(),a=BO();if(!el(r)||!el(n))return null;var{children:i,otherAttributes:o,title:u,desc:c}=e,f,d;return typeof o.tabIndex=="number"?f=o.tabIndex:f=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0,_.createElement(n1,g0({},o,{title:u,desc:c,role:d,tabIndex:f,width:r,height:n,style:EZ,ref:t}),i)}),TZ=e=>{var{children:t}=e,r=Ge(L0);if(!r)return null;var{width:n,height:a,y:i,x:o}=r;return _.createElement(n1,{width:n,height:a,x:o,y:i},t)},ET=_.forwardRef((e,t)=>{var{children:r}=e,n=SZ(e,wZ),a=yn();return a?_.createElement(TZ,null,r):_.createElement(_Z,g0({ref:t},n),r)});function AZ(){var e=Ut(),[t,r]=_.useState(null),n=Ge(K$);return _.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Yr(i)&&i!==n&&e(p$(i))}},[t,e,n]),r}function _T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_T(Object(r),!0).forEach(function(n){OZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OZ(e,t,r){return(t=PZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PZ(e){var t=CZ(e,"string");return typeof t=="symbol"?t:t+""}function CZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xs(){return Xs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xs.apply(null,arguments)}var NZ=()=>(pV(),null);function v0(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var DZ=_.forwardRef((e,t)=>{var r,n,a=_.useRef(null),[i,o]=_.useState({containerWidth:v0((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:v0((n=e.style)===null||n===void 0?void 0:n.height)}),u=_.useCallback((f,d)=>{o(p=>{var m=Math.round(f),v=Math.round(d);return p.containerWidth===m&&p.containerHeight===v?p:{containerWidth:m,containerHeight:v}})},[]),c=_.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:d,height:p}=f.getBoundingClientRect();u(d,p);var m=x=>{var{width:y,height:S}=x[0].contentRect;u(y,S)},v=new ResizeObserver(m);v.observe(f),a.current=v}},[t,u]);return _.useEffect(()=>()=>{var f=a.current;f?.disconnect()},[u]),_.createElement(_.Fragment,null,_.createElement(U0,{width:i.containerWidth,height:i.containerHeight}),_.createElement("div",Xs({ref:c},e)))}),MZ=_.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=_.useState({containerWidth:v0(r),containerHeight:v0(n)}),o=_.useCallback((c,f)=>{i(d=>{var p=Math.round(c),m=Math.round(f);return d.containerWidth===p&&d.containerHeight===m?d:{containerWidth:p,containerHeight:m}})},[]),u=_.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:f,height:d}=c.getBoundingClientRect();o(f,d)}},[t,o]);return _.createElement(_.Fragment,null,_.createElement(U0,{width:a.containerWidth,height:a.containerHeight}),_.createElement("div",Xs({ref:u},e)))}),RZ=_.forwardRef((e,t)=>{var{width:r,height:n}=e;return _.createElement(_.Fragment,null,_.createElement(U0,{width:r,height:n}),_.createElement("div",Xs({ref:t},e)))}),IZ=_.forwardRef((e,t)=>{var{width:r,height:n}=e;return ti(r)||ti(n)?_.createElement(MZ,Xs({},e,{ref:t})):_.createElement(RZ,Xs({},e,{ref:t}))});function FZ(e){return e===!0?DZ:IZ}var jZ=_.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:o,onDoubleClick:u,onMouseDown:c,onMouseEnter:f,onMouseLeave:d,onMouseMove:p,onMouseUp:m,onTouchEnd:v,onTouchMove:x,onTouchStart:y,style:S,width:T,responsive:k,dispatchTouchEvents:A=!0}=e,P=_.useRef(null),N=Ut(),[I,D]=_.useState(null),[z,H]=_.useState(null),te=AZ(),q=E1(),V=q?.width>0?q.width:T,ae=q?.height>0?q.height:a,Ee=_.useCallback(re=>{te(re),typeof t=="function"&&t(re),D(re),H(re),re!=null&&(P.current=re)},[te,t,D,H]),Z=_.useCallback(re=>{N($4(re)),N(Gn({handler:i,reactEvent:re}))},[N,i]),Te=_.useCallback(re=>{N(Nv(re)),N(Gn({handler:f,reactEvent:re}))},[N,f]),Se=_.useCallback(re=>{N(CC()),N(Gn({handler:d,reactEvent:re}))},[N,d]),me=_.useCallback(re=>{N(Nv(re)),N(Gn({handler:p,reactEvent:re}))},[N,p]),we=_.useCallback(()=>{N(V4())},[N]),be=_.useCallback(re=>{N(H4(re.key))},[N]),X=_.useCallback(re=>{N(Gn({handler:o,reactEvent:re}))},[N,o]),M=_.useCallback(re=>{N(Gn({handler:u,reactEvent:re}))},[N,u]),J=_.useCallback(re=>{N(Gn({handler:c,reactEvent:re}))},[N,c]),G=_.useCallback(re=>{N(Gn({handler:m,reactEvent:re}))},[N,m]),K=_.useCallback(re=>{N(Gn({handler:y,reactEvent:re}))},[N,y]),he=_.useCallback(re=>{A&&N(Y4(re)),N(Gn({handler:x,reactEvent:re}))},[N,A,x]),Oe=_.useCallback(re=>{N(Gn({handler:v,reactEvent:re}))},[N,v]),Ne=FZ(k);return _.createElement(XC.Provider,{value:I},_.createElement(xk.Provider,{value:z},_.createElement(Ne,{width:V??S?.width,height:ae??S?.height,className:ht("recharts-wrapper",n),style:kZ({position:"relative",cursor:"default",width:V,height:ae},S),onClick:Z,onContextMenu:X,onDoubleClick:M,onFocus:we,onKeyDown:be,onMouseDown:J,onMouseEnter:Te,onMouseLeave:Se,onMouseMove:me,onMouseUp:G,onTouchEnd:Oe,onTouchMove:he,onTouchStart:K,ref:Ee},_.createElement(NZ,null),r)))}),LZ=["width","height","responsive","children","className","style","compact","title","desc"];function BZ(e,t){if(e==null)return{};var r,n,a=$Z(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $Z(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var J4=_.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:o,style:u,compact:c,title:f,desc:d}=e,p=BZ(e,LZ),m=Qn(p);return c?_.createElement(_.Fragment,null,_.createElement(U0,{width:r,height:n}),_.createElement(ET,{otherAttributes:m,title:f,desc:d},i)):_.createElement(jZ,{className:o,style:u,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},_.createElement(ET,{otherAttributes:m,title:f,desc:d,ref:t},_.createElement(TX,null,i)))});function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(null,arguments)}var UZ={top:5,right:5,bottom:5,left:5},WZ={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:UZ,reverseStackOrder:!1,syncMethod:"index",responsive:!1},eN=_.forwardRef(function(t,r){var n,a=qr(t.categoricalChartProps,WZ),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:u,tooltipPayloadSearcher:c,categoricalChartProps:f}=t,d={chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:u,tooltipPayloadSearcher:c,eventEmitter:void 0};return _.createElement(X4,{preloadedState:{options:d},reduxStoreName:(n=f.id)!==null&&n!==void 0?n:i},_.createElement(C4,{chartData:f.data}),_.createElement(Q4,{layout:a.layout,margin:a.margin}),_.createElement(Z4,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),_.createElement(J4,Dv({},a,{ref:r})))}),zZ=["axis"],TT=_.forwardRef((e,t)=>_.createElement(eN,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:zZ,tooltipPayloadSearcher:Ry,categoricalChartProps:e,ref:t})),KZ=["axis","item"],HZ=_.forwardRef((e,t)=>_.createElement(eN,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:KZ,tooltipPayloadSearcher:Ry,categoricalChartProps:e,ref:t}));function VZ(e){var t=Ut();return _.useEffect(()=>{t(pZ(e))},[t,e]),null}var GZ=["layout"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(null,arguments)}function YZ(e,t){if(e==null)return{};var r,n,a=qZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var XZ={top:5,right:5,bottom:5,left:5},QZ={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:XZ,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},ZZ=_.forwardRef(function(t,r){var n,a=qr(t.categoricalChartProps,QZ),{layout:i}=a,o=YZ(a,GZ),{chartName:u,defaultTooltipEventType:c,validateTooltipEventTypes:f,tooltipPayloadSearcher:d}=t,p={chartName:u,defaultTooltipEventType:c,validateTooltipEventTypes:f,tooltipPayloadSearcher:d,eventEmitter:void 0};return _.createElement(X4,{preloadedState:{options:p},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:u},_.createElement(C4,{chartData:a.data}),_.createElement(Q4,{layout:i,margin:a.margin}),_.createElement(Z4,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),_.createElement(VZ,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),_.createElement(J4,Mv({},o,{ref:r})))}),JZ=["item"],eJ={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},tJ=_.forwardRef((e,t)=>{var r=qr(e,eJ);return _.createElement(ZZ,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:JZ,tooltipPayloadSearcher:Ry,categoricalChartProps:r,ref:t})});function rJ(){const[e,t]=_.useState(fa.getChartData()),[r,n]=_.useState(fa.getSummary()),[a,i]=_.useState("overview");_.useEffect(()=>{const d=setInterval(()=>{t(fa.getChartData()),n(fa.getSummary())},2e3);return()=>clearInterval(d)},[]);const o=()=>{U.update("currentScreen","main-menu")},u={primary:"#d4a656",secondary:"#5c4423",success:"#27ae60",danger:"#e74c3c",info:"#3498db",warning:"#f39c12"},c={Omar:"#e74c3c",Salma:"#3498db",Shadi:"#27ae60"},f=({active:d,payload:p,label:m})=>d&&p&&p.length?b.jsxs("div",{className:"bg-[#1a0f0a] border border-[#d4a656] p-3 rounded-lg shadow-lg",children:[b.jsx("p",{className:"text-[#f8e4c0] font-semibold mb-1",children:m}),p.map((v,x)=>b.jsxs("p",{className:"text-sm",style:{color:v.color},children:[v.name,": ",v.value]},x))]}):null;return b.jsxs("div",{className:"min-h-screen bg-gradient-radial from-[#1a0f0a] via-[#0d0604] to-black text-[#f8e4c0] p-4 overflow-y-auto",children:[b.jsxs("div",{className:"flex items-center justify-between mb-6",children:[b.jsx("h1",{className:"text-3xl font-bold text-[#d4a656] flex items-center gap-2",children:"📊 Player Analytics"}),b.jsxs("div",{className:"flex gap-2",children:[b.jsx("button",{onClick:()=>pk.exportAnalyticsToExcel(),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-[#f8e4c0] rounded-lg border border-[#d4a656]/30 transition-all",title:"Export all analytics to Excel",children:"📊 Export"}),b.jsx("button",{onClick:o,className:"px-4 py-2 bg-[#5c4423] hover:bg-[#7d5f36] text-[#f8e4c0] rounded-lg border border-[#d4a656]/30 transition-all",children:"← Back"})]})]}),b.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto",children:["overview","characters","history"].map(d=>b.jsx("button",{onClick:()=>i(d),className:`px-4 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${a===d?"bg-[#d4a656] text-[#1a0f0a]":"bg-[#5c4423]/50 text-[#f8e4c0] hover:bg-[#5c4423]"}`,children:d.charAt(0).toUpperCase()+d.slice(1)},d))}),a==="overview"&&b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[b.jsx(Li,{icon:"⚔️",label:"Total Battles",value:r.totalBattles,color:u.primary}),b.jsx(Li,{icon:"🏆",label:"Win Rate",value:`${r.winRate}%`,color:u.success}),b.jsx(Li,{icon:"🏔️",label:"Highest Floor",value:r.highestFloor,color:u.info}),b.jsx(Li,{icon:"💰",label:"Gold Earned",value:r.totalGoldEarned.toLocaleString(),color:u.warning}),b.jsx(Li,{icon:"💥",label:"Total Damage",value:r.totalDamageDealt.toLocaleString(),color:u.danger}),b.jsx(Li,{icon:"🛡️",label:"Damage Taken",value:r.totalDamageTaken.toLocaleString(),color:u.info}),b.jsx(Li,{icon:"⏱️",label:"Playtime",value:`${r.playtimeMinutes}m`,color:u.secondary}),b.jsx(Li,{icon:"💀",label:"Deaths",value:r.totalDeaths,color:u.danger})]}),r.totalBattles>0&&b.jsxs("div",{className:"bg-[#5c4423]/30 p-6 rounded-lg border border-[#d4a656]/30",children:[b.jsx("h2",{className:"text-xl font-bold text-[#d4a656] mb-4",children:"Combat Results"}),b.jsx(Zf,{width:"100%",height:250,children:b.jsxs(tJ,{children:[b.jsx(E4,{data:e.winLoss,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:({name:d,percent:p})=>`${d} ${(p*100).toFixed(0)}%`,children:e.winLoss.map((d,p)=>b.jsx(Sc,{fill:d.fill},`cell-${p}`))}),b.jsx(od,{content:b.jsx(f,{})}),b.jsx(Os,{})]})}),b.jsxs("div",{className:"text-center mt-4",children:[b.jsx("div",{className:"text-sm opacity-70",children:"Average Damage per Battle"}),b.jsx("div",{className:"text-2xl font-bold text-[#d4a656]",children:r.avgDamagePerBattle})]})]}),e.recentBattles.length>0&&b.jsxs("div",{className:"bg-[#5c4423]/30 p-6 rounded-lg border border-[#d4a656]/30",children:[b.jsx("h2",{className:"text-xl font-bold text-[#d4a656] mb-4",children:"Recent Battle Performance"}),b.jsx(Zf,{width:"100%",height:250,children:b.jsxs(TT,{data:e.recentBattles,children:[b.jsx(pd,{dataKey:"battle",stroke:"#f8e4c0"}),b.jsx(md,{stroke:"#f8e4c0"}),b.jsx(od,{content:b.jsx(f,{})}),b.jsx(Os,{}),b.jsx(hd,{type:"monotone",dataKey:"damage",stroke:u.danger,strokeWidth:2,name:"Damage Dealt"}),b.jsx(hd,{type:"monotone",dataKey:"gold",stroke:u.warning,strokeWidth:2,name:"Gold Earned"})]})})]})]}),a==="characters"&&b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-[#5c4423]/30 p-6 rounded-lg border border-[#d4a656]/30",children:[b.jsx("h2",{className:"text-xl font-bold text-[#d4a656] mb-4",children:"Character Comparison"}),b.jsx(Zf,{width:"100%",height:300,children:b.jsxs(HZ,{data:e.characterComparison,children:[b.jsx(pd,{dataKey:"character",stroke:"#f8e4c0"}),b.jsx(md,{stroke:"#f8e4c0"}),b.jsx(od,{content:b.jsx(f,{})}),b.jsx(Os,{}),b.jsx(dd,{dataKey:"battles",fill:u.primary,name:"Total Battles"}),b.jsx(dd,{dataKey:"wins",fill:u.success,name:"Wins"}),b.jsx(dd,{dataKey:"maxFloor",fill:u.info,name:"Max Floor"})]})})]}),b.jsx("div",{className:"grid gap-4",children:e.characterComparison.map((d,p)=>b.jsxs("div",{className:"bg-[#5c4423]/30 p-4 rounded-lg border-l-4",style:{borderColor:Object.values(c)[p]},children:[b.jsx("h3",{className:"text-xl font-bold mb-3",style:{color:Object.values(c)[p]},children:d.character}),b.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Battles"}),b.jsx("div",{className:"text-lg font-bold",children:d.battles})]}),b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Win Rate"}),b.jsxs("div",{className:"text-lg font-bold",children:[d.winRate.toFixed(1),"%"]})]}),b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Max Floor"}),b.jsx("div",{className:"text-lg font-bold",children:d.maxFloor})]}),b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Total Damage"}),b.jsx("div",{className:"text-lg font-bold",children:d.damageDealt.toLocaleString()})]}),b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Gold Earned"}),b.jsx("div",{className:"text-lg font-bold",children:d.goldEarned.toLocaleString()})]}),b.jsxs("div",{children:[b.jsx("div",{className:"opacity-70",children:"Avg Damage/Battle"}),b.jsx("div",{className:"text-lg font-bold",children:d.battles>0?Math.round(d.damageDealt/d.battles):0})]})]})]},d.character))})]}),a==="history"&&b.jsxs("div",{className:"space-y-6",children:[e.floorProgression.length>0&&b.jsxs("div",{className:"bg-[#5c4423]/30 p-6 rounded-lg border border-[#d4a656]/30",children:[b.jsx("h2",{className:"text-xl font-bold text-[#d4a656] mb-4",children:"Floor Progression History"}),b.jsx(Zf,{width:"100%",height:250,children:b.jsxs(TT,{data:e.floorProgression,children:[b.jsx(pd,{dataKey:"run",stroke:"#f8e4c0"}),b.jsx(md,{stroke:"#f8e4c0"}),b.jsx(od,{content:b.jsx(f,{})}),b.jsx(Os,{}),b.jsx(hd,{type:"monotone",dataKey:"floor",stroke:u.primary,strokeWidth:2,name:"Floor Reached"})]})})]}),b.jsxs("div",{className:"bg-[#5c4423]/30 p-6 rounded-lg border border-[#d4a656]/30",children:[b.jsx("h2",{className:"text-xl font-bold text-[#d4a656] mb-4",children:"Recent Battles"}),b.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[fa.stats.battleHistory.slice(0,20).map((d,p)=>b.jsx("div",{className:`p-3 rounded-lg border-l-4 ${d.victory?"bg-green-900/20 border-green-500":"bg-red-900/20 border-red-500"}`,children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{children:[b.jsx("span",{className:"font-bold",children:d.character}),b.jsx("span",{className:"mx-2",children:"•"}),b.jsxs("span",{children:["Floor ",d.floor]}),b.jsx("span",{className:"mx-2",children:"•"}),b.jsx("span",{className:d.victory?"text-green-400":"text-red-400",children:d.victory?"🏆 Victory":"💀 Defeat"})]}),b.jsxs("div",{className:"text-right text-sm opacity-70",children:[b.jsxs("div",{children:["💥 ",d.damageDealt," dmg"]}),b.jsxs("div",{children:["💰 ",d.goldGained," gold"]})]})]})},p)),fa.stats.battleHistory.length===0&&b.jsx("div",{className:"text-center py-8 opacity-50",children:"No battles recorded yet. Start playing to see your history!"})]})]})]}),r.totalBattles===0&&b.jsxs("div",{className:"text-center py-12",children:[b.jsx("div",{className:"text-6xl mb-4",children:"📊"}),b.jsx("h2",{className:"text-2xl font-bold text-[#d4a656] mb-2",children:"No Data Yet"}),b.jsx("p",{className:"text-[#f8e4c0]/70",children:"Start playing to see your statistics and progress!"})]})]})}function Li({icon:e,label:t,value:r,color:n}){return b.jsxs("div",{className:"bg-[#5c4423]/30 p-4 rounded-lg border border-[#d4a656]/30 hover:border-[#d4a656] transition-all",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[b.jsx("span",{className:"text-2xl",children:e}),b.jsx("div",{className:"text-sm opacity-70",children:t})]}),b.jsx("div",{className:"text-2xl font-bold",style:{color:n},children:r})]})}function Dg(){const[e,t]=_.useState(!1),[r,n]=_.useState(Ns.getReport()),[a,i]=_.useState(!1);if(_.useEffect(()=>{const c=setInterval(()=>{n(Ns.getReport())},1e3),f=d=>{(d.key==="p"||d.key==="P")&&t(p=>!p)};return window.addEventListener("keypress",f),()=>{clearInterval(c),window.removeEventListener("keypress",f)}},[]),!e)return b.jsx("button",{onClick:()=>t(!0),className:"fixed bottom-4 right-4 bg-black/50 text-white px-2 py-1 rounded text-xs hover:bg-black/70 transition-all z-50",title:"Show Performance HUD (Press P)",children:"📊 FPS"});const o=Ns.getPerformanceGrade(),u={A:"text-green-400",B:"text-blue-400",C:"text-yellow-400",D:"text-orange-400",F:"text-red-400"};return b.jsxs("div",{className:"fixed bottom-4 right-4 bg-black/80 text-white p-3 rounded-lg text-xs font-mono z-50 border border-white/20 backdrop-blur-sm",children:[b.jsxs("div",{className:"flex items-center justify-between mb-2",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("span",{className:"text-lg",children:"📊"}),b.jsx("span",{className:"font-bold",children:"Performance"}),b.jsxs("span",{className:`font-bold ${u[o]}`,children:["[",o,"]"]})]}),b.jsxs("div",{className:"flex gap-1",children:[b.jsx("button",{onClick:()=>i(!a),className:"hover:text-blue-400 transition-colors",title:"Toggle details",children:a?"▼":"▶"}),b.jsx("button",{onClick:()=>t(!1),className:"hover:text-red-400 transition-colors ml-1",title:"Hide (Press P)",children:"✕"})]})]}),b.jsxs("div",{className:"space-y-1",children:[b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"FPS:"}),b.jsx("span",{className:r.fps>=30?"text-green-400":"text-red-400",children:r.fps})]}),a&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Avg FPS:"}),b.jsx("span",{className:r.avgFps>=30?"text-green-400":"text-yellow-400",children:r.avgFps})]}),b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Memory:"}),b.jsxs("span",{className:r.memoryMB<100?"text-green-400":"text-yellow-400",children:[r.memoryMB,"MB"]})]}),b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Battles:"}),b.jsx("span",{className:"text-blue-400",children:r.totalBattles})]}),r.totalBattles>0&&b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Avg Battle:"}),b.jsxs("span",{className:r.avgBattleDuration<45?"text-green-400":"text-yellow-400",children:[r.avgBattleDuration,"s"]})]}),r.slowBattles>0&&b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Slow Battles:"}),b.jsx("span",{className:"text-orange-400",children:r.slowBattles})]})]}),b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Uptime:"}),b.jsx("span",{className:"text-gray-400",children:r.uptime})]}),b.jsxs("div",{className:"flex justify-between gap-4",children:[b.jsx("span",{children:"Frames:"}),b.jsx("span",{className:"text-gray-400",children:r.totalFrames.toLocaleString()})]})]})]}),a&&b.jsxs("div",{className:"mt-2 pt-2 border-t border-white/20 text-[10px] opacity-70",children:[b.jsxs("div",{children:["Press ",b.jsx("span",{className:"text-blue-400",children:"P"})," to toggle"]}),b.jsx("div",{children:"FPS < 30 = Performance issue"}),b.jsx("div",{children:"Memory > 100MB = High usage"})]})]})}de.log("App.jsx: Module loaded.","SYSTEM");let tN=()=>de.log("forceUI called before App component mounted!","ERROR");const Mg=new pD({forceUpdate:()=>tN()}),nJ=new mD({});function aJ(){de.log("App component rendering started.","UI");const[e,t]=_.useState(U.current),[r,n]=_.useState([]),[a,i]=_.useState(null),[o,u]=_.useState(null),[c,f]=_.useState(!1),[d,p]=_.useState(!1),[m,v]=_.useState("en"),[x,y]=_.useState(null),[S,T]=_.useState(null),[k,A]=_.useState(!1),[P,N]=_.useState(null),[I,D]=_.useState(!1),[z,H]=_.useState(!1),[te,q]=_.useState(null),[V,ae]=_.useState(!1),Ee=_.useCallback(()=>{t({...U.current})},[]);_.useEffect(()=>{tN=Ee},[Ee]),_.useEffect(()=>{de.log("App component mounted. Initializing localization and GameState.","UI");const pe=async()=>{await Er.loadTranslations(),p(!0),v(Er.getCurrentLanguage());const rt=Er.subscribe(Nt=>{v(Nt),de.log(`App language changed to: ${Nt}`,"UI")});return localStorage.getItem("pathOfHeroes_language")||f(!0),rt};let qe;pe().then(rt=>{qe=rt}),U.loadSoulData();const Xe=U.subscribe(t);return()=>{de.log("App component unmounting. Unsubscribing from GameState and Localization.","UI"),Xe(),qe&&qe()}},[]),_.useEffect(()=>{const pe=Lo.subscribe("saveComplete",()=>{D(!0),setTimeout(()=>D(!1),2e3)}),qe=Lo.subscribe("saveError",Xe=>{de.log(`Auto-save failed: ${Xe.message}`,"ERROR")});return()=>{pe(),qe()}},[]);const Z=pe=>pe.completed?Te(pe):!pe.visited&&pe.type!==Ye.WALL&&pe.type!==Ye.EMPTY?"":tD[pe.type],Te=pe=>{switch(pe.type){case Ye.BATTLE:case Ye.ELITE:case Ye.BOSS:return"✅";case Ye.TREASURE:return"📦";case Ye.SHOP:return"🏪";case Ye.SHRINE:return"✨";case Ye.STAIRS:return"🔄";default:return""}},Se=(pe,qe)=>{if(qe)return"bg-rpg-primary animate-pulse";if(!pe.revealed)return"bg-rpg-bg-darker";if(pe.type===Ye.WALL)return"bg-rpg-secondary text-rpg-text opacity-60";if(pe.completed)switch(pe.type){case Ye.BATTLE:case Ye.ELITE:case Ye.BOSS:return"bg-uncommon bg-opacity-30 text-uncommon";case Ye.TREASURE:return"bg-legendary bg-opacity-30 text-legendary";case Ye.SHRINE:return"bg-epic bg-opacity-30 text-epic";case Ye.STAIRS:return"bg-rare bg-opacity-30 text-rare";default:return"bg-rpg-bg-darker"}return pe.type===Ye.STAIRS?"bg-rare bg-opacity-50 hover:bg-rare hover:bg-opacity-70 animate-pulse":"bg-rpg-bg-darker hover:bg-rpg-secondary hover:bg-opacity-50"},me=_.useCallback((pe,qe)=>{if(U.current.currentScreen!=="exploration")return;const Xe=U.current.playerPos,rt=Xe.x+pe,lt=Xe.y+qe,Nt=U.current.dungeon;if(Nt&&rt>=0&&rt<Nt[0].length&&lt>=0&&lt<Nt.length){const Vt=Nt[lt][rt];Vt.revealed&&Vt.type!==Ye.WALL&&(U.current.playerPos={x:rt,y:lt},Vt.visited||(Vt.visited=!0,Vt.completed||we(Vt)),Ee())}},[Ee]);_.useEffect(()=>{const pe=qe=>{if(U.current.currentScreen!=="exploration")return;let Xe=0,rt=0;const lt=Er.getCurrentLanguage()==="ar";switch(qe.key.toLowerCase()){case"arrowup":case"w":rt=-1;break;case"arrowdown":case"s":rt=1;break;case"arrowleft":case"a":Xe=lt?1:-1;break;case"arrowright":case"d":Xe=lt?-1:1;break;default:return}qe.preventDefault(),de.log(`Key press detected: ${qe.key}`,"INPUT"),me(Xe,rt)};return window.addEventListener("keydown",pe),()=>window.removeEventListener("keydown",pe)},[me]);const we=pe=>{if(de.log(`Handling event for room type: ${pe.type}`,"SYSTEM"),pe.encounter&&!pe.completed){const Xe=pe.type===Ye.BOSS?"boss":pe.type===Ye.ELITE?"elite":"battle";N({type:"intro",eventType:Xe,eventData:pe.encounter,onContinue:()=>{N(null),M(pe.encounter,Xe)}});return}const qe=(Xe,rt=null)=>{N({type:"intro",eventType:Xe,eventData:rt,onContinue:()=>{N(null),be(pe,Xe)}})};switch(pe.type){case Ye.SHOP:pe.completed||qe("shop");break;case Ye.TREASURE:pe.completed||be(pe,"treasure");break;case Ye.SHRINE:pe.completed||be(pe,"shrine");break;case Ye.STAIRS:pe.completed||qe("stairs");break;default:be(pe,pe.type)}},be=(pe,qe)=>{switch(qe){case"shop":U.update("currentScreen","shop"),pe.completed=!0;break;case"treasure":const Xe=3+Math.floor(Math.random()*7),rt=1+(U.current.currentFloor-1)*.2,lt=Math.floor(Xe*rt);U.addGold(lt),y({type:"gold",icon:"💎",title:ee("events.treasure"),message:ee("rewards.treasureChestFound",{amount:lt})}),pe.completed=!0;break;case"shrine":if(U.current.player){const Vt=Math.floor((U.current.currentFloor-1)*.5),or=[{nameKey:"blessings.strength",effect:"atk",bonus:3+Vt},{nameKey:"blessings.fortitude",effect:"def",bonus:2+Vt},{nameKey:"blessings.swiftness",effect:"spd",bonus:2+Vt},{nameKey:"blessings.fortune",effect:"crit",bonus:5+Vt*2}],gr=or[Math.floor(Math.random()*or.length)];U.current.player.stats[gr.effect]+=gr.bonus,U.current.player.maxStats[gr.effect]+=gr.bonus,y({type:"blessing",icon:"⛩️",title:ee("events.shrine"),message:ee("rewards.shrineBlessing",{blessing:ee(gr.nameKey),stat:ee(`stats.${gr.effect}`),bonus:gr.bonus})}),pe.completed=!0}break;case"stairs":const Nt=U.nextFloor();y({type:"floor_complete",message:ee("rewards.floorComplete",{floor:U.current.currentFloor-1,gold:Nt.gold,souls:Nt.souls})}),Lo.performAutoSave(zo.FLOOR_COMPLETE),setTimeout(()=>{U.resetForNewFloor(),Ig()},2e3),pe.completed=!0;break}Ee()},X=pe=>{N({type:"outro",eventType:pe,onContinue:()=>{N(null),U.update("currentScreen","exploration")}})},M=(pe,qe="battle")=>{if(qe==="boss"||qe==="elite")q(pe),H(!0);else{const rt=pe.map(lt=>({...lt}));n([]),U.current.onBattleEnd=G,U.update("currentScreen","battle"),Ns.startBattleTimer(),Mg.startBattle(rt,{onLog:lt=>n(Nt=>[...Nt,lt])})}},J=pe=>{if(H(!1),te){const qe=te.map(Xe=>({...Xe}));n([]),U.current.onBattleEnd=G,U.update("currentScreen","battle"),Ns.startBattleTimer(),Mg.startBattle(qe,{onLog:Xe=>n(rt=>[...rt,Xe])}),q(null)}},G=(pe,qe)=>{de.log(`Battle ended. Victory: ${pe}`,"SYSTEM");const Xe=Ns.endBattleTimer(),rt=pe?qe.reduce((Nt,Vt)=>Nt+(Vt.gold||0),0):0,lt=pe?0:U.current.gold*.1;if(fa.trackBattle({victory:pe,characterId:U.current.selectedCharacter,floor:U.current.currentFloor,goldGained:rt,goldLost:lt,damageDealt:0,damageTaken:0,duration:Xe||0}),pe){const{x:Nt,y:Vt}=U.current.playerPos,or=U.current.dungeon[Vt][Nt];or.completed=!0;const gr=qe.reduce((Ma,sn)=>Ma+(sn.xp||0),0);U.addGold(rt),U.addExperience(gr);const Da=or.type===Ye.BOSS;Da&&(sD(),de.log("Boss defeated! Stairs to next floor have appeared!","SYSTEM"),Lo.performAutoSave(zo.BOSS_DEFEAT),fa.trackFloorComplete(U.current.currentFloor,U.current.selectedCharacter)),i({gold:rt,xp:gr}),u({duration:Xe||30,isBoss:Da,floor:U.current.currentFloor})}else{const Nt=U.applyDeathPenalty();i(Nt),u({duration:Xe||30,isBoss:!1,floor:U.current.currentFloor})}U.update("currentScreen","outcome")},K=()=>{if(i(null),u(null),U.current.player&&U.current.player.stats&&U.current.player.stats.hp>0){const{x:pe,y:qe}=U.current.playerPos,Xe=U.current.dungeon[qe][pe],rt=Xe.type===Ye.BOSS?"boss":Xe.type===Ye.ELITE?"elite":"battle";N({type:"outro",eventType:rt,onContinue:()=>{N(null),U.update("currentScreen","exploration")}})}else U.collectRunSouls(),Lo.performAutoSave(zo.PLAYER_DEATH),U.reset()};if(de.log(`Rendering screen: ${e.currentScreen}`,"UI"),!d)return b.jsx("div",{className:"min-h-screen bg-rpg-radial text-rpg-text flex items-center justify-center",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl mb-4",children:"🌍"}),b.jsx("div",{className:"text-lg text-rpg-text opacity-80",children:"Loading..."})]})});if(c)return b.jsx(gD,{onLanguageSelected:()=>f(!1)});if(z)return b.jsxs(b.Fragment,{children:[b.jsx(v8,{onBuffSelected:J}),b.jsx(la,{})]});if(P)return b.jsxs(b.Fragment,{children:[b.jsx(g8,{...P}),b.jsx(la,{})]});if(e.currentScreen==="outcome")return b.jsxs(b.Fragment,{children:[b.jsx(TD,{victory:e.player&&e.player.stats&&e.player.stats.hp>0,results:a,battleContext:o,onContinue:K}),b.jsx(la,{})]});if(e.currentScreen==="battle")return b.jsxs(b.Fragment,{children:[b.jsx(yD,{player:e.player,enemies:e.enemies,combatSystem:Mg,combatLog:r}),b.jsx(la,{}),b.jsx(Dg,{})]});if(e.currentScreen==="shop")return b.jsxs(b.Fragment,{children:[b.jsx(_D,{inventorySystem:nJ,onLeave:()=>X("shop")}),b.jsx(la,{}),b.jsx(Dg,{})]});if(e.currentScreen==="analytics")return b.jsxs(b.Fragment,{children:[b.jsx(rJ,{}),b.jsx(la,{}),b.jsx(Dg,{})]});if(e.currentScreen==="save-slots")return b.jsxs(b.Fragment,{children:[b.jsx(_2,{characterId:e.selectedCharacter,onBack:()=>{U.update("selectedCharacter",null),U.update("currentScreen","main-menu")},onGameStart:()=>{Ee()}}),b.jsx(la,{})]});if(S&&k)return b.jsxs(b.Fragment,{children:[b.jsx(_2,{characterId:S,onBack:()=>{T(null),A(!1)},onGameStart:()=>{T(null),A(!1),Ee()}}),b.jsx(la,{})]});if(!e.gameStarted||e.currentScreen==="main-menu")return b.jsxs(b.Fragment,{children:[b.jsx(iJ,{onCharacterSelect:pe=>{T(pe),A(!0)},currentLanguage:m}),b.jsx(la,{})]});const he=e.dungeon||[],Oe=e.playerPos,Ne=e.player,re=U.getRequiredExperience(e.level),ye=U.getRequiredExperience(e.level+1),Be=ye-re,ge=Math.max(0,e.experience-re),ot=Be>0?ge/Be*100:0,ze=e.selectedCharacter,bt=U.getCurrentSaveSlot(),at=ze?U.getCharacterSouls(ze,bt):0;return he.length===0||!Oe?b.jsxs("div",{className:"min-h-screen bg-rpg-radial text-rpg-text flex items-center justify-center",children:[b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl mb-4",children:"🏗️"}),b.jsx("div",{className:"text-lg text-rpg-text opacity-80",children:ee("menu.loading")})]}),b.jsx(la,{})]}):b.jsxs("div",{className:"w-full max-w-2xl h-[90vh] bg-rpg-radial text-rpg-text p-1 flex flex-col overflow-hidden mx-auto",children:[I&&b.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-uncommon text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 animate-fade-in",children:[b.jsx("span",{children:"💾"}),b.jsx("span",{className:"font-bold",children:ee("system.gameSaved")})]}),b.jsxs("div",{className:"bg-rpg-bg-darker bg-opacity-80 rounded-lg px-2 py-1 mb-0.5 border border-rpg-primary shrink-0 backdrop-blur-sm",children:[b.jsxs("div",{className:"grid grid-cols-4 gap-1.5 text-center text-xs mb-1",children:[b.jsxs("div",{children:[b.jsx("div",{className:"text-rpg-text opacity-70 text-xs leading-none",children:ee("stats.floor")}),b.jsx("div",{className:"text-rpg-primary font-bold text-sm leading-none",children:e.currentFloor})]}),b.jsxs("div",{children:[b.jsx("div",{className:"text-rpg-text opacity-70 text-xs leading-none",children:ee("stats.level")}),b.jsx("div",{className:"text-mana-light font-bold text-sm leading-none",children:e.level})]}),b.jsxs("div",{children:[b.jsx("div",{className:"text-rpg-text opacity-70 text-xs leading-none",children:ee("stats.gold")}),b.jsx("div",{className:"text-legendary font-bold text-sm leading-none",children:e.gold})]}),b.jsxs("div",{children:[b.jsx("div",{className:"text-rpg-text opacity-70 text-xs leading-none",children:ee("stats.souls")}),b.jsx("div",{className:"text-epic font-bold text-sm leading-none",children:at+e.currentRunSouls})]})]}),b.jsxs("div",{className:"flex items-center gap-1.5",children:[b.jsxs("div",{className:"flex-1",children:[b.jsxs("div",{className:"flex justify-between text-[10px] text-rpg-text opacity-70 leading-none mb-0.5",children:[b.jsxs("span",{children:["XP: ",e.experience,"/",ye]}),b.jsxs("span",{children:[Math.floor(ot),"%"]})]}),b.jsx(SD,{current:ge,max:Be,color:"bg-mana-light",showNumbers:!1})]}),Ne&&b.jsxs("div",{className:"text-xs text-center",children:[b.jsx(Za,{className:"leading-none mb-0.5",children:"HP"}),b.jsxs("div",{className:"text-health-mid font-bold text-xs leading-none",children:[Ne.stats.hp,"/",Ne.maxStats.hp]})]})]})]}),b.jsx("div",{className:"shrink-0 mb-0.5",children:b.jsxs(ol,{onClick:()=>ae(!0),className:"w-full bg-gradient-to-r from-rpg-secondary to-rpg-primary hover:from-rpg-primary hover:to-rpg-secondary text-black flex items-center justify-center gap-1.5",children:[b.jsx("span",{className:"text-base",children:"🎒"}),b.jsx("span",{children:"Inventory"})]})}),b.jsxs("div",{className:"bg-rpg-bg-darker bg-opacity-60 rounded-lg p-1 border border-rpg-secondary flex-1 flex flex-col justify-center min-h-0 backdrop-blur-sm",children:[b.jsx("div",{className:"grid grid-cols-5 gap-0.5 w-full h-full max-h-full",children:he.map((pe,qe)=>pe.map((Xe,rt)=>{const lt=Oe&&Oe.x===rt&&Oe.y===qe;return b.jsx("div",{className:`flex items-center justify-center text-base sm:text-lg rounded transition-colors ${Xe.revealed&&Xe.type!==Ye.WALL?"cursor-pointer":"cursor-default"} ${Se(Xe,lt)}`,onClick:()=>{Xe.revealed&&Xe.type!==Ye.WALL&&Oe&&Math.abs(rt-Oe.x)+Math.abs(qe-Oe.y)===1&&me(rt-Oe.x,qe-Oe.y)},children:lt?"🧍":Xe.revealed?Z(Xe):""},`${rt},${qe}`)}))}),b.jsx("div",{className:"text-center text-[10px] text-rpg-text opacity-60 mt-0.5 px-1 leading-tight shrink-0",children:ee("exploration.controls")})]}),b.jsx(la,{}),x&&b.jsx(kD,{reward:x,onClose:()=>y(null)}),V&&b.jsx(y8,{onClose:()=>ae(!1)})]})}function iJ({onCharacterSelect:e,currentLanguage:t}){return b.jsx(Rv,{className:"justify-center items-center",children:b.jsxs(OT,{className:"items-center max-w-md w-full",children:[b.jsx(Xu,{className:"mb-2",children:ee("game.title")}),b.jsx(An,{className:"text-center opacity-80 mb-4",large:!0,children:ee("game.subtitle")}),b.jsxs(DT,{onClick:()=>{const r=t==="en"?"ar":"en";Er.setLanguage(r)},className:"mb-4",children:["🌍 ",t==="en"?"العربية":"English"]}),b.jsx("div",{className:"flex flex-col gap-3 w-full",children:Object.values(Xo).map(r=>b.jsxs(ol,{onClick:()=>e(r.id),className:"w-full text-left backdrop-blur-sm py-3",children:[ee(r.nameKey)," ",b.jsxs(Za,{className:"inline opacity-70",children:["(",ee(r.roleKey),")"]})]},r.id))})]})})}de.initGlobalErrorHandling();de.log("main.jsx: Script start.","SYSTEM");try{X3.createRoot(document.getElementById("root")).render(b.jsx(gd.StrictMode,{children:b.jsx(aJ,{})})),de.log("main.jsx: React app mount initiated.","SYSTEM")}catch(e){de.log(`[FATAL] React failed to render: ${e.message}`,"ERROR"),console.error("Fatal error during React rendering:",e)}
